<html>
<head>
<title>Modules/_hashopenssl.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3353.html'>Modules</a>/_hashopenssl.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L77'>[^]</a><a href='#L640'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L77' title='Defined at 77.'>DEFINE_CONSTS_FOR_NEW</a>
<li><a href='#L105' title='Defined at 105.'>EVP_hash</a>
<li><a href='#L123' title='Defined at 123.'>EVP_dealloc</a>
<li><a href='#L134' title='Defined at 134.'>locked_EVP_MD_CTX_copy</a>
<li><a href='#L147' title='Defined at 147.'>EVP_copy</a>
<li><a href='#L162' title='Defined at 162.'>EVP_digest</a>
<li><a href='#L182' title='Defined at 182.'>EVP_hexdigest</a>
<li><a href='#L221' title='Defined at 221.'>EVP_update</a>
<li><a href='#L263' title='Defined at 263.'>EVP_get_block_size</a>
<li><a href='#L271' title='Defined at 271.'>EVP_get_digest_size</a>
<li><a href='#L297' title='Defined at 297.'>EVP_repr</a>
<li><a href='#L304' title='Defined at 304.'>EVP_tp_init</a>
<li><a href='#L417' title='Defined at 417.'>EVPnew</a>
<li><a href='#L461' title='Defined at 461.'>EVP_new</a>
<li><a href='#L503' title='Defined at 503.'>_openssl_hash_name_mapper</a>
<li><a href='#L531' title='Defined at 531.'>generate_hash_name_list</a>
<li><a href='#L640' title='Defined at 640.'>PyInit__hashlib</a>
</ol>
<hr>
<pre>
<a name='L1'><i><font color='green'>/* Module that wraps all OpenSSL hash algorithms */</font></i>
<a name='L2'>
<a name='L3'><i><font color='green'>/*</font></i>
<a name='L4'><i><font color='green'> * Copyright (C) 2005-2010   Gregory P. Smith (greg@krypto.org)</font></i>
<a name='L5'><i><font color='green'> * Licensed to PSF under a Contributor Agreement.</font></i>
<a name='L6'><i><font color='green'> *</font></i>
<a name='L7'><i><font color='green'> * Derived from a skeleton of shamodule.c containing work performed by:</font></i>
<a name='L8'><i><font color='green'> *</font></i>
<a name='L9'><i><font color='green'> * Andrew Kuchling (amk@amk.ca)</font></i>
<a name='L10'><i><font color='green'> * Greg Stein (gstein@lyra.org)</font></i>
<a name='L11'><i><font color='green'> *</font></i>
<a name='L12'><i><font color='green'> */</font></i>
<a name='L13'>
<a name='L14'><font color='darkred'>#define</font> <a href='../R/2388.html' title='Multiple refered from 2 places.'>PY_SSIZE_T_CLEAN</a>
<a name='L15'>
<a name='L16'><font color='darkred'>#include</font> "<a href='570.html'>Python.h</a>"
<a name='L17'><font color='darkred'>#include</font> "<a href='577.html'>structmember.h</a>"
<a name='L18'><font color='darkred'>#include</font> "<a href='2682.html'>hashlib.h</a>"
<a name='L19'>
<a name='L20'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L21'><font color='darkred'>#include</font> "<a href='572.html'>pythread.h</a>"
<a name='L22'><font color='darkred'>    #define</font> <a href='../S/2566.html#L136' title='Refered from 136 in Modules/_hashopenssl.c.'>ENTER_HASHLIB</a>(obj) \
<a name='L23'>        <b>if</b> ((obj)-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>) <font color='red'>{</font> \
<a name='L24'>            <b>if</b> (!<a href='../D/3846.html' title='Multiple defined in 10 places.'>PyThread_acquire_lock</a>((obj)-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>, 0)) <font color='red'>{</font> \
<a name='L25'>                <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a> \
<a name='L26'>                <a href='../D/3846.html' title='Multiple defined in 10 places.'>PyThread_acquire_lock</a>((obj)-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>, 1); \
<a name='L27'>                <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a> \
<a name='L28'>            <font color='red'>}</font> \
<a name='L29'>        <font color='red'>}</font>
<a name='L30'><font color='darkred'>    #define</font> <a href='../S/2566.html#L138' title='Refered from 138 in Modules/_hashopenssl.c.'>LEAVE_HASHLIB</a>(obj) \
<a name='L31'>        <b>if</b> ((obj)-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>) <font color='red'>{</font> \
<a name='L32'>            <a href='../D/3858.html' title='Multiple defined in 11 places.'>PyThread_release_lock</a>((obj)-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>); \
<a name='L33'>        <font color='red'>}</font>
<a name='L34'><font color='darkred'>#else</font>
<a name='L35'><font color='darkred'>    #define</font> <a href='../S/2566.html#L136' title='Refered from 136 in Modules/_hashopenssl.c.'>ENTER_HASHLIB</a>(obj)
<a name='L36'><font color='darkred'>    #define</font> <a href='../S/2566.html#L138' title='Refered from 138 in Modules/_hashopenssl.c.'>LEAVE_HASHLIB</a>(obj)
<a name='L37'><font color='darkred'>#endif</font>
<a name='L38'>
<a name='L39'><i><font color='green'>/* EVP is the preferred interface to hashing in OpenSSL */</font></i>
<a name='L40'><font color='darkred'>#include</font> &lt;openssl/evp.h&gt;
<a name='L41'><i><font color='green'>/* We use the object interface to discover what hashes OpenSSL supports. */</font></i>
<a name='L42'><font color='darkred'>#include</font> &lt;openssl/objects.h&gt;
<a name='L43'>
<a name='L44'><font color='darkred'>#define</font> <a href='../R/1990.html' title='Multiple refered from 2 places.'>MUNCH_SIZE</a> <a href='../S/565.html#L753' title='Defined at 753 in Include/pyport.h.'>INT_MAX</a>
<a name='L45'>
<a name='L46'><i><font color='green'>/* TODO(gps): We should probably make this a module or EVPobject attribute</font></i>
<a name='L47'><i><font color='green'> * to allow the user to optimize based on the platform they're using. */</font></i>
<a name='L48'><font color='darkred'>#define</font> <a href='../R/1308.html' title='Multiple refered from 3 places.'>HASHLIB_GIL_MINSIZE</a> 2048
<a name='L49'>
<a name='L50'><font color='darkred'>#ifndef</font> <a href='../S/2566.html#L51' title='Defined at 51 in Modules/_hashopenssl.c.'>HASH_OBJ_CONSTRUCTOR</a>
<a name='L51'><font color='darkred'>#define</font> <a href='../R/1309.html' title='Multiple refered from 4 places.'>HASH_OBJ_CONSTRUCTOR</a> 0
<a name='L52'><font color='darkred'>#endif</font>
<a name='L53'>
<a name='L54'><i><font color='green'>/* Minimum OpenSSL version needed to support sha224 and higher. */</font></i>
<a name='L55'><font color='darkred'>#if</font> <b>defined</b>(OPENSSL_VERSION_NUMBER) &amp;&amp; (OPENSSL_VERSION_NUMBER &gt;= 0x00908000)
<a name='L56'><font color='darkred'>#define</font> <a href='../R/5341.html' title='Multiple refered from 4 places.'>_OPENSSL_SUPPORTS_SHA2</a>
<a name='L57'><font color='darkred'>#endif</font>
<a name='L58'>
<a name='L59'><b>typedef</b> <b>struct</b> <font color='red'>{</font>
<a name='L60'>    <a href='../S/544.html#L82' title='Defined at 82 in Include/object.h.'>PyObject_HEAD</a>
<a name='L61'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a>            *name;  <i><font color='green'>/* name of this hash algorithm */</font></i>
<a name='L62'>    EVP_MD_CTX           ctx;   <i><font color='green'>/* OpenSSL message digest context */</font></i>
<a name='L63'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L64'>    <a href='../S/572.html#L5' title='Defined at 5 in Include/pythread.h.'>PyThread_type_lock</a>   <a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>;  <i><font color='green'>/* OpenSSL context lock */</font></i>
<a name='L65'><font color='darkred'>#endif</font>
<a name='L66'><font color='red'>}</font> <a href='../R/915.html' title='Multiple refered from 5 places.'>EVPobject</a>;
<a name='L67'>
<a name='L68'>
<a name='L69'><b>static</b> <a href='../D/3899.html' title='Multiple defined in 3 places.'>PyTypeObject</a> EVPtype;
<a name='L70'>
<a name='L71'>
<a name='L72'><font color='darkred'>#define</font> <a href='../R/710.html' title='Multiple refered from 5 places.'>DEFINE_CONSTS_FOR_NEW</a>(Name)  \
<a name='L73'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *CONST_ ## <a href='../D/2364.html' title='Multiple defined in 2 places.'>Name</a> ## _name_obj; \
<a name='L74'>    <b>static</b> EVP_MD_CTX CONST_new_ ## <a href='../D/2364.html' title='Multiple defined in 2 places.'>Name</a> ## _ctx; \
<a name='L75'>    <b>static</b> EVP_MD_CTX *CONST_new_ ## <a href='../D/2364.html' title='Multiple defined in 2 places.'>Name</a> ## _ctx_p = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L76'>
<a name='L77'><a href='../R/710.html' title='Multiple refered from 5 places.'>DEFINE_CONSTS_FOR_NEW</a>(md5)
<a name='L78'><a href='../D/762.html' title='Multiple defined in 2 places.'>DEFINE_CONSTS_FOR_NEW</a>(sha1)
<a name='L79'><font color='darkred'>#ifdef</font> <a href='../S/2566.html#L56' title='Defined at 56 in Modules/_hashopenssl.c.'>_OPENSSL_SUPPORTS_SHA2</a>
<a name='L80'><a href='../D/762.html' title='Multiple defined in 2 places.'>DEFINE_CONSTS_FOR_NEW</a>(sha224)
<a name='L81'><a href='../D/762.html' title='Multiple defined in 2 places.'>DEFINE_CONSTS_FOR_NEW</a>(sha256)
<a name='L82'><a href='../D/762.html' title='Multiple defined in 2 places.'>DEFINE_CONSTS_FOR_NEW</a>(sha384)
<a name='L83'><a href='../D/762.html' title='Multiple defined in 2 places.'>DEFINE_CONSTS_FOR_NEW</a>(sha512)
<a name='L84'><font color='darkred'>#endif</font>
<a name='L85'>
<a name='L86'>
<a name='L87'><b>static</b> EVPobject *
<a name='L88'>newEVPobject(PyObject *name)
<a name='L89'><font color='red'>{</font>
<a name='L90'>    <a href='../S/2566.html#L66' title='Defined at 66 in Modules/_hashopenssl.c.'>EVPobject</a> *retval = (<a href='../S/2566.html#L66' title='Defined at 66 in Modules/_hashopenssl.c.'>EVPobject</a> *)PyObject_New(<a href='../S/2566.html#L66' title='Defined at 66 in Modules/_hashopenssl.c.'>EVPobject</a>, &amp;EVPtype);
<a name='L91'>
<a name='L92'>    <i><font color='green'>/* save the name for .name to return */</font></i>
<a name='L93'>    <b>if</b> (retval != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L94'>        Py_INCREF(name);
<a name='L95'>        retval-&gt;name = name;
<a name='L96'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L97'>        retval-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a> = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L98'><font color='darkred'>#endif</font>
<a name='L99'>    <font color='red'>}</font>
<a name='L100'>
<a name='L101'>    <b>return</b> retval;
<a name='L102'><font color='red'>}</font>
<a name='L103'>
<a name='L104'><b>static</b> <b>void</b>
<a name='L105'><a href='../R/908.html' title='Multiple refered from 7 places.'>EVP_hash</a>(EVPobject *self, <b>const</b> <b>void</b> *vp, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len)
<a name='L106'><font color='red'>{</font>
<a name='L107'>    <b>unsigned</b> <b>int</b> process;
<a name='L108'>    <b>const</b> <b>unsigned</b> <b>char</b> *cp = (<b>const</b> <b>unsigned</b> <b>char</b> *)vp;
<a name='L109'>    <b>while</b> (0 &lt; len) <font color='red'>{</font>
<a name='L110'>        <b>if</b> (len &gt; (<a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>)<a href='../S/2566.html#L44' title='Defined at 44 in Modules/_hashopenssl.c.'>MUNCH_SIZE</a>)
<a name='L111'>            process = <a href='../S/2566.html#L44' title='Defined at 44 in Modules/_hashopenssl.c.'>MUNCH_SIZE</a>;
<a name='L112'>        <b>else</b>
<a name='L113'>            process = <a href='../D/4230.html' title='Multiple defined in 2 places.'>Py_SAFE_DOWNCAST</a>(len, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>, <b>unsigned</b> <b>int</b>);
<a name='L114'>        EVP_DigestUpdate(&amp;self-&gt;ctx, (<b>const</b> <b>void</b>*)cp, process);
<a name='L115'>        len -= process;
<a name='L116'>        cp += process;
<a name='L117'>    <font color='red'>}</font>
<a name='L118'><font color='red'>}</font>
<a name='L119'>
<a name='L120'><i><font color='green'>/* Internal methods for a hash object */</font></i>
<a name='L121'>
<a name='L122'><b>static</b> <b>void</b>
<a name='L123'><a href='../S/2566.html#L378' title='Refered from 378 in Modules/_hashopenssl.c.'>EVP_dealloc</a>(EVPobject *self)
<a name='L124'><font color='red'>{</font>
<a name='L125'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L126'>    <b>if</b> (self-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L127'>        <a href='../D/3853.html' title='Multiple defined in 11 places.'>PyThread_free_lock</a>(self-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>);
<a name='L128'><font color='darkred'>#endif</font>
<a name='L129'>    EVP_MD_CTX_cleanup(&amp;self-&gt;ctx);
<a name='L130'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(self-&gt;name);
<a name='L131'>    PyObject_Del(self);
<a name='L132'><font color='red'>}</font>
<a name='L133'>
<a name='L134'><b>static</b> <b>void</b> <a href='../R/8752.html' title='Multiple refered from 3 places.'>locked_EVP_MD_CTX_copy</a>(EVP_MD_CTX *new_ctx_p, EVPobject *self)
<a name='L135'><font color='red'>{</font>
<a name='L136'>    <a href='../D/944.html' title='Multiple defined in 2 places.'>ENTER_HASHLIB</a>(self);
<a name='L137'>    EVP_MD_CTX_copy(new_ctx_p, &amp;self-&gt;ctx);
<a name='L138'>    <a href='../D/1895.html' title='Multiple defined in 2 places.'>LEAVE_HASHLIB</a>(self);
<a name='L139'><font color='red'>}</font>
<a name='L140'>
<a name='L141'><i><font color='green'>/* External methods for a hash object */</font></i>
<a name='L142'>
<a name='L143'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EVP_copy__doc__, "Return a copy of the hash object.");
<a name='L144'>
<a name='L145'>
<a name='L146'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L147'><a href='../S/2566.html#L258' title='Refered from 258 in Modules/_hashopenssl.c.'>EVP_copy</a>(EVPobject *self, PyObject *unused)
<a name='L148'><font color='red'>{</font>
<a name='L149'>    <a href='../S/2566.html#L66' title='Defined at 66 in Modules/_hashopenssl.c.'>EVPobject</a> *newobj;
<a name='L150'>
<a name='L151'>    <b>if</b> ( (newobj = newEVPobject(self-&gt;name))==<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L152'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L153'>
<a name='L154'>    <a href='../S/2566.html#L134' title='Defined at 134 in Modules/_hashopenssl.c.'>locked_EVP_MD_CTX_copy</a>(&amp;newobj-&gt;ctx, self);
<a name='L155'>    <b>return</b> (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)newobj;
<a name='L156'><font color='red'>}</font>
<a name='L157'>
<a name='L158'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EVP_digest__doc__,
<a name='L159'>"Return the digest value as a string of binary data.");
<a name='L160'>
<a name='L161'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L162'><a href='../S/2566.html#L256' title='Refered from 256 in Modules/_hashopenssl.c.'>EVP_digest</a>(EVPobject *self, PyObject *unused)
<a name='L163'><font color='red'>{</font>
<a name='L164'>    <b>unsigned</b> <b>char</b> digest[EVP_MAX_MD_SIZE];
<a name='L165'>    EVP_MD_CTX temp_ctx;
<a name='L166'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *retval;
<a name='L167'>    <b>unsigned</b> <b>int</b> digest_size;
<a name='L168'>
<a name='L169'>    <a href='../S/2566.html#L134' title='Defined at 134 in Modules/_hashopenssl.c.'>locked_EVP_MD_CTX_copy</a>(&amp;temp_ctx, self);
<a name='L170'>    digest_size = EVP_MD_CTX_size(&amp;temp_ctx);
<a name='L171'>    EVP_DigestFinal(&amp;temp_ctx, digest, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L172'>
<a name='L173'>    retval = <a href='../S/2779.html#L70' title='Defined at 70 in Objects/bytesobject.c.'>PyBytes_FromStringAndSize</a>((<b>const</b> <b>char</b> *)digest, digest_size);
<a name='L174'>    EVP_MD_CTX_cleanup(&amp;temp_ctx);
<a name='L175'>    <b>return</b> retval;
<a name='L176'><font color='red'>}</font>
<a name='L177'>
<a name='L178'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EVP_hexdigest__doc__,
<a name='L179'>"Return the digest value as a string of hexadecimal digits.");
<a name='L180'>
<a name='L181'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L182'><a href='../S/2566.html#L257' title='Refered from 257 in Modules/_hashopenssl.c.'>EVP_hexdigest</a>(EVPobject *self, PyObject *unused)
<a name='L183'><font color='red'>{</font>
<a name='L184'>    <b>unsigned</b> <b>char</b> digest[EVP_MAX_MD_SIZE];
<a name='L185'>    EVP_MD_CTX temp_ctx;
<a name='L186'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *retval;
<a name='L187'>    <b>char</b> *hex_digest;
<a name='L188'>    <b>unsigned</b> <b>int</b> i, j, digest_size;
<a name='L189'>
<a name='L190'>    <i><font color='green'>/* Get the raw (binary) digest value */</font></i>
<a name='L191'>    <a href='../S/2566.html#L134' title='Defined at 134 in Modules/_hashopenssl.c.'>locked_EVP_MD_CTX_copy</a>(&amp;temp_ctx, self);
<a name='L192'>    digest_size = EVP_MD_CTX_size(&amp;temp_ctx);
<a name='L193'>    EVP_DigestFinal(&amp;temp_ctx, digest, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L194'>
<a name='L195'>    EVP_MD_CTX_cleanup(&amp;temp_ctx);
<a name='L196'>
<a name='L197'>    <i><font color='green'>/* Allocate a new buffer */</font></i>
<a name='L198'>    hex_digest = <a href='../S/2803.html#L1769' title='Defined at 1769 in Objects/object.c.'>PyMem_Malloc</a>(digest_size * 2 + 1);
<a name='L199'>    <b>if</b> (!hex_digest)
<a name='L200'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L201'>
<a name='L202'>    <i><font color='green'>/* Make hex version of the digest */</font></i>
<a name='L203'>    <b>for</b>(i=j=0; i&lt;digest_size; i++) <font color='red'>{</font>
<a name='L204'>        <b>char</b> c;
<a name='L205'>        c = (digest[i] &gt;&gt; 4) &amp; 0xf;
<a name='L206'>        c = (c&gt;9) ? c+'a'-10 : c + '0';
<a name='L207'>        hex_digest[j++] = c;
<a name='L208'>        c = (digest[i] &amp; 0xf);
<a name='L209'>        c = (c&gt;9) ? c+'a'-10 : c + '0';
<a name='L210'>        hex_digest[j++] = c;
<a name='L211'>    <font color='red'>}</font>
<a name='L212'>    retval = <a href='../D/4013.html' title='Multiple defined in 3 places.'>PyUnicode_FromStringAndSize</a>(hex_digest, digest_size * 2);
<a name='L213'>    <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(hex_digest);
<a name='L214'>    <b>return</b> retval;
<a name='L215'><font color='red'>}</font>
<a name='L216'>
<a name='L217'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EVP_update__doc__,
<a name='L218'>"Update this hash object's state with the provided string.");
<a name='L219'>
<a name='L220'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L221'><a href='../S/2566.html#L255' title='Refered from 255 in Modules/_hashopenssl.c.'>EVP_update</a>(EVPobject *self, PyObject *args)
<a name='L222'><font color='red'>{</font>
<a name='L223'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obj;
<a name='L224'>    <a href='../S/544.html#L163' title='Defined at 163 in Include/object.h.'>Py_buffer</a> view;
<a name='L225'>
<a name='L226'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O:update", &amp;obj))
<a name='L227'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L228'>
<a name='L229'>    <a href='../S/2682.html#L8' title='Defined at 8 in Modules/hashlib.h.'>GET_BUFFER_VIEW_OR_ERROUT</a>(obj, &amp;view);
<a name='L230'>
<a name='L231'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L232'>    <b>if</b> (self-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a> == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; view.len &gt;= <a href='../S/2566.html#L48' title='Defined at 48 in Modules/_hashopenssl.c.'>HASHLIB_GIL_MINSIZE</a>) <font color='red'>{</font>
<a name='L233'>        self-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a> = <a href='../D/3848.html' title='Multiple defined in 11 places.'>PyThread_allocate_lock</a>();
<a name='L234'>        <i><font color='green'>/* fail? lock = NULL and we fail over to non-threaded code. */</font></i>
<a name='L235'>    <font color='red'>}</font>
<a name='L236'>
<a name='L237'>    <b>if</b> (self-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L238'>        <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L239'>        <a href='../D/3846.html' title='Multiple defined in 10 places.'>PyThread_acquire_lock</a>(self-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>, 1);
<a name='L240'>        <a href='../S/2566.html#L105' title='Defined at 105 in Modules/_hashopenssl.c.'>EVP_hash</a>(self, view.buf, view.len);
<a name='L241'>        <a href='../D/3858.html' title='Multiple defined in 11 places.'>PyThread_release_lock</a>(self-&gt;<a href='../S/3148.html#L9' title='Defined at 9 in Python/thread_lwp.h.'>lock</a>);
<a name='L242'>        <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L243'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L244'>        <a href='../S/2566.html#L105' title='Defined at 105 in Modules/_hashopenssl.c.'>EVP_hash</a>(self, view.buf, view.len);
<a name='L245'>    <font color='red'>}</font>
<a name='L246'><font color='darkred'>#else</font>
<a name='L247'>    <a href='../S/2566.html#L105' title='Defined at 105 in Modules/_hashopenssl.c.'>EVP_hash</a>(self, view.buf, view.len);
<a name='L248'><font color='darkred'>#endif</font>
<a name='L249'>
<a name='L250'>    <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view);
<a name='L251'>    <a href='../S/2562.html#L112' title='Defined at 112 in Modules/_elementtree.c.'>Py_RETURN_NONE</a>;
<a name='L252'><font color='red'>}</font>
<a name='L253'>
<a name='L254'><b>static</b> <a href='../D/3525.html' title='Multiple defined in 3 places.'>PyMethodDef</a> EVP_methods[] = <font color='red'>{</font>
<a name='L255'>    <font color='red'>{</font>"update",    (PyCFunction)<a href='../S/2566.html#L221' title='Defined at 221 in Modules/_hashopenssl.c.'>EVP_update</a>,    <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, EVP_update__doc__<font color='red'>}</font>,
<a name='L256'>    <font color='red'>{</font>"digest",    (PyCFunction)<a href='../S/2566.html#L162' title='Defined at 162 in Modules/_hashopenssl.c.'>EVP_digest</a>,    <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  EVP_digest__doc__<font color='red'>}</font>,
<a name='L257'>    <font color='red'>{</font>"hexdigest", (PyCFunction)<a href='../S/2566.html#L182' title='Defined at 182 in Modules/_hashopenssl.c.'>EVP_hexdigest</a>, <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  EVP_hexdigest__doc__<font color='red'>}</font>,
<a name='L258'>    <font color='red'>{</font>"copy",      (PyCFunction)<a href='../S/2566.html#L147' title='Defined at 147 in Modules/_hashopenssl.c.'>EVP_copy</a>,      <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  EVP_copy__doc__<font color='red'>}</font>,
<a name='L259'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>  <i><font color='green'>/* sentinel */</font></i>
<a name='L260'><font color='red'>}</font>;
<a name='L261'>
<a name='L262'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L263'><a href='../S/2566.html#L289' title='Refered from 289 in Modules/_hashopenssl.c.'>EVP_get_block_size</a>(EVPobject *self, <b>void</b> *closure)
<a name='L264'><font color='red'>{</font>
<a name='L265'>    <b>long</b> block_size;
<a name='L266'>    block_size = EVP_MD_CTX_block_size(&amp;self-&gt;ctx);
<a name='L267'>    <b>return</b> <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(block_size);
<a name='L268'><font color='red'>}</font>
<a name='L269'>
<a name='L270'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L271'><a href='../S/2566.html#L285' title='Refered from 285 in Modules/_hashopenssl.c.'>EVP_get_digest_size</a>(EVPobject *self, <b>void</b> *closure)
<a name='L272'><font color='red'>{</font>
<a name='L273'>    <b>long</b> size;
<a name='L274'>    size = EVP_MD_CTX_size(&amp;self-&gt;ctx);
<a name='L275'>    <b>return</b> <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(size);
<a name='L276'><font color='red'>}</font>
<a name='L277'>
<a name='L278'><b>static</b> <a href='../D/3506.html' title='Multiple defined in 2 places.'>PyMemberDef</a> EVP_members[] = <font color='red'>{</font>
<a name='L279'>    <font color='red'>{</font>"name", <a href='../S/577.html#L44' title='Defined at 44 in Include/structmember.h.'>T_OBJECT</a>, <a href='../D/10194.html' title='Multiple defined in 2 places.'>offsetof</a>(<a href='../S/2566.html#L66' title='Defined at 66 in Modules/_hashopenssl.c.'>EVPobject</a>, name), <a href='../S/577.html#L73' title='Defined at 73 in Include/structmember.h.'>READONLY</a>, <a href='../D/3130.html' title='Multiple defined in 4 places.'>PyDoc_STR</a>("algorithm name.")<font color='red'>}</font>,
<a name='L280'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>  <i><font color='green'>/* Sentinel */</font></i>
<a name='L281'><font color='red'>}</font>;
<a name='L282'>
<a name='L283'><b>static</b> <a href='../D/3272.html' title='Multiple defined in 2 places.'>PyGetSetDef</a> EVP_getseters[] = <font color='red'>{</font>
<a name='L284'>    <font color='red'>{</font>"digest_size",
<a name='L285'>     (getter)<a href='../S/2566.html#L271' title='Defined at 271 in Modules/_hashopenssl.c.'>EVP_get_digest_size</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L286'>     <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L287'>     <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>,
<a name='L288'>    <font color='red'>{</font>"block_size",
<a name='L289'>     (getter)<a href='../S/2566.html#L263' title='Defined at 263 in Modules/_hashopenssl.c.'>EVP_get_block_size</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L290'>     <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L291'>     <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>,
<a name='L292'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>  <i><font color='green'>/* Sentinel */</font></i>
<a name='L293'><font color='red'>}</font>;
<a name='L294'>
<a name='L295'>
<a name='L296'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L297'><a href='../S/2566.html#L383' title='Refered from 383 in Modules/_hashopenssl.c.'>EVP_repr</a>(EVPobject *self)
<a name='L298'><font color='red'>{</font>
<a name='L299'>    <b>return</b> <a href='../D/4008.html' title='Multiple defined in 3 places.'>PyUnicode_FromFormat</a>("&lt;%U HASH object @ %p&gt;", self-&gt;name, self);
<a name='L300'><font color='red'>}</font>
<a name='L301'>
<a name='L302'><font color='darkred'>#if</font> <a href='../S/2566.html#L51' title='Defined at 51 in Modules/_hashopenssl.c.'>HASH_OBJ_CONSTRUCTOR</a>
<a name='L303'><b>static</b> <b>int</b>
<a name='L304'><a href='../S/2566.html#L412' title='Refered from 412 in Modules/_hashopenssl.c.'>EVP_tp_init</a>(EVPobject *self, PyObject *args, PyObject *kwds)
<a name='L305'><font color='red'>{</font>
<a name='L306'>    <b>static</b> <b>char</b> *kwlist[] = <font color='red'>{</font>"name", "string", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L307'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *name_obj = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L308'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *data_obj = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L309'>    <a href='../S/544.html#L163' title='Defined at 163 in Include/object.h.'>Py_buffer</a> view;
<a name='L310'>    <b>char</b> *nameStr;
<a name='L311'>    <b>const</b> EVP_MD *digest;
<a name='L312'>
<a name='L313'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kwds, "O|O:HASH", kwlist,
<a name='L314'>                                     &amp;name_obj, &amp;data_obj)) <font color='red'>{</font>
<a name='L315'>        <b>return</b> -1;
<a name='L316'>    <font color='red'>}</font>
<a name='L317'>
<a name='L318'>    <b>if</b> (data_obj)
<a name='L319'>        <a href='../S/2682.html#L8' title='Defined at 8 in Modules/hashlib.h.'>GET_BUFFER_VIEW_OR_ERROUT</a>(data_obj, &amp;view);
<a name='L320'>
<a name='L321'>    <b>if</b> (!<a href='../S/541.html#L15' title='Defined at 15 in Include/modsupport.h.'>PyArg_Parse</a>(name_obj, "s", &amp;nameStr)) <font color='red'>{</font>
<a name='L322'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError, "name must be a string");
<a name='L323'>        <b>if</b> (data_obj)
<a name='L324'>            <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view);
<a name='L325'>        <b>return</b> -1;
<a name='L326'>    <font color='red'>}</font>
<a name='L327'>
<a name='L328'>    digest = EVP_get_digestbyname(nameStr);
<a name='L329'>    <b>if</b> (!digest) <font color='red'>{</font>
<a name='L330'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError, "unknown hash function");
<a name='L331'>        <b>if</b> (data_obj)
<a name='L332'>            <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view);
<a name='L333'>        <b>return</b> -1;
<a name='L334'>    <font color='red'>}</font>
<a name='L335'>    EVP_DigestInit(&amp;self-&gt;ctx, digest);
<a name='L336'>
<a name='L337'>    self-&gt;name = name_obj;
<a name='L338'>    Py_INCREF(self-&gt;name);
<a name='L339'>
<a name='L340'>    <b>if</b> (data_obj) <font color='red'>{</font>
<a name='L341'>        <b>if</b> (view.len &gt;= <a href='../S/2566.html#L48' title='Defined at 48 in Modules/_hashopenssl.c.'>HASHLIB_GIL_MINSIZE</a>) <font color='red'>{</font>
<a name='L342'>            <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L343'>            <a href='../S/2566.html#L105' title='Defined at 105 in Modules/_hashopenssl.c.'>EVP_hash</a>(self, view.buf, view.len);
<a name='L344'>            <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L345'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L346'>            <a href='../S/2566.html#L105' title='Defined at 105 in Modules/_hashopenssl.c.'>EVP_hash</a>(self, view.buf, view.len);
<a name='L347'>        <font color='red'>}</font>
<a name='L348'>        <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view);
<a name='L349'>    <font color='red'>}</font>
<a name='L350'>
<a name='L351'>    <b>return</b> 0;
<a name='L352'><font color='red'>}</font>
<a name='L353'><font color='darkred'>#endif</font>
<a name='L354'>
<a name='L355'>
<a name='L356'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(hashtype_doc,
<a name='L357'>"A hash represents the object used to calculate a checksum of a\n\
<a name='L358'>string of information.\n\
<a name='L359'>\n\
<a name='L360'>Methods:\n\
<a name='L361'>\n\
<a name='L362'>update() -- updates the current digest with an additional string\n\
<a name='L363'>digest() -- return the current digest value\n\
<a name='L364'>hexdigest() -- return the current digest as a string of hexadecimal digits\n\
<a name='L365'>copy() -- return a copy of the current hash object\n\
<a name='L366'>\n\
<a name='L367'>Attributes:\n\
<a name='L368'>\n\
<a name='L369'>name -- the hash algorithm being used by this object\n\
<a name='L370'>digest_size -- number of bytes in this hashes output\n");
<a name='L371'>
<a name='L372'><b>static</b> <a href='../D/3899.html' title='Multiple defined in 3 places.'>PyTypeObject</a> EVPtype = <font color='red'>{</font>
<a name='L373'>    <a href='../D/4042.html' title='Multiple defined in 3 places.'>PyVarObject_HEAD_INIT</a>(<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, 0)
<a name='L374'>    "_hashlib.HASH",    <i><font color='green'>/*tp_name*/</font></i>
<a name='L375'>    <b>sizeof</b>(<a href='../S/2566.html#L66' title='Defined at 66 in Modules/_hashopenssl.c.'>EVPobject</a>),  <i><font color='green'>/*tp_basicsize*/</font></i>
<a name='L376'>    0,                  <i><font color='green'>/*tp_itemsize*/</font></i>
<a name='L377'>    <i><font color='green'>/* methods */</font></i>
<a name='L378'>    (<a href='../D/8095.html' title='Multiple defined in 2 places.'>destructor</a>)<a href='../S/2566.html#L123' title='Defined at 123 in Modules/_hashopenssl.c.'>EVP_dealloc</a>, <i><font color='green'>/*tp_dealloc*/</font></i>
<a name='L379'>    0,                  <i><font color='green'>/*tp_print*/</font></i>
<a name='L380'>    0,                  <i><font color='green'>/*tp_getattr*/</font></i>
<a name='L381'>    0,                  <i><font color='green'>/*tp_setattr*/</font></i>
<a name='L382'>    0,                  <i><font color='green'>/*tp_reserved*/</font></i>
<a name='L383'>    (reprfunc)<a href='../S/2566.html#L297' title='Defined at 297 in Modules/_hashopenssl.c.'>EVP_repr</a>, <i><font color='green'>/*tp_repr*/</font></i>
<a name='L384'>    0,                  <i><font color='green'>/*tp_as_number*/</font></i>
<a name='L385'>    0,                  <i><font color='green'>/*tp_as_sequence*/</font></i>
<a name='L386'>    0,                  <i><font color='green'>/*tp_as_mapping*/</font></i>
<a name='L387'>    0,                  <i><font color='green'>/*tp_hash*/</font></i>
<a name='L388'>    0,                  <i><font color='green'>/*tp_call*/</font></i>
<a name='L389'>    0,                  <i><font color='green'>/*tp_str*/</font></i>
<a name='L390'>    0,                  <i><font color='green'>/*tp_getattro*/</font></i>
<a name='L391'>    0,                  <i><font color='green'>/*tp_setattro*/</font></i>
<a name='L392'>    0,                  <i><font color='green'>/*tp_as_buffer*/</font></i>
<a name='L393'>    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_BASETYPE, <i><font color='green'>/*tp_flags*/</font></i>
<a name='L394'>    hashtype_doc,       <i><font color='green'>/*tp_doc*/</font></i>
<a name='L395'>    0,                  <i><font color='green'>/*tp_traverse*/</font></i>
<a name='L396'>    0,                  <i><font color='green'>/*tp_clear*/</font></i>
<a name='L397'>    0,                  <i><font color='green'>/*tp_richcompare*/</font></i>
<a name='L398'>    0,                  <i><font color='green'>/*tp_weaklistoffset*/</font></i>
<a name='L399'>    0,                  <i><font color='green'>/*tp_iter*/</font></i>
<a name='L400'>    0,                  <i><font color='green'>/*tp_iternext*/</font></i>
<a name='L401'>    EVP_methods,        <i><font color='green'>/* tp_methods */</font></i>
<a name='L402'>    EVP_members,        <i><font color='green'>/* tp_members */</font></i>
<a name='L403'>    EVP_getseters,      <i><font color='green'>/* tp_getset */</font></i>
<a name='L404'><font color='darkred'>#if</font> 1
<a name='L405'>    0,                  <i><font color='green'>/* tp_base */</font></i>
<a name='L406'>    0,                  <i><font color='green'>/* tp_dict */</font></i>
<a name='L407'>    0,                  <i><font color='green'>/* tp_descr_get */</font></i>
<a name='L408'>    0,                  <i><font color='green'>/* tp_descr_set */</font></i>
<a name='L409'>    0,                  <i><font color='green'>/* tp_dictoffset */</font></i>
<a name='L410'><font color='darkred'>#endif</font>
<a name='L411'><font color='darkred'>#if</font> <a href='../S/2566.html#L51' title='Defined at 51 in Modules/_hashopenssl.c.'>HASH_OBJ_CONSTRUCTOR</a>
<a name='L412'>    (initproc)<a href='../S/2566.html#L304' title='Defined at 304 in Modules/_hashopenssl.c.'>EVP_tp_init</a>, <i><font color='green'>/* tp_init */</font></i>
<a name='L413'><font color='darkred'>#endif</font>
<a name='L414'><font color='red'>}</font>;
<a name='L415'>
<a name='L416'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L417'><a href='../R/914.html' title='Multiple refered from 2 places.'>EVPnew</a>(PyObject *name_obj,
<a name='L418'>       <b>const</b> EVP_MD *digest, <b>const</b> EVP_MD_CTX *initial_ctx,
<a name='L419'>       <b>const</b> <b>unsigned</b> <b>char</b> *cp, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len)
<a name='L420'><font color='red'>{</font>
<a name='L421'>    <a href='../S/2566.html#L66' title='Defined at 66 in Modules/_hashopenssl.c.'>EVPobject</a> *self;
<a name='L422'>
<a name='L423'>    <b>if</b> (!digest &amp;&amp; !initial_ctx) <font color='red'>{</font>
<a name='L424'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError, "unsupported hash type");
<a name='L425'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L426'>    <font color='red'>}</font>
<a name='L427'>
<a name='L428'>    <b>if</b> ((self = newEVPobject(name_obj)) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L429'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L430'>
<a name='L431'>    <b>if</b> (initial_ctx) <font color='red'>{</font>
<a name='L432'>        EVP_MD_CTX_copy(&amp;self-&gt;ctx, initial_ctx);
<a name='L433'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L434'>        EVP_DigestInit(&amp;self-&gt;ctx, digest);
<a name='L435'>    <font color='red'>}</font>
<a name='L436'>
<a name='L437'>    <b>if</b> (cp &amp;&amp; len) <font color='red'>{</font>
<a name='L438'>        <b>if</b> (len &gt;= <a href='../S/2566.html#L48' title='Defined at 48 in Modules/_hashopenssl.c.'>HASHLIB_GIL_MINSIZE</a>) <font color='red'>{</font>
<a name='L439'>            <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L440'>            <a href='../S/2566.html#L105' title='Defined at 105 in Modules/_hashopenssl.c.'>EVP_hash</a>(self, cp, len);
<a name='L441'>            <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L442'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L443'>            <a href='../S/2566.html#L105' title='Defined at 105 in Modules/_hashopenssl.c.'>EVP_hash</a>(self, cp, len);
<a name='L444'>        <font color='red'>}</font>
<a name='L445'>    <font color='red'>}</font>
<a name='L446'>
<a name='L447'>    <b>return</b> (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)self;
<a name='L448'><font color='red'>}</font>
<a name='L449'>
<a name='L450'>
<a name='L451'><i><font color='green'>/* The module-level function: new() */</font></i>
<a name='L452'>
<a name='L453'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EVP_new__doc__,
<a name='L454'>"Return a new hash object using the named algorithm.\n\
<a name='L455'>An optional string argument may be provided and will be\n\
<a name='L456'>automatically hashed.\n\
<a name='L457'>\n\
<a name='L458'>The MD5 and SHA1 algorithms are always supported.\n");
<a name='L459'>
<a name='L460'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L461'><a href='../S/2566.html#L611' title='Refered from 611 in Modules/_hashopenssl.c.'>EVP_new</a>(PyObject *self, PyObject *args, PyObject *kwdict)
<a name='L462'><font color='red'>{</font>
<a name='L463'>    <b>static</b> <b>char</b> *kwlist[] = <font color='red'>{</font>"name", "string", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L464'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *name_obj = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L465'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *data_obj = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L466'>    <a href='../S/544.html#L163' title='Defined at 163 in Include/object.h.'>Py_buffer</a> view = <font color='red'>{</font> 0 <font color='red'>}</font>;
<a name='L467'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *ret_obj;
<a name='L468'>    <b>char</b> *name;
<a name='L469'>    <b>const</b> EVP_MD *digest;
<a name='L470'>
<a name='L471'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kwdict, "O|O:new", kwlist,
<a name='L472'>                                     &amp;name_obj, &amp;data_obj)) <font color='red'>{</font>
<a name='L473'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L474'>    <font color='red'>}</font>
<a name='L475'>
<a name='L476'>    <b>if</b> (!<a href='../S/541.html#L15' title='Defined at 15 in Include/modsupport.h.'>PyArg_Parse</a>(name_obj, "s", &amp;name)) <font color='red'>{</font>
<a name='L477'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError, "name must be a string");
<a name='L478'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L479'>    <font color='red'>}</font>
<a name='L480'>
<a name='L481'>    <b>if</b> (data_obj)
<a name='L482'>        <a href='../S/2682.html#L8' title='Defined at 8 in Modules/hashlib.h.'>GET_BUFFER_VIEW_OR_ERROUT</a>(data_obj, &amp;view);
<a name='L483'>
<a name='L484'>    digest = EVP_get_digestbyname(name);
<a name='L485'>
<a name='L486'>    ret_obj = <a href='../S/2566.html#L417' title='Defined at 417 in Modules/_hashopenssl.c.'>EVPnew</a>(name_obj, digest, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, (<b>unsigned</b> <b>char</b>*)view.buf, view.len);
<a name='L487'>
<a name='L488'>    <b>if</b> (data_obj)
<a name='L489'>        <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view);
<a name='L490'>    <b>return</b> ret_obj;
<a name='L491'><font color='red'>}</font>
<a name='L492'>
<a name='L493'>
<a name='L494'><i><font color='green'>/* State for our callback function so that it can accumulate a result. */</font></i>
<a name='L495'><b>typedef</b> <b>struct</b> _internal_name_mapper_state <font color='red'>{</font>
<a name='L496'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *set;
<a name='L497'>    <b>int</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L498'><font color='red'>}</font> <a href='../R/5332.html' title='Multiple refered from 2 places.'>_InternalNameMapperState</a>;
<a name='L499'>
<a name='L500'>
<a name='L501'><i><font color='green'>/* A callback function to pass to OpenSSL's OBJ_NAME_do_all(...) */</font></i>
<a name='L502'><b>static</b> <b>void</b>
<a name='L503'><a href='../S/2566.html#L539' title='Refered from 539 in Modules/_hashopenssl.c.'>_openssl_hash_name_mapper</a>(<b>const</b> OBJ_NAME *openssl_obj_name, <b>void</b> *arg)
<a name='L504'><font color='red'>{</font>
<a name='L505'>    <a href='../S/2566.html#L498' title='Defined at 498 in Modules/_hashopenssl.c.'>_InternalNameMapperState</a> *<a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a> = (<a href='../S/2566.html#L498' title='Defined at 498 in Modules/_hashopenssl.c.'>_InternalNameMapperState</a> *)<a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>;
<a name='L506'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *py_name;
<a name='L507'>
<a name='L508'>    <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L509'>    <b>if</b> (openssl_obj_name == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L510'>        <b>return</b>;
<a name='L511'>    <i><font color='green'>/* Ignore aliased names, they pollute the list and OpenSSL appears to</font></i>
<a name='L512'><i><font color='green'>     * have a its own definition of alias as the resulting list still</font></i>
<a name='L513'><i><font color='green'>     * contains duplicate and alternate names for several algorithms.     */</font></i>
<a name='L514'>    <b>if</b> (openssl_obj_name-&gt;<a href='../D/6702.html' title='Multiple defined in 2 places.'>alias</a>)
<a name='L515'>        <b>return</b>;
<a name='L516'>
<a name='L517'>    py_name = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(openssl_obj_name-&gt;name);
<a name='L518'>    <b>if</b> (py_name == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L519'>        <a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>-&gt;<a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a> = 1;
<a name='L520'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L521'>        <b>if</b> (<a href='../S/2806.html#L2315' title='Defined at 2315 in Objects/setobject.c.'>PySet_Add</a>(<a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>-&gt;set, py_name) != 0) <font color='red'>{</font>
<a name='L522'>            Py_DECREF(py_name);
<a name='L523'>            <a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>-&gt;<a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a> = 1;
<a name='L524'>        <font color='red'>}</font>
<a name='L525'>    <font color='red'>}</font>
<a name='L526'><font color='red'>}</font>
<a name='L527'>
<a name='L528'>
<a name='L529'><i><font color='green'>/* Ask OpenSSL for a list of supported ciphers, filling in a Python set. */</font></i>
<a name='L530'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a>*
<a name='L531'><a href='../S/2566.html#L659' title='Refered from 659 in Modules/_hashopenssl.c.'>generate_hash_name_list</a>(<b>void</b>)
<a name='L532'><font color='red'>{</font>
<a name='L533'>    <a href='../S/2566.html#L498' title='Defined at 498 in Modules/_hashopenssl.c.'>_InternalNameMapperState</a> <a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>;
<a name='L534'>    <a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>.set = <a href='../S/2806.html#L2269' title='Defined at 2269 in Objects/setobject.c.'>PyFrozenSet_New</a>(<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L535'>    <b>if</b> (<a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>.set == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L536'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L537'>    <a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>.<a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a> = 0;
<a name='L538'>
<a name='L539'>    OBJ_NAME_do_all(OBJ_NAME_TYPE_MD_METH, &amp;<a href='../S/2566.html#L503' title='Defined at 503 in Modules/_hashopenssl.c.'>_openssl_hash_name_mapper</a>, &amp;<a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>);
<a name='L540'>
<a name='L541'>    <b>if</b> (<a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>.<a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>) <font color='red'>{</font>
<a name='L542'>        Py_DECREF(<a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>.set);
<a name='L543'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L544'>    <font color='red'>}</font>
<a name='L545'>    <b>return</b> <a href='../S/530.html#L46' title='Defined at 46 in Include/grammar.h.'>state</a>.set;
<a name='L546'><font color='red'>}</font>
<a name='L547'>
<a name='L548'>
<a name='L549'><i><font color='green'>/*</font></i>
<a name='L550'><i><font color='green'> *  This macro generates constructor function definitions for specific</font></i>
<a name='L551'><i><font color='green'> *  hash algorithms.  These constructors are much faster than calling</font></i>
<a name='L552'><i><font color='green'> *  the generic one passing it a python string and are noticably</font></i>
<a name='L553'><i><font color='green'> *  faster than calling a python new() wrapper.  Thats important for</font></i>
<a name='L554'><i><font color='green'> *  code that wants to make hashes of a bunch of small strings.</font></i>
<a name='L555'><i><font color='green'> */</font></i>
<a name='L556'><font color='darkred'>#define</font> <a href='../R/1229.html' title='Multiple refered from 6 places.'>GEN_CONSTRUCTOR</a>(NAME)  \
<a name='L557'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> * \
<a name='L558'>    EVP_new_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *self, <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>) \
<a name='L559'>    <font color='red'>{</font> \
<a name='L560'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *data_obj = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; \
<a name='L561'>        <a href='../S/544.html#L163' title='Defined at 163 in Include/object.h.'>Py_buffer</a> view = <font color='red'>{</font> 0 <font color='red'>}</font>; \
<a name='L562'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *ret_obj; \
<a name='L563'>     \
<a name='L564'>        <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "|O:" #<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> , &amp;data_obj)) <font color='red'>{</font> \
<a name='L565'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; \
<a name='L566'>        <font color='red'>}</font> \
<a name='L567'>     \
<a name='L568'>        <b>if</b> (data_obj) \
<a name='L569'>            <a href='../S/2682.html#L8' title='Defined at 8 in Modules/hashlib.h.'>GET_BUFFER_VIEW_OR_ERROUT</a>(data_obj, &amp;view); \
<a name='L570'>     \
<a name='L571'>        ret_obj = <a href='../S/2566.html#L417' title='Defined at 417 in Modules/_hashopenssl.c.'>EVPnew</a>( \
<a name='L572'>                    CONST_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> ## _name_obj, \
<a name='L573'>                    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, \
<a name='L574'>                    CONST_new_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> ## _ctx_p, \
<a name='L575'>                    (<b>unsigned</b> <b>char</b>*)view.buf, \
<a name='L576'>                    view.len); \
<a name='L577'>     \
<a name='L578'>        <b>if</b> (data_obj) \
<a name='L579'>            <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view); \
<a name='L580'>        <b>return</b> ret_obj; \
<a name='L581'>    <font color='red'>}</font>
<a name='L582'>
<a name='L583'><i><font color='green'>/* a PyMethodDef structure for the constructor */</font></i>
<a name='L584'><font color='darkred'>#define</font> <a href='../R/574.html' title='Multiple refered from 6 places.'>CONSTRUCTOR_METH_DEF</a>(NAME)  \
<a name='L585'>    <font color='red'>{</font>"openssl_" #<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a>, (PyCFunction)EVP_new_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, \
<a name='L586'>        <a href='../D/3130.html' title='Multiple defined in 4 places.'>PyDoc_STR</a>("Returns a " #<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> \
<a name='L587'>                  " hash object; optionally initialized with a string") \
<a name='L588'>    <font color='red'>}</font>
<a name='L589'>
<a name='L590'><i><font color='green'>/* used in the init function to setup a constructor */</font></i>
<a name='L591'><font color='darkred'>#define</font> <a href='../R/1522.html' title='Multiple refered from 6 places.'>INIT_CONSTRUCTOR_CONSTANTS</a>(NAME)  <b>do</b> <font color='red'>{</font> \
<a name='L592'>    CONST_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> ## _name_obj = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(#<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a>); \
<a name='L593'>    <b>if</b> (EVP_get_digestbyname(#<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a>)) <font color='red'>{</font> \
<a name='L594'>        CONST_new_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> ## _ctx_p = &amp;CONST_new_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> ## _ctx; \
<a name='L595'>        EVP_DigestInit(CONST_new_ ## <a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a> ## _ctx_p, EVP_get_digestbyname(#<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a>)); \
<a name='L596'>    <font color='red'>}</font> \
<a name='L597'><font color='red'>}</font> <b>while</b> (0);
<a name='L598'>
<a name='L599'><a href='../S/2566.html#L556' title='Defined at 556 in Modules/_hashopenssl.c.'>GEN_CONSTRUCTOR</a>(md5)
<a name='L600'><a href='../S/2566.html#L556' title='Defined at 556 in Modules/_hashopenssl.c.'>GEN_CONSTRUCTOR</a>(sha1)
<a name='L601'><font color='darkred'>#ifdef</font> <a href='../S/2566.html#L56' title='Defined at 56 in Modules/_hashopenssl.c.'>_OPENSSL_SUPPORTS_SHA2</a>
<a name='L602'><a href='../S/2566.html#L556' title='Defined at 556 in Modules/_hashopenssl.c.'>GEN_CONSTRUCTOR</a>(sha224)
<a name='L603'><a href='../S/2566.html#L556' title='Defined at 556 in Modules/_hashopenssl.c.'>GEN_CONSTRUCTOR</a>(sha256)
<a name='L604'><a href='../S/2566.html#L556' title='Defined at 556 in Modules/_hashopenssl.c.'>GEN_CONSTRUCTOR</a>(sha384)
<a name='L605'><a href='../S/2566.html#L556' title='Defined at 556 in Modules/_hashopenssl.c.'>GEN_CONSTRUCTOR</a>(sha512)
<a name='L606'><font color='darkred'>#endif</font>
<a name='L607'>
<a name='L608'><i><font color='green'>/* List of functions exported by this module */</font></i>
<a name='L609'>
<a name='L610'><b>static</b> <b>struct</b> PyMethodDef EVP_functions[] = <font color='red'>{</font>
<a name='L611'>    <font color='red'>{</font>"new", (PyCFunction)<a href='../S/2566.html#L461' title='Defined at 461 in Modules/_hashopenssl.c.'>EVP_new</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>|METH_KEYWORDS, EVP_new__doc__<font color='red'>}</font>,
<a name='L612'>    <a href='../S/2566.html#L584' title='Defined at 584 in Modules/_hashopenssl.c.'>CONSTRUCTOR_METH_DEF</a>(md5),
<a name='L613'>    <a href='../S/2566.html#L584' title='Defined at 584 in Modules/_hashopenssl.c.'>CONSTRUCTOR_METH_DEF</a>(sha1),
<a name='L614'><font color='darkred'>#ifdef</font> <a href='../S/2566.html#L56' title='Defined at 56 in Modules/_hashopenssl.c.'>_OPENSSL_SUPPORTS_SHA2</a>
<a name='L615'>    <a href='../S/2566.html#L584' title='Defined at 584 in Modules/_hashopenssl.c.'>CONSTRUCTOR_METH_DEF</a>(sha224),
<a name='L616'>    <a href='../S/2566.html#L584' title='Defined at 584 in Modules/_hashopenssl.c.'>CONSTRUCTOR_METH_DEF</a>(sha256),
<a name='L617'>    <a href='../S/2566.html#L584' title='Defined at 584 in Modules/_hashopenssl.c.'>CONSTRUCTOR_METH_DEF</a>(sha384),
<a name='L618'>    <a href='../S/2566.html#L584' title='Defined at 584 in Modules/_hashopenssl.c.'>CONSTRUCTOR_METH_DEF</a>(sha512),
<a name='L619'><font color='darkred'>#endif</font>
<a name='L620'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,      <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>            <i><font color='green'>/* Sentinel */</font></i>
<a name='L621'><font color='red'>}</font>;
<a name='L622'>
<a name='L623'>
<a name='L624'><i><font color='green'>/* Initialize this module. */</font></i>
<a name='L625'>
<a name='L626'>
<a name='L627'><b>static</b> <b>struct</b> <a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a> _hashlibmodule = <font color='red'>{</font>
<a name='L628'>    <a href='../S/542.html#L33' title='Defined at 33 in Include/moduleobject.h.'>PyModuleDef_HEAD_INIT</a>,
<a name='L629'>    "_hashlib",
<a name='L630'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L631'>    -1,
<a name='L632'>    EVP_functions,
<a name='L633'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L634'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L635'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L636'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L637'><font color='red'>}</font>;
<a name='L638'>
<a name='L639'><a href='../D/3482.html' title='Multiple defined in 10 places.'>PyMODINIT_FUNC</a>
<a name='L640'>PyInit__hashlib(<b>void</b>)
<a name='L641'><font color='red'>{</font>
<a name='L642'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m, *openssl_md_meth_names;
<a name='L643'>
<a name='L644'>    OpenSSL_add_all_digests();
<a name='L645'>
<a name='L646'>    <i><font color='green'>/* TODO build EVP_functions openssl_* entries dynamically based</font></i>
<a name='L647'><i><font color='green'>     * on what hashes are supported rather than listing many</font></i>
<a name='L648'><i><font color='green'>     * but having some be unsupported.  Only init appropriate</font></i>
<a name='L649'><i><font color='green'>     * constants. */</font></i>
<a name='L650'>
<a name='L651'>    <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(&amp;EVPtype) = &amp;PyType_Type;
<a name='L652'>    <b>if</b> (<a href='../S/2824.html#L3799' title='Defined at 3799 in Objects/typeobject.c.'>PyType_Ready</a>(&amp;EVPtype) &lt; 0)
<a name='L653'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L654'>
<a name='L655'>    m = PyModule_Create(&amp;_hashlibmodule);
<a name='L656'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L657'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L658'>
<a name='L659'>    openssl_md_meth_names = <a href='../S/2566.html#L531' title='Defined at 531 in Modules/_hashopenssl.c.'>generate_hash_name_list</a>();
<a name='L660'>    <b>if</b> (openssl_md_meth_names == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L661'>        Py_DECREF(m);
<a name='L662'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L663'>    <font color='red'>}</font>
<a name='L664'>    <b>if</b> (<a href='../S/3125.html#L525' title='Defined at 525 in Python/modsupport.c.'>PyModule_AddObject</a>(m, "openssl_md_meth_names", openssl_md_meth_names)) <font color='red'>{</font>
<a name='L665'>        Py_DECREF(m);
<a name='L666'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L667'>    <font color='red'>}</font>
<a name='L668'>
<a name='L669'><font color='darkred'>#if</font> <a href='../S/2566.html#L51' title='Defined at 51 in Modules/_hashopenssl.c.'>HASH_OBJ_CONSTRUCTOR</a>
<a name='L670'>    Py_INCREF(&amp;EVPtype);
<a name='L671'>    <a href='../S/3125.html#L525' title='Defined at 525 in Python/modsupport.c.'>PyModule_AddObject</a>(m, "HASH", (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)&amp;EVPtype);
<a name='L672'><font color='darkred'>#endif</font>
<a name='L673'>
<a name='L674'>    <i><font color='green'>/* these constants are used by the convenience constructors */</font></i>
<a name='L675'>    <a href='../S/2566.html#L591' title='Defined at 591 in Modules/_hashopenssl.c.'>INIT_CONSTRUCTOR_CONSTANTS</a>(md5);
<a name='L676'>    <a href='../S/2566.html#L591' title='Defined at 591 in Modules/_hashopenssl.c.'>INIT_CONSTRUCTOR_CONSTANTS</a>(sha1);
<a name='L677'><font color='darkred'>#ifdef</font> <a href='../S/2566.html#L56' title='Defined at 56 in Modules/_hashopenssl.c.'>_OPENSSL_SUPPORTS_SHA2</a>
<a name='L678'>    <a href='../S/2566.html#L591' title='Defined at 591 in Modules/_hashopenssl.c.'>INIT_CONSTRUCTOR_CONSTANTS</a>(sha224);
<a name='L679'>    <a href='../S/2566.html#L591' title='Defined at 591 in Modules/_hashopenssl.c.'>INIT_CONSTRUCTOR_CONSTANTS</a>(sha256);
<a name='L680'>    <a href='../S/2566.html#L591' title='Defined at 591 in Modules/_hashopenssl.c.'>INIT_CONSTRUCTOR_CONSTANTS</a>(sha384);
<a name='L681'>    <a href='../S/2566.html#L591' title='Defined at 591 in Modules/_hashopenssl.c.'>INIT_CONSTRUCTOR_CONSTANTS</a>(sha512);
<a name='L682'><font color='darkred'>#endif</font>
<a name='L683'>    <b>return</b> m;
<a name='L684'><font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L77'>[^]</a><a href='#L640'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
