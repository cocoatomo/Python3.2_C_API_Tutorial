<html>
<head>
<title>Modules/fcntlmodule.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3353.html'>Modules</a>/fcntlmodule.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L19'>[^]</a><a href='#L631'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L19' title='Defined at 19.'>conv_descriptor</a>
<li><a href='#L33' title='Defined at 33.'>fcntl_fcntl</a>
<li><a href='#L96' title='Defined at 96.'>fcntl_ioctl</a>
<li><a href='#L259' title='Defined at 259.'>fcntl_flock</a>
<li><a href='#L318' title='Defined at 318.'>fcntl_lockf</a>
<li><a href='#L434' title='Defined at 434.'>ins</a>
<li><a href='#L447' title='Defined at 447.'>all_ins</a>
<li><a href='#L631' title='Defined at 631.'>PyInit_fcntl</a>
</ol>
<hr>
<pre>
<a name='L1'>
<a name='L2'><i><font color='green'>/* fcntl module */</font></i>
<a name='L3'>
<a name='L4'><font color='darkred'>#define</font> <a href='../R/2388.html' title='Multiple refered from 2 places.'>PY_SSIZE_T_CLEAN</a>
<a name='L5'>
<a name='L6'><font color='darkred'>#include</font> "<a href='570.html'>Python.h</a>"
<a name='L7'>
<a name='L8'><font color='darkred'>#ifdef</font> <a href='../S/2894.html#L291' title='Defined at 291 in PC/os2emx/pyconfig.h.'>HAVE_SYS_FILE_H</a>
<a name='L9'><font color='darkred'>#include</font> &lt;sys/file.h&gt;
<a name='L10'><font color='darkred'>#endif</font>
<a name='L11'>
<a name='L12'><font color='darkred'>#include</font> &lt;sys/ioctl.h&gt;
<a name='L13'><font color='darkred'>#include</font> &lt;fcntl.h&gt;
<a name='L14'><font color='darkred'>#ifdef</font> HAVE_STROPTS_H
<a name='L15'><font color='darkred'>#include</font> &lt;stropts.h&gt;
<a name='L16'><font color='darkred'>#endif</font>
<a name='L17'>
<a name='L18'><b>static</b> <b>int</b>
<a name='L19'><a href='../R/6992.html' title='Multiple refered from 7 places.'>conv_descriptor</a>(PyObject *object, <b>int</b> *target)
<a name='L20'><font color='red'>{</font>
<a name='L21'>    <b>int</b> fd = <a href='../S/2790.html#L197' title='Defined at 197 in Objects/fileobject.c.'>PyObject_AsFileDescriptor</a>(<a href='../S/500.html#L6' title='Defined at 6 in Include/asdl.h.'>object</a>);
<a name='L22'>
<a name='L23'>    <b>if</b> (fd &lt; 0)
<a name='L24'>    <b>return</b> 0;
<a name='L25'>    *target = fd;
<a name='L26'>    <b>return</b> 1;
<a name='L27'><font color='red'>}</font>
<a name='L28'>
<a name='L29'>
<a name='L30'><i><font color='green'>/* fcntl(fd, opt, [arg]) */</font></i>
<a name='L31'>
<a name='L32'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L33'><a href='../S/2672.html#L417' title='Refered from 417 in Modules/fcntlmodule.c.'>fcntl_fcntl</a>(PyObject *self, PyObject *args)
<a name='L34'><font color='red'>{</font>
<a name='L35'>    <b>int</b> fd;
<a name='L36'>    <b>int</b> <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>;
<a name='L37'>    <b>long</b> <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>;
<a name='L38'>    <b>int</b> ret;
<a name='L39'>    <b>char</b> *str;
<a name='L40'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len;
<a name='L41'>    <b>char</b> buf[1024];
<a name='L42'>
<a name='L43'>    <b>if</b> (<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O&amp;is#:fcntl",
<a name='L44'>                         <a href='../S/2672.html#L19' title='Defined at 19 in Modules/fcntlmodule.c.'>conv_descriptor</a>, &amp;fd, &amp;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, &amp;str, &amp;len)) <font color='red'>{</font>
<a name='L45'>        <b>if</b> (len &gt; <b>sizeof</b> buf) <font color='red'>{</font>
<a name='L46'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L47'>                            "fcntl string arg too long");
<a name='L48'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L49'>        <font color='red'>}</font>
<a name='L50'>        <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(buf, str, len);
<a name='L51'>        <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L52'>        ret = fcntl(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, buf);
<a name='L53'>        <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L54'>        <b>if</b> (ret &lt; 0) <font color='red'>{</font>
<a name='L55'>            <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L56'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L57'>        <font color='red'>}</font>
<a name='L58'>        <b>return</b> <a href='../S/2779.html#L70' title='Defined at 70 in Objects/bytesobject.c.'>PyBytes_FromStringAndSize</a>(buf, len);
<a name='L59'>    <font color='red'>}</font>
<a name='L60'>
<a name='L61'>    <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L62'>    <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a> = 0;
<a name='L63'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>,
<a name='L64'>         "O&amp;i|l;fcntl requires a file or file descriptor,"
<a name='L65'>         " an integer and optionally a third integer or a string",
<a name='L66'>                          <a href='../S/2672.html#L19' title='Defined at 19 in Modules/fcntlmodule.c.'>conv_descriptor</a>, &amp;fd, &amp;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, &amp;<a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>)) <font color='red'>{</font>
<a name='L67'>      <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L68'>    <font color='red'>}</font>
<a name='L69'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L70'>    ret = fcntl(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>);
<a name='L71'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L72'>    <b>if</b> (ret &lt; 0) <font color='red'>{</font>
<a name='L73'>        <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L74'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L75'>    <font color='red'>}</font>
<a name='L76'>    <b>return</b> <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>((<b>long</b>)ret);
<a name='L77'><font color='red'>}</font>
<a name='L78'>
<a name='L79'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(fcntl_doc,
<a name='L80'>"fcntl(fd, opt, [arg])\n\
<a name='L81'>\n\
<a name='L82'>Perform the requested operation on file descriptor fd.  The operation\n\
<a name='L83'>is defined by op and is operating system dependent.  These constants are\n\
<a name='L84'>available from the fcntl module.  The argument arg is optional, and\n\
<a name='L85'>defaults to 0; it may be an int or a string.  If arg is given as a string,\n\
<a name='L86'>the return value of fcntl is a string of that length, containing the\n\
<a name='L87'>resulting value put in the arg buffer by the operating system.  The length\n\
<a name='L88'>of the arg string is not allowed to exceed 1024 bytes.  If the arg given\n\
<a name='L89'>is an integer or if none is specified, the result value is an integer\n\
<a name='L90'>corresponding to the return value of the fcntl call in the C code.");
<a name='L91'>
<a name='L92'>
<a name='L93'><i><font color='green'>/* ioctl(fd, opt, [arg]) */</font></i>
<a name='L94'>
<a name='L95'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L96'><a href='../S/2672.html#L418' title='Refered from 418 in Modules/fcntlmodule.c.'>fcntl_ioctl</a>(PyObject *self, PyObject *args)
<a name='L97'><font color='red'>{</font>
<a name='L98'><font color='darkred'>#define</font> <a href='../R/1572.html' title='Multiple refered from 5 places.'>IOCTL_BUFSZ</a> 1024
<a name='L99'>    <b>int</b> fd;
<a name='L100'>    <i><font color='green'>/* In PyArg_ParseTuple below, we use the unsigned non-checked 'I'</font></i>
<a name='L101'><i><font color='green'>       format for the 'code' parameter because Python turns 0x8000000</font></i>
<a name='L102'><i><font color='green'>       into either a large positive number (PyLong or PyInt on 64-bit</font></i>
<a name='L103'><i><font color='green'>       platforms) or a negative number on others (32-bit PyInt)</font></i>
<a name='L104'><i><font color='green'>       whereas the system expects it to be a 32bit bit field value</font></i>
<a name='L105'><i><font color='green'>       regardless of it being passed as an int or unsigned long on</font></i>
<a name='L106'><i><font color='green'>       various platforms.  See the termios.TIOCSWINSZ constant across</font></i>
<a name='L107'><i><font color='green'>       platforms for an example of thise.</font></i>
<a name='L108'><i><font color='green'></font></i>
<a name='L109'><i><font color='green'>       If any of the 64bit platforms ever decide to use more than 32bits</font></i>
<a name='L110'><i><font color='green'>       in their unsigned long ioctl codes this will break and need</font></i>
<a name='L111'><i><font color='green'>       special casing based on the platform being built on.</font></i>
<a name='L112'><i><font color='green'>     */</font></i>
<a name='L113'>    <b>unsigned</b> <b>int</b> <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>;
<a name='L114'>    <b>int</b> <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>;
<a name='L115'>    <b>int</b> ret;
<a name='L116'>    <a href='../S/544.html#L163' title='Defined at 163 in Include/object.h.'>Py_buffer</a> pstr;
<a name='L117'>    <b>char</b> *str;
<a name='L118'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len;
<a name='L119'>    <b>int</b> mutate_arg = 1;
<a name='L120'>    <b>char</b> buf[<a href='../D/1762.html' title='Multiple defined in 2 places.'>IOCTL_BUFSZ</a>+1];  <i><font color='green'>/* argument plus NUL byte */</font></i>
<a name='L121'>
<a name='L122'>    <b>if</b> (<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O&amp;Iw*|i:ioctl",
<a name='L123'>                         <a href='../S/2672.html#L19' title='Defined at 19 in Modules/fcntlmodule.c.'>conv_descriptor</a>, &amp;fd, &amp;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>,
<a name='L124'>                         &amp;pstr, &amp;mutate_arg)) <font color='red'>{</font>
<a name='L125'>        <b>char</b> *<a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>;
<a name='L126'>        str = pstr.buf;
<a name='L127'>        len = pstr.len;
<a name='L128'>
<a name='L129'>        <b>if</b> (mutate_arg) <font color='red'>{</font>
<a name='L130'>            <b>if</b> (len &lt;= <a href='../D/1762.html' title='Multiple defined in 2 places.'>IOCTL_BUFSZ</a>) <font color='red'>{</font>
<a name='L131'>                <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(buf, str, len);
<a name='L132'>                buf[len] = '\0';
<a name='L133'>                <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a> = buf;
<a name='L134'>            <font color='red'>}</font>
<a name='L135'>            <b>else</b> <font color='red'>{</font>
<a name='L136'>                <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a> = str;
<a name='L137'>            <font color='red'>}</font>
<a name='L138'>        <font color='red'>}</font>
<a name='L139'>        <b>else</b> <font color='red'>{</font>
<a name='L140'>            <b>if</b> (len &gt; <a href='../D/1762.html' title='Multiple defined in 2 places.'>IOCTL_BUFSZ</a>) <font color='red'>{</font>
<a name='L141'>                <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;pstr);
<a name='L142'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L143'>                    "ioctl string arg too long");
<a name='L144'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L145'>            <font color='red'>}</font>
<a name='L146'>            <b>else</b> <font color='red'>{</font>
<a name='L147'>                <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(buf, str, len);
<a name='L148'>                buf[len] = '\0';
<a name='L149'>                <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a> = buf;
<a name='L150'>            <font color='red'>}</font>
<a name='L151'>        <font color='red'>}</font>
<a name='L152'>        <b>if</b> (buf == <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>) <font color='red'>{</font>
<a name='L153'>            <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a> <i><font color='green'>/* think array.resize() */</font></i>
<a name='L154'>            ret = ioctl(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>);
<a name='L155'>            <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L156'>        <font color='red'>}</font>
<a name='L157'>        <b>else</b> <font color='red'>{</font>
<a name='L158'>            ret = ioctl(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>);
<a name='L159'>        <font color='red'>}</font>
<a name='L160'>        <b>if</b> (mutate_arg &amp;&amp; (len &lt;= <a href='../D/1762.html' title='Multiple defined in 2 places.'>IOCTL_BUFSZ</a>)) <font color='red'>{</font>
<a name='L161'>            <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(str, buf, len);
<a name='L162'>        <font color='red'>}</font>
<a name='L163'>        <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;pstr); <i><font color='green'>/* No further access to str below this point */</font></i>
<a name='L164'>        <b>if</b> (ret &lt; 0) <font color='red'>{</font>
<a name='L165'>            <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L166'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L167'>        <font color='red'>}</font>
<a name='L168'>        <b>if</b> (mutate_arg) <font color='red'>{</font>
<a name='L169'>            <b>return</b> <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(ret);
<a name='L170'>        <font color='red'>}</font>
<a name='L171'>        <b>else</b> <font color='red'>{</font>
<a name='L172'>            <b>return</b> <a href='../S/2779.html#L70' title='Defined at 70 in Objects/bytesobject.c.'>PyBytes_FromStringAndSize</a>(buf, len);
<a name='L173'>        <font color='red'>}</font>
<a name='L174'>    <font color='red'>}</font>
<a name='L175'>
<a name='L176'>    <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L177'>    <b>if</b> (<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O&amp;Is*:ioctl",
<a name='L178'>                         <a href='../S/2672.html#L19' title='Defined at 19 in Modules/fcntlmodule.c.'>conv_descriptor</a>, &amp;fd, &amp;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, &amp;pstr)) <font color='red'>{</font>
<a name='L179'>        str = pstr.buf;
<a name='L180'>        len = pstr.len;
<a name='L181'>        <b>if</b> (len &gt; <a href='../D/1762.html' title='Multiple defined in 2 places.'>IOCTL_BUFSZ</a>) <font color='red'>{</font>
<a name='L182'>            <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;pstr);
<a name='L183'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L184'>                            "ioctl string arg too long");
<a name='L185'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L186'>        <font color='red'>}</font>
<a name='L187'>        <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(buf, str, len);
<a name='L188'>        buf[len] = '\0';
<a name='L189'>        <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L190'>        ret = ioctl(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, buf);
<a name='L191'>        <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L192'>        <b>if</b> (ret &lt; 0) <font color='red'>{</font>
<a name='L193'>            <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;pstr);
<a name='L194'>            <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L195'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L196'>        <font color='red'>}</font>
<a name='L197'>        <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;pstr);
<a name='L198'>        <b>return</b> <a href='../S/2779.html#L70' title='Defined at 70 in Objects/bytesobject.c.'>PyBytes_FromStringAndSize</a>(buf, len);
<a name='L199'>    <font color='red'>}</font>
<a name='L200'>
<a name='L201'>    <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L202'>    <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a> = 0;
<a name='L203'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>,
<a name='L204'>         "O&amp;I|i;ioctl requires a file or file descriptor,"
<a name='L205'>         " an integer and optionally an integer or buffer argument",
<a name='L206'>                          <a href='../S/2672.html#L19' title='Defined at 19 in Modules/fcntlmodule.c.'>conv_descriptor</a>, &amp;fd, &amp;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, &amp;<a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>)) <font color='red'>{</font>
<a name='L207'>      <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L208'>    <font color='red'>}</font>
<a name='L209'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L210'><font color='darkred'>#ifdef</font> __VMS
<a name='L211'>    ret = ioctl(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, (<b>void</b> *)<a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>);
<a name='L212'><font color='darkred'>#else</font>
<a name='L213'>    ret = ioctl(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, <a href='../D/6730.html' title='Multiple defined in 2 places.'>arg</a>);
<a name='L214'><font color='darkred'>#endif</font>
<a name='L215'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L216'>    <b>if</b> (ret &lt; 0) <font color='red'>{</font>
<a name='L217'>        <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L218'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L219'>    <font color='red'>}</font>
<a name='L220'>    <b>return</b> <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>((<b>long</b>)ret);
<a name='L221'><font color='darkred'>#undef</font> <a href='../R/1572.html' title='Multiple refered from 5 places.'>IOCTL_BUFSZ</a>
<a name='L222'><font color='red'>}</font>
<a name='L223'>
<a name='L224'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(ioctl_doc,
<a name='L225'>"ioctl(fd, opt[, arg[, mutate_flag]])\n\
<a name='L226'>\n\
<a name='L227'>Perform the requested operation on file descriptor fd.  The operation is\n\
<a name='L228'>defined by opt and is operating system dependent.  Typically these codes are\n\
<a name='L229'>retrieved from the fcntl or termios library modules.\n\
<a name='L230'>\n\
<a name='L231'>The argument arg is optional, and defaults to 0; it may be an int or a\n\
<a name='L232'>buffer containing character data (most likely a string or an array). \n\
<a name='L233'>\n\
<a name='L234'>If the argument is a mutable buffer (such as an array) and if the\n\
<a name='L235'>mutate_flag argument (which is only allowed in this case) is true then the\n\
<a name='L236'>buffer is (in effect) passed to the operating system and changes made by\n\
<a name='L237'>the OS will be reflected in the contents of the buffer after the call has\n\
<a name='L238'>returned.  The return value is the integer returned by the ioctl system\n\
<a name='L239'>call.\n\
<a name='L240'>\n\
<a name='L241'>If the argument is a mutable buffer and the mutable_flag argument is not\n\
<a name='L242'>passed or is false, the behavior is as if a string had been passed.  This\n\
<a name='L243'>behavior will change in future releases of Python.\n\
<a name='L244'>\n\
<a name='L245'>If the argument is an immutable buffer (most likely a string) then a copy\n\
<a name='L246'>of the buffer is passed to the operating system and the return value is a\n\
<a name='L247'>string of the same length containing whatever the operating system put in\n\
<a name='L248'>the buffer.  The length of the arg buffer in this case is not allowed to\n\
<a name='L249'>exceed 1024 bytes.\n\
<a name='L250'>\n\
<a name='L251'>If the arg given is an integer or if none is specified, the result value is\n\
<a name='L252'>an integer corresponding to the return value of the ioctl call in the C\n\
<a name='L253'>code.");
<a name='L254'>
<a name='L255'>
<a name='L256'><i><font color='green'>/* flock(fd, operation) */</font></i>
<a name='L257'>
<a name='L258'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L259'><a href='../S/2672.html#L419' title='Refered from 419 in Modules/fcntlmodule.c.'>fcntl_flock</a>(PyObject *self, PyObject *args)
<a name='L260'><font color='red'>{</font>
<a name='L261'>    <b>int</b> fd;
<a name='L262'>    <b>int</b> <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>;
<a name='L263'>    <b>int</b> ret;
<a name='L264'>
<a name='L265'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O&amp;i:flock",
<a name='L266'>                          <a href='../S/2672.html#L19' title='Defined at 19 in Modules/fcntlmodule.c.'>conv_descriptor</a>, &amp;fd, &amp;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>))
<a name='L267'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L268'>
<a name='L269'><font color='darkred'>#ifdef</font> <a href='../S/2894.html#L162' title='Defined at 162 in PC/os2emx/pyconfig.h.'>HAVE_FLOCK</a>
<a name='L270'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L271'>    ret = flock(fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>);
<a name='L272'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L273'><font color='darkred'>#else</font>
<a name='L274'>
<a name='L275'><font color='darkred'>#ifndef</font> <a href='../D/1948.html' title='Multiple defined in 2 places.'>LOCK_SH</a>
<a name='L276'><font color='darkred'>#define</font> <a href='../R/1752.html' title='Multiple refered from 5 places.'>LOCK_SH</a>         1       <i><font color='green'>/* shared lock */</font></i>
<a name='L277'><font color='darkred'>#define</font> <a href='../R/1750.html' title='Multiple refered from 3 places.'>LOCK_EX</a>         2       <i><font color='green'>/* exclusive lock */</font></i>
<a name='L278'><font color='darkred'>#define</font> <a href='../R/1751.html' title='Multiple refered from 3 places.'>LOCK_NB</a>         4       <i><font color='green'>/* don't block when locking */</font></i>
<a name='L279'><font color='darkred'>#define</font> <a href='../R/1753.html' title='Multiple refered from 3 places.'>LOCK_UN</a>         8       <i><font color='green'>/* unlock */</font></i>
<a name='L280'><font color='darkred'>#endif</font>
<a name='L281'>    <font color='red'>{</font>
<a name='L282'>        <b>struct</b> flock l;
<a name='L283'>        <b>if</b> (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> == <a href='../D/1949.html' title='Multiple defined in 2 places.'>LOCK_UN</a>)
<a name='L284'>            l.l_type = F_UNLCK;
<a name='L285'>        <b>else</b> <b>if</b> (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> &amp; <a href='../D/1948.html' title='Multiple defined in 2 places.'>LOCK_SH</a>)
<a name='L286'>            l.l_type = F_RDLCK;
<a name='L287'>        <b>else</b> <b>if</b> (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> &amp; <a href='../D/1946.html' title='Multiple defined in 2 places.'>LOCK_EX</a>)
<a name='L288'>            l.l_type = F_WRLCK;
<a name='L289'>        <b>else</b> <font color='red'>{</font>
<a name='L290'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L291'>                            "unrecognized flock argument");
<a name='L292'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L293'>        <font color='red'>}</font>
<a name='L294'>        l.l_whence = l.l_start = l.l_len = 0;
<a name='L295'>        <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L296'>        ret = fcntl(fd, (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> &amp; <a href='../D/1947.html' title='Multiple defined in 2 places.'>LOCK_NB</a>) ? F_SETLK : F_SETLKW, &amp;l);
<a name='L297'>        <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L298'>    <font color='red'>}</font>
<a name='L299'><font color='darkred'>#endif</font> <i><font color='green'>/* HAVE_FLOCK */</font></i>
<a name='L300'>    <b>if</b> (ret &lt; 0) <font color='red'>{</font>
<a name='L301'>        <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L302'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L303'>    <font color='red'>}</font>
<a name='L304'>    Py_INCREF(Py_None);
<a name='L305'>    <b>return</b> Py_None;
<a name='L306'><font color='red'>}</font>
<a name='L307'>
<a name='L308'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(flock_doc,
<a name='L309'>"flock(fd, operation)\n\
<a name='L310'>\n\
<a name='L311'>Perform the lock operation op on file descriptor fd.  See the Unix \n\
<a name='L312'>manual page for flock(3) for details.  (On some systems, this function is\n\
<a name='L313'>emulated using fcntl().)");
<a name='L314'>
<a name='L315'>
<a name='L316'><i><font color='green'>/* lockf(fd, operation) */</font></i>
<a name='L317'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L318'><a href='../S/2672.html#L420' title='Refered from 420 in Modules/fcntlmodule.c.'>fcntl_lockf</a>(PyObject *self, PyObject *args)
<a name='L319'><font color='red'>{</font>
<a name='L320'>    <b>int</b> fd, <a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, ret, whence = 0;
<a name='L321'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *lenobj = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, *startobj = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L322'>
<a name='L323'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O&amp;i|OOi:lockf",
<a name='L324'>                          <a href='../S/2672.html#L19' title='Defined at 19 in Modules/fcntlmodule.c.'>conv_descriptor</a>, &amp;fd, &amp;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>,
<a name='L325'>                          &amp;lenobj, &amp;startobj, &amp;whence))
<a name='L326'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L327'>
<a name='L328'><font color='darkred'>#if</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>) &amp;&amp; <b>defined</b>(<a href='../S/2894.html#L13' title='Defined at 13 in PC/os2emx/pyconfig.h.'>PYCC_GCC</a>)
<a name='L329'>    <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_NotImplementedError,
<a name='L330'>                    "lockf not supported on OS/2 (EMX)");
<a name='L331'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L332'><font color='darkred'>#else</font>
<a name='L333'><font color='darkred'>#ifndef</font> <a href='../D/1948.html' title='Multiple defined in 2 places.'>LOCK_SH</a>
<a name='L334'><font color='darkred'>#define</font> <a href='../R/1752.html' title='Multiple refered from 5 places.'>LOCK_SH</a>         1       <i><font color='green'>/* shared lock */</font></i>
<a name='L335'><font color='darkred'>#define</font> <a href='../R/1750.html' title='Multiple refered from 3 places.'>LOCK_EX</a>         2       <i><font color='green'>/* exclusive lock */</font></i>
<a name='L336'><font color='darkred'>#define</font> <a href='../R/1751.html' title='Multiple refered from 3 places.'>LOCK_NB</a>         4       <i><font color='green'>/* don't block when locking */</font></i>
<a name='L337'><font color='darkred'>#define</font> <a href='../R/1753.html' title='Multiple refered from 3 places.'>LOCK_UN</a>         8       <i><font color='green'>/* unlock */</font></i>
<a name='L338'><font color='darkred'>#endif</font>  <i><font color='green'>/* LOCK_SH */</font></i>
<a name='L339'>    <font color='red'>{</font>
<a name='L340'>        <b>struct</b> flock l;
<a name='L341'>        <b>if</b> (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> == <a href='../D/1949.html' title='Multiple defined in 2 places.'>LOCK_UN</a>)
<a name='L342'>            l.l_type = F_UNLCK;
<a name='L343'>        <b>else</b> <b>if</b> (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> &amp; <a href='../D/1948.html' title='Multiple defined in 2 places.'>LOCK_SH</a>)
<a name='L344'>            l.l_type = F_RDLCK;
<a name='L345'>        <b>else</b> <b>if</b> (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> &amp; <a href='../D/1946.html' title='Multiple defined in 2 places.'>LOCK_EX</a>)
<a name='L346'>            l.l_type = F_WRLCK;
<a name='L347'>        <b>else</b> <font color='red'>{</font>
<a name='L348'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L349'>                            "unrecognized lockf argument");
<a name='L350'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L351'>        <font color='red'>}</font>
<a name='L352'>        l.l_start = l.l_len = 0;
<a name='L353'>        <b>if</b> (startobj != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L354'><font color='darkred'>#if</font> !<b>defined</b>(<a href='../D/1522.html' title='Multiple defined in 4 places.'>HAVE_LARGEFILE_SUPPORT</a>)
<a name='L355'>            l.l_start = <a href='../S/2799.html#L416' title='Defined at 416 in Objects/longobject.c.'>PyLong_AsLong</a>(startobj);
<a name='L356'><font color='darkred'>#else</font>
<a name='L357'>            l.l_start = PyLong_Check(startobj) ?
<a name='L358'>                            <a href='../S/2799.html#L1137' title='Defined at 1137 in Objects/longobject.c.'>PyLong_AsLongLong</a>(startobj) :
<a name='L359'>                    <a href='../S/2799.html#L416' title='Defined at 416 in Objects/longobject.c.'>PyLong_AsLong</a>(startobj);
<a name='L360'><font color='darkred'>#endif</font>
<a name='L361'>            <b>if</b> (<a href='../D/3154.html' title='Multiple defined in 2 places.'>PyErr_Occurred</a>())
<a name='L362'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L363'>        <font color='red'>}</font>
<a name='L364'>        <b>if</b> (lenobj != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L365'><font color='darkred'>#if</font> !<b>defined</b>(<a href='../D/1522.html' title='Multiple defined in 4 places.'>HAVE_LARGEFILE_SUPPORT</a>)
<a name='L366'>            l.l_len = <a href='../S/2799.html#L416' title='Defined at 416 in Objects/longobject.c.'>PyLong_AsLong</a>(lenobj);
<a name='L367'><font color='darkred'>#else</font>
<a name='L368'>            l.l_len = PyLong_Check(lenobj) ?
<a name='L369'>                            <a href='../S/2799.html#L1137' title='Defined at 1137 in Objects/longobject.c.'>PyLong_AsLongLong</a>(lenobj) :
<a name='L370'>                    <a href='../S/2799.html#L416' title='Defined at 416 in Objects/longobject.c.'>PyLong_AsLong</a>(lenobj);
<a name='L371'><font color='darkred'>#endif</font>
<a name='L372'>            <b>if</b> (<a href='../D/3154.html' title='Multiple defined in 2 places.'>PyErr_Occurred</a>())
<a name='L373'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L374'>        <font color='red'>}</font>
<a name='L375'>        l.l_whence = whence;
<a name='L376'>        <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L377'>        ret = fcntl(fd, (<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> &amp; <a href='../D/1947.html' title='Multiple defined in 2 places.'>LOCK_NB</a>) ? F_SETLK : F_SETLKW, &amp;l);
<a name='L378'>        <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L379'>    <font color='red'>}</font>
<a name='L380'>    <b>if</b> (ret &lt; 0) <font color='red'>{</font>
<a name='L381'>        <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L382'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L383'>    <font color='red'>}</font>
<a name='L384'>    Py_INCREF(Py_None);
<a name='L385'>    <b>return</b> Py_None;
<a name='L386'><font color='darkred'>#endif</font>  <i><font color='green'>/* defined(PYOS_OS2) &amp;&amp; defined(PYCC_GCC) */</font></i>
<a name='L387'><font color='red'>}</font>
<a name='L388'>
<a name='L389'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(lockf_doc,
<a name='L390'>"lockf (fd, operation, length=0, start=0, whence=0)\n\
<a name='L391'>\n\
<a name='L392'>This is essentially a wrapper around the fcntl() locking calls.  fd is the\n\
<a name='L393'>file descriptor of the file to lock or unlock, and operation is one of the\n\
<a name='L394'>following values:\n\
<a name='L395'>\n\
<a name='L396'>    LOCK_UN - unlock\n\
<a name='L397'>    LOCK_SH - acquire a shared lock\n\
<a name='L398'>    LOCK_EX - acquire an exclusive lock\n\
<a name='L399'>\n\
<a name='L400'>When operation is LOCK_SH or LOCK_EX, it can also be bitwise ORed with\n\
<a name='L401'>LOCK_NB to avoid blocking on lock acquisition.  If LOCK_NB is used and the\n\
<a name='L402'>lock cannot be acquired, an IOError will be raised and the exception will\n\
<a name='L403'>have an errno attribute set to EACCES or EAGAIN (depending on the operating\n\
<a name='L404'>system -- for portability, check for either value).\n\
<a name='L405'>\n\
<a name='L406'>length is the number of bytes to lock, with the default meaning to lock to\n\
<a name='L407'>EOF.  start is the byte offset, relative to whence, to that the lock\n\
<a name='L408'>starts.  whence is as with fileobj.seek(), specifically:\n\
<a name='L409'>\n\
<a name='L410'>    0 - relative to the start of the file (SEEK_SET)\n\
<a name='L411'>    1 - relative to the current buffer position (SEEK_CUR)\n\
<a name='L412'>    2 - relative to the end of the file (SEEK_END)");
<a name='L413'>
<a name='L414'><i><font color='green'>/* List of functions */</font></i>
<a name='L415'>
<a name='L416'><b>static</b> <a href='../D/3525.html' title='Multiple defined in 3 places.'>PyMethodDef</a> fcntl_methods[] = <font color='red'>{</font>
<a name='L417'>    <font color='red'>{</font>"fcntl",           <a href='../S/2672.html#L33' title='Defined at 33 in Modules/fcntlmodule.c.'>fcntl_fcntl</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, fcntl_doc<font color='red'>}</font>,
<a name='L418'>    <font color='red'>{</font>"ioctl",           <a href='../S/2672.html#L96' title='Defined at 96 in Modules/fcntlmodule.c.'>fcntl_ioctl</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, ioctl_doc<font color='red'>}</font>,
<a name='L419'>    <font color='red'>{</font>"flock",           <a href='../S/2672.html#L259' title='Defined at 259 in Modules/fcntlmodule.c.'>fcntl_flock</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, flock_doc<font color='red'>}</font>,
<a name='L420'>    <font color='red'>{</font>"lockf",       <a href='../S/2672.html#L318' title='Defined at 318 in Modules/fcntlmodule.c.'>fcntl_lockf</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, lockf_doc<font color='red'>}</font>,
<a name='L421'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,              <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>           <i><font color='green'>/* sentinel */</font></i>
<a name='L422'><font color='red'>}</font>;
<a name='L423'>
<a name='L424'>
<a name='L425'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(module_doc,
<a name='L426'>"This module performs file control and I/O control on file \n\
<a name='L427'>descriptors.  It is an interface to the fcntl() and ioctl() Unix\n\
<a name='L428'>routines.  File descriptors can be obtained with the fileno() method of\n\
<a name='L429'>a file or socket object.");
<a name='L430'>
<a name='L431'><i><font color='green'>/* Module initialisation */</font></i>
<a name='L432'>
<a name='L433'><b>static</b> <b>int</b>
<a name='L434'><a href='../R/8405.html' title='Multiple refered from 136 places.'>ins</a>(PyObject* d, <b>char</b>* symbol, <b>long</b> value)
<a name='L435'><font color='red'>{</font>
<a name='L436'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a>* v = <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L437'>    <b>if</b> (!v || <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, symbol, v) &lt; 0)
<a name='L438'>        <b>return</b> -1;
<a name='L439'>
<a name='L440'>    Py_DECREF(v);
<a name='L441'>    <b>return</b> 0;
<a name='L442'><font color='red'>}</font>
<a name='L443'>
<a name='L444'><font color='darkred'>#define</font> <a href='../R/1547.html' title='Multiple refered from 29 places.'>INS</a>(x) <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, #x, (<b>long</b>)x)) <b>return</b> -1
<a name='L445'>
<a name='L446'><b>static</b> <b>int</b>
<a name='L447'><a href='../R/5958.html' title='Multiple refered from 2 places.'>all_ins</a>(PyObject* d)
<a name='L448'><font color='red'>{</font>
<a name='L449'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_SH", (<b>long</b>)<a href='../D/1948.html' title='Multiple defined in 2 places.'>LOCK_SH</a>)) <b>return</b> -1;
<a name='L450'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_EX", (<b>long</b>)<a href='../D/1946.html' title='Multiple defined in 2 places.'>LOCK_EX</a>)) <b>return</b> -1;
<a name='L451'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_NB", (<b>long</b>)<a href='../D/1947.html' title='Multiple defined in 2 places.'>LOCK_NB</a>)) <b>return</b> -1;
<a name='L452'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_UN", (<b>long</b>)<a href='../D/1949.html' title='Multiple defined in 2 places.'>LOCK_UN</a>)) <b>return</b> -1;
<a name='L453'><i><font color='green'>/* GNU extensions, as of glibc 2.2.4 */</font></i>
<a name='L454'><font color='darkred'>#ifdef</font> LOCK_MAND
<a name='L455'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_MAND", (<b>long</b>)LOCK_MAND)) <b>return</b> -1;
<a name='L456'><font color='darkred'>#endif</font>
<a name='L457'><font color='darkred'>#ifdef</font> LOCK_READ
<a name='L458'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_READ", (<b>long</b>)LOCK_READ)) <b>return</b> -1;
<a name='L459'><font color='darkred'>#endif</font>
<a name='L460'><font color='darkred'>#ifdef</font> LOCK_WRITE
<a name='L461'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_WRITE", (<b>long</b>)LOCK_WRITE)) <b>return</b> -1;
<a name='L462'><font color='darkred'>#endif</font>
<a name='L463'><font color='darkred'>#ifdef</font> LOCK_RW
<a name='L464'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "LOCK_RW", (<b>long</b>)LOCK_RW)) <b>return</b> -1;
<a name='L465'><font color='darkred'>#endif</font>
<a name='L466'>
<a name='L467'><font color='darkred'>#ifdef</font> F_DUPFD
<a name='L468'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_DUPFD", (<b>long</b>)F_DUPFD)) <b>return</b> -1;
<a name='L469'><font color='darkred'>#endif</font>
<a name='L470'><font color='darkred'>#ifdef</font> F_GETFD
<a name='L471'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_GETFD", (<b>long</b>)F_GETFD)) <b>return</b> -1;
<a name='L472'><font color='darkred'>#endif</font>
<a name='L473'><font color='darkred'>#ifdef</font> F_SETFD
<a name='L474'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETFD", (<b>long</b>)F_SETFD)) <b>return</b> -1;
<a name='L475'><font color='darkred'>#endif</font>
<a name='L476'><font color='darkred'>#ifdef</font> F_GETFL
<a name='L477'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_GETFL", (<b>long</b>)F_GETFL)) <b>return</b> -1;
<a name='L478'><font color='darkred'>#endif</font>
<a name='L479'><font color='darkred'>#ifdef</font> F_SETFL
<a name='L480'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETFL", (<b>long</b>)F_SETFL)) <b>return</b> -1;
<a name='L481'><font color='darkred'>#endif</font>
<a name='L482'><font color='darkred'>#ifdef</font> F_GETLK
<a name='L483'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_GETLK", (<b>long</b>)F_GETLK)) <b>return</b> -1;
<a name='L484'><font color='darkred'>#endif</font>
<a name='L485'><font color='darkred'>#ifdef</font> F_SETLK
<a name='L486'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETLK", (<b>long</b>)F_SETLK)) <b>return</b> -1;
<a name='L487'><font color='darkred'>#endif</font>
<a name='L488'><font color='darkred'>#ifdef</font> F_SETLKW
<a name='L489'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETLKW", (<b>long</b>)F_SETLKW)) <b>return</b> -1;
<a name='L490'><font color='darkred'>#endif</font>
<a name='L491'><font color='darkred'>#ifdef</font> F_GETOWN
<a name='L492'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_GETOWN", (<b>long</b>)F_GETOWN)) <b>return</b> -1;
<a name='L493'><font color='darkred'>#endif</font>
<a name='L494'><font color='darkred'>#ifdef</font> F_SETOWN
<a name='L495'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETOWN", (<b>long</b>)F_SETOWN)) <b>return</b> -1;
<a name='L496'><font color='darkred'>#endif</font>
<a name='L497'><font color='darkred'>#ifdef</font> F_GETSIG
<a name='L498'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_GETSIG", (<b>long</b>)F_GETSIG)) <b>return</b> -1;
<a name='L499'><font color='darkred'>#endif</font>
<a name='L500'><font color='darkred'>#ifdef</font> F_SETSIG
<a name='L501'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETSIG", (<b>long</b>)F_SETSIG)) <b>return</b> -1;
<a name='L502'><font color='darkred'>#endif</font>
<a name='L503'><font color='darkred'>#ifdef</font> F_RDLCK
<a name='L504'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_RDLCK", (<b>long</b>)F_RDLCK)) <b>return</b> -1;
<a name='L505'><font color='darkred'>#endif</font>
<a name='L506'><font color='darkred'>#ifdef</font> F_WRLCK
<a name='L507'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_WRLCK", (<b>long</b>)F_WRLCK)) <b>return</b> -1;
<a name='L508'><font color='darkred'>#endif</font>
<a name='L509'><font color='darkred'>#ifdef</font> F_UNLCK
<a name='L510'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_UNLCK", (<b>long</b>)F_UNLCK)) <b>return</b> -1;
<a name='L511'><font color='darkred'>#endif</font>
<a name='L512'><i><font color='green'>/* LFS constants */</font></i>
<a name='L513'><font color='darkred'>#ifdef</font> F_GETLK64
<a name='L514'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_GETLK64", (<b>long</b>)F_GETLK64)) <b>return</b> -1;
<a name='L515'><font color='darkred'>#endif</font>
<a name='L516'><font color='darkred'>#ifdef</font> F_SETLK64
<a name='L517'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETLK64", (<b>long</b>)F_SETLK64)) <b>return</b> -1;
<a name='L518'><font color='darkred'>#endif</font>
<a name='L519'><font color='darkred'>#ifdef</font> F_SETLKW64
<a name='L520'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETLKW64", (<b>long</b>)F_SETLKW64)) <b>return</b> -1;
<a name='L521'><font color='darkred'>#endif</font>
<a name='L522'><i><font color='green'>/* GNU extensions, as of glibc 2.2.4. */</font></i>
<a name='L523'><font color='darkred'>#ifdef</font> FASYNC
<a name='L524'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "FASYNC", (<b>long</b>)FASYNC)) <b>return</b> -1;
<a name='L525'><font color='darkred'>#endif</font>
<a name='L526'><font color='darkred'>#ifdef</font> F_SETLEASE
<a name='L527'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SETLEASE", (<b>long</b>)F_SETLEASE)) <b>return</b> -1;
<a name='L528'><font color='darkred'>#endif</font>
<a name='L529'><font color='darkred'>#ifdef</font> F_GETLEASE
<a name='L530'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_GETLEASE", (<b>long</b>)F_GETLEASE)) <b>return</b> -1;
<a name='L531'><font color='darkred'>#endif</font>
<a name='L532'><font color='darkred'>#ifdef</font> F_NOTIFY
<a name='L533'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_NOTIFY", (<b>long</b>)F_NOTIFY)) <b>return</b> -1;
<a name='L534'><font color='darkred'>#endif</font>
<a name='L535'><i><font color='green'>/* Old BSD flock(). */</font></i>
<a name='L536'><font color='darkred'>#ifdef</font> F_EXLCK
<a name='L537'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_EXLCK", (<b>long</b>)F_EXLCK)) <b>return</b> -1;
<a name='L538'><font color='darkred'>#endif</font>
<a name='L539'><font color='darkred'>#ifdef</font> F_SHLCK
<a name='L540'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_SHLCK", (<b>long</b>)F_SHLCK)) <b>return</b> -1;
<a name='L541'><font color='darkred'>#endif</font>
<a name='L542'>
<a name='L543'><i><font color='green'>/* OS X (and maybe others) let you tell the storage device to flush to physical media */</font></i>
<a name='L544'><font color='darkred'>#ifdef</font> F_FULLFSYNC
<a name='L545'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "F_FULLFSYNC", (<b>long</b>)F_FULLFSYNC)) <b>return</b> -1;
<a name='L546'><font color='darkred'>#endif</font>
<a name='L547'>
<a name='L548'><i><font color='green'>/* For F_{GET|SET}FL */</font></i>
<a name='L549'><font color='darkred'>#ifdef</font> FD_CLOEXEC
<a name='L550'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "FD_CLOEXEC", (<b>long</b>)FD_CLOEXEC)) <b>return</b> -1;
<a name='L551'><font color='darkred'>#endif</font>
<a name='L552'>
<a name='L553'><i><font color='green'>/* For F_NOTIFY */</font></i>
<a name='L554'><font color='darkred'>#ifdef</font> DN_ACCESS
<a name='L555'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "DN_ACCESS", (<b>long</b>)DN_ACCESS)) <b>return</b> -1;
<a name='L556'><font color='darkred'>#endif</font>
<a name='L557'><font color='darkred'>#ifdef</font> DN_MODIFY
<a name='L558'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "DN_MODIFY", (<b>long</b>)DN_MODIFY)) <b>return</b> -1;
<a name='L559'><font color='darkred'>#endif</font>
<a name='L560'><font color='darkred'>#ifdef</font> DN_CREATE
<a name='L561'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "DN_CREATE", (<b>long</b>)DN_CREATE)) <b>return</b> -1;
<a name='L562'><font color='darkred'>#endif</font>
<a name='L563'><font color='darkred'>#ifdef</font> DN_DELETE
<a name='L564'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "DN_DELETE", (<b>long</b>)DN_DELETE)) <b>return</b> -1;
<a name='L565'><font color='darkred'>#endif</font>
<a name='L566'><font color='darkred'>#ifdef</font> DN_RENAME
<a name='L567'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "DN_RENAME", (<b>long</b>)DN_RENAME)) <b>return</b> -1;
<a name='L568'><font color='darkred'>#endif</font>
<a name='L569'><font color='darkred'>#ifdef</font> DN_ATTRIB
<a name='L570'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "DN_ATTRIB", (<b>long</b>)DN_ATTRIB)) <b>return</b> -1;
<a name='L571'><font color='darkred'>#endif</font>
<a name='L572'><font color='darkred'>#ifdef</font> DN_MULTISHOT
<a name='L573'>    <b>if</b> (<a href='../D/9214.html' title='Multiple defined in 3 places.'>ins</a>(d, "DN_MULTISHOT", (<b>long</b>)DN_MULTISHOT)) <b>return</b> -1;
<a name='L574'><font color='darkred'>#endif</font>
<a name='L575'>
<a name='L576'><font color='darkred'>#ifdef</font> HAVE_STROPTS_H
<a name='L577'>    <i><font color='green'>/* Unix 98 guarantees that these are in stropts.h. */</font></i>
<a name='L578'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_PUSH);
<a name='L579'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_POP);
<a name='L580'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_LOOK);
<a name='L581'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_FLUSH);
<a name='L582'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_FLUSHBAND);
<a name='L583'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_SETSIG);
<a name='L584'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_GETSIG);
<a name='L585'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_FIND);
<a name='L586'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_PEEK);
<a name='L587'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_SRDOPT);
<a name='L588'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_GRDOPT);
<a name='L589'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_NREAD);
<a name='L590'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_FDINSERT);
<a name='L591'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_STR);
<a name='L592'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_SWROPT);
<a name='L593'><font color='darkred'>#ifdef</font> I_GWROPT
<a name='L594'>    <i><font color='green'>/* despite the comment above, old-ish glibcs miss a couple... */</font></i>
<a name='L595'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_GWROPT);
<a name='L596'><font color='darkred'>#endif</font>
<a name='L597'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_SENDFD);
<a name='L598'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_RECVFD);
<a name='L599'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_LIST);
<a name='L600'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_ATMARK);
<a name='L601'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_CKBAND);
<a name='L602'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_GETBAND);
<a name='L603'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_CANPUT);
<a name='L604'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_SETCLTIME);
<a name='L605'><font color='darkred'>#ifdef</font> I_GETCLTIME
<a name='L606'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_GETCLTIME);
<a name='L607'><font color='darkred'>#endif</font>
<a name='L608'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_LINK);
<a name='L609'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_UNLINK);
<a name='L610'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_PLINK);
<a name='L611'>    <a href='../S/2672.html#L444' title='Defined at 444 in Modules/fcntlmodule.c.'>INS</a>(I_PUNLINK);
<a name='L612'><font color='darkred'>#endif</font>
<a name='L613'>
<a name='L614'>    <b>return</b> 0;
<a name='L615'><font color='red'>}</font>
<a name='L616'>
<a name='L617'>
<a name='L618'><b>static</b> <b>struct</b> <a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a> fcntlmodule = <font color='red'>{</font>
<a name='L619'>    <a href='../S/542.html#L33' title='Defined at 33 in Include/moduleobject.h.'>PyModuleDef_HEAD_INIT</a>,
<a name='L620'>    "fcntl",
<a name='L621'>    module_doc,
<a name='L622'>    -1,
<a name='L623'>    fcntl_methods,
<a name='L624'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L625'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L626'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L627'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L628'><font color='red'>}</font>;
<a name='L629'>
<a name='L630'><a href='../D/3482.html' title='Multiple defined in 10 places.'>PyMODINIT_FUNC</a>
<a name='L631'>PyInit_fcntl(<b>void</b>)
<a name='L632'><font color='red'>{</font>
<a name='L633'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m, *d;
<a name='L634'>
<a name='L635'>    <i><font color='green'>/* Create the module and add the functions and documentation */</font></i>
<a name='L636'>    m = PyModule_Create(&amp;fcntlmodule);
<a name='L637'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L638'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L639'>
<a name='L640'>    <i><font color='green'>/* Add some symbolic constants to the module */</font></i>
<a name='L641'>    d = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(m);
<a name='L642'>    <a href='../D/6710.html' title='Multiple defined in 2 places.'>all_ins</a>(d);
<a name='L643'>    <b>return</b> m;
<a name='L644'><font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L19'>[^]</a><a href='#L631'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
