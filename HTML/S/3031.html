<html>
<head>
<title>PC/winreg.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3393.html'>PC</a>/winreg.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L395'>[^]</a><a href='#L1739'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L395' title='Defined at 395.'>PyHKEY_unaryFailureFunc</a>
<li><a href='#L401' title='Defined at 401.'>PyHKEY_binaryFailureFunc</a>
<li><a href='#L407' title='Defined at 407.'>PyHKEY_ternaryFailureFunc</a>
<li><a href='#L414' title='Defined at 414.'>PyHKEY_deallocFunc</a>
<li><a href='#L427' title='Defined at 427.'>PyHKEY_boolFunc</a>
<li><a href='#L433' title='Defined at 433.'>PyHKEY_intFunc</a>
<li><a href='#L440' title='Defined at 440.'>PyHKEY_strFunc</a>
<li><a href='#L447' title='Defined at 447.'>PyHKEY_compareFunc</a>
<li><a href='#L456' title='Defined at 456.'>PyHKEY_hashFunc</a>
<li><a href='#L547' title='Defined at 547.'>PyHKEY_CloseMethod</a>
<li><a href='#L558' title='Defined at 558.'>PyHKEY_DetachMethod</a>
<li><a href='#L570' title='Defined at 570.'>PyHKEY_Enter</a>
<li><a href='#L577' title='Defined at 577.'>PyHKEY_Exit</a>
<li><a href='#L589' title='Defined at 589.'>PyHKEY_New</a>
<li><a href='#L598' title='Defined at 598.'>PyHKEY_Close</a>
<li><a href='#L616' title='Defined at 616.'>PyHKEY_AsHKEY</a>
<li><a href='#L648' title='Defined at 648.'>PyHKEY_FromHKEY</a>
<li><a href='#L666' title='Defined at 666.'>PyWinObject_CloseHKEY</a>
<li><a href='#L708' title='Defined at 708.'>fixupMultiSZ</a>
<li><a href='#L723' title='Defined at 723.'>countStrings</a>
<li><a href='#L738' title='Defined at 738.'>Py2Reg</a>
<li><a href='#L864' title='Defined at 864.'>Reg2Py</a>
<li><a href='#L941' title='Defined at 941.'>PyCloseKey</a>
<li><a href='#L953' title='Defined at 953.'>PyConnectRegistry</a>
<li><a href='#L974' title='Defined at 974.'>PyCreateKey</a>
<li><a href='#L992' title='Defined at 992.'>PyCreateKeyEx</a>
<li><a href='#L1018' title='Defined at 1018.'>PyDeleteKey</a>
<li><a href='#L1036' title='Defined at 1036.'>PyDeleteKeyEx</a>
<li><a href='#L1077' title='Defined at 1077.'>PyDeleteValue</a>
<li><a href='#L1098' title='Defined at 1098.'>PyEnumKey</a>
<li><a href='#L1131' title='Defined at 1131.'>PyEnumValue</a>
<li><a href='#L1216' title='Defined at 1216.'>PyExpandEnvironmentStrings</a>
<li><a href='#L1249' title='Defined at 1249.'>PyFlushKey</a>
<li><a href='#L1267' title='Defined at 1267.'>PyLoadKey</a>
<li><a href='#L1289' title='Defined at 1289.'>PyOpenKey</a>
<li><a href='#L1317' title='Defined at 1317.'>PyQueryInfoKey</a>
<li><a href='#L1346' title='Defined at 1346.'>PyQueryValue</a>
<li><a href='#L1403' title='Defined at 1403.'>PyQueryValueEx</a>
<li><a href='#L1464' title='Defined at 1464.'>PySaveKey</a>
<li><a href='#L1490' title='Defined at 1490.'>PySetValue</a>
<li><a href='#L1524' title='Defined at 1524.'>PySetValueEx</a>
<li><a href='#L1565' title='Defined at 1565.'>PyDisableReflectionKey</a>
<li><a href='#L1601' title='Defined at 1601.'>PyEnableReflectionKey</a>
<li><a href='#L1637' title='Defined at 1637.'>PyQueryReflectionKey</a>
<li><a href='#L1705' title='Defined at 1705.'>insint</a>
<li><a href='#L1716' title='Defined at 1716.'>inskey</a>
<li><a href='#L1739' title='Defined at 1739.'>PyInit_winreg</a>
</ol>
<hr>
<pre>
<a name='L1'><i><font color='green'>/*</font></i>
<a name='L2'><i><font color='green'>  winreg.c</font></i>
<a name='L3'><i><font color='green'></font></i>
<a name='L4'><i><font color='green'>  Windows Registry access module for Python.</font></i>
<a name='L5'><i><font color='green'></font></i>
<a name='L6'><i><font color='green'>  * Simple registry access written by Mark Hammond in win32api</font></i>
<a name='L7'><i><font color='green'>    module circa 1995.</font></i>
<a name='L8'><i><font color='green'>  * Bill Tutt expanded the support significantly not long after.</font></i>
<a name='L9'><i><font color='green'>  * Numerous other people have submitted patches since then.</font></i>
<a name='L10'><i><font color='green'>  * Ripped from win32api module 03-Feb-2000 by Mark Hammond, and</font></i>
<a name='L11'><i><font color='green'>    basic Unicode support added.</font></i>
<a name='L12'><i><font color='green'></font></i>
<a name='L13'><i><font color='green'>*/</font></i>
<a name='L14'>
<a name='L15'><font color='darkred'>#include</font> "<a href='570.html'>Python.h</a>"
<a name='L16'><font color='darkred'>#include</font> "<a href='577.html'>structmember.h</a>"
<a name='L17'><font color='darkred'>#include</font> "windows.h"
<a name='L18'>
<a name='L19'><b>static</b> <a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a> <a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(PyObject *ob, HKEY *pRes, <a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a> bNoneOK);
<a name='L20'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3031.html#L648' title='Defined at 648 in PC/winreg.c.'>PyHKEY_FromHKEY</a>(HKEY h);
<a name='L21'><b>static</b> <a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a> <a href='../S/3031.html#L598' title='Defined at 598 in PC/winreg.c.'>PyHKEY_Close</a>(PyObject *obHandle);
<a name='L22'>
<a name='L23'><b>static</b> <b>char</b> errNotAHandle[] = "Object is not a handle";
<a name='L24'>
<a name='L25'><i><font color='green'>/* The win32api module reports the function name that failed,</font></i>
<a name='L26'><i><font color='green'>   but this concept is not in the Python core.</font></i>
<a name='L27'><i><font color='green'>   Hopefully it will one day, and in the meantime I dont</font></i>
<a name='L28'><i><font color='green'>   want to lose this info...</font></i>
<a name='L29'><i><font color='green'>*/</font></i>
<a name='L30'><font color='darkred'>#define</font> <a href='../R/2891.html' title='Multiple refered from 28 places.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, fnname) \
<a name='L31'>    <a href='../S/3106.html#L546' title='Defined at 546 in Python/errors.c.'>PyErr_SetFromWindowsErr</a>(rc)
<a name='L32'>
<a name='L33'><i><font color='green'>/* Forward declares */</font></i>
<a name='L34'>
<a name='L35'><i><font color='green'>/* Doc strings */</font></i>
<a name='L36'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(module_doc,
<a name='L37'>"This module provides access to the Windows registry API.\n"
<a name='L38'>"\n"
<a name='L39'>"Functions:\n"
<a name='L40'>"\n"
<a name='L41'>"CloseKey() - Closes a registry key.\n"
<a name='L42'>"ConnectRegistry() - Establishes a connection to a predefined registry handle\n"
<a name='L43'>"                    on another computer.\n"
<a name='L44'>"CreateKey() - Creates the specified key, or opens it if it already exists.\n"
<a name='L45'>"DeleteKey() - Deletes the specified key.\n"
<a name='L46'>"DeleteValue() - Removes a named value from the specified registry key.\n"
<a name='L47'>"EnumKey() - Enumerates subkeys of the specified open registry key.\n"
<a name='L48'>"EnumValue() - Enumerates values of the specified open registry key.\n"
<a name='L49'>"ExpandEnvironmentStrings() - Expand the env strings in a REG_EXPAND_SZ string.\n"
<a name='L50'>"FlushKey() - Writes all the attributes of the specified key to the registry.\n"
<a name='L51'>"LoadKey() - Creates a subkey under HKEY_USER or HKEY_LOCAL_MACHINE and stores\n"
<a name='L52'>"            registration information from a specified file into that subkey.\n"
<a name='L53'>"OpenKey() - Alias for &lt;om win32api.RegOpenKeyEx&gt;\n"
<a name='L54'>"OpenKeyEx() - Opens the specified key.\n"
<a name='L55'>"QueryValue() - Retrieves the value associated with the unnamed value for a\n"
<a name='L56'>"               specified key in the registry.\n"
<a name='L57'>"QueryValueEx() - Retrieves the type and data for a specified value name\n"
<a name='L58'>"                 associated with an open registry key.\n"
<a name='L59'>"QueryInfoKey() - Returns information about the specified key.\n"
<a name='L60'>"SaveKey() - Saves the specified key, and all its subkeys a file.\n"
<a name='L61'>"SetValue() - Associates a value with a specified key.\n"
<a name='L62'>"SetValueEx() - Stores data in the value field of an open registry key.\n"
<a name='L63'>"\n"
<a name='L64'>"Special objects:\n"
<a name='L65'>"\n"
<a name='L66'>"HKEYType -- type object for HKEY objects\n"
<a name='L67'>"error -- exception raised for Win32 errors\n"
<a name='L68'>"\n"
<a name='L69'>"Integer constants:\n"
<a name='L70'>"Many constants are defined - see the documentation for each function\n"
<a name='L71'>"to see what constants are used, and where.");
<a name='L72'>
<a name='L73'>
<a name='L74'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(CloseKey_doc,
<a name='L75'>"CloseKey(hkey) - Closes a previously opened registry key.\n"
<a name='L76'>"\n"
<a name='L77'>"The hkey argument specifies a previously opened key.\n"
<a name='L78'>"\n"
<a name='L79'>"Note that if the key is not closed using this method, it will be\n"
<a name='L80'>"closed when the hkey object is destroyed by Python.");
<a name='L81'>
<a name='L82'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(ConnectRegistry_doc,
<a name='L83'>"key = ConnectRegistry(computer_name, key) - "
<a name='L84'>"Establishes a connection to a predefined registry handle on another computer.\n"
<a name='L85'>"\n"
<a name='L86'>"computer_name is the name of the remote computer, of the form \\\\computername.\n"
<a name='L87'>" If None, the local computer is used.\n"
<a name='L88'>"key is the predefined handle to connect to.\n"
<a name='L89'>"\n"
<a name='L90'>"The return value is the handle of the opened key.\n"
<a name='L91'>"If the function fails, a WindowsError exception is raised.");
<a name='L92'>
<a name='L93'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(CreateKey_doc,
<a name='L94'>"key = CreateKey(key, sub_key) - Creates or opens the specified key.\n"
<a name='L95'>"\n"
<a name='L96'>"key is an already open key, or one of the predefined HKEY_* constants\n"
<a name='L97'>"sub_key is a string that names the key this method opens or creates.\n"
<a name='L98'>" If key is one of the predefined keys, sub_key may be None. In that case,\n"
<a name='L99'>" the handle returned is the same key handle passed in to the function.\n"
<a name='L100'>"\n"
<a name='L101'>"If the key already exists, this function opens the existing key\n"
<a name='L102'>"\n"
<a name='L103'>"The return value is the handle of the opened key.\n"
<a name='L104'>"If the function fails, an exception is raised.");
<a name='L105'>
<a name='L106'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(CreateKeyEx_doc,
<a name='L107'>"key = CreateKeyEx(key, sub_key, res, sam) - Creates or opens the specified key.\n"
<a name='L108'>"\n"
<a name='L109'>"key is an already open key, or one of the predefined HKEY_* constants\n"
<a name='L110'>"sub_key is a string that names the key this method opens or creates.\n"
<a name='L111'>"res is a reserved integer, and must be zero.  Default is zero.\n"
<a name='L112'>"sam is an integer that specifies an access mask that describes the desired\n"
<a name='L113'>" If key is one of the predefined keys, sub_key may be None. In that case,\n"
<a name='L114'>" the handle returned is the same key handle passed in to the function.\n"
<a name='L115'>"\n"
<a name='L116'>"If the key already exists, this function opens the existing key\n"
<a name='L117'>"\n"
<a name='L118'>"The return value is the handle of the opened key.\n"
<a name='L119'>"If the function fails, an exception is raised.");
<a name='L120'>
<a name='L121'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(DeleteKey_doc,
<a name='L122'>"DeleteKey(key, sub_key) - Deletes the specified key.\n"
<a name='L123'>"\n"
<a name='L124'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L125'>"sub_key is a string that must be a subkey of the key identified by the key parameter.\n"
<a name='L126'>" This value must not be None, and the key may not have subkeys.\n"
<a name='L127'>"\n"
<a name='L128'>"This method can not delete keys with subkeys.\n"
<a name='L129'>"\n"
<a name='L130'>"If the method succeeds, the entire key, including all of its values,\n"
<a name='L131'>"is removed.  If the method fails, a WindowsError exception is raised.");
<a name='L132'>
<a name='L133'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(DeleteKeyEx_doc,
<a name='L134'>"DeleteKeyEx(key, sub_key, sam, res) - Deletes the specified key.\n"
<a name='L135'>"\n"
<a name='L136'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L137'>"sub_key is a string that must be a subkey of the key identified by the key parameter.\n"
<a name='L138'>"res is a reserved integer, and must be zero.  Default is zero.\n"
<a name='L139'>"sam is an integer that specifies an access mask that describes the desired\n"
<a name='L140'>" This value must not be None, and the key may not have subkeys.\n"
<a name='L141'>"\n"
<a name='L142'>"This method can not delete keys with subkeys.\n"
<a name='L143'>"\n"
<a name='L144'>"If the method succeeds, the entire key, including all of its values,\n"
<a name='L145'>"is removed.  If the method fails, a WindowsError exception is raised.\n"
<a name='L146'>"On unsupported Windows versions, NotImplementedError is raised.");
<a name='L147'>
<a name='L148'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(DeleteValue_doc,
<a name='L149'>"DeleteValue(key, value) - Removes a named value from a registry key.\n"
<a name='L150'>"\n"
<a name='L151'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L152'>"value is a string that identifies the value to remove.");
<a name='L153'>
<a name='L154'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EnumKey_doc,
<a name='L155'>"string = EnumKey(key, index) - Enumerates subkeys of an open registry key.\n"
<a name='L156'>"\n"
<a name='L157'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L158'>"index is an integer that identifies the index of the key to retrieve.\n"
<a name='L159'>"\n"
<a name='L160'>"The function retrieves the name of one subkey each time it is called.\n"
<a name='L161'>"It is typically called repeatedly until a WindowsError exception is\n"
<a name='L162'>"raised, indicating no more values are available.");
<a name='L163'>
<a name='L164'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EnumValue_doc,
<a name='L165'>"tuple = EnumValue(key, index) - Enumerates values of an open registry key.\n"
<a name='L166'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L167'>"index is an integer that identifies the index of the value to retrieve.\n"
<a name='L168'>"\n"
<a name='L169'>"The function retrieves the name of one subkey each time it is called.\n"
<a name='L170'>"It is typically called repeatedly, until a WindowsError exception\n"
<a name='L171'>"is raised, indicating no more values.\n"
<a name='L172'>"\n"
<a name='L173'>"The result is a tuple of 3 items:\n"
<a name='L174'>"value_name is a string that identifies the value.\n"
<a name='L175'>"value_data is an object that holds the value data, and whose type depends\n"
<a name='L176'>" on the underlying registry type.\n"
<a name='L177'>"data_type is an integer that identifies the type of the value data.");
<a name='L178'>
<a name='L179'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(ExpandEnvironmentStrings_doc,
<a name='L180'>"string = ExpandEnvironmentStrings(string) - Expand environment vars.\n");
<a name='L181'>
<a name='L182'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(FlushKey_doc,
<a name='L183'>"FlushKey(key) - Writes all the attributes of a key to the registry.\n"
<a name='L184'>"\n"
<a name='L185'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L186'>"\n"
<a name='L187'>"It is not necessary to call RegFlushKey to change a key.\n"
<a name='L188'>"Registry changes are flushed to disk by the registry using its lazy flusher.\n"
<a name='L189'>"Registry changes are also flushed to disk at system shutdown.\n"
<a name='L190'>"Unlike CloseKey(), the FlushKey() method returns only when all the data has\n"
<a name='L191'>"been written to the registry.\n"
<a name='L192'>"An application should only call FlushKey() if it requires absolute certainty that registry changes are on disk.\n"
<a name='L193'>"If you don't know whether a FlushKey() call is required, it probably isn't.");
<a name='L194'>
<a name='L195'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(LoadKey_doc,
<a name='L196'>"LoadKey(key, sub_key, file_name) - Creates a subkey under the specified key\n"
<a name='L197'>"and stores registration information from a specified file into that subkey.\n"
<a name='L198'>"\n"
<a name='L199'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L200'>"sub_key is a string that identifies the sub_key to load\n"
<a name='L201'>"file_name is the name of the file to load registry data from.\n"
<a name='L202'>" This file must have been created with the SaveKey() function.\n"
<a name='L203'>" Under the file allocation table (FAT) file system, the filename may not\n"
<a name='L204'>"have an extension.\n"
<a name='L205'>"\n"
<a name='L206'>"A call to LoadKey() fails if the calling process does not have the\n"
<a name='L207'>"SE_RESTORE_PRIVILEGE privilege.\n"
<a name='L208'>"\n"
<a name='L209'>"If key is a handle returned by ConnectRegistry(), then the path specified\n"
<a name='L210'>"in fileName is relative to the remote computer.\n"
<a name='L211'>"\n"
<a name='L212'>"The docs imply key must be in the HKEY_USER or HKEY_LOCAL_MACHINE tree");
<a name='L213'>
<a name='L214'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(OpenKey_doc,
<a name='L215'>"key = OpenKey(key, sub_key, res = 0, sam = KEY_READ) - Opens the specified key.\n"
<a name='L216'>"\n"
<a name='L217'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L218'>"sub_key is a string that identifies the sub_key to open\n"
<a name='L219'>"res is a reserved integer, and must be zero.  Default is zero.\n"
<a name='L220'>"sam is an integer that specifies an access mask that describes the desired\n"
<a name='L221'>" security access for the key.  Default is KEY_READ\n"
<a name='L222'>"\n"
<a name='L223'>"The result is a new handle to the specified key\n"
<a name='L224'>"If the function fails, a WindowsError exception is raised.");
<a name='L225'>
<a name='L226'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(OpenKeyEx_doc, "See OpenKey()");
<a name='L227'>
<a name='L228'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(QueryInfoKey_doc,
<a name='L229'>"tuple = QueryInfoKey(key) - Returns information about a key.\n"
<a name='L230'>"\n"
<a name='L231'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L232'>"\n"
<a name='L233'>"The result is a tuple of 3 items:"
<a name='L234'>"An integer that identifies the number of sub keys this key has.\n"
<a name='L235'>"An integer that identifies the number of values this key has.\n"
<a name='L236'>"A long integer that identifies when the key was last modified (if available)\n"
<a name='L237'>" as 100's of nanoseconds since Jan 1, 1600.");
<a name='L238'>
<a name='L239'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(QueryValue_doc,
<a name='L240'>"string = QueryValue(key, sub_key) - retrieves the unnamed value for a key.\n"
<a name='L241'>"\n"
<a name='L242'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L243'>"sub_key is a string that holds the name of the subkey with which the value\n"
<a name='L244'>" is associated.  If this parameter is None or empty, the function retrieves\n"
<a name='L245'>" the value set by the SetValue() method for the key identified by key."
<a name='L246'>"\n"
<a name='L247'>"Values in the registry have name, type, and data components. This method\n"
<a name='L248'>"retrieves the data for a key's first value that has a NULL name.\n"
<a name='L249'>"But the underlying API call doesn't return the type, Lame Lame Lame, DONT USE THIS!!!");
<a name='L250'>
<a name='L251'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(QueryValueEx_doc,
<a name='L252'>"value,type_id = QueryValueEx(key, value_name) - Retrieves the type and data for a specified value name associated with an open registry key.\n"
<a name='L253'>"\n"
<a name='L254'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L255'>"value_name is a string indicating the value to query");
<a name='L256'>
<a name='L257'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(SaveKey_doc,
<a name='L258'>"SaveKey(key, file_name) - Saves the specified key, and all its subkeys to the specified file.\n"
<a name='L259'>"\n"
<a name='L260'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L261'>"file_name is the name of the file to save registry data to.\n"
<a name='L262'>" This file cannot already exist. If this filename includes an extension,\n"
<a name='L263'>" it cannot be used on file allocation table (FAT) file systems by the\n"
<a name='L264'>" LoadKey(), ReplaceKey() or RestoreKey() methods.\n"
<a name='L265'>"\n"
<a name='L266'>"If key represents a key on a remote computer, the path described by\n"
<a name='L267'>"file_name is relative to the remote computer.\n"
<a name='L268'>"The caller of this method must possess the SeBackupPrivilege security privilege.\n"
<a name='L269'>"This function passes NULL for security_attributes to the API.");
<a name='L270'>
<a name='L271'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(SetValue_doc,
<a name='L272'>"SetValue(key, sub_key, type, value) - Associates a value with a specified key.\n"
<a name='L273'>"\n"
<a name='L274'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L275'>"sub_key is a string that names the subkey with which the value is associated.\n"
<a name='L276'>"type is an integer that specifies the type of the data.  Currently this\n"
<a name='L277'>" must be REG_SZ, meaning only strings are supported.\n"
<a name='L278'>"value is a string that specifies the new value.\n"
<a name='L279'>"\n"
<a name='L280'>"If the key specified by the sub_key parameter does not exist, the SetValue\n"
<a name='L281'>"function creates it.\n"
<a name='L282'>"\n"
<a name='L283'>"Value lengths are limited by available memory. Long values (more than\n"
<a name='L284'>"2048 bytes) should be stored as files with the filenames stored in \n"
<a name='L285'>"the configuration registry.  This helps the registry perform efficiently.\n"
<a name='L286'>"\n"
<a name='L287'>"The key identified by the key parameter must have been opened with\n"
<a name='L288'>"KEY_SET_VALUE access.");
<a name='L289'>
<a name='L290'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(SetValueEx_doc,
<a name='L291'>"SetValueEx(key, value_name, reserved, type, value) - Stores data in the value field of an open registry key.\n"
<a name='L292'>"\n"
<a name='L293'>"key is an already open key, or any one of the predefined HKEY_* constants.\n"
<a name='L294'>"value_name is a string containing the name of the value to set, or None\n"
<a name='L295'>"type is an integer that specifies the type of the data.  This should be one of:\n"
<a name='L296'>"  REG_BINARY -- Binary data in any form.\n"
<a name='L297'>"  REG_DWORD -- A 32-bit number.\n"
<a name='L298'>"  REG_DWORD_LITTLE_ENDIAN -- A 32-bit number in little-endian format.\n"
<a name='L299'>"  REG_DWORD_BIG_ENDIAN -- A 32-bit number in big-endian format.\n"
<a name='L300'>"  REG_EXPAND_SZ -- A null-terminated string that contains unexpanded references\n"
<a name='L301'>"                   to environment variables (for example, %PATH%).\n"
<a name='L302'>"  REG_LINK -- A Unicode symbolic link.\n"
<a name='L303'>"  REG_MULTI_SZ -- An sequence of null-terminated strings, terminated by\n"
<a name='L304'>"                  two null characters.  Note that Python handles this\n"
<a name='L305'>"                  termination automatically.\n"
<a name='L306'>"  REG_NONE -- No defined value type.\n"
<a name='L307'>"  REG_RESOURCE_LIST -- A device-driver resource list.\n"
<a name='L308'>"  REG_SZ -- A null-terminated string.\n"
<a name='L309'>"reserved can be anything - zero is always passed to the API.\n"
<a name='L310'>"value is a string that specifies the new value.\n"
<a name='L311'>"\n"
<a name='L312'>"This method can also set additional value and type information for the\n"
<a name='L313'>"specified key.  The key identified by the key parameter must have been\n"
<a name='L314'>"opened with KEY_SET_VALUE access.\n"
<a name='L315'>"\n"
<a name='L316'>"To open the key, use the CreateKeyEx() or OpenKeyEx() methods.\n"
<a name='L317'>"\n"
<a name='L318'>"Value lengths are limited by available memory. Long values (more than\n"
<a name='L319'>"2048 bytes) should be stored as files with the filenames stored in \n"
<a name='L320'>"the configuration registry.  This helps the registry perform efficiently.");
<a name='L321'>
<a name='L322'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(DisableReflectionKey_doc,
<a name='L323'>"Disables registry reflection for 32-bit processes running on a 64-bit\n"
<a name='L324'>"Operating System.  Will generally raise NotImplemented if executed on\n"
<a name='L325'>"a 32-bit Operating System.\n"
<a name='L326'>"If the key is not on the reflection list, the function succeeds but has no effect.\n"
<a name='L327'>"Disabling reflection for a key does not affect reflection of any subkeys.");
<a name='L328'>
<a name='L329'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(EnableReflectionKey_doc,
<a name='L330'>"Restores registry reflection for the specified disabled key.\n"
<a name='L331'>"Will generally raise NotImplemented if executed on a 32-bit Operating System.\n"
<a name='L332'>"Restoring reflection for a key does not affect reflection of any subkeys.");
<a name='L333'>
<a name='L334'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(QueryReflectionKey_doc,
<a name='L335'>"bool = QueryReflectionKey(hkey) - Determines the reflection state for the specified key.\n"
<a name='L336'>"Will generally raise NotImplemented if executed on a 32-bit Operating System.\n");
<a name='L337'>
<a name='L338'><i><font color='green'>/* PyHKEY docstrings */</font></i>
<a name='L339'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(PyHKEY_doc,
<a name='L340'>"PyHKEY Object - A Python object, representing a win32 registry key.\n"
<a name='L341'>"\n"
<a name='L342'>"This object wraps a Windows HKEY object, automatically closing it when\n"
<a name='L343'>"the object is destroyed.  To guarantee cleanup, you can call either\n"
<a name='L344'>"the Close() method on the PyHKEY, or the CloseKey() method.\n"
<a name='L345'>"\n"
<a name='L346'>"All functions which accept a handle object also accept an integer - \n"
<a name='L347'>"however, use of the handle object is encouraged.\n"
<a name='L348'>"\n"
<a name='L349'>"Functions:\n"
<a name='L350'>"Close() - Closes the underlying handle.\n"
<a name='L351'>"Detach() - Returns the integer Win32 handle, detaching it from the object\n"
<a name='L352'>"\n"
<a name='L353'>"Properties:\n"
<a name='L354'>"handle - The integer Win32 handle.\n"
<a name='L355'>"\n"
<a name='L356'>"Operations:\n"
<a name='L357'>"__bool__ - Handles with an open object return true, otherwise false.\n"
<a name='L358'>"__int__ - Converting a handle to an integer returns the Win32 handle.\n"
<a name='L359'>"rich comparison - Handle objects are compared using the handle value.");
<a name='L360'>
<a name='L361'>
<a name='L362'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(PyHKEY_Close_doc,
<a name='L363'>"key.Close() - Closes the underlying Windows handle.\n"
<a name='L364'>"\n"
<a name='L365'>"If the handle is already closed, no error is raised.");
<a name='L366'>
<a name='L367'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(PyHKEY_Detach_doc,
<a name='L368'>"int = key.Detach() - Detaches the Windows handle from the handle object.\n"
<a name='L369'>"\n"
<a name='L370'>"The result is the value of the handle before it is detached.  If the\n"
<a name='L371'>"handle is already detached, this will return zero.\n"
<a name='L372'>"\n"
<a name='L373'>"After calling this function, the handle is effectively invalidated,\n"
<a name='L374'>"but the handle is not closed.  You would call this function when you\n"
<a name='L375'>"need the underlying win32 handle to exist beyond the lifetime of the\n"
<a name='L376'>"handle object.\n"
<a name='L377'>"On 64 bit windows, the result of this function is a long integer");
<a name='L378'>
<a name='L379'>
<a name='L380'><i><font color='green'>/************************************************************************</font></i>
<a name='L381'><i><font color='green'></font></i>
<a name='L382'><i><font color='green'>  The PyHKEY object definition</font></i>
<a name='L383'><i><font color='green'></font></i>
<a name='L384'><i><font color='green'>************************************************************************/</font></i>
<a name='L385'><b>typedef</b> <b>struct</b> <font color='red'>{</font>
<a name='L386'>    <a href='../S/544.html#L97' title='Defined at 97 in Include/object.h.'>PyObject_VAR_HEAD</a>
<a name='L387'>    HKEY hkey;
<a name='L388'><font color='red'>}</font> <a href='../R/2988.html' title='Multiple refered from 15 places.'>PyHKEYObject</a>;
<a name='L389'>
<a name='L390'><font color='darkred'>#define</font> <a href='../R/2990.html' title='Multiple refered from 3 places.'>PyHKEY_Check</a>(op) ((op)-&gt;ob_type == &amp;PyHKEY_Type)
<a name='L391'>
<a name='L392'><b>static</b> <b>char</b> *failMsg = "bad operand type";
<a name='L393'>
<a name='L394'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L395'><a href='../R/3004.html' title='Multiple refered from 5 places.'>PyHKEY_unaryFailureFunc</a>(PyObject *ob)
<a name='L396'><font color='red'>{</font>
<a name='L397'>    <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError, failMsg);
<a name='L398'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L399'><font color='red'>}</font>
<a name='L400'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L401'><a href='../R/2997.html' title='Multiple refered from 10 places.'>PyHKEY_binaryFailureFunc</a>(PyObject *ob1, PyObject *ob2)
<a name='L402'><font color='red'>{</font>
<a name='L403'>    <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError, failMsg);
<a name='L404'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L405'><font color='red'>}</font>
<a name='L406'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L407'><a href='../S/3031.html#L472' title='Refered from 472 in PC/winreg.c.'>PyHKEY_ternaryFailureFunc</a>(PyObject *ob1, PyObject *ob2, PyObject *ob3)
<a name='L408'><font color='red'>{</font>
<a name='L409'>    <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError, failMsg);
<a name='L410'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L411'><font color='red'>}</font>
<a name='L412'>
<a name='L413'><b>static</b> <b>void</b>
<a name='L414'><a href='../S/3031.html#L514' title='Refered from 514 in PC/winreg.c.'>PyHKEY_deallocFunc</a>(PyObject *ob)
<a name='L415'><font color='red'>{</font>
<a name='L416'>    <i><font color='green'>/* Can not call PyHKEY_Close, as the ob-&gt;tp_type</font></i>
<a name='L417'><i><font color='green'>       has already been cleared, thus causing the type</font></i>
<a name='L418'><i><font color='green'>       check to fail!</font></i>
<a name='L419'><i><font color='green'>    */</font></i>
<a name='L420'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *obkey = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob;
<a name='L421'>    <b>if</b> (obkey-&gt;hkey)
<a name='L422'>        RegCloseKey((HKEY)obkey-&gt;hkey);
<a name='L423'>    <a href='../S/2611.html#L74' title='Defined at 74 in Modules/_sre.c.'>PyObject_DEL</a>(ob);
<a name='L424'><font color='red'>}</font>
<a name='L425'>
<a name='L426'><b>static</b> <b>int</b>
<a name='L427'><a href='../S/3031.html#L476' title='Refered from 476 in PC/winreg.c.'>PyHKEY_boolFunc</a>(PyObject *ob)
<a name='L428'><font color='red'>{</font>
<a name='L429'>    <b>return</b> ((<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob)-&gt;hkey != 0;
<a name='L430'><font color='red'>}</font>
<a name='L431'>
<a name='L432'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L433'><a href='../S/3031.html#L483' title='Refered from 483 in PC/winreg.c.'>PyHKEY_intFunc</a>(PyObject *ob)
<a name='L434'><font color='red'>{</font>
<a name='L435'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *pyhkey = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob;
<a name='L436'>    <b>return</b> <a href='../S/2799.html#L929' title='Defined at 929 in Objects/longobject.c.'>PyLong_FromVoidPtr</a>(pyhkey-&gt;hkey);
<a name='L437'><font color='red'>}</font>
<a name='L438'>
<a name='L439'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L440'><a href='../S/3031.html#L525' title='Refered from 525 in PC/winreg.c.'>PyHKEY_strFunc</a>(PyObject *ob)
<a name='L441'><font color='red'>{</font>
<a name='L442'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *pyhkey = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob;
<a name='L443'>    <b>return</b> <a href='../D/4008.html' title='Multiple defined in 3 places.'>PyUnicode_FromFormat</a>("&lt;PyHKEY:%p&gt;", pyhkey-&gt;hkey);
<a name='L444'><font color='red'>}</font>
<a name='L445'>
<a name='L446'><b>static</b> <b>int</b>
<a name='L447'>PyHKEY_compareFunc(PyObject *ob1, PyObject *ob2)
<a name='L448'><font color='red'>{</font>
<a name='L449'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *pyhkey1 = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob1;
<a name='L450'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *pyhkey2 = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob2;
<a name='L451'>    <b>return</b> pyhkey1 == pyhkey2 ? 0 :
<a name='L452'>         (pyhkey1 &lt; pyhkey2 ? -1 : 1);
<a name='L453'><font color='red'>}</font>
<a name='L454'>
<a name='L455'><b>static</b> <a href='../S/565.html#L186' title='Defined at 186 in Include/pyport.h.'>Py_hash_t</a>
<a name='L456'><a href='../S/3031.html#L523' title='Refered from 523 in PC/winreg.c.'>PyHKEY_hashFunc</a>(PyObject *ob)
<a name='L457'><font color='red'>{</font>
<a name='L458'>    <i><font color='green'>/* Just use the address.</font></i>
<a name='L459'><i><font color='green'>       XXX - should we use the handle value?</font></i>
<a name='L460'><i><font color='green'>    */</font></i>
<a name='L461'>    <b>return</b> <a href='../S/2803.html#L736' title='Defined at 736 in Objects/object.c.'>_Py_HashPointer</a>(ob);
<a name='L462'><font color='red'>}</font>
<a name='L463'>
<a name='L464'>
<a name='L465'><b>static</b> <a href='../S/544.html#L247' title='Defined at 247 in Include/object.h.'>PyNumberMethods</a> PyHKEY_NumberMethods =
<a name='L466'><font color='red'>{</font>
<a name='L467'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_add */</font></i>
<a name='L468'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_subtract */</font></i>
<a name='L469'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_multiply */</font></i>
<a name='L470'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_remainder */</font></i>
<a name='L471'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_divmod */</font></i>
<a name='L472'>    <a href='../S/3031.html#L407' title='Defined at 407 in PC/winreg.c.'>PyHKEY_ternaryFailureFunc</a>,          <i><font color='green'>/* nb_power */</font></i>
<a name='L473'>    <a href='../S/3031.html#L395' title='Defined at 395 in PC/winreg.c.'>PyHKEY_unaryFailureFunc</a>,            <i><font color='green'>/* nb_negative */</font></i>
<a name='L474'>    <a href='../S/3031.html#L395' title='Defined at 395 in PC/winreg.c.'>PyHKEY_unaryFailureFunc</a>,            <i><font color='green'>/* nb_positive */</font></i>
<a name='L475'>    <a href='../S/3031.html#L395' title='Defined at 395 in PC/winreg.c.'>PyHKEY_unaryFailureFunc</a>,            <i><font color='green'>/* nb_absolute */</font></i>
<a name='L476'>    <a href='../S/3031.html#L427' title='Defined at 427 in PC/winreg.c.'>PyHKEY_boolFunc</a>,                    <i><font color='green'>/* nb_bool */</font></i>
<a name='L477'>    <a href='../S/3031.html#L395' title='Defined at 395 in PC/winreg.c.'>PyHKEY_unaryFailureFunc</a>,            <i><font color='green'>/* nb_invert */</font></i>
<a name='L478'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_lshift */</font></i>
<a name='L479'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_rshift */</font></i>
<a name='L480'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_and */</font></i>
<a name='L481'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_xor */</font></i>
<a name='L482'>    <a href='../S/3031.html#L401' title='Defined at 401 in PC/winreg.c.'>PyHKEY_binaryFailureFunc</a>,           <i><font color='green'>/* nb_or */</font></i>
<a name='L483'>    <a href='../S/3031.html#L433' title='Defined at 433 in PC/winreg.c.'>PyHKEY_intFunc</a>,                     <i><font color='green'>/* nb_int */</font></i>
<a name='L484'>    0,                                  <i><font color='green'>/* nb_reserved */</font></i>
<a name='L485'>    <a href='../S/3031.html#L395' title='Defined at 395 in PC/winreg.c.'>PyHKEY_unaryFailureFunc</a>,            <i><font color='green'>/* nb_float */</font></i>
<a name='L486'><font color='red'>}</font>;
<a name='L487'>
<a name='L488'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3031.html#L547' title='Defined at 547 in PC/winreg.c.'>PyHKEY_CloseMethod</a>(PyObject *self, PyObject *args);
<a name='L489'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3031.html#L558' title='Defined at 558 in PC/winreg.c.'>PyHKEY_DetachMethod</a>(PyObject *self, PyObject *args);
<a name='L490'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3031.html#L570' title='Defined at 570 in PC/winreg.c.'>PyHKEY_Enter</a>(PyObject *self);
<a name='L491'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3031.html#L577' title='Defined at 577 in PC/winreg.c.'>PyHKEY_Exit</a>(PyObject *self, PyObject *args);
<a name='L492'>
<a name='L493'><b>static</b> <b>struct</b> <a href='../D/3525.html' title='Multiple defined in 3 places.'>PyMethodDef</a> PyHKEY_methods[] = <font color='red'>{</font>
<a name='L494'>    <font color='red'>{</font>"Close",  <a href='../S/3031.html#L547' title='Defined at 547 in PC/winreg.c.'>PyHKEY_CloseMethod</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, PyHKEY_Close_doc<font color='red'>}</font>,
<a name='L495'>    <font color='red'>{</font>"Detach", <a href='../S/3031.html#L558' title='Defined at 558 in PC/winreg.c.'>PyHKEY_DetachMethod</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, PyHKEY_Detach_doc<font color='red'>}</font>,
<a name='L496'>    <font color='red'>{</font>"__enter__", (PyCFunction)<a href='../S/3031.html#L570' title='Defined at 570 in PC/winreg.c.'>PyHKEY_Enter</a>, <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>,
<a name='L497'>    <font color='red'>{</font>"__exit__", <a href='../S/3031.html#L577' title='Defined at 577 in PC/winreg.c.'>PyHKEY_Exit</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>,
<a name='L498'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>
<a name='L499'><font color='red'>}</font>;
<a name='L500'>
<a name='L501'><font color='darkred'>#define</font> <a href='../R/2175.html' title='Multiple refered from 57 places.'>OFF</a>(e) <a href='../D/10194.html' title='Multiple defined in 2 places.'>offsetof</a>(<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a>, e)
<a name='L502'><b>static</b> <a href='../D/3506.html' title='Multiple defined in 2 places.'>PyMemberDef</a> PyHKEY_memberlist[] = <font color='red'>{</font>
<a name='L503'>    <font color='red'>{</font>"handle",      <a href='../S/577.html#L39' title='Defined at 39 in Include/structmember.h.'>T_INT</a>,      <a href='../D/2402.html' title='Multiple defined in 16 places.'>OFF</a>(hkey), <a href='../S/577.html#L73' title='Defined at 73 in Include/structmember.h.'>READONLY</a><font color='red'>}</font>,
<a name='L504'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>    <i><font color='green'>/* Sentinel */</font></i>
<a name='L505'><font color='red'>}</font>;
<a name='L506'>
<a name='L507'><i><font color='green'>/* The type itself */</font></i>
<a name='L508'><a href='../D/3899.html' title='Multiple defined in 3 places.'>PyTypeObject</a> PyHKEY_Type =
<a name='L509'><font color='red'>{</font>
<a name='L510'>    <a href='../D/4042.html' title='Multiple defined in 3 places.'>PyVarObject_HEAD_INIT</a>(0, 0) <i><font color='green'>/* fill in type at module init */</font></i>
<a name='L511'>    "PyHKEY",
<a name='L512'>    <b>sizeof</b>(<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a>),
<a name='L513'>    0,
<a name='L514'>    <a href='../S/3031.html#L414' title='Defined at 414 in PC/winreg.c.'>PyHKEY_deallocFunc</a>,                 <i><font color='green'>/* tp_dealloc */</font></i>
<a name='L515'>    0,                                  <i><font color='green'>/* tp_print */</font></i>
<a name='L516'>    0,                                  <i><font color='green'>/* tp_getattr */</font></i>
<a name='L517'>    0,                                  <i><font color='green'>/* tp_setattr */</font></i>
<a name='L518'>    0,                                  <i><font color='green'>/* tp_reserved */</font></i>
<a name='L519'>    0,                                  <i><font color='green'>/* tp_repr */</font></i>
<a name='L520'>    &amp;PyHKEY_NumberMethods,              <i><font color='green'>/* tp_as_number */</font></i>
<a name='L521'>    0,                                  <i><font color='green'>/* tp_as_sequence */</font></i>
<a name='L522'>    0,                                  <i><font color='green'>/* tp_as_mapping */</font></i>
<a name='L523'>    <a href='../S/3031.html#L456' title='Defined at 456 in PC/winreg.c.'>PyHKEY_hashFunc</a>,                    <i><font color='green'>/* tp_hash */</font></i>
<a name='L524'>    0,                                  <i><font color='green'>/* tp_call */</font></i>
<a name='L525'>    <a href='../S/3031.html#L440' title='Defined at 440 in PC/winreg.c.'>PyHKEY_strFunc</a>,                     <i><font color='green'>/* tp_str */</font></i>
<a name='L526'>    0,                                  <i><font color='green'>/* tp_getattro */</font></i>
<a name='L527'>    0,                                  <i><font color='green'>/* tp_setattro */</font></i>
<a name='L528'>    0,                                  <i><font color='green'>/* tp_as_buffer */</font></i>
<a name='L529'>    0,                                  <i><font color='green'>/* tp_flags */</font></i>
<a name='L530'>    PyHKEY_doc,                         <i><font color='green'>/* tp_doc */</font></i>
<a name='L531'>    0,                                  <i><font color='green'>/*tp_traverse*/</font></i>
<a name='L532'>    0,                                  <i><font color='green'>/*tp_clear*/</font></i>
<a name='L533'>    0,                                  <i><font color='green'>/*tp_richcompare*/</font></i>
<a name='L534'>    0,                                  <i><font color='green'>/*tp_weaklistoffset*/</font></i>
<a name='L535'>    0,                                  <i><font color='green'>/*tp_iter*/</font></i>
<a name='L536'>    0,                                  <i><font color='green'>/*tp_iternext*/</font></i>
<a name='L537'>    PyHKEY_methods,                     <i><font color='green'>/*tp_methods*/</font></i>
<a name='L538'>    PyHKEY_memberlist,                  <i><font color='green'>/*tp_members*/</font></i>
<a name='L539'><font color='red'>}</font>;
<a name='L540'>
<a name='L541'><i><font color='green'>/************************************************************************</font></i>
<a name='L542'><i><font color='green'></font></i>
<a name='L543'><i><font color='green'>  The PyHKEY object methods</font></i>
<a name='L544'><i><font color='green'></font></i>
<a name='L545'><i><font color='green'>************************************************************************/</font></i>
<a name='L546'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L547'><a href='../R/2992.html' title='Multiple refered from 2 places.'>PyHKEY_CloseMethod</a>(PyObject *self, PyObject *args)
<a name='L548'><font color='red'>{</font>
<a name='L549'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, ":Close"))
<a name='L550'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L551'>    <b>if</b> (!<a href='../S/3031.html#L598' title='Defined at 598 in PC/winreg.c.'>PyHKEY_Close</a>(self))
<a name='L552'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L553'>    Py_INCREF(Py_None);
<a name='L554'>    <b>return</b> Py_None;
<a name='L555'><font color='red'>}</font>
<a name='L556'>
<a name='L557'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L558'><a href='../R/2993.html' title='Multiple refered from 2 places.'>PyHKEY_DetachMethod</a>(PyObject *self, PyObject *args)
<a name='L559'><font color='red'>{</font>
<a name='L560'>    <b>void</b>* ret;
<a name='L561'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *pThis = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)self;
<a name='L562'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, ":Detach"))
<a name='L563'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L564'>    ret = (<b>void</b>*)pThis-&gt;hkey;
<a name='L565'>    pThis-&gt;hkey = 0;
<a name='L566'>    <b>return</b> <a href='../S/2799.html#L929' title='Defined at 929 in Objects/longobject.c.'>PyLong_FromVoidPtr</a>(ret);
<a name='L567'><font color='red'>}</font>
<a name='L568'>
<a name='L569'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L570'><a href='../R/2994.html' title='Multiple refered from 2 places.'>PyHKEY_Enter</a>(PyObject *self)
<a name='L571'><font color='red'>{</font>
<a name='L572'>    <a href='../S/544.html#L766' title='Defined at 766 in Include/object.h.'>Py_XINCREF</a>(self);
<a name='L573'>    <b>return</b> self;
<a name='L574'><font color='red'>}</font>
<a name='L575'>
<a name='L576'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L577'><a href='../R/2995.html' title='Multiple refered from 2 places.'>PyHKEY_Exit</a>(PyObject *self, PyObject *args)
<a name='L578'><font color='red'>{</font>
<a name='L579'>    <b>if</b> (!<a href='../S/3031.html#L598' title='Defined at 598 in PC/winreg.c.'>PyHKEY_Close</a>(self))
<a name='L580'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L581'>    <a href='../S/2562.html#L112' title='Defined at 112 in Modules/_elementtree.c.'>Py_RETURN_NONE</a>;
<a name='L582'><font color='red'>}</font>
<a name='L583'>
<a name='L584'>
<a name='L585'><i><font color='green'>/************************************************************************</font></i>
<a name='L586'><i><font color='green'>   The public PyHKEY API (well, not public yet :-)</font></i>
<a name='L587'><i><font color='green'>************************************************************************/</font></i>
<a name='L588'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L589'>PyHKEY_New(HKEY hInit)
<a name='L590'><font color='red'>{</font>
<a name='L591'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a> = <a href='../S/545.html#L189' title='Defined at 189 in Include/objimpl.h.'>PyObject_NEW</a>(<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a>, &amp;PyHKEY_Type);
<a name='L592'>    <b>if</b> (<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>)
<a name='L593'>        <a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>-&gt;hkey = hInit;
<a name='L594'>    <b>return</b> (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>;
<a name='L595'><font color='red'>}</font>
<a name='L596'>
<a name='L597'><a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a>
<a name='L598'><a href='../R/2991.html' title='Multiple refered from 5 places.'>PyHKEY_Close</a>(PyObject *ob_handle)
<a name='L599'><font color='red'>{</font>
<a name='L600'>    <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> rc;
<a name='L601'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>;
<a name='L602'>
<a name='L603'>    <b>if</b> (!<a href='../S/3031.html#L390' title='Defined at 390 in PC/winreg.c.'>PyHKEY_Check</a>(ob_handle)) <font color='red'>{</font>
<a name='L604'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError, "bad operand type");
<a name='L605'>        <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L606'>    <font color='red'>}</font>
<a name='L607'>    <a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a> = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob_handle;
<a name='L608'>    rc = <a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>-&gt;hkey ? RegCloseKey((HKEY)<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>-&gt;hkey) : ERROR_SUCCESS;
<a name='L609'>    <a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>-&gt;hkey = 0;
<a name='L610'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L611'>        <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegCloseKey");
<a name='L612'>    <b>return</b> rc == ERROR_SUCCESS;
<a name='L613'><font color='red'>}</font>
<a name='L614'>
<a name='L615'><a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a>
<a name='L616'><a href='../R/2989.html' title='Multiple refered from 21 places.'>PyHKEY_AsHKEY</a>(PyObject *ob, HKEY *pHANDLE, <a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a> bNoneOK)
<a name='L617'><font color='red'>{</font>
<a name='L618'>    <b>if</b> (ob == Py_None) <font color='red'>{</font>
<a name='L619'>        <b>if</b> (!bNoneOK) <font color='red'>{</font>
<a name='L620'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(
<a name='L621'>                      PyExc_TypeError,
<a name='L622'>                      "None is not a valid HKEY in this context");
<a name='L623'>            <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L624'>        <font color='red'>}</font>
<a name='L625'>        *pHANDLE = (HKEY)0;
<a name='L626'>    <font color='red'>}</font>
<a name='L627'>    <b>else</b> <b>if</b> (<a href='../S/3031.html#L390' title='Defined at 390 in PC/winreg.c.'>PyHKEY_Check</a>(ob)) <font color='red'>{</font>
<a name='L628'>        <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *pH = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *)ob;
<a name='L629'>        *pHANDLE = pH-&gt;hkey;
<a name='L630'>    <font color='red'>}</font>
<a name='L631'>    <b>else</b> <b>if</b> (PyLong_Check(ob)) <font color='red'>{</font>
<a name='L632'>        <i><font color='green'>/* We also support integers */</font></i>
<a name='L633'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L634'>        *pHANDLE = (HKEY)<a href='../S/2799.html#L947' title='Defined at 947 in Objects/longobject.c.'>PyLong_AsVoidPtr</a>(ob);
<a name='L635'>        <b>if</b> (<a href='../D/3154.html' title='Multiple defined in 2 places.'>PyErr_Occurred</a>())
<a name='L636'>            <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L637'>    <font color='red'>}</font>
<a name='L638'>    <b>else</b> <font color='red'>{</font>
<a name='L639'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(
<a name='L640'>                        PyExc_TypeError,
<a name='L641'>            "The object is not a PyHKEY object");
<a name='L642'>        <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L643'>    <font color='red'>}</font>
<a name='L644'>    <b>return</b> <a href='../D/5177.html' title='Multiple defined in 3 places.'>TRUE</a>;
<a name='L645'><font color='red'>}</font>
<a name='L646'>
<a name='L647'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L648'><a href='../R/2996.html' title='Multiple refered from 5 places.'>PyHKEY_FromHKEY</a>(HKEY h)
<a name='L649'><font color='red'>{</font>
<a name='L650'>    <a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *op;
<a name='L651'>
<a name='L652'>    <i><font color='green'>/* Inline PyObject_New */</font></i>
<a name='L653'>    op = (<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a> *) PyObject_MALLOC(<b>sizeof</b>(<a href='../S/3031.html#L388' title='Defined at 388 in PC/winreg.c.'>PyHKEYObject</a>));
<a name='L654'>    <b>if</b> (op == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L655'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L656'>    PyObject_INIT(op, &amp;PyHKEY_Type);
<a name='L657'>    op-&gt;hkey = h;
<a name='L658'>    <b>return</b> (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)op;
<a name='L659'><font color='red'>}</font>
<a name='L660'>
<a name='L661'>
<a name='L662'><i><font color='green'>/************************************************************************</font></i>
<a name='L663'><i><font color='green'>  The module methods</font></i>
<a name='L664'><i><font color='green'>************************************************************************/</font></i>
<a name='L665'><a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a>
<a name='L666'>PyWinObject_CloseHKEY(PyObject *obHandle)
<a name='L667'><font color='red'>{</font>
<a name='L668'>    <a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a> ok;
<a name='L669'>    <b>if</b> (<a href='../S/3031.html#L390' title='Defined at 390 in PC/winreg.c.'>PyHKEY_Check</a>(obHandle)) <font color='red'>{</font>
<a name='L670'>        ok = <a href='../S/3031.html#L598' title='Defined at 598 in PC/winreg.c.'>PyHKEY_Close</a>(obHandle);
<a name='L671'>    <font color='red'>}</font>
<a name='L672'><font color='darkred'>#if</font> <a href='../D/4734.html' title='Multiple defined in 7 places.'>SIZEOF_LONG</a> &gt;= <a href='../D/4732.html' title='Multiple defined in 2 places.'>SIZEOF_HKEY</a>
<a name='L673'>    <b>else</b> <b>if</b> (PyLong_Check(obHandle)) <font color='red'>{</font>
<a name='L674'>        <b>long</b> rc = RegCloseKey((HKEY)<a href='../S/2799.html#L416' title='Defined at 416 in Objects/longobject.c.'>PyLong_AsLong</a>(obHandle));
<a name='L675'>        ok = (rc == ERROR_SUCCESS);
<a name='L676'>        <b>if</b> (!ok)
<a name='L677'>            <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegCloseKey");
<a name='L678'>    <font color='red'>}</font>
<a name='L679'><font color='darkred'>#else</font>
<a name='L680'>    <b>else</b> <b>if</b> (PyLong_Check(obHandle)) <font color='red'>{</font>
<a name='L681'>        <b>long</b> rc = RegCloseKey((HKEY)<a href='../S/2799.html#L947' title='Defined at 947 in Objects/longobject.c.'>PyLong_AsVoidPtr</a>(obHandle));
<a name='L682'>        ok = (rc == ERROR_SUCCESS);
<a name='L683'>        <b>if</b> (!ok)
<a name='L684'>            <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegCloseKey");
<a name='L685'>    <font color='red'>}</font>
<a name='L686'><font color='darkred'>#endif</font>
<a name='L687'>    <b>else</b> <font color='red'>{</font>
<a name='L688'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(
<a name='L689'>            PyExc_TypeError,
<a name='L690'>            "A handle must be a HKEY object or an integer");
<a name='L691'>        <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L692'>    <font color='red'>}</font>
<a name='L693'>    <b>return</b> ok;
<a name='L694'><font color='red'>}</font>
<a name='L695'>
<a name='L696'>
<a name='L697'><i><font color='green'>/*</font></i>
<a name='L698'><i><font color='green'>   Private Helper functions for the registry interfaces</font></i>
<a name='L699'><i><font color='green'></font></i>
<a name='L700'><i><font color='green'>** Note that fixupMultiSZ and countString have both had changes</font></i>
<a name='L701'><i><font color='green'>** made to support "incorrect strings".  The registry specification</font></i>
<a name='L702'><i><font color='green'>** calls for strings to be terminated with 2 null bytes.  It seems</font></i>
<a name='L703'><i><font color='green'>** some commercial packages install strings which dont conform,</font></i>
<a name='L704'><i><font color='green'>** causing this code to fail - however, "regedit" etc still work</font></i>
<a name='L705'><i><font color='green'>** with these strings (ie only we dont!).</font></i>
<a name='L706'><i><font color='green'>*/</font></i>
<a name='L707'><b>static</b> <b>void</b>
<a name='L708'><a href='../S/3031.html#L901' title='Refered from 901 in PC/winreg.c.'>fixupMultiSZ</a>(wchar_t **str, wchar_t *data, <b>int</b> len)
<a name='L709'><font color='red'>{</font>
<a name='L710'>    wchar_t *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>;
<a name='L711'>    <b>int</b> i;
<a name='L712'>    wchar_t *Q;
<a name='L713'>
<a name='L714'>    Q = data + len;
<a name='L715'>    <b>for</b> (<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> = data, i = 0; <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> &lt; Q &amp;&amp; *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> != '\0'; <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>++, i++) <font color='red'>{</font>
<a name='L716'>        str[i] = <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>;
<a name='L717'>        <b>for</b>(; *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> != '\0'; <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>++)
<a name='L718'>            ;
<a name='L719'>    <font color='red'>}</font>
<a name='L720'><font color='red'>}</font>
<a name='L721'>
<a name='L722'><b>static</b> <b>int</b>
<a name='L723'><a href='../S/3031.html#L896' title='Refered from 896 in PC/winreg.c.'>countStrings</a>(wchar_t *data, <b>int</b> len)
<a name='L724'><font color='red'>{</font>
<a name='L725'>    <b>int</b> strings;
<a name='L726'>    wchar_t *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>;
<a name='L727'>    wchar_t *Q = data + len;
<a name='L728'>
<a name='L729'>    <b>for</b> (<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> = data, strings = 0; <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> &lt; Q &amp;&amp; *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> != '\0'; <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>++, strings++)
<a name='L730'>        <b>for</b> (; <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> &lt; Q &amp;&amp; *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> != '\0'; <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>++)
<a name='L731'>            ;
<a name='L732'>    <b>return</b> strings;
<a name='L733'><font color='red'>}</font>
<a name='L734'>
<a name='L735'><i><font color='green'>/* Convert PyObject into Registry data.</font></i>
<a name='L736'><i><font color='green'>   Allocates space as needed. */</font></i>
<a name='L737'><b>static</b> <a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a>
<a name='L738'><a href='../S/3031.html#L1546' title='Refered from 1546 in PC/winreg.c.'>Py2Reg</a>(PyObject *value, DWORD typ, <a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> **retDataBuf, DWORD *retDataSize)
<a name='L739'><font color='red'>{</font>
<a name='L740'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> i,j;
<a name='L741'>    <b>switch</b> (typ) <font color='red'>{</font>
<a name='L742'>        <b>case</b> REG_DWORD:
<a name='L743'>            <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> != Py_None &amp;&amp; !PyLong_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>))
<a name='L744'>                <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L745'>            *retDataBuf = (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)PyMem_NEW(DWORD, 1);
<a name='L746'>            <b>if</b> (*retDataBuf==<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)<font color='red'>{</font>
<a name='L747'>                <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L748'>                <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L749'>            <font color='red'>}</font>
<a name='L750'>            *retDataSize = <b>sizeof</b>(DWORD);
<a name='L751'>            <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> == Py_None) <font color='red'>{</font>
<a name='L752'>                DWORD zero = 0;
<a name='L753'>                <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(*retDataBuf, &amp;zero, <b>sizeof</b>(DWORD));
<a name='L754'>            <font color='red'>}</font>
<a name='L755'>            <b>else</b> <font color='red'>{</font>
<a name='L756'>                DWORD d = <a href='../S/2799.html#L416' title='Defined at 416 in Objects/longobject.c.'>PyLong_AsLong</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L757'>                <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(*retDataBuf, &amp;d, <b>sizeof</b>(DWORD));
<a name='L758'>            <font color='red'>}</font>
<a name='L759'>            <b>break</b>;
<a name='L760'>        <b>case</b> REG_SZ:
<a name='L761'>        <b>case</b> REG_EXPAND_SZ:
<a name='L762'>            <font color='red'>{</font>
<a name='L763'>            <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> == Py_None)
<a name='L764'>                *retDataSize = 1;
<a name='L765'>            <b>else</b> <font color='red'>{</font>
<a name='L766'>                <b>if</b> (!PyUnicode_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>))
<a name='L767'>                    <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L768'>                *retDataSize = <a href='../D/4230.html' title='Multiple defined in 2 places.'>Py_SAFE_DOWNCAST</a>(
<a name='L769'>                                   2 + <a href='../S/587.html#L406' title='Defined at 406 in Include/unicodeobject.h.'>PyUnicode_GET_DATA_SIZE</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>),
<a name='L770'>                                   <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a>, DWORD);
<a name='L771'>            <font color='red'>}</font>
<a name='L772'>            *retDataBuf = (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)PyMem_NEW(DWORD, *retDataSize);
<a name='L773'>            <b>if</b> (*retDataBuf==<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)<font color='red'>{</font>
<a name='L774'>                <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L775'>                <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L776'>            <font color='red'>}</font>
<a name='L777'>            <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> == Py_None)
<a name='L778'>                wcscpy((wchar_t *)*retDataBuf, L"");
<a name='L779'>            <b>else</b>
<a name='L780'>                wcscpy((wchar_t *)*retDataBuf,
<a name='L781'>                       <a href='../S/587.html#L408' title='Defined at 408 in Include/unicodeobject.h.'>PyUnicode_AS_UNICODE</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>));
<a name='L782'>            <b>break</b>;
<a name='L783'>            <font color='red'>}</font>
<a name='L784'>        <b>case</b> REG_MULTI_SZ:
<a name='L785'>            <font color='red'>{</font>
<a name='L786'>                DWORD size = 0;
<a name='L787'>                wchar_t *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>;
<a name='L788'>
<a name='L789'>                <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> == Py_None)
<a name='L790'>                    i = 0;
<a name='L791'>                <b>else</b> <font color='red'>{</font>
<a name='L792'>                    <b>if</b> (!PyList_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>))
<a name='L793'>                        <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L794'>                    i = <a href='../S/2796.html#L166' title='Defined at 166 in Objects/listobject.c.'>PyList_Size</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L795'>                <font color='red'>}</font>
<a name='L796'>                <b>for</b> (j = 0; j &lt; i; j++)
<a name='L797'>                <font color='red'>{</font>
<a name='L798'>                    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *t;
<a name='L799'>                    t = PyList_GET_ITEM(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>, j);
<a name='L800'>                    <b>if</b> (!PyUnicode_Check(t))
<a name='L801'>                        <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L802'>                    size += <a href='../D/4230.html' title='Multiple defined in 2 places.'>Py_SAFE_DOWNCAST</a>(2 + <a href='../S/587.html#L406' title='Defined at 406 in Include/unicodeobject.h.'>PyUnicode_GET_DATA_SIZE</a>(t),
<a name='L803'>                                             <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a>, DWORD);
<a name='L804'>                <font color='red'>}</font>
<a name='L805'>
<a name='L806'>                *retDataSize = size + 2;
<a name='L807'>                *retDataBuf = (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)PyMem_NEW(<b>char</b>,
<a name='L808'>                                                *retDataSize);
<a name='L809'>                <b>if</b> (*retDataBuf==<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)<font color='red'>{</font>
<a name='L810'>                    <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L811'>                    <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L812'>                <font color='red'>}</font>
<a name='L813'>                <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> = (wchar_t *)*retDataBuf;
<a name='L814'>
<a name='L815'>                <b>for</b> (j = 0; j &lt; i; j++)
<a name='L816'>                <font color='red'>{</font>
<a name='L817'>                    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *t;
<a name='L818'>                    t = PyList_GET_ITEM(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>, j);
<a name='L819'>                    wcscpy(<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a>, <a href='../S/587.html#L408' title='Defined at 408 in Include/unicodeobject.h.'>PyUnicode_AS_UNICODE</a>(t));
<a name='L820'>                    <a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> += 1 + wcslen(
<a name='L821'>                        <a href='../S/587.html#L408' title='Defined at 408 in Include/unicodeobject.h.'>PyUnicode_AS_UNICODE</a>(t));
<a name='L822'>                <font color='red'>}</font>
<a name='L823'>                <i><font color='green'>/* And doubly-terminate the list... */</font></i>
<a name='L824'>                *<a href='../D/2444.html' title='Multiple defined in 2 places.'>P</a> = '\0';
<a name='L825'>                <b>break</b>;
<a name='L826'>            <font color='red'>}</font>
<a name='L827'>        <b>case</b> REG_BINARY:
<a name='L828'>        <i><font color='green'>/* ALSO handle ALL unknown data types here.  Even if we can't</font></i>
<a name='L829'><i><font color='green'>           support it natively, we should handle the bits. */</font></i>
<a name='L830'>        <b>default</b>:
<a name='L831'>            <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> == Py_None)
<a name='L832'>                *retDataSize = 0;
<a name='L833'>            <b>else</b> <font color='red'>{</font>
<a name='L834'>                <a href='../S/544.html#L163' title='Defined at 163 in Include/object.h.'>Py_buffer</a> view;
<a name='L835'>
<a name='L836'>                <b>if</b> (!PyObject_CheckBuffer(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L837'>                    <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_TypeError,
<a name='L838'>                        "Objects of type '%s' can not "
<a name='L839'>                        "be used as binary registry values",
<a name='L840'>                        <a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>-&gt;ob_type-&gt;tp_name);
<a name='L841'>                    <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L842'>                <font color='red'>}</font>
<a name='L843'>
<a name='L844'>                <b>if</b> (<a href='../S/2775.html#L330' title='Defined at 330 in Objects/abstract.c.'>PyObject_GetBuffer</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>, &amp;view, <a href='../S/544.html#L169' title='Defined at 169 in Include/object.h.'>PyBUF_SIMPLE</a>) &lt; 0)
<a name='L845'>                    <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L846'>
<a name='L847'>                *retDataBuf = (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)PyMem_NEW(<b>char</b>, view.len);
<a name='L848'>                <b>if</b> (*retDataBuf==<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)<font color='red'>{</font>
<a name='L849'>                    <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view);
<a name='L850'>                    <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L851'>                    <b>return</b> <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>;
<a name='L852'>                <font color='red'>}</font>
<a name='L853'>                *retDataSize = <a href='../D/4230.html' title='Multiple defined in 2 places.'>Py_SAFE_DOWNCAST</a>(view.len, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>, DWORD);
<a name='L854'>                <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(*retDataBuf, view.buf, view.len);
<a name='L855'>                <a href='../S/2775.html#L684' title='Defined at 684 in Objects/abstract.c.'>PyBuffer_Release</a>(&amp;view);
<a name='L856'>            <font color='red'>}</font>
<a name='L857'>            <b>break</b>;
<a name='L858'>    <font color='red'>}</font>
<a name='L859'>    <b>return</b> <a href='../D/5177.html' title='Multiple defined in 3 places.'>TRUE</a>;
<a name='L860'><font color='red'>}</font>
<a name='L861'>
<a name='L862'><i><font color='green'>/* Convert Registry data into PyObject*/</font></i>
<a name='L863'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L864'><a href='../R/4005.html' title='Multiple refered from 2 places.'>Reg2Py</a>(<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *retDataBuf, DWORD retDataSize, DWORD typ)
<a name='L865'><font color='red'>{</font>
<a name='L866'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obData;
<a name='L867'>
<a name='L868'>    <b>switch</b> (typ) <font color='red'>{</font>
<a name='L869'>        <b>case</b> REG_DWORD:
<a name='L870'>            <b>if</b> (retDataSize == 0)
<a name='L871'>                obData = <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(0);
<a name='L872'>            <b>else</b>
<a name='L873'>                obData = <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(*(<b>int</b> *)retDataBuf);
<a name='L874'>            <b>break</b>;
<a name='L875'>        <b>case</b> REG_SZ:
<a name='L876'>        <b>case</b> REG_EXPAND_SZ:
<a name='L877'>            <font color='red'>{</font>
<a name='L878'>                <i><font color='green'>/* the buffer may or may not have a trailing NULL */</font></i>
<a name='L879'>                wchar_t *data = (wchar_t *)retDataBuf;
<a name='L880'>                <b>int</b> len = retDataSize / 2;
<a name='L881'>                <b>if</b> (retDataSize &amp;&amp; data[len-1] == '\0')
<a name='L882'>                    retDataSize -= 2;
<a name='L883'>                <b>if</b> (retDataSize &lt;= 0)
<a name='L884'>                    data = L"";
<a name='L885'>                obData = <a href='../D/4014.html' title='Multiple defined in 3 places.'>PyUnicode_FromUnicode</a>(data, retDataSize/2);
<a name='L886'>                <b>break</b>;
<a name='L887'>            <font color='red'>}</font>
<a name='L888'>        <b>case</b> REG_MULTI_SZ:
<a name='L889'>            <b>if</b> (retDataSize == 0)
<a name='L890'>                obData = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L891'>            <b>else</b>
<a name='L892'>            <font color='red'>{</font>
<a name='L893'>                <b>int</b> index = 0;
<a name='L894'>                wchar_t *data = (wchar_t *)retDataBuf;
<a name='L895'>                <b>int</b> len = retDataSize / 2;
<a name='L896'>                <b>int</b> s = <a href='../S/3031.html#L723' title='Defined at 723 in PC/winreg.c.'>countStrings</a>(data, len);
<a name='L897'>                wchar_t **str = (wchar_t **)malloc(<b>sizeof</b>(wchar_t *)*s);
<a name='L898'>                <b>if</b> (str == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L899'>                    <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L900'>
<a name='L901'>                <a href='../S/3031.html#L708' title='Defined at 708 in PC/winreg.c.'>fixupMultiSZ</a>(str, data, len);
<a name='L902'>                obData = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(s);
<a name='L903'>                <b>if</b> (obData == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L904'>                    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L905'>                <b>for</b> (index = 0; index &lt; s; index++)
<a name='L906'>                <font color='red'>{</font>
<a name='L907'>                    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> len = wcslen(str[index]);
<a name='L908'>                    <b>if</b> (len &gt; <a href='../S/565.html#L753' title='Defined at 753 in Include/pyport.h.'>INT_MAX</a>) <font color='red'>{</font>
<a name='L909'>                        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_OverflowError,
<a name='L910'>                            "registry string is too long for a Python string");
<a name='L911'>                        Py_DECREF(obData);
<a name='L912'>                        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L913'>                    <font color='red'>}</font>
<a name='L914'>                    <a href='../S/2796.html#L199' title='Defined at 199 in Objects/listobject.c.'>PyList_SetItem</a>(obData,
<a name='L915'>                                   index,
<a name='L916'>                                   <a href='../D/4014.html' title='Multiple defined in 3 places.'>PyUnicode_FromUnicode</a>(str[index], len));
<a name='L917'>                <font color='red'>}</font>
<a name='L918'>                free(str);
<a name='L919'>
<a name='L920'>                <b>break</b>;
<a name='L921'>            <font color='red'>}</font>
<a name='L922'>        <b>case</b> REG_BINARY:
<a name='L923'>        <i><font color='green'>/* ALSO handle ALL unknown data types here.  Even if we can't</font></i>
<a name='L924'><i><font color='green'>           support it natively, we should handle the bits. */</font></i>
<a name='L925'>        <b>default</b>:
<a name='L926'>            <b>if</b> (retDataSize == 0) <font color='red'>{</font>
<a name='L927'>                Py_INCREF(Py_None);
<a name='L928'>                obData = Py_None;
<a name='L929'>            <font color='red'>}</font>
<a name='L930'>            <b>else</b>
<a name='L931'>                obData = <a href='../S/2779.html#L70' title='Defined at 70 in Objects/bytesobject.c.'>PyBytes_FromStringAndSize</a>(
<a name='L932'>                             (<b>char</b> *)retDataBuf, retDataSize);
<a name='L933'>            <b>break</b>;
<a name='L934'>    <font color='red'>}</font>
<a name='L935'>    <b>return</b> obData;
<a name='L936'><font color='red'>}</font>
<a name='L937'>
<a name='L938'><i><font color='green'>/* The Python methods */</font></i>
<a name='L939'>
<a name='L940'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L941'><a href='../S/3031.html#L1673' title='Refered from 1673 in PC/winreg.c.'>PyCloseKey</a>(PyObject *self, PyObject *args)
<a name='L942'><font color='red'>{</font>
<a name='L943'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L944'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O:CloseKey", &amp;obKey))
<a name='L945'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L946'>    <b>if</b> (!<a href='../S/3031.html#L598' title='Defined at 598 in PC/winreg.c.'>PyHKEY_Close</a>(obKey))
<a name='L947'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L948'>    Py_INCREF(Py_None);
<a name='L949'>    <b>return</b> Py_None;
<a name='L950'><font color='red'>}</font>
<a name='L951'>
<a name='L952'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L953'><a href='../S/3031.html#L1674' title='Refered from 1674 in PC/winreg.c.'>PyConnectRegistry</a>(PyObject *self, PyObject *args)
<a name='L954'><font color='red'>{</font>
<a name='L955'>    HKEY hKey;
<a name='L956'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L957'>    wchar_t *szCompName = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L958'>    HKEY retKey;
<a name='L959'>    <b>long</b> rc;
<a name='L960'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "ZO:ConnectRegistry", &amp;szCompName, &amp;obKey))
<a name='L961'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L962'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L963'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L964'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L965'>    rc = RegConnectRegistryW(szCompName, hKey, &amp;retKey);
<a name='L966'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L967'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L968'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L969'>                                                   "ConnectRegistry");
<a name='L970'>    <b>return</b> <a href='../S/3031.html#L648' title='Defined at 648 in PC/winreg.c.'>PyHKEY_FromHKEY</a>(retKey);
<a name='L971'><font color='red'>}</font>
<a name='L972'>
<a name='L973'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L974'><a href='../S/3031.html#L1675' title='Refered from 1675 in PC/winreg.c.'>PyCreateKey</a>(PyObject *self, PyObject *args)
<a name='L975'><font color='red'>{</font>
<a name='L976'>    HKEY hKey;
<a name='L977'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L978'>    wchar_t *subKey;
<a name='L979'>    HKEY retKey;
<a name='L980'>    <b>long</b> rc;
<a name='L981'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "OZ:CreateKey", &amp;obKey, &amp;subKey))
<a name='L982'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L983'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L984'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L985'>    rc = RegCreateKeyW(hKey, subKey, &amp;retKey);
<a name='L986'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L987'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "CreateKey");
<a name='L988'>    <b>return</b> <a href='../S/3031.html#L648' title='Defined at 648 in PC/winreg.c.'>PyHKEY_FromHKEY</a>(retKey);
<a name='L989'><font color='red'>}</font>
<a name='L990'>
<a name='L991'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L992'><a href='../S/3031.html#L1676' title='Refered from 1676 in PC/winreg.c.'>PyCreateKeyEx</a>(PyObject *self, PyObject *args, PyObject *kwargs)
<a name='L993'><font color='red'>{</font>
<a name='L994'>    HKEY hKey;
<a name='L995'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>;
<a name='L996'>    wchar_t *sub_key;
<a name='L997'>    HKEY retKey;
<a name='L998'>    <b>int</b> reserved = 0;
<a name='L999'>    REGSAM access = KEY_WRITE;
<a name='L1000'>    <b>long</b> rc;
<a name='L1001'>
<a name='L1002'>    <b>char</b> *kwlist[] = <font color='red'>{</font>"key", "sub_key", "reserved", "access", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L1003'>
<a name='L1004'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kwargs, "OZ|ii:CreateKeyEx", kwlist,
<a name='L1005'>                                     &amp;<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;sub_key, &amp;reserved, &amp;access))
<a name='L1006'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1007'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1008'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1009'>
<a name='L1010'>    rc = RegCreateKeyExW(hKey, sub_key, reserved, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, (DWORD)<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1011'>                         access, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, &amp;retKey, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L1012'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1013'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "CreateKeyEx");
<a name='L1014'>    <b>return</b> <a href='../S/3031.html#L648' title='Defined at 648 in PC/winreg.c.'>PyHKEY_FromHKEY</a>(retKey);
<a name='L1015'><font color='red'>}</font>
<a name='L1016'>
<a name='L1017'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1018'><a href='../S/3031.html#L1678' title='Refered from 1678 in PC/winreg.c.'>PyDeleteKey</a>(PyObject *self, PyObject *args)
<a name='L1019'><font color='red'>{</font>
<a name='L1020'>    HKEY hKey;
<a name='L1021'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1022'>    wchar_t *subKey;
<a name='L1023'>    <b>long</b> rc;
<a name='L1024'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "Ou:DeleteKey", &amp;obKey, &amp;subKey))
<a name='L1025'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1026'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1027'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1028'>    rc = RegDeleteKeyW(hKey, subKey );
<a name='L1029'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1030'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegDeleteKey");
<a name='L1031'>    Py_INCREF(Py_None);
<a name='L1032'>    <b>return</b> Py_None;
<a name='L1033'><font color='red'>}</font>
<a name='L1034'>
<a name='L1035'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1036'><a href='../S/3031.html#L1679' title='Refered from 1679 in PC/winreg.c.'>PyDeleteKeyEx</a>(PyObject *self, PyObject *args, PyObject *kwargs)
<a name='L1037'><font color='red'>{</font>
<a name='L1038'>    HKEY hKey;
<a name='L1039'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>;
<a name='L1040'>    HMODULE hMod;
<a name='L1041'>    <b>typedef</b> <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> (WINAPI *RDKEFunc)(HKEY, <b>const</b> wchar_t*, REGSAM, <b>int</b>);
<a name='L1042'>    RDKEFunc pfn = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1043'>    wchar_t *sub_key;
<a name='L1044'>    <b>long</b> rc;
<a name='L1045'>    <b>int</b> reserved = 0;
<a name='L1046'>    REGSAM access = KEY_WOW64_64KEY;
<a name='L1047'>
<a name='L1048'>    <b>char</b> *kwlist[] = <font color='red'>{</font>"key", "sub_key", "access", "reserved", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L1049'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kwargs, "Ou|ii:DeleteKeyEx", kwlist,
<a name='L1050'>                                     &amp;<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;sub_key, &amp;access, &amp;reserved))
<a name='L1051'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1052'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1053'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1054'>
<a name='L1055'>    <i><font color='green'>/* Only available on 64bit platforms, so we must load it</font></i>
<a name='L1056'><i><font color='green'>       dynamically. */</font></i>
<a name='L1057'>    hMod = GetModuleHandle("advapi32.dll");
<a name='L1058'>    <b>if</b> (hMod)
<a name='L1059'>        pfn = (RDKEFunc)<a href='../D/1434.html' title='Multiple defined in 2 places.'>GetProcAddress</a>(hMod,
<a name='L1060'>                                                                   "RegDeleteKeyExW");
<a name='L1061'>    <b>if</b> (!pfn) <font color='red'>{</font>
<a name='L1062'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_NotImplementedError,
<a name='L1063'>                                        "not implemented on this platform");
<a name='L1064'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1065'>    <font color='red'>}</font>
<a name='L1066'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1067'>    rc = (*pfn)(hKey, sub_key, access, reserved);
<a name='L1068'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1069'>
<a name='L1070'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1071'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegDeleteKeyEx");
<a name='L1072'>    Py_INCREF(Py_None);
<a name='L1073'>    <b>return</b> Py_None;
<a name='L1074'><font color='red'>}</font>
<a name='L1075'>
<a name='L1076'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1077'><a href='../S/3031.html#L1681' title='Refered from 1681 in PC/winreg.c.'>PyDeleteValue</a>(PyObject *self, PyObject *args)
<a name='L1078'><font color='red'>{</font>
<a name='L1079'>    HKEY hKey;
<a name='L1080'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1081'>    wchar_t *subKey;
<a name='L1082'>    <b>long</b> rc;
<a name='L1083'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "OZ:DeleteValue", &amp;obKey, &amp;subKey))
<a name='L1084'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1085'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1086'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1087'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1088'>    rc = RegDeleteValueW(hKey, subKey);
<a name='L1089'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1090'>    <b>if</b> (rc !=ERROR_SUCCESS)
<a name='L1091'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1092'>                                                   "RegDeleteValue");
<a name='L1093'>    Py_INCREF(Py_None);
<a name='L1094'>    <b>return</b> Py_None;
<a name='L1095'><font color='red'>}</font>
<a name='L1096'>
<a name='L1097'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1098'><a href='../S/3031.html#L1684' title='Refered from 1684 in PC/winreg.c.'>PyEnumKey</a>(PyObject *self, PyObject *args)
<a name='L1099'><font color='red'>{</font>
<a name='L1100'>    HKEY hKey;
<a name='L1101'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1102'>    <b>int</b> index;
<a name='L1103'>    <b>long</b> rc;
<a name='L1104'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *retStr;
<a name='L1105'>
<a name='L1106'>    <i><font color='green'>/* The Windows docs claim that the max key name length is 255</font></i>
<a name='L1107'><i><font color='green'>     * characters, plus a terminating nul character.  However,</font></i>
<a name='L1108'><i><font color='green'>     * empirical testing demonstrates that it is possible to</font></i>
<a name='L1109'><i><font color='green'>     * create a 256 character key that is missing the terminating</font></i>
<a name='L1110'><i><font color='green'>     * nul.  RegEnumKeyEx requires a 257 character buffer to</font></i>
<a name='L1111'><i><font color='green'>     * retrieve such a key name. */</font></i>
<a name='L1112'>    wchar_t tmpbuf[257];
<a name='L1113'>    DWORD len = <b>sizeof</b>(tmpbuf); <i><font color='green'>/* includes NULL terminator */</font></i>
<a name='L1114'>
<a name='L1115'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "Oi:EnumKey", &amp;obKey, &amp;index))
<a name='L1116'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1117'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1118'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1119'>
<a name='L1120'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1121'>    rc = RegEnumKeyExW(hKey, index, tmpbuf, &amp;len, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L1122'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1123'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1124'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegEnumKeyEx");
<a name='L1125'>
<a name='L1126'>    retStr = <a href='../D/4014.html' title='Multiple defined in 3 places.'>PyUnicode_FromUnicode</a>(tmpbuf, len);
<a name='L1127'>    <b>return</b> retStr;  <i><font color='green'>/* can be NULL */</font></i>
<a name='L1128'><font color='red'>}</font>
<a name='L1129'>
<a name='L1130'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1131'><a href='../S/3031.html#L1685' title='Refered from 1685 in PC/winreg.c.'>PyEnumValue</a>(PyObject *self, PyObject *args)
<a name='L1132'><font color='red'>{</font>
<a name='L1133'>    HKEY hKey;
<a name='L1134'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1135'>    <b>int</b> index;
<a name='L1136'>    <b>long</b> rc;
<a name='L1137'>    wchar_t *retValueBuf;
<a name='L1138'>    <a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *tmpBuf;
<a name='L1139'>    <a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *retDataBuf;
<a name='L1140'>    DWORD retValueSize, bufValueSize;
<a name='L1141'>    DWORD retDataSize, bufDataSize;
<a name='L1142'>    DWORD typ;
<a name='L1143'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obData;
<a name='L1144'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *retVal;
<a name='L1145'>
<a name='L1146'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "Oi:EnumValue", &amp;obKey, &amp;index))
<a name='L1147'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1148'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1149'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1150'>
<a name='L1151'>    <b>if</b> ((rc = RegQueryInfoKeyW(hKey, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1152'>                              <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1153'>                              &amp;retValueSize, &amp;retDataSize, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>))
<a name='L1154'>        != ERROR_SUCCESS)
<a name='L1155'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1156'>                                                   "RegQueryInfoKey");
<a name='L1157'>    ++retValueSize;    <i><font color='green'>/* include null terminators */</font></i>
<a name='L1158'>    ++retDataSize;
<a name='L1159'>    bufDataSize = retDataSize;
<a name='L1160'>    bufValueSize = retValueSize;
<a name='L1161'>    retValueBuf = (wchar_t *)<a href='../S/2803.html#L1769' title='Defined at 1769 in Objects/object.c.'>PyMem_Malloc</a>(<b>sizeof</b>(wchar_t) * retValueSize);
<a name='L1162'>    <b>if</b> (retValueBuf == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1163'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1164'>    retDataBuf = (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)<a href='../S/2803.html#L1769' title='Defined at 1769 in Objects/object.c.'>PyMem_Malloc</a>(retDataSize);
<a name='L1165'>    <b>if</b> (retDataBuf == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1166'>        <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retValueBuf);
<a name='L1167'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1168'>    <font color='red'>}</font>
<a name='L1169'>
<a name='L1170'>    <b>while</b> (1) <font color='red'>{</font>
<a name='L1171'>        <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1172'>        rc = RegEnumValueW(hKey,
<a name='L1173'>                  index,
<a name='L1174'>                  retValueBuf,
<a name='L1175'>                  &amp;retValueSize,
<a name='L1176'>                  <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1177'>                  &amp;typ,
<a name='L1178'>                  (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)retDataBuf,
<a name='L1179'>                  &amp;retDataSize);
<a name='L1180'>        <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1181'>
<a name='L1182'>        <b>if</b> (rc != ERROR_MORE_DATA)
<a name='L1183'>            <b>break</b>;
<a name='L1184'>
<a name='L1185'>        bufDataSize *= 2;
<a name='L1186'>        tmpBuf = (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)<a href='../S/2803.html#L1775' title='Defined at 1775 in Objects/object.c.'>PyMem_Realloc</a>(retDataBuf, bufDataSize);
<a name='L1187'>        <b>if</b> (tmpBuf == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1188'>            <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1189'>            retVal = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1190'>            <b>goto</b> fail;
<a name='L1191'>        <font color='red'>}</font>
<a name='L1192'>        retDataBuf = tmpBuf;
<a name='L1193'>        retDataSize = bufDataSize;
<a name='L1194'>        retValueSize = bufValueSize;
<a name='L1195'>    <font color='red'>}</font>
<a name='L1196'>
<a name='L1197'>    <b>if</b> (rc != ERROR_SUCCESS) <font color='red'>{</font>
<a name='L1198'>        retVal = <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1199'>                                                     "PyRegEnumValue");
<a name='L1200'>        <b>goto</b> fail;
<a name='L1201'>    <font color='red'>}</font>
<a name='L1202'>    obData = <a href='../S/3031.html#L864' title='Defined at 864 in PC/winreg.c.'>Reg2Py</a>(retDataBuf, retDataSize, typ);
<a name='L1203'>    <b>if</b> (obData == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1204'>        retVal = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1205'>        <b>goto</b> fail;
<a name='L1206'>    <font color='red'>}</font>
<a name='L1207'>    retVal = <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("uOi", retValueBuf, obData, typ);
<a name='L1208'>    Py_DECREF(obData);
<a name='L1209'>  fail:
<a name='L1210'>    <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retValueBuf);
<a name='L1211'>    <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retDataBuf);
<a name='L1212'>    <b>return</b> retVal;
<a name='L1213'><font color='red'>}</font>
<a name='L1214'>
<a name='L1215'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1216'><a href='../S/3031.html#L1686' title='Refered from 1686 in PC/winreg.c.'>PyExpandEnvironmentStrings</a>(PyObject *self, PyObject *args)
<a name='L1217'><font color='red'>{</font>
<a name='L1218'>    <a href='../S/587.html#L135' title='Defined at 135 in Include/unicodeobject.h.'>Py_UNICODE</a> *retValue = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1219'>    <a href='../S/587.html#L135' title='Defined at 135 in Include/unicodeobject.h.'>Py_UNICODE</a> *src;
<a name='L1220'>    DWORD retValueSize;
<a name='L1221'>    DWORD rc;
<a name='L1222'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *o;
<a name='L1223'>
<a name='L1224'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "u:ExpandEnvironmentStrings", &amp;src))
<a name='L1225'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1226'>
<a name='L1227'>    retValueSize = ExpandEnvironmentStringsW(src, retValue, 0);
<a name='L1228'>    <b>if</b> (retValueSize == 0) <font color='red'>{</font>
<a name='L1229'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(retValueSize,
<a name='L1230'>                                        "ExpandEnvironmentStrings");
<a name='L1231'>    <font color='red'>}</font>
<a name='L1232'>    retValue = (<a href='../S/587.html#L135' title='Defined at 135 in Include/unicodeobject.h.'>Py_UNICODE</a> *)<a href='../S/2803.html#L1769' title='Defined at 1769 in Objects/object.c.'>PyMem_Malloc</a>(retValueSize * <b>sizeof</b>(<a href='../S/587.html#L135' title='Defined at 135 in Include/unicodeobject.h.'>Py_UNICODE</a>));
<a name='L1233'>    <b>if</b> (retValue == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1234'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1235'>    <font color='red'>}</font>
<a name='L1236'>
<a name='L1237'>    rc = ExpandEnvironmentStringsW(src, retValue, retValueSize);
<a name='L1238'>    <b>if</b> (rc == 0) <font color='red'>{</font>
<a name='L1239'>        <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retValue);
<a name='L1240'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(retValueSize,
<a name='L1241'>                                        "ExpandEnvironmentStrings");
<a name='L1242'>    <font color='red'>}</font>
<a name='L1243'>    o = <a href='../D/4014.html' title='Multiple defined in 3 places.'>PyUnicode_FromUnicode</a>(retValue, wcslen(retValue));
<a name='L1244'>    <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retValue);
<a name='L1245'>    <b>return</b> o;
<a name='L1246'><font color='red'>}</font>
<a name='L1247'>
<a name='L1248'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1249'><a href='../S/3031.html#L1688' title='Refered from 1688 in PC/winreg.c.'>PyFlushKey</a>(PyObject *self, PyObject *args)
<a name='L1250'><font color='red'>{</font>
<a name='L1251'>    HKEY hKey;
<a name='L1252'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1253'>    <b>long</b> rc;
<a name='L1254'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O:FlushKey", &amp;obKey))
<a name='L1255'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1256'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1257'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1258'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1259'>    rc = RegFlushKey(hKey);
<a name='L1260'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1261'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1262'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegFlushKey");
<a name='L1263'>    Py_INCREF(Py_None);
<a name='L1264'>    <b>return</b> Py_None;
<a name='L1265'><font color='red'>}</font>
<a name='L1266'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1267'><a href='../S/3031.html#L1689' title='Refered from 1689 in PC/winreg.c.'>PyLoadKey</a>(PyObject *self, PyObject *args)
<a name='L1268'><font color='red'>{</font>
<a name='L1269'>    HKEY hKey;
<a name='L1270'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1271'>    wchar_t *subKey;
<a name='L1272'>    wchar_t *fileName;
<a name='L1273'>
<a name='L1274'>    <b>long</b> rc;
<a name='L1275'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "Ouu:LoadKey", &amp;obKey, &amp;subKey, &amp;fileName))
<a name='L1276'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1277'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1278'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1279'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1280'>    rc = RegLoadKeyW(hKey, subKey, fileName );
<a name='L1281'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1282'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1283'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegLoadKey");
<a name='L1284'>    Py_INCREF(Py_None);
<a name='L1285'>    <b>return</b> Py_None;
<a name='L1286'><font color='red'>}</font>
<a name='L1287'>
<a name='L1288'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1289'><a href='../R/3304.html' title='Multiple refered from 2 places.'>PyOpenKey</a>(PyObject *self, PyObject *args, PyObject *kwargs)
<a name='L1290'><font color='red'>{</font>
<a name='L1291'>    HKEY hKey;
<a name='L1292'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>;
<a name='L1293'>    wchar_t *sub_key;
<a name='L1294'>    <b>int</b> reserved = 0;
<a name='L1295'>    HKEY retKey;
<a name='L1296'>    <b>long</b> rc;
<a name='L1297'>    REGSAM access = KEY_READ;
<a name='L1298'>
<a name='L1299'>    <b>char</b> *kwlist[] = <font color='red'>{</font>"key", "sub_key", "reserved", "access", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L1300'>
<a name='L1301'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kwargs, "OZ|ii:OpenKey", kwlist,
<a name='L1302'>                                     &amp;<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;sub_key, &amp;reserved, &amp;access))
<a name='L1303'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1304'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1305'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1306'>
<a name='L1307'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1308'>    rc = RegOpenKeyExW(hKey, sub_key, reserved, access, &amp;retKey);
<a name='L1309'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1310'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1311'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegOpenKeyEx");
<a name='L1312'>    <b>return</b> <a href='../S/3031.html#L648' title='Defined at 648 in PC/winreg.c.'>PyHKEY_FromHKEY</a>(retKey);
<a name='L1313'><font color='red'>}</font>
<a name='L1314'>
<a name='L1315'>
<a name='L1316'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1317'><a href='../S/3031.html#L1696' title='Refered from 1696 in PC/winreg.c.'>PyQueryInfoKey</a>(PyObject *self, PyObject *args)
<a name='L1318'><font color='red'>{</font>
<a name='L1319'>  HKEY hKey;
<a name='L1320'>  <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1321'>  <b>long</b> rc;
<a name='L1322'>  DWORD nSubKeys, nValues;
<a name='L1323'>  FILETIME ft;
<a name='L1324'>  LARGE_INTEGER li;
<a name='L1325'>  <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *l;
<a name='L1326'>  <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *ret;
<a name='L1327'>  <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O:QueryInfoKey", &amp;obKey))
<a name='L1328'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1329'>  <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1330'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1331'>  <b>if</b> ((rc = RegQueryInfoKey(hKey, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, 0, &amp;nSubKeys, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1332'>                            &amp;nValues,  <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,  <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, &amp;ft))
<a name='L1333'>      != ERROR_SUCCESS)
<a name='L1334'>    <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegQueryInfoKey");
<a name='L1335'>  li.LowPart = ft.dwLowDateTime;
<a name='L1336'>  li.HighPart = ft.dwHighDateTime;
<a name='L1337'>  l = <a href='../S/2799.html#L994' title='Defined at 994 in Objects/longobject.c.'>PyLong_FromLongLong</a>(li.QuadPart);
<a name='L1338'>  <b>if</b> (l == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1339'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1340'>  ret = <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("iiO", nSubKeys, nValues, l);
<a name='L1341'>  Py_DECREF(l);
<a name='L1342'>  <b>return</b> ret;
<a name='L1343'><font color='red'>}</font>
<a name='L1344'>
<a name='L1345'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1346'><a href='../S/3031.html#L1694' title='Refered from 1694 in PC/winreg.c.'>PyQueryValue</a>(PyObject *self, PyObject *args)
<a name='L1347'><font color='red'>{</font>
<a name='L1348'>    HKEY hKey;
<a name='L1349'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1350'>    wchar_t *subKey;
<a name='L1351'>    <b>long</b> rc;
<a name='L1352'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *retStr;
<a name='L1353'>    wchar_t *retBuf;
<a name='L1354'>    DWORD bufSize = 0;
<a name='L1355'>    DWORD retSize = 0;
<a name='L1356'>    wchar_t *tmp;
<a name='L1357'>
<a name='L1358'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "OZ:QueryValue", &amp;obKey, &amp;subKey))
<a name='L1359'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1360'>
<a name='L1361'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1362'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1363'>
<a name='L1364'>    rc = RegQueryValueW(hKey, subKey, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, &amp;retSize);
<a name='L1365'>    <b>if</b> (rc == ERROR_MORE_DATA)
<a name='L1366'>        retSize = 256;
<a name='L1367'>    <b>else</b> <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1368'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1369'>                                                   "RegQueryValue");
<a name='L1370'>
<a name='L1371'>    bufSize = retSize;
<a name='L1372'>    retBuf = (wchar_t *) <a href='../S/2803.html#L1769' title='Defined at 1769 in Objects/object.c.'>PyMem_Malloc</a>(bufSize);
<a name='L1373'>    <b>if</b> (retBuf == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1374'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1375'>
<a name='L1376'>    <b>while</b> (1) <font color='red'>{</font>
<a name='L1377'>        retSize = bufSize;
<a name='L1378'>        rc = RegQueryValueW(hKey, subKey, retBuf, &amp;retSize);
<a name='L1379'>        <b>if</b> (rc != ERROR_MORE_DATA)
<a name='L1380'>            <b>break</b>;
<a name='L1381'>
<a name='L1382'>        bufSize *= 2;
<a name='L1383'>        tmp = (wchar_t *) <a href='../S/2803.html#L1775' title='Defined at 1775 in Objects/object.c.'>PyMem_Realloc</a>(retBuf, bufSize);
<a name='L1384'>        <b>if</b> (tmp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1385'>            <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retBuf);
<a name='L1386'>            <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1387'>        <font color='red'>}</font>
<a name='L1388'>        retBuf = tmp;
<a name='L1389'>    <font color='red'>}</font>
<a name='L1390'>
<a name='L1391'>    <b>if</b> (rc != ERROR_SUCCESS) <font color='red'>{</font>
<a name='L1392'>        <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retBuf);
<a name='L1393'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1394'>                                                   "RegQueryValue");
<a name='L1395'>    <font color='red'>}</font>
<a name='L1396'>
<a name='L1397'>    retStr = <a href='../D/4014.html' title='Multiple defined in 3 places.'>PyUnicode_FromUnicode</a>(retBuf, wcslen(retBuf));
<a name='L1398'>    <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retBuf);
<a name='L1399'>    <b>return</b> retStr;
<a name='L1400'><font color='red'>}</font>
<a name='L1401'>
<a name='L1402'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1403'><a href='../S/3031.html#L1695' title='Refered from 1695 in PC/winreg.c.'>PyQueryValueEx</a>(PyObject *self, PyObject *args)
<a name='L1404'><font color='red'>{</font>
<a name='L1405'>    HKEY hKey;
<a name='L1406'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1407'>    wchar_t *valueName;
<a name='L1408'>
<a name='L1409'>    <b>long</b> rc;
<a name='L1410'>    <a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *retBuf, *tmp;
<a name='L1411'>    DWORD bufSize = 0, retSize;
<a name='L1412'>    DWORD typ;
<a name='L1413'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obData;
<a name='L1414'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1415'>
<a name='L1416'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "OZ:QueryValueEx", &amp;obKey, &amp;valueName))
<a name='L1417'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1418'>
<a name='L1419'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1420'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1421'>
<a name='L1422'>    rc = RegQueryValueExW(hKey, valueName, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, &amp;bufSize);
<a name='L1423'>    <b>if</b> (rc == ERROR_MORE_DATA)
<a name='L1424'>        bufSize = 256;
<a name='L1425'>    <b>else</b> <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1426'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1427'>                                                   "RegQueryValueEx");
<a name='L1428'>    retBuf = (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)<a href='../S/2803.html#L1769' title='Defined at 1769 in Objects/object.c.'>PyMem_Malloc</a>(bufSize);
<a name='L1429'>    <b>if</b> (retBuf == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1430'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1431'>
<a name='L1432'>    <b>while</b> (1) <font color='red'>{</font>
<a name='L1433'>        retSize = bufSize;
<a name='L1434'>        rc = RegQueryValueExW(hKey, valueName, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, &amp;typ,
<a name='L1435'>                             (<a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *)retBuf, &amp;retSize);
<a name='L1436'>        <b>if</b> (rc != ERROR_MORE_DATA)
<a name='L1437'>            <b>break</b>;
<a name='L1438'>
<a name='L1439'>        bufSize *= 2;
<a name='L1440'>        tmp = (<b>char</b> *) <a href='../S/2803.html#L1775' title='Defined at 1775 in Objects/object.c.'>PyMem_Realloc</a>(retBuf, bufSize);
<a name='L1441'>        <b>if</b> (tmp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1442'>            <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retBuf);
<a name='L1443'>            <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1444'>        <font color='red'>}</font>
<a name='L1445'>       retBuf = tmp;
<a name='L1446'>    <font color='red'>}</font>
<a name='L1447'>
<a name='L1448'>    <b>if</b> (rc != ERROR_SUCCESS) <font color='red'>{</font>
<a name='L1449'>        <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retBuf);
<a name='L1450'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1451'>                                                   "RegQueryValueEx");
<a name='L1452'>    <font color='red'>}</font>
<a name='L1453'>    obData = <a href='../S/3031.html#L864' title='Defined at 864 in PC/winreg.c.'>Reg2Py</a>(retBuf, bufSize, typ);
<a name='L1454'>    <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(retBuf);
<a name='L1455'>    <b>if</b> (obData == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1456'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1457'>    <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("Oi", obData, typ);
<a name='L1458'>    Py_DECREF(obData);
<a name='L1459'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1460'><font color='red'>}</font>
<a name='L1461'>
<a name='L1462'>
<a name='L1463'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1464'><a href='../S/3031.html#L1698' title='Refered from 1698 in PC/winreg.c.'>PySaveKey</a>(PyObject *self, PyObject *args)
<a name='L1465'><font color='red'>{</font>
<a name='L1466'>    HKEY hKey;
<a name='L1467'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1468'>    wchar_t *fileName;
<a name='L1469'>    LPSECURITY_ATTRIBUTES pSA = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1470'>
<a name='L1471'>    <b>long</b> rc;
<a name='L1472'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "Ou:SaveKey", &amp;obKey, &amp;fileName))
<a name='L1473'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1474'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1475'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1476'><i><font color='green'>/*  One day we may get security into the core?</font></i>
<a name='L1477'><i><font color='green'>    if (!PyWinObject_AsSECURITY_ATTRIBUTES(obSA, &amp;pSA, TRUE))</font></i>
<a name='L1478'><i><font color='green'>        return NULL;</font></i>
<a name='L1479'><i><font color='green'>*/</font></i>
<a name='L1480'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1481'>    rc = RegSaveKeyW(hKey, fileName, pSA );
<a name='L1482'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1483'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1484'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegSaveKey");
<a name='L1485'>    Py_INCREF(Py_None);
<a name='L1486'>    <b>return</b> Py_None;
<a name='L1487'><font color='red'>}</font>
<a name='L1488'>
<a name='L1489'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1490'><a href='../S/3031.html#L1699' title='Refered from 1699 in PC/winreg.c.'>PySetValue</a>(PyObject *self, PyObject *args)
<a name='L1491'><font color='red'>{</font>
<a name='L1492'>    HKEY hKey;
<a name='L1493'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1494'>    wchar_t *subKey;
<a name='L1495'>    wchar_t *str;
<a name='L1496'>    DWORD typ;
<a name='L1497'>    DWORD len;
<a name='L1498'>    <b>long</b> rc;
<a name='L1499'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "OZiu#:SetValue",
<a name='L1500'>                          &amp;obKey,
<a name='L1501'>                          &amp;subKey,
<a name='L1502'>                          &amp;typ,
<a name='L1503'>                          &amp;str,
<a name='L1504'>                          &amp;len))
<a name='L1505'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1506'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1507'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1508'>    <b>if</b> (typ != REG_SZ) <font color='red'>{</font>
<a name='L1509'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError,
<a name='L1510'>                        "Type must be winreg.REG_SZ");
<a name='L1511'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1512'>    <font color='red'>}</font>
<a name='L1513'>
<a name='L1514'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1515'>    rc = RegSetValueW(hKey, subKey, REG_SZ, str, len+1);
<a name='L1516'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1517'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1518'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc, "RegSetValue");
<a name='L1519'>    Py_INCREF(Py_None);
<a name='L1520'>    <b>return</b> Py_None;
<a name='L1521'><font color='red'>}</font>
<a name='L1522'>
<a name='L1523'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1524'><a href='../S/3031.html#L1700' title='Refered from 1700 in PC/winreg.c.'>PySetValueEx</a>(PyObject *self, PyObject *args)
<a name='L1525'><font color='red'>{</font>
<a name='L1526'>    HKEY hKey;
<a name='L1527'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1528'>    <a href='../S/587.html#L135' title='Defined at 135 in Include/unicodeobject.h.'>Py_UNICODE</a> *valueName;
<a name='L1529'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obRes;
<a name='L1530'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>;
<a name='L1531'>    <a href='../D/364.html' title='Multiple defined in 2 places.'>BYTE</a> *data;
<a name='L1532'>    DWORD len;
<a name='L1533'>    DWORD typ;
<a name='L1534'>
<a name='L1535'>    <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> rc;
<a name='L1536'>
<a name='L1537'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "OZOiO:SetValueEx",
<a name='L1538'>                          &amp;obKey,
<a name='L1539'>                          &amp;valueName,
<a name='L1540'>                          &amp;obRes,
<a name='L1541'>                          &amp;typ,
<a name='L1542'>                          &amp;<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>))
<a name='L1543'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1544'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1545'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1546'>    <b>if</b> (!<a href='../S/3031.html#L738' title='Defined at 738 in PC/winreg.c.'>Py2Reg</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>, typ, &amp;data, &amp;len))
<a name='L1547'>    <font color='red'>{</font>
<a name='L1548'>        <b>if</b> (!<a href='../D/3154.html' title='Multiple defined in 2 places.'>PyErr_Occurred</a>())
<a name='L1549'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L1550'>                     "Could not convert the data to the specified type.");
<a name='L1551'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1552'>    <font color='red'>}</font>
<a name='L1553'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1554'>    rc = RegSetValueExW(hKey, valueName, 0, typ, data, len);
<a name='L1555'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1556'>    PyMem_DEL(data);
<a name='L1557'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1558'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1559'>                                                   "RegSetValueEx");
<a name='L1560'>    Py_INCREF(Py_None);
<a name='L1561'>    <b>return</b> Py_None;
<a name='L1562'><font color='red'>}</font>
<a name='L1563'>
<a name='L1564'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1565'><a href='../S/3031.html#L1682' title='Refered from 1682 in PC/winreg.c.'>PyDisableReflectionKey</a>(PyObject *self, PyObject *args)
<a name='L1566'><font color='red'>{</font>
<a name='L1567'>    HKEY hKey;
<a name='L1568'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1569'>    HMODULE hMod;
<a name='L1570'>    <b>typedef</b> <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> (WINAPI *RDRKFunc)(HKEY);
<a name='L1571'>    RDRKFunc pfn = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1572'>    <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> rc;
<a name='L1573'>
<a name='L1574'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O:DisableReflectionKey", &amp;obKey))
<a name='L1575'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1576'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1577'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1578'>
<a name='L1579'>    <i><font color='green'>/* Only available on 64bit platforms, so we must load it</font></i>
<a name='L1580'><i><font color='green'>       dynamically.*/</font></i>
<a name='L1581'>    hMod = GetModuleHandle("advapi32.dll");
<a name='L1582'>    <b>if</b> (hMod)
<a name='L1583'>        pfn = (RDRKFunc)<a href='../D/1434.html' title='Multiple defined in 2 places.'>GetProcAddress</a>(hMod,
<a name='L1584'>                                       "RegDisableReflectionKey");
<a name='L1585'>    <b>if</b> (!pfn) <font color='red'>{</font>
<a name='L1586'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_NotImplementedError,
<a name='L1587'>                        "not implemented on this platform");
<a name='L1588'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1589'>    <font color='red'>}</font>
<a name='L1590'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1591'>    rc = (*pfn)(hKey);
<a name='L1592'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1593'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1594'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1595'>                                                   "RegDisableReflectionKey");
<a name='L1596'>    Py_INCREF(Py_None);
<a name='L1597'>    <b>return</b> Py_None;
<a name='L1598'><font color='red'>}</font>
<a name='L1599'>
<a name='L1600'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1601'><a href='../S/3031.html#L1683' title='Refered from 1683 in PC/winreg.c.'>PyEnableReflectionKey</a>(PyObject *self, PyObject *args)
<a name='L1602'><font color='red'>{</font>
<a name='L1603'>    HKEY hKey;
<a name='L1604'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1605'>    HMODULE hMod;
<a name='L1606'>    <b>typedef</b> <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> (WINAPI *RERKFunc)(HKEY);
<a name='L1607'>    RERKFunc pfn = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1608'>    <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> rc;
<a name='L1609'>
<a name='L1610'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O:EnableReflectionKey", &amp;obKey))
<a name='L1611'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1612'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1613'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1614'>
<a name='L1615'>    <i><font color='green'>/* Only available on 64bit platforms, so we must load it</font></i>
<a name='L1616'><i><font color='green'>       dynamically.*/</font></i>
<a name='L1617'>    hMod = GetModuleHandle("advapi32.dll");
<a name='L1618'>    <b>if</b> (hMod)
<a name='L1619'>        pfn = (RERKFunc)<a href='../D/1434.html' title='Multiple defined in 2 places.'>GetProcAddress</a>(hMod,
<a name='L1620'>                                       "RegEnableReflectionKey");
<a name='L1621'>    <b>if</b> (!pfn) <font color='red'>{</font>
<a name='L1622'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_NotImplementedError,
<a name='L1623'>                        "not implemented on this platform");
<a name='L1624'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1625'>    <font color='red'>}</font>
<a name='L1626'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1627'>    rc = (*pfn)(hKey);
<a name='L1628'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1629'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1630'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1631'>                                                   "RegEnableReflectionKey");
<a name='L1632'>    Py_INCREF(Py_None);
<a name='L1633'>    <b>return</b> Py_None;
<a name='L1634'><font color='red'>}</font>
<a name='L1635'>
<a name='L1636'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1637'><a href='../S/3031.html#L1697' title='Refered from 1697 in PC/winreg.c.'>PyQueryReflectionKey</a>(PyObject *self, PyObject *args)
<a name='L1638'><font color='red'>{</font>
<a name='L1639'>    HKEY hKey;
<a name='L1640'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obKey;
<a name='L1641'>    HMODULE hMod;
<a name='L1642'>    <b>typedef</b> <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> (WINAPI *RQRKFunc)(HKEY, BOOL *);
<a name='L1643'>    RQRKFunc pfn = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1644'>    <a href='../S/2583.html#L42' title='Defined at 42 in Modules/_multiprocessing/multiprocessing.h.'>BOOL</a> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1645'>    <a href='../S/2588.html#L25' title='Defined at 25 in Modules/_pickle.c.'>LONG</a> rc;
<a name='L1646'>
<a name='L1647'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O:QueryReflectionKey", &amp;obKey))
<a name='L1648'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1649'>    <b>if</b> (!<a href='../S/3031.html#L616' title='Defined at 616 in PC/winreg.c.'>PyHKEY_AsHKEY</a>(obKey, &amp;hKey, <a href='../D/1087.html' title='Multiple defined in 3 places.'>FALSE</a>))
<a name='L1650'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1651'>
<a name='L1652'>    <i><font color='green'>/* Only available on 64bit platforms, so we must load it</font></i>
<a name='L1653'><i><font color='green'>       dynamically.*/</font></i>
<a name='L1654'>    hMod = GetModuleHandle("advapi32.dll");
<a name='L1655'>    <b>if</b> (hMod)
<a name='L1656'>        pfn = (RQRKFunc)<a href='../D/1434.html' title='Multiple defined in 2 places.'>GetProcAddress</a>(hMod,
<a name='L1657'>                                       "RegQueryReflectionKey");
<a name='L1658'>    <b>if</b> (!pfn) <font color='red'>{</font>
<a name='L1659'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_NotImplementedError,
<a name='L1660'>                        "not implemented on this platform");
<a name='L1661'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1662'>    <font color='red'>}</font>
<a name='L1663'>    <a href='../D/4080.html' title='Multiple defined in 2 places.'>Py_BEGIN_ALLOW_THREADS</a>
<a name='L1664'>    rc = (*pfn)(hKey, &amp;<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L1665'>    <a href='../D/4114.html' title='Multiple defined in 2 places.'>Py_END_ALLOW_THREADS</a>
<a name='L1666'>    <b>if</b> (rc != ERROR_SUCCESS)
<a name='L1667'>        <b>return</b> <a href='../S/3031.html#L30' title='Defined at 30 in PC/winreg.c.'>PyErr_SetFromWindowsErrWithFunction</a>(rc,
<a name='L1668'>                                                   "RegQueryReflectionKey");
<a name='L1669'>    <b>return</b> <a href='../D/2761.html' title='Multiple defined in 2 places.'>PyBool_FromLong</a>(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L1670'><font color='red'>}</font>
<a name='L1671'>
<a name='L1672'><b>static</b> <b>struct</b> <a href='../D/3525.html' title='Multiple defined in 3 places.'>PyMethodDef</a> winreg_methods[] = <font color='red'>{</font>
<a name='L1673'>    <font color='red'>{</font>"CloseKey",         <a href='../S/3031.html#L941' title='Defined at 941 in PC/winreg.c.'>PyCloseKey</a>,        <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, CloseKey_doc<font color='red'>}</font>,
<a name='L1674'>    <font color='red'>{</font>"ConnectRegistry",  <a href='../S/3031.html#L953' title='Defined at 953 in PC/winreg.c.'>PyConnectRegistry</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, ConnectRegistry_doc<font color='red'>}</font>,
<a name='L1675'>    <font color='red'>{</font>"CreateKey",        <a href='../S/3031.html#L974' title='Defined at 974 in PC/winreg.c.'>PyCreateKey</a>,       <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, CreateKey_doc<font color='red'>}</font>,
<a name='L1676'>    <font color='red'>{</font>"CreateKeyEx",      (PyCFunction)<a href='../S/3031.html#L992' title='Defined at 992 in PC/winreg.c.'>PyCreateKeyEx</a>,
<a name='L1677'>                         <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a> | METH_KEYWORDS, CreateKeyEx_doc<font color='red'>}</font>,
<a name='L1678'>    <font color='red'>{</font>"DeleteKey",        <a href='../S/3031.html#L1018' title='Defined at 1018 in PC/winreg.c.'>PyDeleteKey</a>,       <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, DeleteKey_doc<font color='red'>}</font>,
<a name='L1679'>    <font color='red'>{</font>"DeleteKeyEx",      (PyCFunction)<a href='../S/3031.html#L1036' title='Defined at 1036 in PC/winreg.c.'>PyDeleteKeyEx</a>,
<a name='L1680'>                         <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a> | METH_KEYWORDS, DeleteKeyEx_doc<font color='red'>}</font>,
<a name='L1681'>    <font color='red'>{</font>"DeleteValue",      <a href='../S/3031.html#L1077' title='Defined at 1077 in PC/winreg.c.'>PyDeleteValue</a>,     <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, DeleteValue_doc<font color='red'>}</font>,
<a name='L1682'>    <font color='red'>{</font>"DisableReflectionKey", <a href='../S/3031.html#L1565' title='Defined at 1565 in PC/winreg.c.'>PyDisableReflectionKey</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, DisableReflectionKey_doc<font color='red'>}</font>,
<a name='L1683'>    <font color='red'>{</font>"EnableReflectionKey",  <a href='../S/3031.html#L1601' title='Defined at 1601 in PC/winreg.c.'>PyEnableReflectionKey</a>,  <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, EnableReflectionKey_doc<font color='red'>}</font>,
<a name='L1684'>    <font color='red'>{</font>"EnumKey",          <a href='../S/3031.html#L1098' title='Defined at 1098 in PC/winreg.c.'>PyEnumKey</a>,         <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, EnumKey_doc<font color='red'>}</font>,
<a name='L1685'>    <font color='red'>{</font>"EnumValue",        <a href='../S/3031.html#L1131' title='Defined at 1131 in PC/winreg.c.'>PyEnumValue</a>,       <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, EnumValue_doc<font color='red'>}</font>,
<a name='L1686'>    <font color='red'>{</font>"ExpandEnvironmentStrings", <a href='../S/3031.html#L1216' title='Defined at 1216 in PC/winreg.c.'>PyExpandEnvironmentStrings</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>,
<a name='L1687'>        ExpandEnvironmentStrings_doc <font color='red'>}</font>,
<a name='L1688'>    <font color='red'>{</font>"FlushKey",         <a href='../S/3031.html#L1249' title='Defined at 1249 in PC/winreg.c.'>PyFlushKey</a>,        <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, FlushKey_doc<font color='red'>}</font>,
<a name='L1689'>    <font color='red'>{</font>"LoadKey",          <a href='../S/3031.html#L1267' title='Defined at 1267 in PC/winreg.c.'>PyLoadKey</a>,         <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, LoadKey_doc<font color='red'>}</font>,
<a name='L1690'>    <font color='red'>{</font>"OpenKey",          (PyCFunction)<a href='../S/3031.html#L1289' title='Defined at 1289 in PC/winreg.c.'>PyOpenKey</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a> | METH_KEYWORDS,
<a name='L1691'>                                                 OpenKey_doc<font color='red'>}</font>,
<a name='L1692'>    <font color='red'>{</font>"OpenKeyEx",        (PyCFunction)<a href='../S/3031.html#L1289' title='Defined at 1289 in PC/winreg.c.'>PyOpenKey</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a> | METH_KEYWORDS,
<a name='L1693'>                                                 OpenKeyEx_doc<font color='red'>}</font>,
<a name='L1694'>    <font color='red'>{</font>"QueryValue",       <a href='../S/3031.html#L1346' title='Defined at 1346 in PC/winreg.c.'>PyQueryValue</a>,      <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, QueryValue_doc<font color='red'>}</font>,
<a name='L1695'>    <font color='red'>{</font>"QueryValueEx",     <a href='../S/3031.html#L1403' title='Defined at 1403 in PC/winreg.c.'>PyQueryValueEx</a>,    <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, QueryValueEx_doc<font color='red'>}</font>,
<a name='L1696'>    <font color='red'>{</font>"QueryInfoKey",     <a href='../S/3031.html#L1317' title='Defined at 1317 in PC/winreg.c.'>PyQueryInfoKey</a>,    <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, QueryInfoKey_doc<font color='red'>}</font>,
<a name='L1697'>    <font color='red'>{</font>"QueryReflectionKey",<a href='../S/3031.html#L1637' title='Defined at 1637 in PC/winreg.c.'>PyQueryReflectionKey</a>,<a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, QueryReflectionKey_doc<font color='red'>}</font>,
<a name='L1698'>    <font color='red'>{</font>"SaveKey",          <a href='../S/3031.html#L1464' title='Defined at 1464 in PC/winreg.c.'>PySaveKey</a>,         <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, SaveKey_doc<font color='red'>}</font>,
<a name='L1699'>    <font color='red'>{</font>"SetValue",         <a href='../S/3031.html#L1490' title='Defined at 1490 in PC/winreg.c.'>PySetValue</a>,        <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, SetValue_doc<font color='red'>}</font>,
<a name='L1700'>    <font color='red'>{</font>"SetValueEx",       <a href='../S/3031.html#L1524' title='Defined at 1524 in PC/winreg.c.'>PySetValueEx</a>,      <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, SetValueEx_doc<font color='red'>}</font>,
<a name='L1701'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1702'><font color='red'>}</font>;
<a name='L1703'>
<a name='L1704'><b>static</b> <b>void</b>
<a name='L1705'><a href='../S/3031.html#L1713' title='Refered from 1713 in PC/winreg.c.'>insint</a>(PyObject * d, <b>char</b> * name, <b>long</b> value)
<a name='L1706'><font color='red'>{</font>
<a name='L1707'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *v = <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L1708'>    <b>if</b> (!v || <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, name, v))
<a name='L1709'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L1710'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(v);
<a name='L1711'><font color='red'>}</font>
<a name='L1712'>
<a name='L1713'><font color='darkred'>#define</font> <a href='../R/26.html' title='Multiple refered from 46 places.'>ADD_INT</a>(val) <a href='../D/9230.html' title='Multiple defined in 5 places.'>insint</a>(d, #val, val)
<a name='L1714'>
<a name='L1715'><b>static</b> <b>void</b>
<a name='L1716'><a href='../S/3031.html#L1724' title='Refered from 1724 in PC/winreg.c.'>inskey</a>(PyObject * d, <b>char</b> * name, HKEY key)
<a name='L1717'><font color='red'>{</font>
<a name='L1718'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *v = <a href='../S/2799.html#L929' title='Defined at 929 in Objects/longobject.c.'>PyLong_FromVoidPtr</a>(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>);
<a name='L1719'>    <b>if</b> (!v || <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, name, v))
<a name='L1720'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L1721'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(v);
<a name='L1722'><font color='red'>}</font>
<a name='L1723'>
<a name='L1724'><font color='darkred'>#define</font> <a href='../R/27.html' title='Multiple refered from 7 places.'>ADD_KEY</a>(val) <a href='../S/3031.html#L1716' title='Defined at 1716 in PC/winreg.c.'>inskey</a>(d, #val, val)
<a name='L1725'>
<a name='L1726'>
<a name='L1727'><b>static</b> <b>struct</b> <a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a> winregmodule = <font color='red'>{</font>
<a name='L1728'>    <a href='../S/542.html#L33' title='Defined at 33 in Include/moduleobject.h.'>PyModuleDef_HEAD_INIT</a>,
<a name='L1729'>    "winreg",
<a name='L1730'>    module_doc,
<a name='L1731'>    -1,
<a name='L1732'>    winreg_methods,
<a name='L1733'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1734'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1735'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1736'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L1737'><font color='red'>}</font>;
<a name='L1738'>
<a name='L1739'><a href='../D/3482.html' title='Multiple defined in 10 places.'>PyMODINIT_FUNC</a> <a href='../R/3064.html' title='Multiple refered from 2 places.'>PyInit_winreg</a>(<b>void</b>)
<a name='L1740'><font color='red'>{</font>
<a name='L1741'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m, *d;
<a name='L1742'>    m = PyModule_Create(&amp;winregmodule);
<a name='L1743'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1744'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1745'>    d = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(m);
<a name='L1746'>    PyHKEY_Type.tp_doc = PyHKEY_doc;
<a name='L1747'>    <b>if</b> (<a href='../S/2824.html#L3799' title='Defined at 3799 in Objects/typeobject.c.'>PyType_Ready</a>(&amp;PyHKEY_Type) &lt; 0)
<a name='L1748'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1749'>    Py_INCREF(&amp;PyHKEY_Type);
<a name='L1750'>    <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "HKEYType",
<a name='L1751'>                             (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)&amp;PyHKEY_Type) != 0)
<a name='L1752'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1753'>    Py_INCREF(PyExc_WindowsError);
<a name='L1754'>    <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "error",
<a name='L1755'>                             PyExc_WindowsError) != 0)
<a name='L1756'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1757'>
<a name='L1758'>    <i><font color='green'>/* Add the relevant constants */</font></i>
<a name='L1759'>    <a href='../S/3031.html#L1724' title='Defined at 1724 in PC/winreg.c.'>ADD_KEY</a>(HKEY_CLASSES_ROOT);
<a name='L1760'>    <a href='../S/3031.html#L1724' title='Defined at 1724 in PC/winreg.c.'>ADD_KEY</a>(HKEY_CURRENT_USER);
<a name='L1761'>    <a href='../S/3031.html#L1724' title='Defined at 1724 in PC/winreg.c.'>ADD_KEY</a>(HKEY_LOCAL_MACHINE);
<a name='L1762'>    <a href='../S/3031.html#L1724' title='Defined at 1724 in PC/winreg.c.'>ADD_KEY</a>(HKEY_USERS);
<a name='L1763'>    <a href='../S/3031.html#L1724' title='Defined at 1724 in PC/winreg.c.'>ADD_KEY</a>(HKEY_PERFORMANCE_DATA);
<a name='L1764'><font color='darkred'>#ifdef</font> HKEY_CURRENT_CONFIG
<a name='L1765'>    <a href='../S/3031.html#L1724' title='Defined at 1724 in PC/winreg.c.'>ADD_KEY</a>(HKEY_CURRENT_CONFIG);
<a name='L1766'><font color='darkred'>#endif</font>
<a name='L1767'><font color='darkred'>#ifdef</font> HKEY_DYN_DATA
<a name='L1768'>    <a href='../S/3031.html#L1724' title='Defined at 1724 in PC/winreg.c.'>ADD_KEY</a>(HKEY_DYN_DATA);
<a name='L1769'><font color='darkred'>#endif</font>
<a name='L1770'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_QUERY_VALUE);
<a name='L1771'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_SET_VALUE);
<a name='L1772'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_CREATE_SUB_KEY);
<a name='L1773'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_ENUMERATE_SUB_KEYS);
<a name='L1774'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_NOTIFY);
<a name='L1775'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_CREATE_LINK);
<a name='L1776'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_READ);
<a name='L1777'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_WRITE);
<a name='L1778'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_EXECUTE);
<a name='L1779'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_ALL_ACCESS);
<a name='L1780'><font color='darkred'>#ifdef</font> KEY_WOW64_64KEY
<a name='L1781'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_WOW64_64KEY);
<a name='L1782'><font color='darkred'>#endif</font>
<a name='L1783'><font color='darkred'>#ifdef</font> KEY_WOW64_32KEY
<a name='L1784'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(KEY_WOW64_32KEY);
<a name='L1785'><font color='darkred'>#endif</font>
<a name='L1786'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_OPTION_RESERVED);
<a name='L1787'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_OPTION_NON_VOLATILE);
<a name='L1788'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_OPTION_VOLATILE);
<a name='L1789'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_OPTION_CREATE_LINK);
<a name='L1790'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_OPTION_BACKUP_RESTORE);
<a name='L1791'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_OPTION_OPEN_LINK);
<a name='L1792'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_LEGAL_OPTION);
<a name='L1793'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_CREATED_NEW_KEY);
<a name='L1794'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_OPENED_EXISTING_KEY);
<a name='L1795'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_WHOLE_HIVE_VOLATILE);
<a name='L1796'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_REFRESH_HIVE);
<a name='L1797'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_NO_LAZY_FLUSH);
<a name='L1798'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_NOTIFY_CHANGE_NAME);
<a name='L1799'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_NOTIFY_CHANGE_ATTRIBUTES);
<a name='L1800'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_NOTIFY_CHANGE_LAST_SET);
<a name='L1801'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_NOTIFY_CHANGE_SECURITY);
<a name='L1802'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_LEGAL_CHANGE_FILTER);
<a name='L1803'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_NONE);
<a name='L1804'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_SZ);
<a name='L1805'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_EXPAND_SZ);
<a name='L1806'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_BINARY);
<a name='L1807'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_DWORD);
<a name='L1808'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_DWORD_LITTLE_ENDIAN);
<a name='L1809'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_DWORD_BIG_ENDIAN);
<a name='L1810'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_LINK);
<a name='L1811'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_MULTI_SZ);
<a name='L1812'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_RESOURCE_LIST);
<a name='L1813'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_FULL_RESOURCE_DESCRIPTOR);
<a name='L1814'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(REG_RESOURCE_REQUIREMENTS_LIST);
<a name='L1815'>    <b>return</b> m;
<a name='L1816'><font color='red'>}</font>
<a name='L1817'>
<a name='L1818'>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L395'>[^]</a><a href='#L1739'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
