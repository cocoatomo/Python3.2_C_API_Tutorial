<html>
<head>
<title>Modules/_ctypes/libffi/testsuite/libffi.special/ffitestcxx.h</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3353.html'>Modules</a>/<a href='../files/3354.html'>_ctypes</a>/<a href='../files/3356.html'>libffi</a>/<a href='../files/3376.html'>testsuite</a>/<a href='../files/3378.html'>libffi.special</a>/ffitestcxx.h</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L58'>[^]</a>[v][top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2><a href='../J/320.html' title='Multiple included from 2 places.'>INCLUDED FROM</a></h2>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L58' title='Defined at 58.'>allocate_mmap</a>
</ol>
<hr>
<pre>
<a name='L1'><font color='darkred'>#include</font> &lt;stdlib.h&gt;
<a name='L2'><font color='darkred'>#include</font> &lt;stdio.h&gt;
<a name='L3'><font color='darkred'>#include</font> &lt;fcntl.h&gt;
<a name='L4'><font color='darkred'>#include</font> &lt;<a href='../I/325.html'>ffi.h</a>&gt;
<a name='L5'><font color='darkred'>#include</font> "<a href='../I/327.html'>fficonfig.h</a>"
<a name='L6'>
<a name='L7'><font color='darkred'>#define</font> <a href='../R/1852.html' title='Multiple refered from 66 places.'>MAX_ARGS</a> 256
<a name='L8'>
<a name='L9'>
<a name='L10'><i><font color='green'>/* Define __UNUSED__ that also other compilers than gcc can run the tests.  */</font></i>
<a name='L11'><font color='darkred'>#undef</font> <a href='../R/5681.html' title='Multiple refered from 166 places.'>__UNUSED__</a>
<a name='L12'><font color='darkred'>#if</font> <b>defined</b>(__GNUC__)
<a name='L13'><font color='darkred'>#define</font> <a href='../R/5681.html' title='Multiple refered from 166 places.'>__UNUSED__</a> <b>__attribute__</b>((__unused__))
<a name='L14'><font color='darkred'>#else</font>
<a name='L15'><font color='darkred'>#define</font> <a href='../R/5681.html' title='Multiple refered from 166 places.'>__UNUSED__</a>
<a name='L16'><font color='darkred'>#endif</font>
<a name='L17'>
<a name='L18'><font color='darkred'>#define</font> <a href='../R/483.html' title='Multiple refered from 349 places.'>CHECK</a>(x) (!(x) ? <a href='../S/2520.html#L152' title='Defined at 152 in Modules/_ctypes/libffi_arm_wince/fficonfig.h.'>abort</a>() : (<b>void</b>)0)
<a name='L19'>
<a name='L20'><i><font color='green'>/* Prefer MAP_ANON(YMOUS) to /dev/zero, since we don't need to keep a</font></i>
<a name='L21'><i><font color='green'>   file open.  */</font></i>
<a name='L22'><font color='darkred'>#ifdef</font> <a href='../S/2539.html#L89' title='Defined at 89 in Modules/_ctypes/libffi_osx/include/fficonfig.h.'>HAVE_MMAP_ANON</a>
<a name='L23'><font color='darkred'># undef</font> <a href='../R/1380.html' title='Multiple refered from 8 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L24'>
<a name='L25'><font color='darkred'># include</font> &lt;sys/mman.h&gt;
<a name='L26'><font color='darkred'># ifndef</font> <a href='../D/2022.html' title='Multiple defined in 4 places.'>MAP_FAILED</a>
<a name='L27'><font color='darkred'>#  define</font> <a href='../R/1823.html' title='Multiple refered from 7 places.'>MAP_FAILED</a> -1
<a name='L28'><font color='darkred'># endif</font>
<a name='L29'><font color='darkred'># if</font> !<b>defined</b> (<a href='../D/2021.html' title='Multiple defined in 5 places.'>MAP_ANONYMOUS</a>) &amp;&amp; <b>defined</b> (MAP_ANON)
<a name='L30'><font color='darkred'>#  define</font> <a href='../R/1822.html' title='Multiple refered from 17 places.'>MAP_ANONYMOUS</a> MAP_ANON
<a name='L31'><font color='darkred'># endif</font>
<a name='L32'><font color='darkred'># define</font> <a href='../R/4782.html' title='Multiple refered from 2 places.'>USING_MMAP</a>
<a name='L33'>
<a name='L34'><font color='darkred'>#endif</font>
<a name='L35'>
<a name='L36'><font color='darkred'>#ifdef</font> <a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L37'>
<a name='L38'><font color='darkred'># include</font> &lt;sys/mman.h&gt;
<a name='L39'><font color='darkred'># ifndef</font> <a href='../D/2022.html' title='Multiple defined in 4 places.'>MAP_FAILED</a>
<a name='L40'><font color='darkred'>#  define</font> <a href='../R/1823.html' title='Multiple refered from 7 places.'>MAP_FAILED</a> -1
<a name='L41'><font color='darkred'># endif</font>
<a name='L42'><font color='darkred'># define</font> <a href='../R/4782.html' title='Multiple refered from 2 places.'>USING_MMAP</a>
<a name='L43'>
<a name='L44'><font color='darkred'>#endif</font>
<a name='L45'>
<a name='L46'>
<a name='L47'><i><font color='green'>/* MinGW kludge.  */</font></i>
<a name='L48'><font color='darkred'>#ifdef</font> _WIN64
<a name='L49'><font color='darkred'>#define</font> <a href='../R/2300.html' title='Multiple refered from 12 places.'>PRIdLL</a> "I64d"
<a name='L50'><font color='darkred'>#define</font> <a href='../S/2450.html#L16' title='Refered from 16 in Modules/_ctypes/libffi/testsuite/libffi.call/cls_ulonglong.c.'>PRIuLL</a> "I64u"
<a name='L51'><font color='darkred'>#else</font>
<a name='L52'><font color='darkred'>#define</font> <a href='../R/2300.html' title='Multiple refered from 12 places.'>PRIdLL</a> "lld"
<a name='L53'><font color='darkred'>#define</font> <a href='../S/2450.html#L16' title='Refered from 16 in Modules/_ctypes/libffi/testsuite/libffi.call/cls_ulonglong.c.'>PRIuLL</a> "llu"
<a name='L54'><font color='darkred'>#endif</font>
<a name='L55'>
<a name='L56'><font color='darkred'>#ifdef</font> <a href='../D/5404.html' title='Multiple defined in 4 places.'>USING_MMAP</a>
<a name='L57'><b>static</b> <b>inline</b> <b>void</b> *
<a name='L58'>allocate_mmap (<a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> size)
<a name='L59'><font color='red'>{</font>
<a name='L60'>  <b>void</b> *page;
<a name='L61'><font color='darkred'>#if</font> <b>defined</b> (<a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>)
<a name='L62'>  <b>static</b> <b>int</b> dev_zero_fd = -1;
<a name='L63'><font color='darkred'>#endif</font>
<a name='L64'>
<a name='L65'><font color='darkred'>#ifdef</font> <a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L66'>  <b>if</b> (dev_zero_fd == -1)
<a name='L67'>    <font color='red'>{</font>
<a name='L68'>      dev_zero_fd = open ("/dev/zero", <a href='../S/2694.html#L28' title='Defined at 28 in Modules/ossaudiodev.c.'>O_RDONLY</a>);
<a name='L69'>      <b>if</b> (dev_zero_fd == -1)
<a name='L70'>        <font color='red'>{</font>
<a name='L71'>          <a href='../S/2759.html#L64' title='Defined at 64 in Modules/zlib/minigzip.c.'>perror</a> ("open /dev/zero: %m");
<a name='L72'>          exit (1);
<a name='L73'>        <font color='red'>}</font>
<a name='L74'>    <font color='red'>}</font>
<a name='L75'><font color='darkred'>#endif</font>
<a name='L76'>
<a name='L77'>
<a name='L78'><font color='darkred'>#ifdef</font> <a href='../S/2539.html#L89' title='Defined at 89 in Modules/_ctypes/libffi_osx/include/fficonfig.h.'>HAVE_MMAP_ANON</a>
<a name='L79'>  page = mmap (<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, size, PROT_READ | PROT_WRITE | PROT_EXEC,
<a name='L80'>               MAP_PRIVATE | <a href='../D/2021.html' title='Multiple defined in 5 places.'>MAP_ANONYMOUS</a>, -1, 0);
<a name='L81'><font color='darkred'>#endif</font>
<a name='L82'><font color='darkred'>#ifdef</font> <a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L83'>  page = mmap (<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, size, PROT_READ | PROT_WRITE | PROT_EXEC,
<a name='L84'>               MAP_PRIVATE, dev_zero_fd, 0);
<a name='L85'><font color='darkred'>#endif</font>
<a name='L86'>
<a name='L87'>  <b>if</b> (page == (<b>char</b> *) <a href='../D/2022.html' title='Multiple defined in 4 places.'>MAP_FAILED</a>)
<a name='L88'>    <font color='red'>{</font>
<a name='L89'>      <a href='../S/2759.html#L64' title='Defined at 64 in Modules/zlib/minigzip.c.'>perror</a> ("virtual memory exhausted");
<a name='L90'>      exit (1);
<a name='L91'>    <font color='red'>}</font>
<a name='L92'>
<a name='L93'>  <b>return</b> page;
<a name='L94'><font color='red'>}</font>
<a name='L95'>
<a name='L96'><font color='darkred'>#endif</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;][^]<a href='#L58'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
