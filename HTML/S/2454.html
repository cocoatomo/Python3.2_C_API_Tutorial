<html>
<head>
<title>Modules/_ctypes/libffi/testsuite/libffi.call/ffitest.h</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3353.html'>Modules</a>/<a href='../files/3354.html'>_ctypes</a>/<a href='../files/3356.html'>libffi</a>/<a href='../files/3376.html'>testsuite</a>/<a href='../files/3377.html'>libffi.call</a>/ffitest.h</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L91'>[^]</a>[v][top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2><a href='../J/266.html' title='Multiple included from 121 places.'>INCLUDED FROM</a></h2>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L91' title='Defined at 91.'>allocate_mmap</a>
</ol>
<hr>
<pre>
<a name='L1'><font color='darkred'>#include</font> &lt;stdlib.h&gt;
<a name='L2'><font color='darkred'>#include</font> &lt;stdio.h&gt;
<a name='L3'><font color='darkred'>#include</font> &lt;string.h&gt;
<a name='L4'><font color='darkred'>#include</font> &lt;fcntl.h&gt;
<a name='L5'><font color='darkred'>#include</font> &lt;<a href='../I/325.html'>ffi.h</a>&gt;
<a name='L6'><font color='darkred'>#include</font> "<a href='../I/327.html'>fficonfig.h</a>"
<a name='L7'>
<a name='L8'><font color='darkred'>#if</font> <b>defined</b> <a href='../S/2649.html#L35' title='Defined at 35 in Modules/expat/amigaconfig.h.'>HAVE_STDINT_H</a>
<a name='L9'><font color='darkred'>#include</font> &lt;stdint.h&gt;
<a name='L10'><font color='darkred'>#endif</font>
<a name='L11'>
<a name='L12'><font color='darkred'>#if</font> <b>defined</b> <a href='../S/2649.html#L23' title='Defined at 23 in Modules/expat/amigaconfig.h.'>HAVE_INTTYPES_H</a>
<a name='L13'><font color='darkred'>#include</font> &lt;inttypes.h&gt;
<a name='L14'><font color='darkred'>#endif</font>
<a name='L15'>
<a name='L16'><font color='darkred'>#define</font> <a href='../R/1852.html' title='Multiple refered from 66 places.'>MAX_ARGS</a> 256
<a name='L17'>
<a name='L18'><font color='darkred'>#define</font> <a href='../R/483.html' title='Multiple refered from 349 places.'>CHECK</a>(x) !(x) ? <a href='../S/2520.html#L152' title='Defined at 152 in Modules/_ctypes/libffi_arm_wince/fficonfig.h.'>abort</a>() : 0
<a name='L19'>
<a name='L20'><i><font color='green'>/* Define __UNUSED__ that also other compilers than gcc can run the tests.  */</font></i>
<a name='L21'><font color='darkred'>#undef</font> <a href='../R/5681.html' title='Multiple refered from 166 places.'>__UNUSED__</a>
<a name='L22'><font color='darkred'>#if</font> <b>defined</b>(__GNUC__)
<a name='L23'><font color='darkred'>#define</font> <a href='../R/5681.html' title='Multiple refered from 166 places.'>__UNUSED__</a> <b>__attribute__</b>((__unused__))
<a name='L24'><font color='darkred'>#else</font>
<a name='L25'><font color='darkred'>#define</font> <a href='../R/5681.html' title='Multiple refered from 166 places.'>__UNUSED__</a>
<a name='L26'><font color='darkred'>#endif</font>
<a name='L27'>
<a name='L28'><i><font color='green'>/* Prefer MAP_ANON(YMOUS) to /dev/zero, since we don't need to keep a</font></i>
<a name='L29'><i><font color='green'>   file open.  */</font></i>
<a name='L30'><font color='darkred'>#ifdef</font> <a href='../S/2539.html#L89' title='Defined at 89 in Modules/_ctypes/libffi_osx/include/fficonfig.h.'>HAVE_MMAP_ANON</a>
<a name='L31'><font color='darkred'># undef</font> <a href='../R/1380.html' title='Multiple refered from 8 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L32'>
<a name='L33'><font color='darkred'># include</font> &lt;sys/mman.h&gt;
<a name='L34'><font color='darkred'># ifndef</font> <a href='../D/2022.html' title='Multiple defined in 4 places.'>MAP_FAILED</a>
<a name='L35'><font color='darkred'>#  define</font> <a href='../R/1823.html' title='Multiple refered from 7 places.'>MAP_FAILED</a> -1
<a name='L36'><font color='darkred'># endif</font>
<a name='L37'><font color='darkred'># if</font> !<b>defined</b> (<a href='../D/2021.html' title='Multiple defined in 5 places.'>MAP_ANONYMOUS</a>) &amp;&amp; <b>defined</b> (MAP_ANON)
<a name='L38'><font color='darkred'>#  define</font> <a href='../R/1822.html' title='Multiple refered from 17 places.'>MAP_ANONYMOUS</a> MAP_ANON
<a name='L39'><font color='darkred'># endif</font>
<a name='L40'><font color='darkred'># define</font> <a href='../R/4782.html' title='Multiple refered from 2 places.'>USING_MMAP</a>
<a name='L41'>
<a name='L42'><font color='darkred'>#endif</font>
<a name='L43'>
<a name='L44'><font color='darkred'>#ifdef</font> <a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L45'>
<a name='L46'><font color='darkred'># include</font> &lt;sys/mman.h&gt;
<a name='L47'><font color='darkred'># ifndef</font> <a href='../D/2022.html' title='Multiple defined in 4 places.'>MAP_FAILED</a>
<a name='L48'><font color='darkred'>#  define</font> <a href='../R/1823.html' title='Multiple refered from 7 places.'>MAP_FAILED</a> -1
<a name='L49'><font color='darkred'># endif</font>
<a name='L50'><font color='darkred'># define</font> <a href='../R/4782.html' title='Multiple refered from 2 places.'>USING_MMAP</a>
<a name='L51'>
<a name='L52'><font color='darkred'>#endif</font>
<a name='L53'>
<a name='L54'><i><font color='green'>/* MinGW kludge.  */</font></i>
<a name='L55'><font color='darkred'>#ifdef</font> _WIN64
<a name='L56'><font color='darkred'>#define</font> <a href='../R/2300.html' title='Multiple refered from 12 places.'>PRIdLL</a> "I64d"
<a name='L57'><font color='darkred'>#define</font> <a href='../S/2450.html#L16' title='Refered from 16 in Modules/_ctypes/libffi/testsuite/libffi.call/cls_ulonglong.c.'>PRIuLL</a> "I64u"
<a name='L58'><font color='darkred'>#else</font>
<a name='L59'><font color='darkred'>#define</font> <a href='../R/2300.html' title='Multiple refered from 12 places.'>PRIdLL</a> "lld"
<a name='L60'><font color='darkred'>#define</font> <a href='../S/2450.html#L16' title='Refered from 16 in Modules/_ctypes/libffi/testsuite/libffi.call/cls_ulonglong.c.'>PRIuLL</a> "llu"
<a name='L61'><font color='darkred'>#endif</font>
<a name='L62'>
<a name='L63'><i><font color='green'>/* Tru64 UNIX kludge.  */</font></i>
<a name='L64'><font color='darkred'>#if</font> <b>defined</b>(__alpha__) &amp;&amp; <b>defined</b>(__osf__)
<a name='L65'><i><font color='green'>/* Tru64 UNIX V4.0 doesn't support %lld/%lld, but long is 64-bit.  */</font></i>
<a name='L66'><font color='darkred'>#undef</font> <a href='../R/2300.html' title='Multiple refered from 12 places.'>PRIdLL</a>
<a name='L67'><font color='darkred'>#define</font> <a href='../R/2300.html' title='Multiple refered from 12 places.'>PRIdLL</a> "ld"
<a name='L68'><font color='darkred'>#undef</font> <a href='../S/2450.html#L16' title='Refered from 16 in Modules/_ctypes/libffi/testsuite/libffi.call/cls_ulonglong.c.'>PRIuLL</a>
<a name='L69'><font color='darkred'>#define</font> <a href='../S/2450.html#L16' title='Refered from 16 in Modules/_ctypes/libffi/testsuite/libffi.call/cls_ulonglong.c.'>PRIuLL</a> "lu"
<a name='L70'><font color='darkred'>#define</font> <a href='../R/2299.html' title='Multiple refered from 16 places.'>PRId64</a> "ld"
<a name='L71'><font color='darkred'>#define</font> <a href='../R/2301.html' title='Multiple refered from 16 places.'>PRIu64</a> "lu"
<a name='L72'><font color='darkred'>#define</font> <a href='../R/2303.html' title='Multiple refered from 5 places.'>PRIuPTR</a> "lu"
<a name='L73'><font color='darkred'>#endif</font>
<a name='L74'>
<a name='L75'><i><font color='green'>/* PA HP-UX kludge.  */</font></i>
<a name='L76'><font color='darkred'>#if</font> <b>defined</b>(__hppa__) &amp;&amp; <b>defined</b>(__hpux__) &amp;&amp; !<b>defined</b>(<a href='../D/2539.html' title='Multiple defined in 4 places.'>PRIuPTR</a>)
<a name='L77'><font color='darkred'>#define</font> <a href='../R/2303.html' title='Multiple refered from 5 places.'>PRIuPTR</a> "lu"
<a name='L78'><font color='darkred'>#endif</font>
<a name='L79'>
<a name='L80'><i><font color='green'>/* Solaris &lt; 10 kludge.  */</font></i>
<a name='L81'><font color='darkred'>#if</font> <b>defined</b>(__sun__) &amp;&amp; <b>defined</b>(__svr4__) &amp;&amp; !<b>defined</b>(<a href='../D/2539.html' title='Multiple defined in 4 places.'>PRIuPTR</a>)
<a name='L82'><font color='darkred'>#if</font> <b>defined</b>(__arch64__) || <b>defined</b> (__x86_64__)
<a name='L83'><font color='darkred'>#define</font> <a href='../R/2303.html' title='Multiple refered from 5 places.'>PRIuPTR</a> "lu"
<a name='L84'><font color='darkred'>#else</font>
<a name='L85'><font color='darkred'>#define</font> <a href='../R/2303.html' title='Multiple refered from 5 places.'>PRIuPTR</a> "u"
<a name='L86'><font color='darkred'>#endif</font>
<a name='L87'><font color='darkred'>#endif</font>
<a name='L88'>
<a name='L89'><font color='darkred'>#ifdef</font> <a href='../D/5404.html' title='Multiple defined in 4 places.'>USING_MMAP</a>
<a name='L90'><b>static</b> <b>inline</b> <b>void</b> *
<a name='L91'>allocate_mmap (<a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> size)
<a name='L92'><font color='red'>{</font>
<a name='L93'>  <b>void</b> *page;
<a name='L94'><font color='darkred'>#if</font> <b>defined</b> (<a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>)
<a name='L95'>  <b>static</b> <b>int</b> dev_zero_fd = -1;
<a name='L96'><font color='darkred'>#endif</font>
<a name='L97'>
<a name='L98'><font color='darkred'>#ifdef</font> <a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L99'>  <b>if</b> (dev_zero_fd == -1)
<a name='L100'>    <font color='red'>{</font>
<a name='L101'>      dev_zero_fd = open ("/dev/zero", <a href='../S/2694.html#L28' title='Defined at 28 in Modules/ossaudiodev.c.'>O_RDONLY</a>);
<a name='L102'>      <b>if</b> (dev_zero_fd == -1)
<a name='L103'>        <font color='red'>{</font>
<a name='L104'>          <a href='../S/2759.html#L64' title='Defined at 64 in Modules/zlib/minigzip.c.'>perror</a> ("open /dev/zero: %m");
<a name='L105'>          exit (1);
<a name='L106'>        <font color='red'>}</font>
<a name='L107'>    <font color='red'>}</font>
<a name='L108'><font color='darkred'>#endif</font>
<a name='L109'>
<a name='L110'>
<a name='L111'><font color='darkred'>#ifdef</font> <a href='../S/2539.html#L89' title='Defined at 89 in Modules/_ctypes/libffi_osx/include/fficonfig.h.'>HAVE_MMAP_ANON</a>
<a name='L112'>  page = mmap (<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, size, PROT_READ | PROT_WRITE | PROT_EXEC,
<a name='L113'>               MAP_PRIVATE | <a href='../D/2021.html' title='Multiple defined in 5 places.'>MAP_ANONYMOUS</a>, -1, 0);
<a name='L114'><font color='darkred'>#endif</font>
<a name='L115'><font color='darkred'>#ifdef</font> <a href='../D/1534.html' title='Multiple defined in 2 places.'>HAVE_MMAP_DEV_ZERO</a>
<a name='L116'>  page = mmap (<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, size, PROT_READ | PROT_WRITE | PROT_EXEC,
<a name='L117'>               MAP_PRIVATE, dev_zero_fd, 0);
<a name='L118'><font color='darkred'>#endif</font>
<a name='L119'>
<a name='L120'>  <b>if</b> (page == (<b>void</b> *) <a href='../D/2022.html' title='Multiple defined in 4 places.'>MAP_FAILED</a>)
<a name='L121'>    <font color='red'>{</font>
<a name='L122'>      <a href='../S/2759.html#L64' title='Defined at 64 in Modules/zlib/minigzip.c.'>perror</a> ("virtual memory exhausted");
<a name='L123'>      exit (1);
<a name='L124'>    <font color='red'>}</font>
<a name='L125'>
<a name='L126'>  <b>return</b> page;
<a name='L127'><font color='red'>}</font>
<a name='L128'>
<a name='L129'><font color='darkred'>#endif</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;][^]<a href='#L91'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
