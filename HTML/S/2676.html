<html>
<head>
<title>Modules/gcmodule.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3353.html'>Modules</a>/gcmodule.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L182'>[^]</a><a href='#L1504'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L182' title='Defined at 182.'>gc_list_init</a>
<li><a href='#L189' title='Defined at 189.'>gc_list_is_empty</a>
<li><a href='#L198' title='Defined at 198.'>gc_list_append</a>
<li><a href='#L209' title='Defined at 209.'>gc_list_remove</a>
<li><a href='#L221' title='Defined at 221.'>gc_list_move</a>
<li><a href='#L237' title='Defined at 237.'>gc_list_merge</a>
<li><a href='#L252' title='Defined at 252.'>gc_list_size</a>
<li><a href='#L266' title='Defined at 266.'>append_objects</a>
<li><a href='#L288' title='Defined at 288.'>update_refs</a>
<li><a href='#L318' title='Defined at 318.'>visit_decref</a>
<li><a href='#L340' title='Defined at 340.'>subtract_refs</a>
<li><a href='#L354' title='Defined at 354.'>visit_reachable</a>
<li><a href='#L404' title='Defined at 404.'>move_unreachable</a>
<li><a href='#L462' title='Defined at 462.'>has_finalizer</a>
<li><a href='#L475' title='Defined at 475.'>move_finalizers</a>
<li><a href='#L498' title='Defined at 498.'>visit_move</a>
<li><a href='#L514' title='Defined at 514.'>move_finalizer_reachable</a>
<li><a href='#L539' title='Defined at 539.'>handle_weakrefs</a>
<li><a href='#L681' title='Defined at 681.'>debug_cycle</a>
<li><a href='#L697' title='Defined at 697.'>handle_finalizers</a>
<li><a href='#L724' title='Defined at 724.'>delete_garbage</a>
<li><a href='#L757' title='Defined at 757.'>clear_freelists</a>
<li><a href='#L768' title='Defined at 768.'>get_time</a>
<li><a href='#L788' title='Defined at 788.'>collect</a>
<li><a href='#L946' title='Defined at 946.'>collect_generations</a>
<li><a href='#L976' title='Defined at 976.'>gc_enable</a>
<li><a href='#L989' title='Defined at 989.'>gc_disable</a>
<li><a href='#L1002' title='Defined at 1002.'>gc_isenabled</a>
<li><a href='#L1016' title='Defined at 1016.'>gc_collect</a>
<li><a href='#L1056' title='Defined at 1056.'>gc_set_debug</a>
<li><a href='#L1071' title='Defined at 1071.'>gc_get_debug</a>
<li><a href='#L1083' title='Defined at 1083.'>gc_set_thresh</a>
<li><a href='#L1106' title='Defined at 1106.'>gc_get_thresh</a>
<li><a href='#L1120' title='Defined at 1120.'>gc_get_count</a>
<li><a href='#L1129' title='Defined at 1129.'>referrersvisit</a>
<li><a href='#L1139' title='Defined at 1139.'>gc_referrers_for</a>
<li><a href='#L1162' title='Defined at 1162.'>gc_get_referrers</a>
<li><a href='#L1179' title='Defined at 1179.'>referentsvisit</a>
<li><a href='#L1189' title='Defined at 1189.'>gc_get_referents</a>
<li><a href='#L1221' title='Defined at 1221.'>gc_get_objects</a>
<li><a href='#L1246' title='Defined at 1246.'>gc_is_tracked</a>
<li><a href='#L1309' title='Defined at 1309.'>PyInit_gc</a>
<li><a href='#L1351' title='Defined at 1351.'>PyGC_Collect</a>
<li><a href='#L1367' title='Defined at 1367.'>_PyGC_Fini</a>
<li><a href='#L1400' title='Defined at 1400.'>_PyGC_Dump</a>
<li><a href='#L1414' title='Defined at 1414.'>PyObject_GC_Track</a>
<li><a href='#L1421' title='Defined at 1421.'>_PyObject_GC_Track</a>
<li><a href='#L1427' title='Defined at 1427.'>PyObject_GC_UnTrack</a>
<li><a href='#L1438' title='Defined at 1438.'>_PyObject_GC_UnTrack</a>
<li><a href='#L1444' title='Defined at 1444.'>_PyObject_GC_Malloc</a>
<li><a href='#L1470' title='Defined at 1470.'>_PyObject_GC_New</a>
<li><a href='#L1479' title='Defined at 1479.'>_PyObject_GC_NewVar</a>
<li><a href='#L1489' title='Defined at 1489.'>_PyObject_GC_Resize</a>
<li><a href='#L1504' title='Defined at 1504.'>PyObject_GC_Del</a>
</ol>
<hr>
<pre>
<a name='L1'><i><font color='green'>/*</font></i>
<a name='L2'><i><font color='green'></font></i>
<a name='L3'><i><font color='green'>  Reference Cycle Garbage Collection</font></i>
<a name='L4'><i><font color='green'>  ==================================</font></i>
<a name='L5'><i><font color='green'></font></i>
<a name='L6'><i><font color='green'>  Neil Schemenauer &lt;nas@arctrix.com&gt;</font></i>
<a name='L7'><i><font color='green'></font></i>
<a name='L8'><i><font color='green'>  Based on a post on the python-dev list.  Ideas from Guido van Rossum,</font></i>
<a name='L9'><i><font color='green'>  Eric Tiedemann, and various others.</font></i>
<a name='L10'><i><font color='green'></font></i>
<a name='L11'><i><font color='green'>  http://www.arctrix.com/nas/python/gc/</font></i>
<a name='L12'><i><font color='green'></font></i>
<a name='L13'><i><font color='green'>  The following mailing list threads provide a historical perspective on</font></i>
<a name='L14'><i><font color='green'>  the design of this module.  Note that a fair amount of refinement has</font></i>
<a name='L15'><i><font color='green'>  occurred since those discussions.</font></i>
<a name='L16'><i><font color='green'></font></i>
<a name='L17'><i><font color='green'>  http://mail.python.org/pipermail/python-dev/2000-March/002385.html</font></i>
<a name='L18'><i><font color='green'>  http://mail.python.org/pipermail/python-dev/2000-March/002434.html</font></i>
<a name='L19'><i><font color='green'>  http://mail.python.org/pipermail/python-dev/2000-March/002497.html</font></i>
<a name='L20'><i><font color='green'></font></i>
<a name='L21'><i><font color='green'>  For a highlevel view of the collection process, read the collect</font></i>
<a name='L22'><i><font color='green'>  function.</font></i>
<a name='L23'><i><font color='green'></font></i>
<a name='L24'><i><font color='green'>*/</font></i>
<a name='L25'>
<a name='L26'><font color='darkred'>#include</font> "<a href='570.html'>Python.h</a>"
<a name='L27'><font color='darkred'>#include</font> "<a href='526.html'>frameobject.h</a>"        <i><font color='green'>/* for PyFrame_ClearFreeList */</font></i>
<a name='L28'>
<a name='L29'><i><font color='green'>/* Get an object's GC head */</font></i>
<a name='L30'><font color='darkred'>#define</font> <a href='../R/143.html' title='Multiple refered from 9 places.'>AS_GC</a>(o) ((PyGC_Head *)(o)-1)
<a name='L31'>
<a name='L32'><i><font color='green'>/* Get the object given the GC head */</font></i>
<a name='L33'><font color='darkred'>#define</font> <a href='../R/1164.html' title='Multiple refered from 18 places.'>FROM_GC</a>(g) ((<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)(((PyGC_Head *)g)+1))
<a name='L34'>
<a name='L35'><i><font color='green'>/*** Global GC state ***/</font></i>
<a name='L36'>
<a name='L37'><b>struct</b> <a href='../S/2676.html#L48' title='Refered from 48 in Modules/gcmodule.c.'>gc_generation</a> <font color='red'>{</font>
<a name='L38'>    PyGC_Head head;
<a name='L39'>    <b>int</b> threshold; <i><font color='green'>/* collection threshold */</font></i>
<a name='L40'>    <b>int</b> count; <i><font color='green'>/* count of allocations or collections of younger</font></i>
<a name='L41'><i><font color='green'>                  generations */</font></i>
<a name='L42'><font color='red'>}</font>;
<a name='L43'>
<a name='L44'><font color='darkred'>#define</font> <a href='../R/2138.html' title='Multiple refered from 14 places.'>NUM_GENERATIONS</a> 3
<a name='L45'><font color='darkred'>#define</font> <a href='../R/1230.html' title='Multiple refered from 10 places.'>GEN_HEAD</a>(n) (&amp;generations[n].head)
<a name='L46'>
<a name='L47'><i><font color='green'>/* linked lists of container objects */</font></i>
<a name='L48'><b>static</b> <b>struct</b> <a href='../S/2676.html#L37' title='Defined at 37 in Modules/gcmodule.c.'>gc_generation</a> generations[<a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>] = <font color='red'>{</font>
<a name='L49'>    <i><font color='green'>/* PyGC_Head,                               threshold,      count */</font></i>
<a name='L50'>    <font color='red'>{</font><font color='red'>{</font><font color='red'>{</font><a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(0), <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(0), 0<font color='red'>}</font><font color='red'>}</font>,           700,            0<font color='red'>}</font>,
<a name='L51'>    <font color='red'>{</font><font color='red'>{</font><font color='red'>{</font><a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(1), <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(1), 0<font color='red'>}</font><font color='red'>}</font>,           10,             0<font color='red'>}</font>,
<a name='L52'>    <font color='red'>{</font><font color='red'>{</font><font color='red'>{</font><a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(2), <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(2), 0<font color='red'>}</font><font color='red'>}</font>,           10,             0<font color='red'>}</font>,
<a name='L53'><font color='red'>}</font>;
<a name='L54'>
<a name='L55'>PyGC_Head *_PyGC_generation0 = <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(0);
<a name='L56'>
<a name='L57'><b>static</b> <b>int</b> enabled = 1; <i><font color='green'>/* automatic collection enabled? */</font></i>
<a name='L58'>
<a name='L59'><i><font color='green'>/* true if we are currently running the collector */</font></i>
<a name='L60'><b>static</b> <b>int</b> collecting = 0;
<a name='L61'>
<a name='L62'><i><font color='green'>/* list of uncollectable objects */</font></i>
<a name='L63'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *garbage = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L64'>
<a name='L65'><i><font color='green'>/* Python string to use if unhandled exception occurs */</font></i>
<a name='L66'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *gc_str = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L67'>
<a name='L68'><i><font color='green'>/* Python string used to look for __del__ attribute. */</font></i>
<a name='L69'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *delstr = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L70'>
<a name='L71'><i><font color='green'>/* This is the number of objects who survived the last full collection. It</font></i>
<a name='L72'><i><font color='green'>   approximates the number of long lived objects tracked by the GC.</font></i>
<a name='L73'><i><font color='green'></font></i>
<a name='L74'><i><font color='green'>   (by "full collection", we mean a collection of the oldest generation).</font></i>
<a name='L75'><i><font color='green'>*/</font></i>
<a name='L76'><b>static</b> <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> long_lived_total = 0;
<a name='L77'>
<a name='L78'><i><font color='green'>/* This is the number of objects who survived all "non-full" collections,</font></i>
<a name='L79'><i><font color='green'>   and are awaiting to undergo a full collection for the first time.</font></i>
<a name='L80'><i><font color='green'></font></i>
<a name='L81'><i><font color='green'>*/</font></i>
<a name='L82'><b>static</b> <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> long_lived_pending = 0;
<a name='L83'>
<a name='L84'><i><font color='green'>/*</font></i>
<a name='L85'><i><font color='green'>   NOTE: about the counting of long-lived objects.</font></i>
<a name='L86'><i><font color='green'></font></i>
<a name='L87'><i><font color='green'>   To limit the cost of garbage collection, there are two strategies;</font></i>
<a name='L88'><i><font color='green'>     - make each collection faster, e.g. by scanning fewer objects</font></i>
<a name='L89'><i><font color='green'>     - do less collections</font></i>
<a name='L90'><i><font color='green'>   This heuristic is about the latter strategy.</font></i>
<a name='L91'><i><font color='green'></font></i>
<a name='L92'><i><font color='green'>   In addition to the various configurable thresholds, we only trigger a</font></i>
<a name='L93'><i><font color='green'>   full collection if the ratio</font></i>
<a name='L94'><i><font color='green'>    long_lived_pending / long_lived_total</font></i>
<a name='L95'><i><font color='green'>   is above a given value (hardwired to 25%).</font></i>
<a name='L96'><i><font color='green'></font></i>
<a name='L97'><i><font color='green'>   The reason is that, while "non-full" collections (i.e., collections of</font></i>
<a name='L98'><i><font color='green'>   the young and middle generations) will always examine roughly the same</font></i>
<a name='L99'><i><font color='green'>   number of objects -- determined by the aforementioned thresholds --,</font></i>
<a name='L100'><i><font color='green'>   the cost of a full collection is proportional to the total number of</font></i>
<a name='L101'><i><font color='green'>   long-lived objects, which is virtually unbounded.</font></i>
<a name='L102'><i><font color='green'></font></i>
<a name='L103'><i><font color='green'>   Indeed, it has been remarked that doing a full collection every</font></i>
<a name='L104'><i><font color='green'>   &lt;constant number&gt; of object creations entails a dramatic performance</font></i>
<a name='L105'><i><font color='green'>   degradation in workloads which consist in creating and storing lots of</font></i>
<a name='L106'><i><font color='green'>   long-lived objects (e.g. building a large list of GC-tracked objects would</font></i>
<a name='L107'><i><font color='green'>   show quadratic performance, instead of linear as expected: see issue #4074).</font></i>
<a name='L108'><i><font color='green'></font></i>
<a name='L109'><i><font color='green'>   Using the above ratio, instead, yields amortized linear performance in</font></i>
<a name='L110'><i><font color='green'>   the total number of objects (the effect of which can be summarized</font></i>
<a name='L111'><i><font color='green'>   thusly: "each full garbage collection is more and more costly as the</font></i>
<a name='L112'><i><font color='green'>   number of objects grows, but we do fewer and fewer of them").</font></i>
<a name='L113'><i><font color='green'></font></i>
<a name='L114'><i><font color='green'>   This heuristic was suggested by Martin von LÃ¶wis on python-dev in</font></i>
<a name='L115'><i><font color='green'>   June 2008. His original analysis and proposal can be found at:</font></i>
<a name='L116'><i><font color='green'>    http://mail.python.org/pipermail/python-dev/2008-June/080579.html</font></i>
<a name='L117'><i><font color='green'>*/</font></i>
<a name='L118'>
<a name='L119'>
<a name='L120'><i><font color='green'>/* set for debugging information */</font></i>
<a name='L121'><font color='darkred'>#define</font> <a href='../R/687.html' title='Multiple refered from 3 places.'>DEBUG_STATS</a>             (1&lt;&lt;0) <i><font color='green'>/* print collection statistics */</font></i>
<a name='L122'><font color='darkred'>#define</font> <a href='../R/683.html' title='Multiple refered from 3 places.'>DEBUG_COLLECTABLE</a>       (1&lt;&lt;1) <i><font color='green'>/* print collectable objects */</font></i>
<a name='L123'><font color='darkred'>#define</font> <a href='../R/688.html' title='Multiple refered from 5 places.'>DEBUG_UNCOLLECTABLE</a>     (1&lt;&lt;2) <i><font color='green'>/* print uncollectable objects */</font></i>
<a name='L124'><font color='darkred'>#define</font> <a href='../R/686.html' title='Multiple refered from 5 places.'>DEBUG_SAVEALL</a>           (1&lt;&lt;5) <i><font color='green'>/* save all garbage in gc.garbage */</font></i>
<a name='L125'><font color='darkred'>#define</font> <a href='../S/2676.html#L1344' title='Refered from 1344 in Modules/gcmodule.c.'>DEBUG_LEAK</a>              <a href='../S/2676.html#L122' title='Defined at 122 in Modules/gcmodule.c.'>DEBUG_COLLECTABLE</a> | \
<a name='L126'>                <a href='../S/2676.html#L123' title='Defined at 123 in Modules/gcmodule.c.'>DEBUG_UNCOLLECTABLE</a> | \
<a name='L127'>                <a href='../S/2676.html#L124' title='Defined at 124 in Modules/gcmodule.c.'>DEBUG_SAVEALL</a>
<a name='L128'><b>static</b> <b>int</b> <a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a>;
<a name='L129'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *tmod = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L130'>
<a name='L131'><i><font color='green'>/*--------------------------------------------------------------------------</font></i>
<a name='L132'><i><font color='green'>gc_refs values.</font></i>
<a name='L133'><i><font color='green'></font></i>
<a name='L134'><i><font color='green'>Between collections, every gc'ed object has one of two gc_refs values:</font></i>
<a name='L135'><i><font color='green'></font></i>
<a name='L136'><i><font color='green'>GC_UNTRACKED</font></i>
<a name='L137'><i><font color='green'>    The initial state; objects returned by PyObject_GC_Malloc are in this</font></i>
<a name='L138'><i><font color='green'>    state.  The object doesn't live in any generation list, and its</font></i>
<a name='L139'><i><font color='green'>    tp_traverse slot must not be called.</font></i>
<a name='L140'><i><font color='green'></font></i>
<a name='L141'><i><font color='green'>GC_REACHABLE</font></i>
<a name='L142'><i><font color='green'>    The object lives in some generation list, and its tp_traverse is safe to</font></i>
<a name='L143'><i><font color='green'>    call.  An object transitions to GC_REACHABLE when PyObject_GC_Track</font></i>
<a name='L144'><i><font color='green'>    is called.</font></i>
<a name='L145'><i><font color='green'></font></i>
<a name='L146'><i><font color='green'>During a collection, gc_refs can temporarily take on other states:</font></i>
<a name='L147'><i><font color='green'></font></i>
<a name='L148'><i><font color='green'>&gt;= 0</font></i>
<a name='L149'><i><font color='green'>    At the start of a collection, update_refs() copies the true refcount</font></i>
<a name='L150'><i><font color='green'>    to gc_refs, for each object in the generation being collected.</font></i>
<a name='L151'><i><font color='green'>    subtract_refs() then adjusts gc_refs so that it equals the number of</font></i>
<a name='L152'><i><font color='green'>    times an object is referenced directly from outside the generation</font></i>
<a name='L153'><i><font color='green'>    being collected.</font></i>
<a name='L154'><i><font color='green'>    gc_refs remains &gt;= 0 throughout these steps.</font></i>
<a name='L155'><i><font color='green'></font></i>
<a name='L156'><i><font color='green'>GC_TENTATIVELY_UNREACHABLE</font></i>
<a name='L157'><i><font color='green'>    move_unreachable() then moves objects not reachable (whether directly or</font></i>
<a name='L158'><i><font color='green'>    indirectly) from outside the generation into an "unreachable" set.</font></i>
<a name='L159'><i><font color='green'>    Objects that are found to be reachable have gc_refs set to GC_REACHABLE</font></i>
<a name='L160'><i><font color='green'>    again.  Objects that are found to be unreachable have gc_refs set to</font></i>
<a name='L161'><i><font color='green'>    GC_TENTATIVELY_UNREACHABLE.  It's "tentatively" because the pass doing</font></i>
<a name='L162'><i><font color='green'>    this can't be sure until it ends, and GC_TENTATIVELY_UNREACHABLE may</font></i>
<a name='L163'><i><font color='green'>    transition back to GC_REACHABLE.</font></i>
<a name='L164'><i><font color='green'></font></i>
<a name='L165'><i><font color='green'>    Only objects with GC_TENTATIVELY_UNREACHABLE still set are candidates</font></i>
<a name='L166'><i><font color='green'>    for collection.  If it's decided not to collect such an object (e.g.,</font></i>
<a name='L167'><i><font color='green'>    it has a __del__ method), its gc_refs is restored to GC_REACHABLE again.</font></i>
<a name='L168'><i><font color='green'>----------------------------------------------------------------------------</font></i>
<a name='L169'><i><font color='green'>*/</font></i>
<a name='L170'><font color='darkred'>#define</font> <a href='../R/1228.html' title='Multiple refered from 3 places.'>GC_UNTRACKED</a>                    <a href='../S/545.html#L260' title='Defined at 260 in Include/objimpl.h.'>_PyGC_REFS_UNTRACKED</a>
<a name='L171'><font color='darkred'>#define</font> <a href='../R/1226.html' title='Multiple refered from 7 places.'>GC_REACHABLE</a>                    <a href='../S/545.html#L261' title='Defined at 261 in Include/objimpl.h.'>_PyGC_REFS_REACHABLE</a>
<a name='L172'><font color='darkred'>#define</font> <a href='../R/1227.html' title='Multiple refered from 3 places.'>GC_TENTATIVELY_UNREACHABLE</a>      <a href='../S/545.html#L262' title='Defined at 262 in Include/objimpl.h.'>_PyGC_REFS_TENTATIVELY_UNREACHABLE</a>
<a name='L173'>
<a name='L174'><font color='darkred'>#define</font> <a href='../R/1608.html' title='Multiple refered from 3 places.'>IS_TRACKED</a>(o) ((<a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(o))-&gt;gc.gc_refs != <a href='../S/2676.html#L170' title='Defined at 170 in Modules/gcmodule.c.'>GC_UNTRACKED</a>)
<a name='L175'><font color='darkred'>#define</font> <a href='../R/1602.html' title='Multiple refered from 2 places.'>IS_REACHABLE</a>(o) ((<a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(o))-&gt;gc.gc_refs == <a href='../S/2676.html#L171' title='Defined at 171 in Modules/gcmodule.c.'>GC_REACHABLE</a>)
<a name='L176'><font color='darkred'>#define</font> <a href='../R/1607.html' title='Multiple refered from 5 places.'>IS_TENTATIVELY_UNREACHABLE</a>(o) ( \
<a name='L177'>    (<a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(o))-&gt;gc.gc_refs == <a href='../S/2676.html#L172' title='Defined at 172 in Modules/gcmodule.c.'>GC_TENTATIVELY_UNREACHABLE</a>)
<a name='L178'>
<a name='L179'><i><font color='green'>/*** list functions ***/</font></i>
<a name='L180'>
<a name='L181'><b>static</b> <b>void</b>
<a name='L182'><a href='../R/7990.html' title='Multiple refered from 4 places.'>gc_list_init</a>(PyGC_Head *list)
<a name='L183'><font color='red'>{</font>
<a name='L184'>    list-&gt;gc.gc_prev = list;
<a name='L185'>    list-&gt;gc.gc_next = list;
<a name='L186'><font color='red'>}</font>
<a name='L187'>
<a name='L188'><b>static</b> <b>int</b>
<a name='L189'><a href='../R/7991.html' title='Multiple refered from 3 places.'>gc_list_is_empty</a>(PyGC_Head *list)
<a name='L190'><font color='red'>{</font>
<a name='L191'>    <b>return</b> (list-&gt;gc.gc_next == list);
<a name='L192'><font color='red'>}</font>
<a name='L193'>
<a name='L194'><font color='darkred'>#if</font> 0
<a name='L195'><i><font color='green'>/* This became unused after gc_list_move() was introduced. */</font></i>
<a name='L196'><i><font color='green'>/* Append `node` to `list`. */</font></i>
<a name='L197'><b>static</b> <b>void</b>
<a name='L198'>gc_list_append(PyGC_Head *node, PyGC_Head *list)
<a name='L199'><font color='red'>{</font>
<a name='L200'>    <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_next = list;
<a name='L201'>    <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_prev = list-&gt;gc.gc_prev;
<a name='L202'>    <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_prev-&gt;gc.gc_next = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>;
<a name='L203'>    list-&gt;gc.gc_prev = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>;
<a name='L204'><font color='red'>}</font>
<a name='L205'><font color='darkred'>#endif</font>
<a name='L206'>
<a name='L207'><i><font color='green'>/* Remove `node` from the gc list it's currently in. */</font></i>
<a name='L208'><b>static</b> <b>void</b>
<a name='L209'><a href='../S/2676.html#L1508' title='Refered from 1508 in Modules/gcmodule.c.'>gc_list_remove</a>(PyGC_Head *node)
<a name='L210'><font color='red'>{</font>
<a name='L211'>    <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_prev-&gt;gc.gc_next = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_next;
<a name='L212'>    <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_next-&gt;gc.gc_prev = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_prev;
<a name='L213'>    <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_next = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; <i><font color='green'>/* object is not currently tracked */</font></i>
<a name='L214'><font color='red'>}</font>
<a name='L215'>
<a name='L216'><i><font color='green'>/* Move `node` from the gc list it's currently in (which is not explicitly</font></i>
<a name='L217'><i><font color='green'> * named here) to the end of `list`.  This is semantically the same as</font></i>
<a name='L218'><i><font color='green'> * gc_list_remove(node) followed by gc_list_append(node, list).</font></i>
<a name='L219'><i><font color='green'> */</font></i>
<a name='L220'><b>static</b> <b>void</b>
<a name='L221'><a href='../R/7993.html' title='Multiple refered from 7 places.'>gc_list_move</a>(PyGC_Head *node, PyGC_Head *list)
<a name='L222'><font color='red'>{</font>
<a name='L223'>    PyGC_Head *new_prev;
<a name='L224'>    PyGC_Head *current_prev = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_prev;
<a name='L225'>    PyGC_Head *current_next = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_next;
<a name='L226'>    <i><font color='green'>/* Unlink from current list. */</font></i>
<a name='L227'>    current_prev-&gt;gc.gc_next = current_next;
<a name='L228'>    current_next-&gt;gc.gc_prev = current_prev;
<a name='L229'>    <i><font color='green'>/* Relink at end of new list. */</font></i>
<a name='L230'>    new_prev = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_prev = list-&gt;gc.gc_prev;
<a name='L231'>    new_prev-&gt;gc.gc_next = list-&gt;gc.gc_prev = <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>;
<a name='L232'>    <a href='../S/543.html#L17' title='Defined at 17 in Include/node.h.'>node</a>-&gt;gc.gc_next = list;
<a name='L233'><font color='red'>}</font>
<a name='L234'>
<a name='L235'><i><font color='green'>/* append list `from` onto list `to`; `from` becomes an empty list */</font></i>
<a name='L236'><b>static</b> <b>void</b>
<a name='L237'><a href='../R/7992.html' title='Multiple refered from 3 places.'>gc_list_merge</a>(PyGC_Head *from, PyGC_Head *to)
<a name='L238'><font color='red'>{</font>
<a name='L239'>    PyGC_Head *tail;
<a name='L240'>    <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(from != to);
<a name='L241'>    <b>if</b> (!<a href='../S/2676.html#L189' title='Defined at 189 in Modules/gcmodule.c.'>gc_list_is_empty</a>(from)) <font color='red'>{</font>
<a name='L242'>        tail = to-&gt;gc.gc_prev;
<a name='L243'>        tail-&gt;gc.gc_next = from-&gt;gc.gc_next;
<a name='L244'>        tail-&gt;gc.gc_next-&gt;gc.gc_prev = tail;
<a name='L245'>        to-&gt;gc.gc_prev = from-&gt;gc.gc_prev;
<a name='L246'>        to-&gt;gc.gc_prev-&gt;gc.gc_next = to;
<a name='L247'>    <font color='red'>}</font>
<a name='L248'>    <a href='../S/2676.html#L182' title='Defined at 182 in Modules/gcmodule.c.'>gc_list_init</a>(from);
<a name='L249'><font color='red'>}</font>
<a name='L250'>
<a name='L251'><b>static</b> <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>
<a name='L252'><a href='../R/7995.html' title='Multiple refered from 3 places.'>gc_list_size</a>(PyGC_Head *list)
<a name='L253'><font color='red'>{</font>
<a name='L254'>    PyGC_Head *gc;
<a name='L255'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> n = 0;
<a name='L256'>    <b>for</b> (gc = list-&gt;gc.gc_next; gc != list; gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L257'>        n++;
<a name='L258'>    <font color='red'>}</font>
<a name='L259'>    <b>return</b> n;
<a name='L260'><font color='red'>}</font>
<a name='L261'>
<a name='L262'><i><font color='green'>/* Append objects in a GC list to a Python list.</font></i>
<a name='L263'><i><font color='green'> * Return 0 if all OK, &lt; 0 if error (out of memory for list).</font></i>
<a name='L264'><i><font color='green'> */</font></i>
<a name='L265'><b>static</b> <b>int</b>
<a name='L266'><a href='../S/2676.html#L1230' title='Refered from 1230 in Modules/gcmodule.c.'>append_objects</a>(PyObject *py_list, PyGC_Head *gc_list)
<a name='L267'><font color='red'>{</font>
<a name='L268'>    PyGC_Head *gc;
<a name='L269'>    <b>for</b> (gc = gc_list-&gt;gc.gc_next; gc != gc_list; gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L270'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L271'>        <b>if</b> (op != py_list) <font color='red'>{</font>
<a name='L272'>            <b>if</b> (<a href='../S/2796.html#L286' title='Defined at 286 in Objects/listobject.c.'>PyList_Append</a>(py_list, op)) <font color='red'>{</font>
<a name='L273'>                <b>return</b> -1; <i><font color='green'>/* exception */</font></i>
<a name='L274'>            <font color='red'>}</font>
<a name='L275'>        <font color='red'>}</font>
<a name='L276'>    <font color='red'>}</font>
<a name='L277'>    <b>return</b> 0;
<a name='L278'><font color='red'>}</font>
<a name='L279'>
<a name='L280'><i><font color='green'>/*** end of list stuff ***/</font></i>
<a name='L281'>
<a name='L282'>
<a name='L283'><i><font color='green'>/* Set all gc_refs = ob_refcnt.  After this, gc_refs is &gt; 0 for all objects</font></i>
<a name='L284'><i><font color='green'> * in containers, and is GC_REACHABLE for all tracked gc objects not in</font></i>
<a name='L285'><i><font color='green'> * containers.</font></i>
<a name='L286'><i><font color='green'> */</font></i>
<a name='L287'><b>static</b> <b>void</b>
<a name='L288'><a href='../S/2676.html#L840' title='Refered from 840 in Modules/gcmodule.c.'>update_refs</a>(PyGC_Head *containers)
<a name='L289'><font color='red'>{</font>
<a name='L290'>    PyGC_Head *gc = containers-&gt;gc.gc_next;
<a name='L291'>    <b>for</b> (; gc != containers; gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L292'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(gc-&gt;gc.gc_refs == <a href='../S/2676.html#L171' title='Defined at 171 in Modules/gcmodule.c.'>GC_REACHABLE</a>);
<a name='L293'>        gc-&gt;gc.gc_refs = <a href='../D/4223.html' title='Multiple defined in 2 places.'>Py_REFCNT</a>(<a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc));
<a name='L294'>        <i><font color='green'>/* Python's cyclic gc should never see an incoming refcount</font></i>
<a name='L295'><i><font color='green'>         * of 0:  if something decref'ed to 0, it should have been</font></i>
<a name='L296'><i><font color='green'>         * deallocated immediately at that time.</font></i>
<a name='L297'><i><font color='green'>         * Possible cause (if the assert triggers):  a tp_dealloc</font></i>
<a name='L298'><i><font color='green'>         * routine left a gc-aware object tracked during its teardown</font></i>
<a name='L299'><i><font color='green'>         * phase, and did something-- or allowed something to happen --</font></i>
<a name='L300'><i><font color='green'>         * that called back into Python.  gc can trigger then, and may</font></i>
<a name='L301'><i><font color='green'>         * see the still-tracked dying object.  Before this assert</font></i>
<a name='L302'><i><font color='green'>         * was added, such mistakes went on to allow gc to try to</font></i>
<a name='L303'><i><font color='green'>         * delete the object again.  In a debug build, that caused</font></i>
<a name='L304'><i><font color='green'>         * a mysterious segfault, when _Py_ForgetReference tried</font></i>
<a name='L305'><i><font color='green'>         * to remove the object from the doubly-linked list of all</font></i>
<a name='L306'><i><font color='green'>         * objects a second time.  In a release build, an actual</font></i>
<a name='L307'><i><font color='green'>         * double deallocation occurred, which leads to corruption</font></i>
<a name='L308'><i><font color='green'>         * of the allocator's internal bookkeeping pointers.  That's</font></i>
<a name='L309'><i><font color='green'>         * so serious that maybe this should be a release-build</font></i>
<a name='L310'><i><font color='green'>         * check instead of an assert?</font></i>
<a name='L311'><i><font color='green'>         */</font></i>
<a name='L312'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(gc-&gt;gc.gc_refs != 0);
<a name='L313'>    <font color='red'>}</font>
<a name='L314'><font color='red'>}</font>
<a name='L315'>
<a name='L316'><i><font color='green'>/* A traversal callback for subtract_refs. */</font></i>
<a name='L317'><b>static</b> <b>int</b>
<a name='L318'><a href='../S/2676.html#L347' title='Refered from 347 in Modules/gcmodule.c.'>visit_decref</a>(PyObject *op, <b>void</b> *data)
<a name='L319'><font color='red'>{</font>
<a name='L320'>    <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(op != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L321'>    <b>if</b> (PyObject_IS_GC(op)) <font color='red'>{</font>
<a name='L322'>        PyGC_Head *gc = <a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(op);
<a name='L323'>        <i><font color='green'>/* We're only interested in gc_refs for objects in the</font></i>
<a name='L324'><i><font color='green'>         * generation being collected, which can be recognized</font></i>
<a name='L325'><i><font color='green'>         * because only they have positive gc_refs.</font></i>
<a name='L326'><i><font color='green'>         */</font></i>
<a name='L327'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(gc-&gt;gc.gc_refs != 0); <i><font color='green'>/* else refcount was too small */</font></i>
<a name='L328'>        <b>if</b> (gc-&gt;gc.gc_refs &gt; 0)
<a name='L329'>            gc-&gt;gc.gc_refs--;
<a name='L330'>    <font color='red'>}</font>
<a name='L331'>    <b>return</b> 0;
<a name='L332'><font color='red'>}</font>
<a name='L333'>
<a name='L334'><i><font color='green'>/* Subtract internal references from gc_refs.  After this, gc_refs is &gt;= 0</font></i>
<a name='L335'><i><font color='green'> * for all objects in containers, and is GC_REACHABLE for all tracked gc</font></i>
<a name='L336'><i><font color='green'> * objects not in containers.  The ones with gc_refs &gt; 0 are directly</font></i>
<a name='L337'><i><font color='green'> * reachable from outside containers, and so can't be collected.</font></i>
<a name='L338'><i><font color='green'> */</font></i>
<a name='L339'><b>static</b> <b>void</b>
<a name='L340'><a href='../S/2676.html#L841' title='Refered from 841 in Modules/gcmodule.c.'>subtract_refs</a>(PyGC_Head *containers)
<a name='L341'><font color='red'>{</font>
<a name='L342'>    traverseproc traverse;
<a name='L343'>    PyGC_Head *gc = containers-&gt;gc.gc_next;
<a name='L344'>    <b>for</b> (; gc != containers; gc=gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L345'>        traverse = <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(<a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc))-&gt;tp_traverse;
<a name='L346'>        (<b>void</b>) traverse(<a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc),
<a name='L347'>                       (visitproc)<a href='../S/2676.html#L318' title='Defined at 318 in Modules/gcmodule.c.'>visit_decref</a>,
<a name='L348'>                       <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L349'>    <font color='red'>}</font>
<a name='L350'><font color='red'>}</font>
<a name='L351'>
<a name='L352'><i><font color='green'>/* A traversal callback for move_unreachable. */</font></i>
<a name='L353'><b>static</b> <b>int</b>
<a name='L354'><a href='../S/2676.html#L434' title='Refered from 434 in Modules/gcmodule.c.'>visit_reachable</a>(PyObject *op, PyGC_Head *reachable)
<a name='L355'><font color='red'>{</font>
<a name='L356'>    <b>if</b> (PyObject_IS_GC(op)) <font color='red'>{</font>
<a name='L357'>        PyGC_Head *gc = <a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(op);
<a name='L358'>        <b>const</b> <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> gc_refs = gc-&gt;gc.gc_refs;
<a name='L359'>
<a name='L360'>        <b>if</b> (gc_refs == 0) <font color='red'>{</font>
<a name='L361'>            <i><font color='green'>/* This is in move_unreachable's 'young' list, but</font></i>
<a name='L362'><i><font color='green'>             * the traversal hasn't yet gotten to it.  All</font></i>
<a name='L363'><i><font color='green'>             * we need to do is tell move_unreachable that it's</font></i>
<a name='L364'><i><font color='green'>             * reachable.</font></i>
<a name='L365'><i><font color='green'>             */</font></i>
<a name='L366'>            gc-&gt;gc.gc_refs = 1;
<a name='L367'>        <font color='red'>}</font>
<a name='L368'>        <b>else</b> <b>if</b> (gc_refs == <a href='../S/2676.html#L172' title='Defined at 172 in Modules/gcmodule.c.'>GC_TENTATIVELY_UNREACHABLE</a>) <font color='red'>{</font>
<a name='L369'>            <i><font color='green'>/* This had gc_refs = 0 when move_unreachable got</font></i>
<a name='L370'><i><font color='green'>             * to it, but turns out it's reachable after all.</font></i>
<a name='L371'><i><font color='green'>             * Move it back to move_unreachable's 'young' list,</font></i>
<a name='L372'><i><font color='green'>             * and move_unreachable will eventually get to it</font></i>
<a name='L373'><i><font color='green'>             * again.</font></i>
<a name='L374'><i><font color='green'>             */</font></i>
<a name='L375'>            <a href='../S/2676.html#L221' title='Defined at 221 in Modules/gcmodule.c.'>gc_list_move</a>(gc, reachable);
<a name='L376'>            gc-&gt;gc.gc_refs = 1;
<a name='L377'>        <font color='red'>}</font>
<a name='L378'>        <i><font color='green'>/* Else there's nothing to do.</font></i>
<a name='L379'><i><font color='green'>         * If gc_refs &gt; 0, it must be in move_unreachable's 'young'</font></i>
<a name='L380'><i><font color='green'>         * list, and move_unreachable will eventually get to it.</font></i>
<a name='L381'><i><font color='green'>         * If gc_refs == GC_REACHABLE, it's either in some other</font></i>
<a name='L382'><i><font color='green'>         * generation so we don't care about it, or move_unreachable</font></i>
<a name='L383'><i><font color='green'>         * already dealt with it.</font></i>
<a name='L384'><i><font color='green'>         * If gc_refs == GC_UNTRACKED, it must be ignored.</font></i>
<a name='L385'><i><font color='green'>         */</font></i>
<a name='L386'>         <b>else</b> <font color='red'>{</font>
<a name='L387'>            <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(gc_refs &gt; 0
<a name='L388'>                   || gc_refs == <a href='../S/2676.html#L171' title='Defined at 171 in Modules/gcmodule.c.'>GC_REACHABLE</a>
<a name='L389'>                   || gc_refs == <a href='../S/2676.html#L170' title='Defined at 170 in Modules/gcmodule.c.'>GC_UNTRACKED</a>);
<a name='L390'>         <font color='red'>}</font>
<a name='L391'>    <font color='red'>}</font>
<a name='L392'>    <b>return</b> 0;
<a name='L393'><font color='red'>}</font>
<a name='L394'>
<a name='L395'><i><font color='green'>/* Move the unreachable objects from young to unreachable.  After this,</font></i>
<a name='L396'><i><font color='green'> * all objects in young have gc_refs = GC_REACHABLE, and all objects in</font></i>
<a name='L397'><i><font color='green'> * unreachable have gc_refs = GC_TENTATIVELY_UNREACHABLE.  All tracked</font></i>
<a name='L398'><i><font color='green'> * gc objects not in young or unreachable still have gc_refs = GC_REACHABLE.</font></i>
<a name='L399'><i><font color='green'> * All objects in young after this are directly or indirectly reachable</font></i>
<a name='L400'><i><font color='green'> * from outside the original young; and all objects in unreachable are</font></i>
<a name='L401'><i><font color='green'> * not.</font></i>
<a name='L402'><i><font color='green'> */</font></i>
<a name='L403'><b>static</b> <b>void</b>
<a name='L404'><a href='../S/2676.html#L850' title='Refered from 850 in Modules/gcmodule.c.'>move_unreachable</a>(PyGC_Head *young, PyGC_Head *unreachable)
<a name='L405'><font color='red'>{</font>
<a name='L406'>    PyGC_Head *gc = young-&gt;gc.gc_next;
<a name='L407'>
<a name='L408'>    <i><font color='green'>/* Invariants:  all objects "to the left" of us in young have gc_refs</font></i>
<a name='L409'><i><font color='green'>     * = GC_REACHABLE, and are indeed reachable (directly or indirectly)</font></i>
<a name='L410'><i><font color='green'>     * from outside the young list as it was at entry.  All other objects</font></i>
<a name='L411'><i><font color='green'>     * from the original young "to the left" of us are in unreachable now,</font></i>
<a name='L412'><i><font color='green'>     * and have gc_refs = GC_TENTATIVELY_UNREACHABLE.  All objects to the</font></i>
<a name='L413'><i><font color='green'>     * left of us in 'young' now have been scanned, and no objects here</font></i>
<a name='L414'><i><font color='green'>     * or to the right have been scanned yet.</font></i>
<a name='L415'><i><font color='green'>     */</font></i>
<a name='L416'>
<a name='L417'>    <b>while</b> (gc != young) <font color='red'>{</font>
<a name='L418'>        PyGC_Head *next;
<a name='L419'>
<a name='L420'>        <b>if</b> (gc-&gt;gc.gc_refs) <font color='red'>{</font>
<a name='L421'>            <i><font color='green'>/* gc is definitely reachable from outside the</font></i>
<a name='L422'><i><font color='green'>             * original 'young'.  Mark it as such, and traverse</font></i>
<a name='L423'><i><font color='green'>             * its pointers to find any other objects that may</font></i>
<a name='L424'><i><font color='green'>             * be directly reachable from it.  Note that the</font></i>
<a name='L425'><i><font color='green'>             * call to tp_traverse may append objects to young,</font></i>
<a name='L426'><i><font color='green'>             * so we have to wait until it returns to determine</font></i>
<a name='L427'><i><font color='green'>             * the next object to visit.</font></i>
<a name='L428'><i><font color='green'>             */</font></i>
<a name='L429'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L430'>            traverseproc traverse = <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(op)-&gt;tp_traverse;
<a name='L431'>            <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(gc-&gt;gc.gc_refs &gt; 0);
<a name='L432'>            gc-&gt;gc.gc_refs = <a href='../S/2676.html#L171' title='Defined at 171 in Modules/gcmodule.c.'>GC_REACHABLE</a>;
<a name='L433'>            (<b>void</b>) traverse(op,
<a name='L434'>                            (visitproc)<a href='../S/2676.html#L354' title='Defined at 354 in Modules/gcmodule.c.'>visit_reachable</a>,
<a name='L435'>                            (<b>void</b> *)young);
<a name='L436'>            next = gc-&gt;gc.gc_next;
<a name='L437'>            <b>if</b> (PyTuple_CheckExact(op)) <font color='red'>{</font>
<a name='L438'>                <a href='../S/2823.html#L160' title='Defined at 160 in Objects/tupleobject.c.'>_PyTuple_MaybeUntrack</a>(op);
<a name='L439'>            <font color='red'>}</font>
<a name='L440'>            <b>else</b> <b>if</b> (<a href='../D/3104.html' title='Multiple defined in 2 places.'>PyDict_CheckExact</a>(op)) <font color='red'>{</font>
<a name='L441'>                <a href='../S/2787.html#L489' title='Defined at 489 in Objects/dictobject.c.'>_PyDict_MaybeUntrack</a>(op);
<a name='L442'>            <font color='red'>}</font>
<a name='L443'>        <font color='red'>}</font>
<a name='L444'>        <b>else</b> <font color='red'>{</font>
<a name='L445'>            <i><font color='green'>/* This *may* be unreachable.  To make progress,</font></i>
<a name='L446'><i><font color='green'>             * assume it is.  gc isn't directly reachable from</font></i>
<a name='L447'><i><font color='green'>             * any object we've already traversed, but may be</font></i>
<a name='L448'><i><font color='green'>             * reachable from an object we haven't gotten to yet.</font></i>
<a name='L449'><i><font color='green'>             * visit_reachable will eventually move gc back into</font></i>
<a name='L450'><i><font color='green'>             * young if that's so, and we'll see it again.</font></i>
<a name='L451'><i><font color='green'>             */</font></i>
<a name='L452'>            next = gc-&gt;gc.gc_next;
<a name='L453'>            <a href='../S/2676.html#L221' title='Defined at 221 in Modules/gcmodule.c.'>gc_list_move</a>(gc, unreachable);
<a name='L454'>            gc-&gt;gc.gc_refs = <a href='../S/2676.html#L172' title='Defined at 172 in Modules/gcmodule.c.'>GC_TENTATIVELY_UNREACHABLE</a>;
<a name='L455'>        <font color='red'>}</font>
<a name='L456'>        gc = next;
<a name='L457'>    <font color='red'>}</font>
<a name='L458'><font color='red'>}</font>
<a name='L459'>
<a name='L460'><i><font color='green'>/* Return true if object has a finalization method. */</font></i>
<a name='L461'><b>static</b> <b>int</b>
<a name='L462'><a href='../R/8258.html' title='Multiple refered from 2 places.'>has_finalizer</a>(PyObject *op)
<a name='L463'><font color='red'>{</font>
<a name='L464'>    <b>if</b> (PyGen_CheckExact(op))
<a name='L465'>        <b>return</b> <a href='../S/2794.html#L393' title='Defined at 393 in Objects/genobject.c.'>PyGen_NeedsFinalizing</a>((<a href='../S/528.html#L28' title='Defined at 28 in Include/genobject.h.'>PyGenObject</a> *)op);
<a name='L466'>    <b>else</b>
<a name='L467'>        <b>return</b> op-&gt;ob_type-&gt;tp_del != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L468'><font color='red'>}</font>
<a name='L469'>
<a name='L470'><i><font color='green'>/* Move the objects in unreachable with __del__ methods into `finalizers`.</font></i>
<a name='L471'><i><font color='green'> * Objects moved into `finalizers` have gc_refs set to GC_REACHABLE; the</font></i>
<a name='L472'><i><font color='green'> * objects remaining in unreachable are left at GC_TENTATIVELY_UNREACHABLE.</font></i>
<a name='L473'><i><font color='green'> */</font></i>
<a name='L474'><b>static</b> <b>void</b>
<a name='L475'><a href='../S/2676.html#L872' title='Refered from 872 in Modules/gcmodule.c.'>move_finalizers</a>(PyGC_Head *unreachable, PyGC_Head *finalizers)
<a name='L476'><font color='red'>{</font>
<a name='L477'>    PyGC_Head *gc;
<a name='L478'>    PyGC_Head *next;
<a name='L479'>
<a name='L480'>    <i><font color='green'>/* March over unreachable.  Move objects with finalizers into</font></i>
<a name='L481'><i><font color='green'>     * `finalizers`.</font></i>
<a name='L482'><i><font color='green'>     */</font></i>
<a name='L483'>    <b>for</b> (gc = unreachable-&gt;gc.gc_next; gc != unreachable; gc = next) <font color='red'>{</font>
<a name='L484'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L485'>
<a name='L486'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../S/2676.html#L176' title='Defined at 176 in Modules/gcmodule.c.'>IS_TENTATIVELY_UNREACHABLE</a>(op));
<a name='L487'>        next = gc-&gt;gc.gc_next;
<a name='L488'>
<a name='L489'>        <b>if</b> (<a href='../S/2676.html#L462' title='Defined at 462 in Modules/gcmodule.c.'>has_finalizer</a>(op)) <font color='red'>{</font>
<a name='L490'>            <a href='../S/2676.html#L221' title='Defined at 221 in Modules/gcmodule.c.'>gc_list_move</a>(gc, finalizers);
<a name='L491'>            gc-&gt;gc.gc_refs = <a href='../S/2676.html#L171' title='Defined at 171 in Modules/gcmodule.c.'>GC_REACHABLE</a>;
<a name='L492'>        <font color='red'>}</font>
<a name='L493'>    <font color='red'>}</font>
<a name='L494'><font color='red'>}</font>
<a name='L495'>
<a name='L496'><i><font color='green'>/* A traversal callback for move_finalizer_reachable. */</font></i>
<a name='L497'><b>static</b> <b>int</b>
<a name='L498'><a href='../S/2676.html#L522' title='Refered from 522 in Modules/gcmodule.c.'>visit_move</a>(PyObject *op, PyGC_Head *tolist)
<a name='L499'><font color='red'>{</font>
<a name='L500'>    <b>if</b> (PyObject_IS_GC(op)) <font color='red'>{</font>
<a name='L501'>        <b>if</b> (<a href='../S/2676.html#L176' title='Defined at 176 in Modules/gcmodule.c.'>IS_TENTATIVELY_UNREACHABLE</a>(op)) <font color='red'>{</font>
<a name='L502'>            PyGC_Head *gc = <a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(op);
<a name='L503'>            <a href='../S/2676.html#L221' title='Defined at 221 in Modules/gcmodule.c.'>gc_list_move</a>(gc, tolist);
<a name='L504'>            gc-&gt;gc.gc_refs = <a href='../S/2676.html#L171' title='Defined at 171 in Modules/gcmodule.c.'>GC_REACHABLE</a>;
<a name='L505'>        <font color='red'>}</font>
<a name='L506'>    <font color='red'>}</font>
<a name='L507'>    <b>return</b> 0;
<a name='L508'><font color='red'>}</font>
<a name='L509'>
<a name='L510'><i><font color='green'>/* Move objects that are reachable from finalizers, from the unreachable set</font></i>
<a name='L511'><i><font color='green'> * into finalizers set.</font></i>
<a name='L512'><i><font color='green'> */</font></i>
<a name='L513'><b>static</b> <b>void</b>
<a name='L514'><a href='../S/2676.html#L877' title='Refered from 877 in Modules/gcmodule.c.'>move_finalizer_reachable</a>(PyGC_Head *finalizers)
<a name='L515'><font color='red'>{</font>
<a name='L516'>    traverseproc traverse;
<a name='L517'>    PyGC_Head *gc = finalizers-&gt;gc.gc_next;
<a name='L518'>    <b>for</b> (; gc != finalizers; gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L519'>        <i><font color='green'>/* Note that the finalizers list may grow during this. */</font></i>
<a name='L520'>        traverse = <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(<a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc))-&gt;tp_traverse;
<a name='L521'>        (<b>void</b>) traverse(<a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc),
<a name='L522'>                        (visitproc)<a href='../S/2676.html#L498' title='Defined at 498 in Modules/gcmodule.c.'>visit_move</a>,
<a name='L523'>                        (<b>void</b> *)finalizers);
<a name='L524'>    <font color='red'>}</font>
<a name='L525'><font color='red'>}</font>
<a name='L526'>
<a name='L527'><i><font color='green'>/* Clear all weakrefs to unreachable objects, and if such a weakref has a</font></i>
<a name='L528'><i><font color='green'> * callback, invoke it if necessary.  Note that it's possible for such</font></i>
<a name='L529'><i><font color='green'> * weakrefs to be outside the unreachable set -- indeed, those are precisely</font></i>
<a name='L530'><i><font color='green'> * the weakrefs whose callbacks must be invoked.  See gc_weakref.txt for</font></i>
<a name='L531'><i><font color='green'> * overview &amp; some details.  Some weakrefs with callbacks may be reclaimed</font></i>
<a name='L532'><i><font color='green'> * directly by this routine; the number reclaimed is the return value.  Other</font></i>
<a name='L533'><i><font color='green'> * weakrefs with callbacks may be moved into the `old` generation.  Objects</font></i>
<a name='L534'><i><font color='green'> * moved into `old` have gc_refs set to GC_REACHABLE; the objects remaining in</font></i>
<a name='L535'><i><font color='green'> * unreachable are left at GC_TENTATIVELY_UNREACHABLE.  When this returns,</font></i>
<a name='L536'><i><font color='green'> * no object in `unreachable` is weakly referenced anymore.</font></i>
<a name='L537'><i><font color='green'> */</font></i>
<a name='L538'><b>static</b> <b>int</b>
<a name='L539'><a href='../S/2676.html#L891' title='Refered from 891 in Modules/gcmodule.c.'>handle_weakrefs</a>(PyGC_Head *unreachable, PyGC_Head *old)
<a name='L540'><font color='red'>{</font>
<a name='L541'>    PyGC_Head *gc;
<a name='L542'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op;               <i><font color='green'>/* generally FROM_GC(gc) */</font></i>
<a name='L543'>    <a href='../S/589.html#L10' title='Defined at 10 in Include/weakrefobject.h.'>PyWeakReference</a> *wr;        <i><font color='green'>/* generally a cast of op */</font></i>
<a name='L544'>    PyGC_Head wrcb_to_call;     <i><font color='green'>/* weakrefs with callbacks to call */</font></i>
<a name='L545'>    PyGC_Head *next;
<a name='L546'>    <b>int</b> num_freed = 0;
<a name='L547'>
<a name='L548'>    <a href='../S/2676.html#L182' title='Defined at 182 in Modules/gcmodule.c.'>gc_list_init</a>(&amp;wrcb_to_call);
<a name='L549'>
<a name='L550'>    <i><font color='green'>/* Clear all weakrefs to the objects in unreachable.  If such a weakref</font></i>
<a name='L551'><i><font color='green'>     * also has a callback, move it into `wrcb_to_call` if the callback</font></i>
<a name='L552'><i><font color='green'>     * needs to be invoked.  Note that we cannot invoke any callbacks until</font></i>
<a name='L553'><i><font color='green'>     * all weakrefs to unreachable objects are cleared, lest the callback</font></i>
<a name='L554'><i><font color='green'>     * resurrect an unreachable object via a still-active weakref.  We</font></i>
<a name='L555'><i><font color='green'>     * make another pass over wrcb_to_call, invoking callbacks, after this</font></i>
<a name='L556'><i><font color='green'>     * pass completes.</font></i>
<a name='L557'><i><font color='green'>     */</font></i>
<a name='L558'>    <b>for</b> (gc = unreachable-&gt;gc.gc_next; gc != unreachable; gc = next) <font color='red'>{</font>
<a name='L559'>        <a href='../S/589.html#L10' title='Defined at 10 in Include/weakrefobject.h.'>PyWeakReference</a> **wrlist;
<a name='L560'>
<a name='L561'>        op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L562'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../S/2676.html#L176' title='Defined at 176 in Modules/gcmodule.c.'>IS_TENTATIVELY_UNREACHABLE</a>(op));
<a name='L563'>        next = gc-&gt;gc.gc_next;
<a name='L564'>
<a name='L565'>        <b>if</b> (! <a href='../S/545.html#L330' title='Defined at 330 in Include/objimpl.h.'>PyType_SUPPORTS_WEAKREFS</a>(<a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(op)))
<a name='L566'>            <b>continue</b>;
<a name='L567'>
<a name='L568'>        <i><font color='green'>/* It supports weakrefs.  Does it have any? */</font></i>
<a name='L569'>        wrlist = (<a href='../S/589.html#L10' title='Defined at 10 in Include/weakrefobject.h.'>PyWeakReference</a> **)
<a name='L570'>                                <a href='../S/545.html#L332' title='Defined at 332 in Include/objimpl.h.'>PyObject_GET_WEAKREFS_LISTPTR</a>(op);
<a name='L571'>
<a name='L572'>        <i><font color='green'>/* `op` may have some weakrefs.  March over the list, clear</font></i>
<a name='L573'><i><font color='green'>         * all the weakrefs, and move the weakrefs with callbacks</font></i>
<a name='L574'><i><font color='green'>         * that must be called into wrcb_to_call.</font></i>
<a name='L575'><i><font color='green'>         */</font></i>
<a name='L576'>        <b>for</b> (wr = *wrlist; wr != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; wr = *wrlist) <font color='red'>{</font>
<a name='L577'>            PyGC_Head *wrasgc;                  <i><font color='green'>/* AS_GC(wr) */</font></i>
<a name='L578'>
<a name='L579'>            <i><font color='green'>/* _PyWeakref_ClearRef clears the weakref but leaves</font></i>
<a name='L580'><i><font color='green'>             * the callback pointer intact.  Obscure:  it also</font></i>
<a name='L581'><i><font color='green'>             * changes *wrlist.</font></i>
<a name='L582'><i><font color='green'>             */</font></i>
<a name='L583'>            <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(wr-&gt;wr_object == op);
<a name='L584'>            <a href='../S/2830.html#L90' title='Defined at 90 in Objects/weakrefobject.c.'>_PyWeakref_ClearRef</a>(wr);
<a name='L585'>            <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(wr-&gt;wr_object == Py_None);
<a name='L586'>            <b>if</b> (wr-&gt;wr_callback == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L587'>                <b>continue</b>;                       <i><font color='green'>/* no callback */</font></i>
<a name='L588'>
<a name='L589'>    <i><font color='green'>/* Headache time.  `op` is going away, and is weakly referenced by</font></i>
<a name='L590'><i><font color='green'>     * `wr`, which has a callback.  Should the callback be invoked?  If wr</font></i>
<a name='L591'><i><font color='green'>     * is also trash, no:</font></i>
<a name='L592'><i><font color='green'>     *</font></i>
<a name='L593'><i><font color='green'>     * 1. There's no need to call it.  The object and the weakref are</font></i>
<a name='L594'><i><font color='green'>     *    both going away, so it's legitimate to pretend the weakref is</font></i>
<a name='L595'><i><font color='green'>     *    going away first.  The user has to ensure a weakref outlives its</font></i>
<a name='L596'><i><font color='green'>     *    referent if they want a guarantee that the wr callback will get</font></i>
<a name='L597'><i><font color='green'>     *    invoked.</font></i>
<a name='L598'><i><font color='green'>     *</font></i>
<a name='L599'><i><font color='green'>     * 2. It may be catastrophic to call it.  If the callback is also in</font></i>
<a name='L600'><i><font color='green'>     *    cyclic trash (CT), then although the CT is unreachable from</font></i>
<a name='L601'><i><font color='green'>     *    outside the current generation, CT may be reachable from the</font></i>
<a name='L602'><i><font color='green'>     *    callback.  Then the callback could resurrect insane objects.</font></i>
<a name='L603'><i><font color='green'>     *</font></i>
<a name='L604'><i><font color='green'>     * Since the callback is never needed and may be unsafe in this case,</font></i>
<a name='L605'><i><font color='green'>     * wr is simply left in the unreachable set.  Note that because we</font></i>
<a name='L606'><i><font color='green'>     * already called _PyWeakref_ClearRef(wr), its callback will never</font></i>
<a name='L607'><i><font color='green'>     * trigger.</font></i>
<a name='L608'><i><font color='green'>     *</font></i>
<a name='L609'><i><font color='green'>     * OTOH, if wr isn't part of CT, we should invoke the callback:  the</font></i>
<a name='L610'><i><font color='green'>     * weakref outlived the trash.  Note that since wr isn't CT in this</font></i>
<a name='L611'><i><font color='green'>     * case, its callback can't be CT either -- wr acted as an external</font></i>
<a name='L612'><i><font color='green'>     * root to this generation, and therefore its callback did too.  So</font></i>
<a name='L613'><i><font color='green'>     * nothing in CT is reachable from the callback either, so it's hard</font></i>
<a name='L614'><i><font color='green'>     * to imagine how calling it later could create a problem for us.  wr</font></i>
<a name='L615'><i><font color='green'>     * is moved to wrcb_to_call in this case.</font></i>
<a name='L616'><i><font color='green'>     */</font></i>
<a name='L617'>            <b>if</b> (<a href='../S/2676.html#L176' title='Defined at 176 in Modules/gcmodule.c.'>IS_TENTATIVELY_UNREACHABLE</a>(wr))
<a name='L618'>                <b>continue</b>;
<a name='L619'>            <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../S/2676.html#L175' title='Defined at 175 in Modules/gcmodule.c.'>IS_REACHABLE</a>(wr));
<a name='L620'>
<a name='L621'>            <i><font color='green'>/* Create a new reference so that wr can't go away</font></i>
<a name='L622'><i><font color='green'>             * before we can process it again.</font></i>
<a name='L623'><i><font color='green'>             */</font></i>
<a name='L624'>            Py_INCREF(wr);
<a name='L625'>
<a name='L626'>            <i><font color='green'>/* Move wr to wrcb_to_call, for the next pass. */</font></i>
<a name='L627'>            wrasgc = <a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(wr);
<a name='L628'>            <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(wrasgc != next); <i><font color='green'>/* wrasgc is reachable, but</font></i>
<a name='L629'><i><font color='green'>                                       next isn't, so they can't</font></i>
<a name='L630'><i><font color='green'>                                       be the same */</font></i>
<a name='L631'>            <a href='../S/2676.html#L221' title='Defined at 221 in Modules/gcmodule.c.'>gc_list_move</a>(wrasgc, &amp;wrcb_to_call);
<a name='L632'>        <font color='red'>}</font>
<a name='L633'>    <font color='red'>}</font>
<a name='L634'>
<a name='L635'>    <i><font color='green'>/* Invoke the callbacks we decided to honor.  It's safe to invoke them</font></i>
<a name='L636'><i><font color='green'>     * because they can't reference unreachable objects.</font></i>
<a name='L637'><i><font color='green'>     */</font></i>
<a name='L638'>    <b>while</b> (! <a href='../S/2676.html#L189' title='Defined at 189 in Modules/gcmodule.c.'>gc_list_is_empty</a>(&amp;wrcb_to_call)) <font color='red'>{</font>
<a name='L639'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *temp;
<a name='L640'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../D/7341.html' title='Multiple defined in 2 places.'>callback</a>;
<a name='L641'>
<a name='L642'>        gc = wrcb_to_call.gc.gc_next;
<a name='L643'>        op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L644'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../S/2676.html#L175' title='Defined at 175 in Modules/gcmodule.c.'>IS_REACHABLE</a>(op));
<a name='L645'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../S/589.html#L57' title='Defined at 57 in Include/weakrefobject.h.'>PyWeakref_Check</a>(op));
<a name='L646'>        wr = (<a href='../S/589.html#L10' title='Defined at 10 in Include/weakrefobject.h.'>PyWeakReference</a> *)op;
<a name='L647'>        <a href='../D/7341.html' title='Multiple defined in 2 places.'>callback</a> = wr-&gt;wr_callback;
<a name='L648'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../D/7341.html' title='Multiple defined in 2 places.'>callback</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L649'>
<a name='L650'>        <i><font color='green'>/* copy-paste of weakrefobject.c's handle_callback() */</font></i>
<a name='L651'>        temp = <a href='../S/2775.html#L2358' title='Defined at 2358 in Objects/abstract.c.'>PyObject_CallFunctionObjArgs</a>(<a href='../D/7341.html' title='Multiple defined in 2 places.'>callback</a>, wr, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L652'>        <b>if</b> (temp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L653'>            <a href='../S/3106.html#L708' title='Defined at 708 in Python/errors.c.'>PyErr_WriteUnraisable</a>(<a href='../D/7341.html' title='Multiple defined in 2 places.'>callback</a>);
<a name='L654'>        <b>else</b>
<a name='L655'>            Py_DECREF(temp);
<a name='L656'>
<a name='L657'>        <i><font color='green'>/* Give up the reference we created in the first pass.  When</font></i>
<a name='L658'><i><font color='green'>         * op's refcount hits 0 (which it may or may not do right now),</font></i>
<a name='L659'><i><font color='green'>         * op's tp_dealloc will decref op-&gt;wr_callback too.  Note</font></i>
<a name='L660'><i><font color='green'>         * that the refcount probably will hit 0 now, and because this</font></i>
<a name='L661'><i><font color='green'>         * weakref was reachable to begin with, gc didn't already</font></i>
<a name='L662'><i><font color='green'>         * add it to its count of freed objects.  Example:  a reachable</font></i>
<a name='L663'><i><font color='green'>         * weak value dict maps some key to this reachable weakref.</font></i>
<a name='L664'><i><font color='green'>         * The callback removes this key-&gt;weakref mapping from the</font></i>
<a name='L665'><i><font color='green'>         * dict, leaving no other references to the weakref (excepting</font></i>
<a name='L666'><i><font color='green'>         * ours).</font></i>
<a name='L667'><i><font color='green'>         */</font></i>
<a name='L668'>        Py_DECREF(op);
<a name='L669'>        <b>if</b> (wrcb_to_call.gc.gc_next == gc) <font color='red'>{</font>
<a name='L670'>            <i><font color='green'>/* object is still alive -- move it */</font></i>
<a name='L671'>            <a href='../S/2676.html#L221' title='Defined at 221 in Modules/gcmodule.c.'>gc_list_move</a>(gc, old);
<a name='L672'>        <font color='red'>}</font>
<a name='L673'>        <b>else</b>
<a name='L674'>            ++num_freed;
<a name='L675'>    <font color='red'>}</font>
<a name='L676'>
<a name='L677'>    <b>return</b> num_freed;
<a name='L678'><font color='red'>}</font>
<a name='L679'>
<a name='L680'><b>static</b> <b>void</b>
<a name='L681'><a href='../R/7186.html' title='Multiple refered from 2 places.'>debug_cycle</a>(<b>char</b> *msg, PyObject *op)
<a name='L682'><font color='red'>{</font>
<a name='L683'>    <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("gc: %.100s &lt;%.100s %p&gt;\n",
<a name='L684'>                      msg, <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(op)-&gt;tp_name, op);
<a name='L685'><font color='red'>}</font>
<a name='L686'>
<a name='L687'><i><font color='green'>/* Handle uncollectable garbage (cycles with finalizers, and stuff reachable</font></i>
<a name='L688'><i><font color='green'> * only from such cycles).</font></i>
<a name='L689'><i><font color='green'> * If DEBUG_SAVEALL, all objects in finalizers are appended to the module</font></i>
<a name='L690'><i><font color='green'> * garbage list (a Python list), else only the objects in finalizers with</font></i>
<a name='L691'><i><font color='green'> * __del__ methods are appended to garbage.  All objects in finalizers are</font></i>
<a name='L692'><i><font color='green'> * merged into the old list regardless.</font></i>
<a name='L693'><i><font color='green'> * Returns 0 if all OK, &lt;0 on error (out of memory to grow the garbage list).</font></i>
<a name='L694'><i><font color='green'> * The finalizers list is made empty on a successful return.</font></i>
<a name='L695'><i><font color='green'> */</font></i>
<a name='L696'><b>static</b> <b>int</b>
<a name='L697'><a href='../S/2676.html#L928' title='Refered from 928 in Modules/gcmodule.c.'>handle_finalizers</a>(PyGC_Head *finalizers, PyGC_Head *old)
<a name='L698'><font color='red'>{</font>
<a name='L699'>    PyGC_Head *gc = finalizers-&gt;gc.gc_next;
<a name='L700'>
<a name='L701'>    <b>if</b> (garbage == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L702'>        garbage = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L703'>        <b>if</b> (garbage == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L704'>            <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("gc couldn't create gc.garbage list");
<a name='L705'>    <font color='red'>}</font>
<a name='L706'>    <b>for</b> (; gc != finalizers; gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L707'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L708'>
<a name='L709'>        <b>if</b> ((<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L124' title='Defined at 124 in Modules/gcmodule.c.'>DEBUG_SAVEALL</a>) || <a href='../S/2676.html#L462' title='Defined at 462 in Modules/gcmodule.c.'>has_finalizer</a>(op)) <font color='red'>{</font>
<a name='L710'>            <b>if</b> (<a href='../S/2796.html#L286' title='Defined at 286 in Objects/listobject.c.'>PyList_Append</a>(garbage, op) &lt; 0)
<a name='L711'>                <b>return</b> -1;
<a name='L712'>        <font color='red'>}</font>
<a name='L713'>    <font color='red'>}</font>
<a name='L714'>
<a name='L715'>    <a href='../S/2676.html#L237' title='Defined at 237 in Modules/gcmodule.c.'>gc_list_merge</a>(finalizers, old);
<a name='L716'>    <b>return</b> 0;
<a name='L717'><font color='red'>}</font>
<a name='L718'>
<a name='L719'><i><font color='green'>/* Break reference cycles by clearing the containers involved.  This is</font></i>
<a name='L720'><i><font color='green'> * tricky business as the lists can be changing and we don't know which</font></i>
<a name='L721'><i><font color='green'> * objects may be freed.  It is possible I screwed something up here.</font></i>
<a name='L722'><i><font color='green'> */</font></i>
<a name='L723'><b>static</b> <b>void</b>
<a name='L724'><a href='../S/2676.html#L897' title='Refered from 897 in Modules/gcmodule.c.'>delete_garbage</a>(PyGC_Head *collectable, PyGC_Head *old)
<a name='L725'><font color='red'>{</font>
<a name='L726'>    inquiry clear;
<a name='L727'>
<a name='L728'>    <b>while</b> (!<a href='../S/2676.html#L189' title='Defined at 189 in Modules/gcmodule.c.'>gc_list_is_empty</a>(collectable)) <font color='red'>{</font>
<a name='L729'>        PyGC_Head *gc = collectable-&gt;gc.gc_next;
<a name='L730'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L731'>
<a name='L732'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(<a href='../S/2676.html#L176' title='Defined at 176 in Modules/gcmodule.c.'>IS_TENTATIVELY_UNREACHABLE</a>(op));
<a name='L733'>        <b>if</b> (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L124' title='Defined at 124 in Modules/gcmodule.c.'>DEBUG_SAVEALL</a>) <font color='red'>{</font>
<a name='L734'>            <a href='../S/2796.html#L286' title='Defined at 286 in Objects/listobject.c.'>PyList_Append</a>(garbage, op);
<a name='L735'>        <font color='red'>}</font>
<a name='L736'>        <b>else</b> <font color='red'>{</font>
<a name='L737'>            <b>if</b> ((clear = <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(op)-&gt;tp_clear) != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L738'>                Py_INCREF(op);
<a name='L739'>                clear(op);
<a name='L740'>                Py_DECREF(op);
<a name='L741'>            <font color='red'>}</font>
<a name='L742'>        <font color='red'>}</font>
<a name='L743'>        <b>if</b> (collectable-&gt;gc.gc_next == gc) <font color='red'>{</font>
<a name='L744'>            <i><font color='green'>/* object is still alive, move it, it may die later */</font></i>
<a name='L745'>            <a href='../S/2676.html#L221' title='Defined at 221 in Modules/gcmodule.c.'>gc_list_move</a>(gc, old);
<a name='L746'>            gc-&gt;gc.gc_refs = <a href='../S/2676.html#L171' title='Defined at 171 in Modules/gcmodule.c.'>GC_REACHABLE</a>;
<a name='L747'>        <font color='red'>}</font>
<a name='L748'>    <font color='red'>}</font>
<a name='L749'><font color='red'>}</font>
<a name='L750'>
<a name='L751'><i><font color='green'>/* Clear all free lists</font></i>
<a name='L752'><i><font color='green'> * All free lists are cleared during the collection of the highest generation.</font></i>
<a name='L753'><i><font color='green'> * Allocated items in the free list may keep a pymalloc arena occupied.</font></i>
<a name='L754'><i><font color='green'> * Clearing the free lists may give back memory to the OS earlier.</font></i>
<a name='L755'><i><font color='green'> */</font></i>
<a name='L756'><b>static</b> <b>void</b>
<a name='L757'><a href='../S/2676.html#L933' title='Refered from 933 in Modules/gcmodule.c.'>clear_freelists</a>(<b>void</b>)
<a name='L758'><font color='red'>{</font>
<a name='L759'>    (<b>void</b>)<a href='../S/2782.html#L382' title='Defined at 382 in Objects/classobject.c.'>PyMethod_ClearFreeList</a>();
<a name='L760'>    (<b>void</b>)<a href='../S/2792.html#L935' title='Defined at 935 in Objects/frameobject.c.'>PyFrame_ClearFreeList</a>();
<a name='L761'>    (<b>void</b>)<a href='../S/2801.html#L286' title='Defined at 286 in Objects/methodobject.c.'>PyCFunction_ClearFreeList</a>();
<a name='L762'>    (<b>void</b>)<a href='../S/2823.html#L878' title='Defined at 878 in Objects/tupleobject.c.'>PyTuple_ClearFreeList</a>();
<a name='L763'>    (<b>void</b>)<a href='../D/3966.html' title='Multiple defined in 3 places.'>PyUnicode_ClearFreeList</a>();
<a name='L764'>    (<b>void</b>)<a href='../S/2791.html#L1946' title='Defined at 1946 in Objects/floatobject.c.'>PyFloat_ClearFreeList</a>();
<a name='L765'><font color='red'>}</font>
<a name='L766'>
<a name='L767'><b>static</b> <b>double</b>
<a name='L768'><a href='../R/8099.html' title='Multiple refered from 2 places.'>get_time</a>(<b>void</b>)
<a name='L769'><font color='red'>{</font>
<a name='L770'>    <b>double</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = 0;
<a name='L771'>    <b>if</b> (tmod != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L772'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *f = <a href='../D/3603.html' title='Multiple defined in 2 places.'>PyObject_CallMethod</a>(tmod, "time", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L773'>        <b>if</b> (f == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L774'>            <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L775'>        <font color='red'>}</font>
<a name='L776'>        <b>else</b> <font color='red'>{</font>
<a name='L777'>            <b>if</b> (PyFloat_Check(f))
<a name='L778'>                <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/2791.html#L244' title='Defined at 244 in Objects/floatobject.c.'>PyFloat_AsDouble</a>(f);
<a name='L779'>            Py_DECREF(f);
<a name='L780'>        <font color='red'>}</font>
<a name='L781'>    <font color='red'>}</font>
<a name='L782'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L783'><font color='red'>}</font>
<a name='L784'>
<a name='L785'><i><font color='green'>/* This is the main function.  Read this to understand how the</font></i>
<a name='L786'><i><font color='green'> * collection process works. */</font></i>
<a name='L787'><b>static</b> <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>
<a name='L788'><a href='../R/6815.html' title='Multiple refered from 27 places.'>collect</a>(<b>int</b> generation)
<a name='L789'><font color='red'>{</font>
<a name='L790'>    <b>int</b> i;
<a name='L791'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> m = 0; <i><font color='green'>/* # objects collected */</font></i>
<a name='L792'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> n = 0; <i><font color='green'>/* # unreachable objects that couldn't be collected */</font></i>
<a name='L793'>    PyGC_Head *young; <i><font color='green'>/* the generation we are examining */</font></i>
<a name='L794'>    PyGC_Head *old; <i><font color='green'>/* next older generation */</font></i>
<a name='L795'>    PyGC_Head unreachable; <i><font color='green'>/* non-problematic unreachable trash */</font></i>
<a name='L796'>    PyGC_Head finalizers;  <i><font color='green'>/* objects with, &amp; reachable from, __del__ */</font></i>
<a name='L797'>    PyGC_Head *gc;
<a name='L798'>    <b>double</b> <a href='../S/2333.html#L123' title='Defined at 123 in Modules/_ctypes/libffi/src/mips/ffitarget.h.'>t1</a> = 0.0;
<a name='L799'>
<a name='L800'>    <b>if</b> (delstr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L801'>        delstr = <a href='../S/2828.html#L10060' title='Defined at 10060 in Objects/unicodeobject.c.'>PyUnicode_InternFromString</a>("__del__");
<a name='L802'>        <b>if</b> (delstr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L803'>            <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("gc couldn't allocate \"__del__\"");
<a name='L804'>    <font color='red'>}</font>
<a name='L805'>
<a name='L806'>    <b>if</b> (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L121' title='Defined at 121 in Modules/gcmodule.c.'>DEBUG_STATS</a>) <font color='red'>{</font>
<a name='L807'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("gc: collecting generation %d...\n",
<a name='L808'>                          generation);
<a name='L809'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("gc: objects in each generation:");
<a name='L810'>        <b>for</b> (i = 0; i &lt; <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>; i++)
<a name='L811'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(" %" <a href='../D/2597.html' title='Multiple defined in 4 places.'>PY_FORMAT_SIZE_T</a> "d",
<a name='L812'>                              <a href='../S/2676.html#L252' title='Defined at 252 in Modules/gcmodule.c.'>gc_list_size</a>(<a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(i)));
<a name='L813'>        <a href='../S/2333.html#L123' title='Defined at 123 in Modules/_ctypes/libffi/src/mips/ffitarget.h.'>t1</a> = <a href='../S/2676.html#L768' title='Defined at 768 in Modules/gcmodule.c.'>get_time</a>();
<a name='L814'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("\n");
<a name='L815'>    <font color='red'>}</font>
<a name='L816'>
<a name='L817'>    <i><font color='green'>/* update collection and allocation counters */</font></i>
<a name='L818'>    <b>if</b> (generation+1 &lt; <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>)
<a name='L819'>        generations[generation+1].count += 1;
<a name='L820'>    <b>for</b> (i = 0; i &lt;= generation; i++)
<a name='L821'>        generations[i].count = 0;
<a name='L822'>
<a name='L823'>    <i><font color='green'>/* merge younger generations with one we are currently collecting */</font></i>
<a name='L824'>    <b>for</b> (i = 0; i &lt; generation; i++) <font color='red'>{</font>
<a name='L825'>        <a href='../S/2676.html#L237' title='Defined at 237 in Modules/gcmodule.c.'>gc_list_merge</a>(<a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(i), <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(generation));
<a name='L826'>    <font color='red'>}</font>
<a name='L827'>
<a name='L828'>    <i><font color='green'>/* handy references */</font></i>
<a name='L829'>    young = <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(generation);
<a name='L830'>    <b>if</b> (generation &lt; <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>-1)
<a name='L831'>        old = <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(generation+1);
<a name='L832'>    <b>else</b>
<a name='L833'>        old = young;
<a name='L834'>
<a name='L835'>    <i><font color='green'>/* Using ob_refcnt and gc_refs, calculate which objects in the</font></i>
<a name='L836'><i><font color='green'>     * container set are reachable from outside the set (i.e., have a</font></i>
<a name='L837'><i><font color='green'>     * refcount greater than 0 when all the references within the</font></i>
<a name='L838'><i><font color='green'>     * set are taken into account).</font></i>
<a name='L839'><i><font color='green'>     */</font></i>
<a name='L840'>    <a href='../S/2676.html#L288' title='Defined at 288 in Modules/gcmodule.c.'>update_refs</a>(young);
<a name='L841'>    <a href='../S/2676.html#L340' title='Defined at 340 in Modules/gcmodule.c.'>subtract_refs</a>(young);
<a name='L842'>
<a name='L843'>    <i><font color='green'>/* Leave everything reachable from outside young in young, and move</font></i>
<a name='L844'><i><font color='green'>     * everything else (in young) to unreachable.</font></i>
<a name='L845'><i><font color='green'>     * NOTE:  This used to move the reachable objects into a reachable</font></i>
<a name='L846'><i><font color='green'>     * set instead.  But most things usually turn out to be reachable,</font></i>
<a name='L847'><i><font color='green'>     * so it's more efficient to move the unreachable things.</font></i>
<a name='L848'><i><font color='green'>     */</font></i>
<a name='L849'>    <a href='../S/2676.html#L182' title='Defined at 182 in Modules/gcmodule.c.'>gc_list_init</a>(&amp;unreachable);
<a name='L850'>    <a href='../S/2676.html#L404' title='Defined at 404 in Modules/gcmodule.c.'>move_unreachable</a>(young, &amp;unreachable);
<a name='L851'>
<a name='L852'>    <i><font color='green'>/* Move reachable objects to next generation. */</font></i>
<a name='L853'>    <b>if</b> (young != old) <font color='red'>{</font>
<a name='L854'>        <b>if</b> (generation == <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a> - 2) <font color='red'>{</font>
<a name='L855'>            long_lived_pending += <a href='../S/2676.html#L252' title='Defined at 252 in Modules/gcmodule.c.'>gc_list_size</a>(young);
<a name='L856'>        <font color='red'>}</font>
<a name='L857'>        <a href='../S/2676.html#L237' title='Defined at 237 in Modules/gcmodule.c.'>gc_list_merge</a>(young, old);
<a name='L858'>    <font color='red'>}</font>
<a name='L859'>    <b>else</b> <font color='red'>{</font>
<a name='L860'>        long_lived_pending = 0;
<a name='L861'>        long_lived_total = <a href='../S/2676.html#L252' title='Defined at 252 in Modules/gcmodule.c.'>gc_list_size</a>(young);
<a name='L862'>    <font color='red'>}</font>
<a name='L863'>
<a name='L864'>    <i><font color='green'>/* All objects in unreachable are trash, but objects reachable from</font></i>
<a name='L865'><i><font color='green'>     * finalizers can't safely be deleted.  Python programmers should take</font></i>
<a name='L866'><i><font color='green'>     * care not to create such things.  For Python, finalizers means</font></i>
<a name='L867'><i><font color='green'>     * instance objects with __del__ methods.  Weakrefs with callbacks</font></i>
<a name='L868'><i><font color='green'>     * can also call arbitrary Python code but they will be dealt with by</font></i>
<a name='L869'><i><font color='green'>     * handle_weakrefs().</font></i>
<a name='L870'><i><font color='green'>     */</font></i>
<a name='L871'>    <a href='../S/2676.html#L182' title='Defined at 182 in Modules/gcmodule.c.'>gc_list_init</a>(&amp;finalizers);
<a name='L872'>    <a href='../S/2676.html#L475' title='Defined at 475 in Modules/gcmodule.c.'>move_finalizers</a>(&amp;unreachable, &amp;finalizers);
<a name='L873'>    <i><font color='green'>/* finalizers contains the unreachable objects with a finalizer;</font></i>
<a name='L874'><i><font color='green'>     * unreachable objects reachable *from* those are also uncollectable,</font></i>
<a name='L875'><i><font color='green'>     * and we move those into the finalizers list too.</font></i>
<a name='L876'><i><font color='green'>     */</font></i>
<a name='L877'>    <a href='../S/2676.html#L514' title='Defined at 514 in Modules/gcmodule.c.'>move_finalizer_reachable</a>(&amp;finalizers);
<a name='L878'>
<a name='L879'>    <i><font color='green'>/* Collect statistics on collectable objects found and print</font></i>
<a name='L880'><i><font color='green'>     * debugging information.</font></i>
<a name='L881'><i><font color='green'>     */</font></i>
<a name='L882'>    <b>for</b> (gc = unreachable.gc.gc_next; gc != &amp;unreachable;
<a name='L883'>                    gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L884'>        m++;
<a name='L885'>        <b>if</b> (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L122' title='Defined at 122 in Modules/gcmodule.c.'>DEBUG_COLLECTABLE</a>) <font color='red'>{</font>
<a name='L886'>            <a href='../S/2676.html#L681' title='Defined at 681 in Modules/gcmodule.c.'>debug_cycle</a>("collectable", <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc));
<a name='L887'>        <font color='red'>}</font>
<a name='L888'>    <font color='red'>}</font>
<a name='L889'>
<a name='L890'>    <i><font color='green'>/* Clear weakrefs and invoke callbacks as necessary. */</font></i>
<a name='L891'>    m += <a href='../S/2676.html#L539' title='Defined at 539 in Modules/gcmodule.c.'>handle_weakrefs</a>(&amp;unreachable, old);
<a name='L892'>
<a name='L893'>    <i><font color='green'>/* Call tp_clear on objects in the unreachable set.  This will cause</font></i>
<a name='L894'><i><font color='green'>     * the reference cycles to be broken.  It may also cause some objects</font></i>
<a name='L895'><i><font color='green'>     * in finalizers to be freed.</font></i>
<a name='L896'><i><font color='green'>     */</font></i>
<a name='L897'>    <a href='../S/2676.html#L724' title='Defined at 724 in Modules/gcmodule.c.'>delete_garbage</a>(&amp;unreachable, old);
<a name='L898'>
<a name='L899'>    <i><font color='green'>/* Collect statistics on uncollectable objects found and print</font></i>
<a name='L900'><i><font color='green'>     * debugging information. */</font></i>
<a name='L901'>    <b>for</b> (gc = finalizers.gc.gc_next;
<a name='L902'>         gc != &amp;finalizers;
<a name='L903'>         gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L904'>        n++;
<a name='L905'>        <b>if</b> (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L123' title='Defined at 123 in Modules/gcmodule.c.'>DEBUG_UNCOLLECTABLE</a>)
<a name='L906'>            <a href='../S/2676.html#L681' title='Defined at 681 in Modules/gcmodule.c.'>debug_cycle</a>("uncollectable", <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc));
<a name='L907'>    <font color='red'>}</font>
<a name='L908'>    <b>if</b> (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L121' title='Defined at 121 in Modules/gcmodule.c.'>DEBUG_STATS</a>) <font color='red'>{</font>
<a name='L909'>        <b>double</b> <a href='../S/2333.html#L124' title='Defined at 124 in Modules/_ctypes/libffi/src/mips/ffitarget.h.'>t2</a> = <a href='../S/2676.html#L768' title='Defined at 768 in Modules/gcmodule.c.'>get_time</a>();
<a name='L910'>        <b>if</b> (m == 0 &amp;&amp; n == 0)
<a name='L911'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("gc: done");
<a name='L912'>        <b>else</b>
<a name='L913'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L914'>                "gc: done, "
<a name='L915'>                "%" <a href='../D/2597.html' title='Multiple defined in 4 places.'>PY_FORMAT_SIZE_T</a> "d unreachable, "
<a name='L916'>                "%" <a href='../D/2597.html' title='Multiple defined in 4 places.'>PY_FORMAT_SIZE_T</a> "d uncollectable",
<a name='L917'>                n+m, n);
<a name='L918'>        <b>if</b> (<a href='../S/2333.html#L123' title='Defined at 123 in Modules/_ctypes/libffi/src/mips/ffitarget.h.'>t1</a> &amp;&amp; <a href='../S/2333.html#L124' title='Defined at 124 in Modules/_ctypes/libffi/src/mips/ffitarget.h.'>t2</a>) <font color='red'>{</font>
<a name='L919'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(", %.4fs elapsed", <a href='../S/2333.html#L124' title='Defined at 124 in Modules/_ctypes/libffi/src/mips/ffitarget.h.'>t2</a>-<a href='../S/2333.html#L123' title='Defined at 123 in Modules/_ctypes/libffi/src/mips/ffitarget.h.'>t1</a>);
<a name='L920'>        <font color='red'>}</font>
<a name='L921'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(".\n");
<a name='L922'>    <font color='red'>}</font>
<a name='L923'>
<a name='L924'>    <i><font color='green'>/* Append instances in the uncollectable set to a Python</font></i>
<a name='L925'><i><font color='green'>     * reachable list of garbage.  The programmer has to deal with</font></i>
<a name='L926'><i><font color='green'>     * this if they insist on creating this type of structure.</font></i>
<a name='L927'><i><font color='green'>     */</font></i>
<a name='L928'>    (<b>void</b>)<a href='../S/2676.html#L697' title='Defined at 697 in Modules/gcmodule.c.'>handle_finalizers</a>(&amp;finalizers, old);
<a name='L929'>
<a name='L930'>    <i><font color='green'>/* Clear free list only during the collection of the highest</font></i>
<a name='L931'><i><font color='green'>     * generation */</font></i>
<a name='L932'>    <b>if</b> (generation == <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>-1) <font color='red'>{</font>
<a name='L933'>        <a href='../S/2676.html#L757' title='Defined at 757 in Modules/gcmodule.c.'>clear_freelists</a>();
<a name='L934'>    <font color='red'>}</font>
<a name='L935'>
<a name='L936'>    <b>if</b> (<a href='../D/3154.html' title='Multiple defined in 2 places.'>PyErr_Occurred</a>()) <font color='red'>{</font>
<a name='L937'>        <b>if</b> (gc_str == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L938'>            gc_str = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>("garbage collection");
<a name='L939'>        <a href='../S/3106.html#L708' title='Defined at 708 in Python/errors.c.'>PyErr_WriteUnraisable</a>(gc_str);
<a name='L940'>        <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("unexpected exception during garbage collection");
<a name='L941'>    <font color='red'>}</font>
<a name='L942'>    <b>return</b> n+m;
<a name='L943'><font color='red'>}</font>
<a name='L944'>
<a name='L945'><b>static</b> <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>
<a name='L946'><a href='../S/2676.html#L1462' title='Refered from 1462 in Modules/gcmodule.c.'>collect_generations</a>(<b>void</b>)
<a name='L947'><font color='red'>{</font>
<a name='L948'>    <b>int</b> i;
<a name='L949'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> n = 0;
<a name='L950'>
<a name='L951'>    <i><font color='green'>/* Find the oldest generation (highest numbered) where the count</font></i>
<a name='L952'><i><font color='green'>     * exceeds the threshold.  Objects in the that generation and</font></i>
<a name='L953'><i><font color='green'>     * generations younger than it will be collected. */</font></i>
<a name='L954'>    <b>for</b> (i = <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>-1; i &gt;= 0; i--) <font color='red'>{</font>
<a name='L955'>        <b>if</b> (generations[i].count &gt; generations[i].threshold) <font color='red'>{</font>
<a name='L956'>            <i><font color='green'>/* Avoid quadratic performance degradation in number</font></i>
<a name='L957'><i><font color='green'>               of tracked objects. See comments at the beginning</font></i>
<a name='L958'><i><font color='green'>               of this file, and issue #4074.</font></i>
<a name='L959'><i><font color='green'>            */</font></i>
<a name='L960'>            <b>if</b> (i == <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a> - 1
<a name='L961'>                &amp;&amp; long_lived_pending &lt; long_lived_total / 4)
<a name='L962'>                <b>continue</b>;
<a name='L963'>            n = <a href='../S/2676.html#L788' title='Defined at 788 in Modules/gcmodule.c.'>collect</a>(i);
<a name='L964'>            <b>break</b>;
<a name='L965'>        <font color='red'>}</font>
<a name='L966'>    <font color='red'>}</font>
<a name='L967'>    <b>return</b> n;
<a name='L968'><font color='red'>}</font>
<a name='L969'>
<a name='L970'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_enable__doc__,
<a name='L971'>"enable() -&gt; None\n"
<a name='L972'>"\n"
<a name='L973'>"Enable automatic garbage collection.\n");
<a name='L974'>
<a name='L975'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L976'><a href='../S/2676.html#L1277' title='Refered from 1277 in Modules/gcmodule.c.'>gc_enable</a>(PyObject *self, PyObject *noargs)
<a name='L977'><font color='red'>{</font>
<a name='L978'>    enabled = 1;
<a name='L979'>    Py_INCREF(Py_None);
<a name='L980'>    <b>return</b> Py_None;
<a name='L981'><font color='red'>}</font>
<a name='L982'>
<a name='L983'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_disable__doc__,
<a name='L984'>"disable() -&gt; None\n"
<a name='L985'>"\n"
<a name='L986'>"Disable automatic garbage collection.\n");
<a name='L987'>
<a name='L988'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L989'><a href='../S/2676.html#L1278' title='Refered from 1278 in Modules/gcmodule.c.'>gc_disable</a>(PyObject *self, PyObject *noargs)
<a name='L990'><font color='red'>{</font>
<a name='L991'>    enabled = 0;
<a name='L992'>    Py_INCREF(Py_None);
<a name='L993'>    <b>return</b> Py_None;
<a name='L994'><font color='red'>}</font>
<a name='L995'>
<a name='L996'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_isenabled__doc__,
<a name='L997'>"isenabled() -&gt; status\n"
<a name='L998'>"\n"
<a name='L999'>"Returns true if automatic garbage collection is enabled.\n");
<a name='L1000'>
<a name='L1001'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1002'><a href='../S/2676.html#L1279' title='Refered from 1279 in Modules/gcmodule.c.'>gc_isenabled</a>(PyObject *self, PyObject *noargs)
<a name='L1003'><font color='red'>{</font>
<a name='L1004'>    <b>return</b> <a href='../D/2761.html' title='Multiple defined in 2 places.'>PyBool_FromLong</a>((<b>long</b>)enabled);
<a name='L1005'><font color='red'>}</font>
<a name='L1006'>
<a name='L1007'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_collect__doc__,
<a name='L1008'>"collect([generation]) -&gt; n\n"
<a name='L1009'>"\n"
<a name='L1010'>"With no arguments, run a full collection.  The optional argument\n"
<a name='L1011'>"may be an integer specifying which generation to collect.  A ValueError\n"
<a name='L1012'>"is raised if the generation number is invalid.\n\n"
<a name='L1013'>"The number of unreachable objects is returned.\n");
<a name='L1014'>
<a name='L1015'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1016'><a href='../S/2676.html#L1285' title='Refered from 1285 in Modules/gcmodule.c.'>gc_collect</a>(PyObject *self, PyObject *args, PyObject *kws)
<a name='L1017'><font color='red'>{</font>
<a name='L1018'>    <b>static</b> <b>char</b> *keywords[] = <font color='red'>{</font>"generation", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L1019'>    <b>int</b> genarg = <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a> - 1;
<a name='L1020'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> n;
<a name='L1021'>
<a name='L1022'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kws, "|i", keywords, &amp;genarg))
<a name='L1023'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1024'>
<a name='L1025'>    <b>else</b> <b>if</b> (genarg &lt; 0 || genarg &gt;= <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>) <font color='red'>{</font>
<a name='L1026'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError, "invalid generation");
<a name='L1027'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1028'>    <font color='red'>}</font>
<a name='L1029'>
<a name='L1030'>    <b>if</b> (collecting)
<a name='L1031'>        n = 0; <i><font color='green'>/* already collecting, don't do anything */</font></i>
<a name='L1032'>    <b>else</b> <font color='red'>{</font>
<a name='L1033'>        collecting = 1;
<a name='L1034'>        n = <a href='../S/2676.html#L788' title='Defined at 788 in Modules/gcmodule.c.'>collect</a>(genarg);
<a name='L1035'>        collecting = 0;
<a name='L1036'>    <font color='red'>}</font>
<a name='L1037'>
<a name='L1038'>    <b>return</b> <a href='../D/3469.html' title='Multiple defined in 2 places.'>PyLong_FromSsize_t</a>(n);
<a name='L1039'><font color='red'>}</font>
<a name='L1040'>
<a name='L1041'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_set_debug__doc__,
<a name='L1042'>"set_debug(flags) -&gt; None\n"
<a name='L1043'>"\n"
<a name='L1044'>"Set the garbage collection debugging flags. Debugging information is\n"
<a name='L1045'>"written to sys.stderr.\n"
<a name='L1046'>"\n"
<a name='L1047'>"flags is an integer and can have the following bits turned on:\n"
<a name='L1048'>"\n"
<a name='L1049'>"  DEBUG_STATS - Print statistics during collection.\n"
<a name='L1050'>"  DEBUG_COLLECTABLE - Print collectable objects found.\n"
<a name='L1051'>"  DEBUG_UNCOLLECTABLE - Print unreachable but uncollectable objects found.\n"
<a name='L1052'>"  DEBUG_SAVEALL - Save objects to gc.garbage rather than freeing them.\n"
<a name='L1053'>"  DEBUG_LEAK - Debug leaking programs (everything but STATS).\n");
<a name='L1054'>
<a name='L1055'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1056'><a href='../S/2676.html#L1280' title='Refered from 1280 in Modules/gcmodule.c.'>gc_set_debug</a>(PyObject *self, PyObject *args)
<a name='L1057'><font color='red'>{</font>
<a name='L1058'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "i:set_debug", &amp;<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a>))
<a name='L1059'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1060'>
<a name='L1061'>    Py_INCREF(Py_None);
<a name='L1062'>    <b>return</b> Py_None;
<a name='L1063'><font color='red'>}</font>
<a name='L1064'>
<a name='L1065'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_get_debug__doc__,
<a name='L1066'>"get_debug() -&gt; flags\n"
<a name='L1067'>"\n"
<a name='L1068'>"Get the garbage collection debugging flags.\n");
<a name='L1069'>
<a name='L1070'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1071'><a href='../S/2676.html#L1281' title='Refered from 1281 in Modules/gcmodule.c.'>gc_get_debug</a>(PyObject *self, PyObject *noargs)
<a name='L1072'><font color='red'>{</font>
<a name='L1073'>    <b>return</b> <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("i", <a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a>);
<a name='L1074'><font color='red'>}</font>
<a name='L1075'>
<a name='L1076'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_set_thresh__doc__,
<a name='L1077'>"set_threshold(threshold0, [threshold1, threshold2]) -&gt; None\n"
<a name='L1078'>"\n"
<a name='L1079'>"Sets the collection thresholds.  Setting threshold0 to zero disables\n"
<a name='L1080'>"collection.\n");
<a name='L1081'>
<a name='L1082'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1083'><a href='../S/2676.html#L1283' title='Refered from 1283 in Modules/gcmodule.c.'>gc_set_thresh</a>(PyObject *self, PyObject *args)
<a name='L1084'><font color='red'>{</font>
<a name='L1085'>    <b>int</b> i;
<a name='L1086'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "i|ii:set_threshold",
<a name='L1087'>                          &amp;generations[0].threshold,
<a name='L1088'>                          &amp;generations[1].threshold,
<a name='L1089'>                          &amp;generations[2].threshold))
<a name='L1090'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1091'>    <b>for</b> (i = 2; i &lt; <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>; i++) <font color='red'>{</font>
<a name='L1092'>        <i><font color='green'>/* generations higher than 2 get the same threshold */</font></i>
<a name='L1093'>        generations[i].threshold = generations[2].threshold;
<a name='L1094'>    <font color='red'>}</font>
<a name='L1095'>
<a name='L1096'>    Py_INCREF(Py_None);
<a name='L1097'>    <b>return</b> Py_None;
<a name='L1098'><font color='red'>}</font>
<a name='L1099'>
<a name='L1100'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_get_thresh__doc__,
<a name='L1101'>"get_threshold() -&gt; (threshold0, threshold1, threshold2)\n"
<a name='L1102'>"\n"
<a name='L1103'>"Return the current collection thresholds\n");
<a name='L1104'>
<a name='L1105'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1106'><a href='../S/2676.html#L1284' title='Refered from 1284 in Modules/gcmodule.c.'>gc_get_thresh</a>(PyObject *self, PyObject *noargs)
<a name='L1107'><font color='red'>{</font>
<a name='L1108'>    <b>return</b> <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("(iii)",
<a name='L1109'>                         generations[0].threshold,
<a name='L1110'>                         generations[1].threshold,
<a name='L1111'>                         generations[2].threshold);
<a name='L1112'><font color='red'>}</font>
<a name='L1113'>
<a name='L1114'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_get_count__doc__,
<a name='L1115'>"get_count() -&gt; (count0, count1, count2)\n"
<a name='L1116'>"\n"
<a name='L1117'>"Return the current collection counts\n");
<a name='L1118'>
<a name='L1119'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1120'><a href='../S/2676.html#L1282' title='Refered from 1282 in Modules/gcmodule.c.'>gc_get_count</a>(PyObject *self, PyObject *noargs)
<a name='L1121'><font color='red'>{</font>
<a name='L1122'>    <b>return</b> <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("(iii)",
<a name='L1123'>                         generations[0].count,
<a name='L1124'>                         generations[1].count,
<a name='L1125'>                         generations[2].count);
<a name='L1126'><font color='red'>}</font>
<a name='L1127'>
<a name='L1128'><b>static</b> <b>int</b>
<a name='L1129'><a href='../S/2676.html#L1149' title='Refered from 1149 in Modules/gcmodule.c.'>referrersvisit</a>(PyObject* obj, PyObject *objs)
<a name='L1130'><font color='red'>{</font>
<a name='L1131'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> i;
<a name='L1132'>    <b>for</b> (i = 0; i &lt; PyTuple_GET_SIZE(objs); i++)
<a name='L1133'>        <b>if</b> (PyTuple_GET_ITEM(objs, i) == obj)
<a name='L1134'>            <b>return</b> 1;
<a name='L1135'>    <b>return</b> 0;
<a name='L1136'><font color='red'>}</font>
<a name='L1137'>
<a name='L1138'><b>static</b> <b>int</b>
<a name='L1139'><a href='../S/2676.html#L1169' title='Refered from 1169 in Modules/gcmodule.c.'>gc_referrers_for</a>(PyObject *objs, PyGC_Head *list, PyObject *resultlist)
<a name='L1140'><font color='red'>{</font>
<a name='L1141'>    PyGC_Head *gc;
<a name='L1142'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obj;
<a name='L1143'>    traverseproc traverse;
<a name='L1144'>    <b>for</b> (gc = list-&gt;gc.gc_next; gc != list; gc = gc-&gt;gc.gc_next) <font color='red'>{</font>
<a name='L1145'>        obj = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(gc);
<a name='L1146'>        traverse = <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(obj)-&gt;tp_traverse;
<a name='L1147'>        <b>if</b> (obj == objs || obj == resultlist)
<a name='L1148'>            <b>continue</b>;
<a name='L1149'>        <b>if</b> (traverse(obj, (visitproc)<a href='../S/2676.html#L1129' title='Defined at 1129 in Modules/gcmodule.c.'>referrersvisit</a>, objs)) <font color='red'>{</font>
<a name='L1150'>            <b>if</b> (<a href='../S/2796.html#L286' title='Defined at 286 in Objects/listobject.c.'>PyList_Append</a>(resultlist, obj) &lt; 0)
<a name='L1151'>                <b>return</b> 0; <i><font color='green'>/* error */</font></i>
<a name='L1152'>        <font color='red'>}</font>
<a name='L1153'>    <font color='red'>}</font>
<a name='L1154'>    <b>return</b> 1; <i><font color='green'>/* no error */</font></i>
<a name='L1155'><font color='red'>}</font>
<a name='L1156'>
<a name='L1157'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_get_referrers__doc__,
<a name='L1158'>"get_referrers(*objs) -&gt; list\n\
<a name='L1159'>Return the list of objects that directly refer to any of objs.");
<a name='L1160'>
<a name='L1161'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1162'><a href='../S/2676.html#L1289' title='Refered from 1289 in Modules/gcmodule.c.'>gc_get_referrers</a>(PyObject *self, PyObject *args)
<a name='L1163'><font color='red'>{</font>
<a name='L1164'>    <b>int</b> i;
<a name='L1165'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L1166'>    <b>if</b> (!<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>) <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1167'>
<a name='L1168'>    <b>for</b> (i = 0; i &lt; <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>; i++) <font color='red'>{</font>
<a name='L1169'>        <b>if</b> (!(<a href='../S/2676.html#L1139' title='Defined at 1139 in Modules/gcmodule.c.'>gc_referrers_for</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(i), <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>))) <font color='red'>{</font>
<a name='L1170'>            Py_DECREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L1171'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1172'>        <font color='red'>}</font>
<a name='L1173'>    <font color='red'>}</font>
<a name='L1174'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1175'><font color='red'>}</font>
<a name='L1176'>
<a name='L1177'><i><font color='green'>/* Append obj to list; return true if error (out of memory), false if OK. */</font></i>
<a name='L1178'><b>static</b> <b>int</b>
<a name='L1179'><a href='../S/2676.html#L1206' title='Refered from 1206 in Modules/gcmodule.c.'>referentsvisit</a>(PyObject *obj, PyObject *list)
<a name='L1180'><font color='red'>{</font>
<a name='L1181'>    <b>return</b> <a href='../S/2796.html#L286' title='Defined at 286 in Objects/listobject.c.'>PyList_Append</a>(list, obj) &lt; 0;
<a name='L1182'><font color='red'>}</font>
<a name='L1183'>
<a name='L1184'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_get_referents__doc__,
<a name='L1185'>"get_referents(*objs) -&gt; list\n\
<a name='L1186'>Return the list of objects that are directly referred to by objs.");
<a name='L1187'>
<a name='L1188'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1189'><a href='../S/2676.html#L1291' title='Refered from 1291 in Modules/gcmodule.c.'>gc_get_referents</a>(PyObject *self, PyObject *args)
<a name='L1190'><font color='red'>{</font>
<a name='L1191'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> i;
<a name='L1192'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L1193'>
<a name='L1194'>    <b>if</b> (<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1195'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1196'>
<a name='L1197'>    <b>for</b> (i = 0; i &lt; PyTuple_GET_SIZE(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>); i++) <font color='red'>{</font>
<a name='L1198'>        traverseproc traverse;
<a name='L1199'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *obj = PyTuple_GET_ITEM(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, i);
<a name='L1200'>
<a name='L1201'>        <b>if</b> (! PyObject_IS_GC(obj))
<a name='L1202'>            <b>continue</b>;
<a name='L1203'>        traverse = <a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(obj)-&gt;tp_traverse;
<a name='L1204'>        <b>if</b> (! traverse)
<a name='L1205'>            <b>continue</b>;
<a name='L1206'>        <b>if</b> (traverse(obj, (visitproc)<a href='../S/2676.html#L1179' title='Defined at 1179 in Modules/gcmodule.c.'>referentsvisit</a>, <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>)) <font color='red'>{</font>
<a name='L1207'>            Py_DECREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L1208'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1209'>        <font color='red'>}</font>
<a name='L1210'>    <font color='red'>}</font>
<a name='L1211'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1212'><font color='red'>}</font>
<a name='L1213'>
<a name='L1214'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_get_objects__doc__,
<a name='L1215'>"get_objects() -&gt; [...]\n"
<a name='L1216'>"\n"
<a name='L1217'>"Return a list of objects tracked by the collector (excluding the list\n"
<a name='L1218'>"returned).\n");
<a name='L1219'>
<a name='L1220'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1221'><a href='../S/2676.html#L1287' title='Refered from 1287 in Modules/gcmodule.c.'>gc_get_objects</a>(PyObject *self, PyObject *noargs)
<a name='L1222'><font color='red'>{</font>
<a name='L1223'>    <b>int</b> i;
<a name='L1224'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a>* <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1225'>
<a name='L1226'>    <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L1227'>    <b>if</b> (<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1228'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1229'>    <b>for</b> (i = 0; i &lt; <a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a>; i++) <font color='red'>{</font>
<a name='L1230'>        <b>if</b> (<a href='../S/2676.html#L266' title='Defined at 266 in Modules/gcmodule.c.'>append_objects</a>(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>, <a href='../S/2676.html#L45' title='Defined at 45 in Modules/gcmodule.c.'>GEN_HEAD</a>(i))) <font color='red'>{</font>
<a name='L1231'>            Py_DECREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L1232'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1233'>        <font color='red'>}</font>
<a name='L1234'>    <font color='red'>}</font>
<a name='L1235'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1236'><font color='red'>}</font>
<a name='L1237'>
<a name='L1238'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc_is_tracked__doc__,
<a name='L1239'>"is_tracked(obj) -&gt; bool\n"
<a name='L1240'>"\n"
<a name='L1241'>"Returns true if the object is tracked by the garbage collector.\n"
<a name='L1242'>"Simple atomic objects will return false.\n"
<a name='L1243'>);
<a name='L1244'>
<a name='L1245'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1246'><a href='../S/2676.html#L1288' title='Refered from 1288 in Modules/gcmodule.c.'>gc_is_tracked</a>(PyObject *self, PyObject *obj)
<a name='L1247'><font color='red'>{</font>
<a name='L1248'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1249'>
<a name='L1250'>    <b>if</b> (PyObject_IS_GC(obj) &amp;&amp; <a href='../S/2676.html#L174' title='Defined at 174 in Modules/gcmodule.c.'>IS_TRACKED</a>(obj))
<a name='L1251'>        <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = Py_True;
<a name='L1252'>    <b>else</b>
<a name='L1253'>        <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = Py_False;
<a name='L1254'>    Py_INCREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L1255'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L1256'><font color='red'>}</font>
<a name='L1257'>
<a name='L1258'>
<a name='L1259'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(gc__doc__,
<a name='L1260'>"This module provides access to the garbage collector for reference cycles.\n"
<a name='L1261'>"\n"
<a name='L1262'>"enable() -- Enable automatic garbage collection.\n"
<a name='L1263'>"disable() -- Disable automatic garbage collection.\n"
<a name='L1264'>"isenabled() -- Returns true if automatic collection is enabled.\n"
<a name='L1265'>"collect() -- Do a full collection right now.\n"
<a name='L1266'>"get_count() -- Return the current collection counts.\n"
<a name='L1267'>"set_debug() -- Set debugging flags.\n"
<a name='L1268'>"get_debug() -- Get debugging flags.\n"
<a name='L1269'>"set_threshold() -- Set the collection thresholds.\n"
<a name='L1270'>"get_threshold() -- Return the current the collection thresholds.\n"
<a name='L1271'>"get_objects() -- Return a list of all objects tracked by the collector.\n"
<a name='L1272'>"is_tracked() -- Returns true if a given object is tracked.\n"
<a name='L1273'>"get_referrers() -- Return the list of objects that refer to an object.\n"
<a name='L1274'>"get_referents() -- Return the list of objects that an object refers to.\n");
<a name='L1275'>
<a name='L1276'><b>static</b> <a href='../D/3525.html' title='Multiple defined in 3 places.'>PyMethodDef</a> GcMethods[] = <font color='red'>{</font>
<a name='L1277'>    <font color='red'>{</font>"enable",             <a href='../S/2676.html#L976' title='Defined at 976 in Modules/gcmodule.c.'>gc_enable</a>,     <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  gc_enable__doc__<font color='red'>}</font>,
<a name='L1278'>    <font color='red'>{</font>"disable",            <a href='../S/2676.html#L989' title='Defined at 989 in Modules/gcmodule.c.'>gc_disable</a>,    <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  gc_disable__doc__<font color='red'>}</font>,
<a name='L1279'>    <font color='red'>{</font>"isenabled",          <a href='../S/2676.html#L1002' title='Defined at 1002 in Modules/gcmodule.c.'>gc_isenabled</a>,  <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  gc_isenabled__doc__<font color='red'>}</font>,
<a name='L1280'>    <font color='red'>{</font>"set_debug",          <a href='../S/2676.html#L1056' title='Defined at 1056 in Modules/gcmodule.c.'>gc_set_debug</a>,  <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, gc_set_debug__doc__<font color='red'>}</font>,
<a name='L1281'>    <font color='red'>{</font>"get_debug",          <a href='../S/2676.html#L1071' title='Defined at 1071 in Modules/gcmodule.c.'>gc_get_debug</a>,  <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  gc_get_debug__doc__<font color='red'>}</font>,
<a name='L1282'>    <font color='red'>{</font>"get_count",          <a href='../S/2676.html#L1120' title='Defined at 1120 in Modules/gcmodule.c.'>gc_get_count</a>,  <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  gc_get_count__doc__<font color='red'>}</font>,
<a name='L1283'>    <font color='red'>{</font>"set_threshold",  <a href='../S/2676.html#L1083' title='Defined at 1083 in Modules/gcmodule.c.'>gc_set_thresh</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, gc_set_thresh__doc__<font color='red'>}</font>,
<a name='L1284'>    <font color='red'>{</font>"get_threshold",  <a href='../S/2676.html#L1106' title='Defined at 1106 in Modules/gcmodule.c.'>gc_get_thresh</a>, <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  gc_get_thresh__doc__<font color='red'>}</font>,
<a name='L1285'>    <font color='red'>{</font>"collect",            (PyCFunction)<a href='../S/2676.html#L1016' title='Defined at 1016 in Modules/gcmodule.c.'>gc_collect</a>,
<a name='L1286'>        <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a> | METH_KEYWORDS,           gc_collect__doc__<font color='red'>}</font>,
<a name='L1287'>    <font color='red'>{</font>"get_objects",    <a href='../S/2676.html#L1221' title='Defined at 1221 in Modules/gcmodule.c.'>gc_get_objects</a>,<a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  gc_get_objects__doc__<font color='red'>}</font>,
<a name='L1288'>    <font color='red'>{</font>"is_tracked",     <a href='../S/2676.html#L1246' title='Defined at 1246 in Modules/gcmodule.c.'>gc_is_tracked</a>, METH_O,       gc_is_tracked__doc__<font color='red'>}</font>,
<a name='L1289'>    <font color='red'>{</font>"get_referrers",  <a href='../S/2676.html#L1162' title='Defined at 1162 in Modules/gcmodule.c.'>gc_get_referrers</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>,
<a name='L1290'>        gc_get_referrers__doc__<font color='red'>}</font>,
<a name='L1291'>    <font color='red'>{</font>"get_referents",  <a href='../S/2676.html#L1189' title='Defined at 1189 in Modules/gcmodule.c.'>gc_get_referents</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>,
<a name='L1292'>        gc_get_referents__doc__<font color='red'>}</font>,
<a name='L1293'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,      <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>           <i><font color='green'>/* Sentinel */</font></i>
<a name='L1294'><font color='red'>}</font>;
<a name='L1295'>
<a name='L1296'><b>static</b> <b>struct</b> <a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a> gcmodule = <font color='red'>{</font>
<a name='L1297'>    <a href='../S/542.html#L33' title='Defined at 33 in Include/moduleobject.h.'>PyModuleDef_HEAD_INIT</a>,
<a name='L1298'>    "gc",              <i><font color='green'>/* m_name */</font></i>
<a name='L1299'>    gc__doc__,         <i><font color='green'>/* m_doc */</font></i>
<a name='L1300'>    -1,                <i><font color='green'>/* m_size */</font></i>
<a name='L1301'>    GcMethods,         <i><font color='green'>/* m_methods */</font></i>
<a name='L1302'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,              <i><font color='green'>/* m_reload */</font></i>
<a name='L1303'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,              <i><font color='green'>/* m_traverse */</font></i>
<a name='L1304'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,              <i><font color='green'>/* m_clear */</font></i>
<a name='L1305'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>               <i><font color='green'>/* m_free */</font></i>
<a name='L1306'><font color='red'>}</font>;
<a name='L1307'>
<a name='L1308'><a href='../D/3482.html' title='Multiple defined in 10 places.'>PyMODINIT_FUNC</a>
<a name='L1309'><a href='../R/3053.html' title='Multiple refered from 2 places.'>PyInit_gc</a>(<b>void</b>)
<a name='L1310'><font color='red'>{</font>
<a name='L1311'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L1312'>
<a name='L1313'>    m = PyModule_Create(&amp;gcmodule);
<a name='L1314'>
<a name='L1315'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1316'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1317'>
<a name='L1318'>    <b>if</b> (garbage == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1319'>        garbage = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L1320'>        <b>if</b> (garbage == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1321'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1322'>    <font color='red'>}</font>
<a name='L1323'>    Py_INCREF(garbage);
<a name='L1324'>    <b>if</b> (<a href='../S/3125.html#L525' title='Defined at 525 in Python/modsupport.c.'>PyModule_AddObject</a>(m, "garbage", garbage) &lt; 0)
<a name='L1325'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1326'>
<a name='L1327'>    <i><font color='green'>/* Importing can't be done in collect() because collect()</font></i>
<a name='L1328'><i><font color='green'>     * can be called via PyGC_Collect() in Py_Finalize().</font></i>
<a name='L1329'><i><font color='green'>     * This wouldn't be a problem, except that &lt;initialized&gt; is</font></i>
<a name='L1330'><i><font color='green'>     * reset to 0 before calling collect which trips up</font></i>
<a name='L1331'><i><font color='green'>     * the import and triggers an assertion.</font></i>
<a name='L1332'><i><font color='green'>     */</font></i>
<a name='L1333'>    <b>if</b> (tmod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1334'>        tmod = <a href='../S/3120.html#L2348' title='Defined at 2348 in Python/import.c.'>PyImport_ImportModuleNoBlock</a>("time");
<a name='L1335'>        <b>if</b> (tmod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1336'>            <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L1337'>    <font color='red'>}</font>
<a name='L1338'>
<a name='L1339'><font color='darkred'>#define</font> <a href='../R/26.html' title='Multiple refered from 46 places.'>ADD_INT</a>(<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a>) <b>if</b> (<a href='../S/3125.html#L554' title='Defined at 554 in Python/modsupport.c.'>PyModule_AddIntConstant</a>(m, #<a href='../D/2251.html' title='Multiple defined in 2 places.'>NAME</a>, NAME) &lt; 0) <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L1340'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(<a href='../S/2676.html#L121' title='Defined at 121 in Modules/gcmodule.c.'>DEBUG_STATS</a>);
<a name='L1341'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(<a href='../S/2676.html#L122' title='Defined at 122 in Modules/gcmodule.c.'>DEBUG_COLLECTABLE</a>);
<a name='L1342'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(<a href='../S/2676.html#L123' title='Defined at 123 in Modules/gcmodule.c.'>DEBUG_UNCOLLECTABLE</a>);
<a name='L1343'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(<a href='../S/2676.html#L124' title='Defined at 124 in Modules/gcmodule.c.'>DEBUG_SAVEALL</a>);
<a name='L1344'>    <a href='../D/36.html' title='Multiple defined in 3 places.'>ADD_INT</a>(<a href='../S/2676.html#L125' title='Defined at 125 in Modules/gcmodule.c.'>DEBUG_LEAK</a>);
<a name='L1345'><font color='darkred'>#undef</font> <a href='../R/26.html' title='Multiple refered from 46 places.'>ADD_INT</a>
<a name='L1346'>    <b>return</b> m;
<a name='L1347'><font color='red'>}</font>
<a name='L1348'>
<a name='L1349'><i><font color='green'>/* API to invoke gc.collect() from C */</font></i>
<a name='L1350'><a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>
<a name='L1351'><a href='../R/2975.html' title='Multiple refered from 3 places.'>PyGC_Collect</a>(<b>void</b>)
<a name='L1352'><font color='red'>{</font>
<a name='L1353'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> n;
<a name='L1354'>
<a name='L1355'>    <b>if</b> (collecting)
<a name='L1356'>        n = 0; <i><font color='green'>/* already collecting, don't do anything */</font></i>
<a name='L1357'>    <b>else</b> <font color='red'>{</font>
<a name='L1358'>        collecting = 1;
<a name='L1359'>        n = <a href='../S/2676.html#L788' title='Defined at 788 in Modules/gcmodule.c.'>collect</a>(<a href='../S/2676.html#L44' title='Defined at 44 in Modules/gcmodule.c.'>NUM_GENERATIONS</a> - 1);
<a name='L1360'>        collecting = 0;
<a name='L1361'>    <font color='red'>}</font>
<a name='L1362'>
<a name='L1363'>    <b>return</b> n;
<a name='L1364'><font color='red'>}</font>
<a name='L1365'>
<a name='L1366'><b>void</b>
<a name='L1367'><a href='../S/3138.html#L427' title='Refered from 427 in Python/pythonrun.c.'>_PyGC_Fini</a>(<b>void</b>)
<a name='L1368'><font color='red'>{</font>
<a name='L1369'>    <b>if</b> (!(<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L124' title='Defined at 124 in Modules/gcmodule.c.'>DEBUG_SAVEALL</a>)
<a name='L1370'>        &amp;&amp; garbage != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; <a href='../S/534.html#L71' title='Defined at 71 in Include/listobject.h.'>PyList_GET_SIZE</a>(garbage) &gt; 0) <font color='red'>{</font>
<a name='L1371'>        <b>char</b> *message;
<a name='L1372'>        <b>if</b> (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L123' title='Defined at 123 in Modules/gcmodule.c.'>DEBUG_UNCOLLECTABLE</a>)
<a name='L1373'>            message = "gc: %zd uncollectable objects at " \
<a name='L1374'>                "shutdown";
<a name='L1375'>        <b>else</b>
<a name='L1376'>            message = "gc: %zd uncollectable objects at " \
<a name='L1377'>                "shutdown; use gc.set_debug(gc.DEBUG_UNCOLLECTABLE) to list them";
<a name='L1378'>        <b>if</b> (<a href='../S/3087.html#L732' title='Defined at 732 in Python/_warnings.c.'>PyErr_WarnFormat</a>(PyExc_ResourceWarning, 0, message,
<a name='L1379'>                             <a href='../S/534.html#L71' title='Defined at 71 in Include/listobject.h.'>PyList_GET_SIZE</a>(garbage)) &lt; 0)
<a name='L1380'>            <a href='../S/3106.html#L708' title='Defined at 708 in Python/errors.c.'>PyErr_WriteUnraisable</a>(<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L1381'>        <b>if</b> (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> &amp; <a href='../S/2676.html#L123' title='Defined at 123 in Modules/gcmodule.c.'>DEBUG_UNCOLLECTABLE</a>) <font color='red'>{</font>
<a name='L1382'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *repr = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, *<a href='../D/7205.html' title='Multiple defined in 2 places.'>bytes</a> = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1383'>            repr = <a href='../S/2803.html#L368' title='Defined at 368 in Objects/object.c.'>PyObject_Repr</a>(garbage);
<a name='L1384'>            <b>if</b> (!repr || !(<a href='../D/7205.html' title='Multiple defined in 2 places.'>bytes</a> = <a href='../S/2828.html#L1585' title='Defined at 1585 in Objects/unicodeobject.c.'>PyUnicode_EncodeFSDefault</a>(repr)))
<a name='L1385'>                <a href='../S/3106.html#L708' title='Defined at 708 in Python/errors.c.'>PyErr_WriteUnraisable</a>(garbage);
<a name='L1386'>            <b>else</b> <font color='red'>{</font>
<a name='L1387'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L1388'>                    "    %s\n",
<a name='L1389'>                    PyBytes_AS_STRING(<a href='../D/7205.html' title='Multiple defined in 2 places.'>bytes</a>)
<a name='L1390'>                    );
<a name='L1391'>            <font color='red'>}</font>
<a name='L1392'>            <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(repr);
<a name='L1393'>            <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(<a href='../D/7205.html' title='Multiple defined in 2 places.'>bytes</a>);
<a name='L1394'>        <font color='red'>}</font>
<a name='L1395'>    <font color='red'>}</font>
<a name='L1396'><font color='red'>}</font>
<a name='L1397'>
<a name='L1398'><i><font color='green'>/* for debugging */</font></i>
<a name='L1399'><b>void</b>
<a name='L1400'>_PyGC_Dump(PyGC_Head *g)
<a name='L1401'><font color='red'>{</font>
<a name='L1402'>    <a href='../S/2803.html#L339' title='Defined at 339 in Objects/object.c.'>_PyObject_Dump</a>(<a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(g));
<a name='L1403'><font color='red'>}</font>
<a name='L1404'>
<a name='L1405'><i><font color='green'>/* extension modules might be compiled with GC support so these</font></i>
<a name='L1406'><i><font color='green'>   functions must always be available */</font></i>
<a name='L1407'>
<a name='L1408'><font color='darkred'>#undef</font> <a href='../R/3263.html' title='Multiple refered from 23 places.'>PyObject_GC_Track</a>
<a name='L1409'><font color='darkred'>#undef</font> <a href='../R/3264.html' title='Multiple refered from 58 places.'>PyObject_GC_UnTrack</a>
<a name='L1410'><font color='darkred'>#undef</font> <a href='../R/3262.html' title='Multiple refered from 95 places.'>PyObject_GC_Del</a>
<a name='L1411'><font color='darkred'>#undef</font> <a href='../R/5469.html' title='Multiple refered from 3 places.'>_PyObject_GC_Malloc</a>
<a name='L1412'>
<a name='L1413'><b>void</b>
<a name='L1414'><a href='../R/3263.html' title='Multiple refered from 23 places.'>PyObject_GC_Track</a>(<b>void</b> *op)
<a name='L1415'><font color='red'>{</font>
<a name='L1416'>    <a href='../S/545.html#L266' title='Defined at 266 in Include/objimpl.h.'>_PyObject_GC_TRACK</a>(op);
<a name='L1417'><font color='red'>}</font>
<a name='L1418'>
<a name='L1419'><i><font color='green'>/* for binary compatibility with 2.2 */</font></i>
<a name='L1420'><b>void</b>
<a name='L1421'>_PyObject_GC_Track(PyObject *op)
<a name='L1422'><font color='red'>{</font>
<a name='L1423'>    <a href='../D/3618.html' title='Multiple defined in 2 places.'>PyObject_GC_Track</a>(op);
<a name='L1424'><font color='red'>}</font>
<a name='L1425'>
<a name='L1426'><b>void</b>
<a name='L1427'><a href='../R/3264.html' title='Multiple refered from 58 places.'>PyObject_GC_UnTrack</a>(<b>void</b> *op)
<a name='L1428'><font color='red'>{</font>
<a name='L1429'>    <i><font color='green'>/* Obscure:  the Py_TRASHCAN mechanism requires that we be able to</font></i>
<a name='L1430'><i><font color='green'>     * call PyObject_GC_UnTrack twice on an object.</font></i>
<a name='L1431'><i><font color='green'>     */</font></i>
<a name='L1432'>    <b>if</b> (<a href='../S/2676.html#L174' title='Defined at 174 in Modules/gcmodule.c.'>IS_TRACKED</a>(op))
<a name='L1433'>        <a href='../S/545.html#L281' title='Defined at 281 in Include/objimpl.h.'>_PyObject_GC_UNTRACK</a>(op);
<a name='L1434'><font color='red'>}</font>
<a name='L1435'>
<a name='L1436'><i><font color='green'>/* for binary compatibility with 2.2 */</font></i>
<a name='L1437'><b>void</b>
<a name='L1438'>_PyObject_GC_UnTrack(PyObject *op)
<a name='L1439'><font color='red'>{</font>
<a name='L1440'>    <a href='../D/3619.html' title='Multiple defined in 2 places.'>PyObject_GC_UnTrack</a>(op);
<a name='L1441'><font color='red'>}</font>
<a name='L1442'>
<a name='L1443'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1444'><a href='../R/5469.html' title='Multiple refered from 3 places.'>_PyObject_GC_Malloc</a>(<a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> basicsize)
<a name='L1445'><font color='red'>{</font>
<a name='L1446'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op;
<a name='L1447'>    PyGC_Head *g;
<a name='L1448'>    <b>if</b> (basicsize &gt; <a href='../D/2625.html' title='Multiple defined in 3 places.'>PY_SSIZE_T_MAX</a> - <b>sizeof</b>(PyGC_Head))
<a name='L1449'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1450'>    g = (PyGC_Head *)PyObject_MALLOC(
<a name='L1451'>        <b>sizeof</b>(PyGC_Head) + basicsize);
<a name='L1452'>    <b>if</b> (g == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1453'>        <b>return</b> <a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1454'>    g-&gt;gc.gc_refs = <a href='../S/2676.html#L170' title='Defined at 170 in Modules/gcmodule.c.'>GC_UNTRACKED</a>;
<a name='L1455'>    generations[0].count++; <i><font color='green'>/* number of allocated GC objects */</font></i>
<a name='L1456'>    <b>if</b> (generations[0].count &gt; generations[0].threshold &amp;&amp;
<a name='L1457'>        enabled &amp;&amp;
<a name='L1458'>        generations[0].threshold &amp;&amp;
<a name='L1459'>        !collecting &amp;&amp;
<a name='L1460'>        !<a href='../D/3154.html' title='Multiple defined in 2 places.'>PyErr_Occurred</a>()) <font color='red'>{</font>
<a name='L1461'>        collecting = 1;
<a name='L1462'>        <a href='../S/2676.html#L946' title='Defined at 946 in Modules/gcmodule.c.'>collect_generations</a>();
<a name='L1463'>        collecting = 0;
<a name='L1464'>    <font color='red'>}</font>
<a name='L1465'>    op = <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(g);
<a name='L1466'>    <b>return</b> op;
<a name='L1467'><font color='red'>}</font>
<a name='L1468'>
<a name='L1469'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1470'>_PyObject_GC_New(PyTypeObject *tp)
<a name='L1471'><font color='red'>{</font>
<a name='L1472'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *op = <a href='../D/6156.html' title='Multiple defined in 2 places.'>_PyObject_GC_Malloc</a>(<a href='../S/545.html#L165' title='Defined at 165 in Include/objimpl.h.'>_PyObject_SIZE</a>(tp));
<a name='L1473'>    <b>if</b> (op != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1474'>        op = PyObject_INIT(op, tp);
<a name='L1475'>    <b>return</b> op;
<a name='L1476'><font color='red'>}</font>
<a name='L1477'>
<a name='L1478'><a href='../S/544.html#L114' title='Defined at 114 in Include/object.h.'>PyVarObject</a> *
<a name='L1479'>_PyObject_GC_NewVar(PyTypeObject *tp, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> nitems)
<a name='L1480'><font color='red'>{</font>
<a name='L1481'>    <b>const</b> <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> size = <a href='../S/545.html#L181' title='Defined at 181 in Include/objimpl.h.'>_PyObject_VAR_SIZE</a>(tp, nitems);
<a name='L1482'>    <a href='../S/544.html#L114' title='Defined at 114 in Include/object.h.'>PyVarObject</a> *op = (<a href='../S/544.html#L114' title='Defined at 114 in Include/object.h.'>PyVarObject</a> *) <a href='../D/6156.html' title='Multiple defined in 2 places.'>_PyObject_GC_Malloc</a>(size);
<a name='L1483'>    <b>if</b> (op != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1484'>        op = <a href='../S/545.html#L162' title='Defined at 162 in Include/objimpl.h.'>PyObject_INIT_VAR</a>(op, tp, nitems);
<a name='L1485'>    <b>return</b> op;
<a name='L1486'><font color='red'>}</font>
<a name='L1487'>
<a name='L1488'><a href='../S/544.html#L114' title='Defined at 114 in Include/object.h.'>PyVarObject</a> *
<a name='L1489'>_PyObject_GC_Resize(PyVarObject *op, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> nitems)
<a name='L1490'><font color='red'>{</font>
<a name='L1491'>    <b>const</b> <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> basicsize = <a href='../S/545.html#L181' title='Defined at 181 in Include/objimpl.h.'>_PyObject_VAR_SIZE</a>(<a href='../D/4259.html' title='Multiple defined in 5 places.'>Py_TYPE</a>(op), nitems);
<a name='L1492'>    PyGC_Head *g = <a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(op);
<a name='L1493'>    <b>if</b> (basicsize &gt; <a href='../D/2625.html' title='Multiple defined in 3 places.'>PY_SSIZE_T_MAX</a> - <b>sizeof</b>(PyGC_Head))
<a name='L1494'>        <b>return</b> (<a href='../S/544.html#L114' title='Defined at 114 in Include/object.h.'>PyVarObject</a> *)<a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1495'>    g = (PyGC_Head *)PyObject_REALLOC(g,  <b>sizeof</b>(PyGC_Head) + basicsize);
<a name='L1496'>    <b>if</b> (g == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1497'>        <b>return</b> (<a href='../S/544.html#L114' title='Defined at 114 in Include/object.h.'>PyVarObject</a> *)<a href='../S/3106.html#L334' title='Defined at 334 in Python/errors.c.'>PyErr_NoMemory</a>();
<a name='L1498'>    op = (<a href='../S/544.html#L114' title='Defined at 114 in Include/object.h.'>PyVarObject</a> *) <a href='../S/2676.html#L33' title='Defined at 33 in Modules/gcmodule.c.'>FROM_GC</a>(g);
<a name='L1499'>    <a href='../S/544.html#L118' title='Defined at 118 in Include/object.h.'>Py_SIZE</a>(op) = nitems;
<a name='L1500'>    <b>return</b> op;
<a name='L1501'><font color='red'>}</font>
<a name='L1502'>
<a name='L1503'><b>void</b>
<a name='L1504'><a href='../R/3262.html' title='Multiple refered from 95 places.'>PyObject_GC_Del</a>(<b>void</b> *op)
<a name='L1505'><font color='red'>{</font>
<a name='L1506'>    PyGC_Head *g = <a href='../S/2676.html#L30' title='Defined at 30 in Modules/gcmodule.c.'>AS_GC</a>(op);
<a name='L1507'>    <b>if</b> (<a href='../S/2676.html#L174' title='Defined at 174 in Modules/gcmodule.c.'>IS_TRACKED</a>(op))
<a name='L1508'>        <a href='../S/2676.html#L209' title='Defined at 209 in Modules/gcmodule.c.'>gc_list_remove</a>(g);
<a name='L1509'>    <b>if</b> (generations[0].count &gt; 0) <font color='red'>{</font>
<a name='L1510'>        generations[0].count--;
<a name='L1511'>    <font color='red'>}</font>
<a name='L1512'>    PyObject_FREE(g);
<a name='L1513'><font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L182'>[^]</a><a href='#L1504'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
