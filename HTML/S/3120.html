<html>
<head>
<title>Python/import.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3402.html'>Python</a>/import.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L147'>[^]</a><a href='#L3875'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L147' title='Defined at 147.'>_PyImport_Init</a>
<li><a href='#L186' title='Defined at 186.'>_PyImportHooks_Init</a>
<li><a href='#L256' title='Defined at 256.'>_PyImport_Fini</a>
<li><a href='#L278' title='Defined at 278.'>_PyImport_AcquireLock</a>
<li><a href='#L303' title='Defined at 303.'>_PyImport_ReleaseLock</a>
<li><a href='#L324' title='Defined at 324.'>_PyImport_ReInitLock</a>
<li><a href='#L344' title='Defined at 344.'>imp_lock_held</a>
<li><a href='#L354' title='Defined at 354.'>imp_acquire_lock</a>
<li><a href='#L364' title='Defined at 364.'>imp_release_lock</a>
<li><a href='#L378' title='Defined at 378.'>imp_modules_reloading_clear</a>
<li><a href='#L388' title='Defined at 388.'>PyImport_GetModuleDict</a>
<li><a href='#L418' title='Defined at 418.'>PyImport_Cleanup</a>
<li><a href='#L552' title='Defined at 552.'>PyImport_GetMagicNumber</a>
<li><a href='#L559' title='Defined at 559.'>PyImport_GetMagicTag</a>
<li><a href='#L581' title='Defined at 581.'>_PyImport_FixupExtensionUnicode</a>
<li><a href='#L626' title='Defined at 626.'>_PyImport_FixupBuiltin</a>
<li><a href='#L639' title='Defined at 639.'>_PyImport_FindExtensionUnicode</a>
<li><a href='#L683' title='Defined at 683.'>_PyImport_FindBuiltin</a>
<li><a href='#L701' title='Defined at 701.'>PyImport_AddModule</a>
<li><a href='#L723' title='Defined at 723.'>remove_module</a>
<li><a href='#L749' title='Defined at 749.'>PyImport_ExecCodeModule</a>
<li><a href='#L756' title='Defined at 756.'>PyImport_ExecCodeModuleEx</a>
<li><a href='#L763' title='Defined at 763.'>PyImport_ExecCodeModuleWithPathnames</a>
<li><a href='#L835' title='Defined at 835.'>rightmost_sep</a>
<li><a href='#L858' title='Defined at 858.'>make_compiled_pathname</a>
<li><a href='#L968' title='Defined at 968.'>make_source_pathname</a>
<li><a href='#L1022' title='Defined at 1022.'>check_compiled_module</a>
<li><a href='#L1054' title='Defined at 1054.'>read_compiled_module</a>
<li><a href='#L1075' title='Defined at 1075.'>load_compiled_module</a>
<li><a href='#L1104' title='Defined at 1104.'>parse_source_module</a>
<li><a href='#L1128' title='Defined at 1128.'>open_exclusive</a>
<li><a href='#L1165' title='Defined at 1165.'>write_compiled_module</a>
<li><a href='#L1235' title='Defined at 1235.'>update_code_filenames</a>
<li><a href='#L1259' title='Defined at 1259.'>update_compiled_module</a>
<li><a href='#L1285' title='Defined at 1285.'>load_source_module</a>
<li><a href='#L1350' title='Defined at 1350.'>get_sourcefile</a>
<li><a href='#L1396' title='Defined at 1396.'>load_package</a>
<li><a href='#L1452' title='Defined at 1452.'>is_builtin</a>
<li><a href='#L1476' title='Defined at 1476.'>get_path_importer</a>
<li><a href='#L1531' title='Defined at 1531.'>PyAPI_FUNC</a>
<li><a href='#L1559' title='Defined at 1559.'>find_module</a>
<li><a href='#L1878' title='Defined at 1878.'>case_ok</a>
<li><a href='#L1991' title='Defined at 1991.'>find_init_module</a>
<li><a href='#L2041' title='Defined at 2041.'>load_builtin</a>
<li><a href='#L2083' title='Defined at 2083.'>load_module</a>
<li><a href='#L2151' title='Defined at 2151.'>init_builtin</a>
<li><a href='#L2187' title='Defined at 2187.'>find_frozen</a>
<li><a href='#L2204' title='Defined at 2204.'>get_frozen_object</a>
<li><a href='#L2228' title='Defined at 2228.'>is_frozen_package</a>
<li><a href='#L2255' title='Defined at 2255.'>PyImport_ImportFrozenModule</a>
<li><a href='#L2325' title='Defined at 2325.'>PyImport_ImportModule</a>
<li><a href='#L2348' title='Defined at 2348.'>PyImport_ImportModuleNoBlock</a>
<li><a href='#L2401' title='Defined at 2401.'>import_module_level</a>
<li><a href='#L2469' title='Defined at 2469.'>PyImport_ImportModuleLevel</a>
<li><a href='#L2496' title='Defined at 2496.'>get_parent</a>
<li><a href='#L2663' title='Defined at 2663.'>load_next</a>
<li><a href='#L2735' title='Defined at 2735.'>mark_miss</a>
<li><a href='#L2742' title='Defined at 2742.'>ensure_fromlist</a>
<li><a href='#L2819' title='Defined at 2819.'>add_submodule</a>
<li><a href='#L2853' title='Defined at 2853.'>import_submodule</a>
<li><a href='#L2912' title='Defined at 2912.'>PyImport_ReloadModule</a>
<li><a href='#L3017' title='Defined at 3017.'>PyImport_Import</a>
<li><a href='#L3099' title='Defined at 3099.'>imp_make_magic</a>
<li><a href='#L3112' title='Defined at 3112.'>imp_get_magic</a>
<li><a href='#L3118' title='Defined at 3118.'>imp_get_tag</a>
<li><a href='#L3124' title='Defined at 3124.'>imp_get_suffixes</a>
<li><a href='#L3150' title='Defined at 3150.'>call_find_module</a>
<li><a href='#L3207' title='Defined at 3207.'>imp_find_module</a>
<li><a href='#L3221' title='Defined at 3221.'>imp_init_builtin</a>
<li><a href='#L3241' title='Defined at 3241.'>imp_init_frozen</a>
<li><a href='#L3261' title='Defined at 3261.'>imp_get_frozen_object</a>
<li><a href='#L3271' title='Defined at 3271.'>imp_is_frozen_package</a>
<li><a href='#L3281' title='Defined at 3281.'>imp_is_builtin</a>
<li><a href='#L3290' title='Defined at 3290.'>imp_is_frozen</a>
<li><a href='#L3301' title='Defined at 3301.'>get_file</a>
<li><a href='#L3331' title='Defined at 3331.'>imp_load_compiled</a>
<li><a href='#L3357' title='Defined at 3357.'>imp_load_dynamic</a>
<li><a href='#L3386' title='Defined at 3386.'>imp_load_source</a>
<li><a href='#L3410' title='Defined at 3410.'>imp_load_module</a>
<li><a href='#L3455' title='Defined at 3455.'>imp_load_package</a>
<li><a href='#L3469' title='Defined at 3469.'>imp_new_module</a>
<li><a href='#L3478' title='Defined at 3478.'>imp_reload</a>
<li><a href='#L3489' title='Defined at 3489.'>imp_cache_from_source</a>
<li><a href='#L3533' title='Defined at 3533.'>imp_source_from_cache</a>
<li><a href='#L3649' title='Defined at 3649.'>setint</a>
<li><a href='#L3665' title='Defined at 3665.'>NullImporter_init</a>
<li><a href='#L3734' title='Defined at 3734.'>NullImporter_find_module</a>
<li><a href='#L3801' title='Defined at 3801.'>PyInit_imp</a>
<li><a href='#L3843' title='Defined at 3843.'>PyImport_ExtendInittab</a>
<li><a href='#L3875' title='Defined at 3875.'>PyImport_AppendInittab</a>
</ol>
<hr>
<pre>
<a name='L1'>
<a name='L2'><i><font color='green'>/* Module definition and import implementation */</font></i>
<a name='L3'>
<a name='L4'><font color='darkred'>#include</font> "<a href='570.html'>Python.h</a>"
<a name='L5'>
<a name='L6'><font color='darkred'>#include</font> "<a href='569.html'>Python-ast.h</a>"
<a name='L7'><font color='darkred'>#undef</font> <a href='../R/5254.html' title='Multiple refered from 9 places.'>Yield</a> <i><font color='green'>/* undefine macro conflicting with winbase.h */</font></i>
<a name='L8'><font color='darkred'>#include</font> "<a href='521.html'>errcode.h</a>"
<a name='L9'><font color='darkred'>#include</font> "<a href='537.html'>marshal.h</a>"
<a name='L10'><font color='darkred'>#include</font> "<a href='511.html'>code.h</a>"
<a name='L11'><font color='darkred'>#include</font> "<a href='547.html'>osdefs.h</a>"
<a name='L12'><font color='darkred'>#include</font> "<a href='3122.html'>importdl.h</a>"
<a name='L13'>
<a name='L14'><font color='darkred'>#ifdef</font> <a href='../D/1484.html' title='Multiple defined in 4 places.'>HAVE_FCNTL_H</a>
<a name='L15'><font color='darkred'>#include</font> &lt;fcntl.h&gt;
<a name='L16'><font color='darkred'>#endif</font>
<a name='L17'><font color='darkred'>#ifdef</font> __cplusplus
<a name='L18'><b>extern</b> "C" <font color='red'>{</font>
<a name='L19'><font color='darkred'>#endif</font>
<a name='L20'>
<a name='L21'><font color='darkred'>#ifdef</font> <a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>
<a name='L22'><i><font color='green'>/* for stat.st_mode */</font></i>
<a name='L23'><b>typedef</b> <b>unsigned</b> <b>short</b> <a href='../R/9089.html' title='Multiple refered from 7 places.'>mode_t</a>;
<a name='L24'><i><font color='green'>/* for _mkdir */</font></i>
<a name='L25'><font color='darkred'>#include</font> &lt;direct.h&gt;
<a name='L26'><font color='darkred'>#endif</font>
<a name='L27'>
<a name='L28'>
<a name='L29'><i><font color='green'>/* Magic word to reject .pyc files generated by other Python versions.</font></i>
<a name='L30'><i><font color='green'>   It should change for each incompatible change to the bytecode.</font></i>
<a name='L31'><i><font color='green'></font></i>
<a name='L32'><i><font color='green'>   The value of CR and LF is incorporated so if you ever read or write</font></i>
<a name='L33'><i><font color='green'>   a .pyc file in text mode the magic number will be wrong; also, the</font></i>
<a name='L34'><i><font color='green'>   Apple MPW compiler swaps their values, botching string constants.</font></i>
<a name='L35'><i><font color='green'></font></i>
<a name='L36'><i><font color='green'>   The magic numbers must be spaced apart at least 2 values, as the</font></i>
<a name='L37'><i><font color='green'>   -U interpeter flag will cause MAGIC+1 being used. They have been</font></i>
<a name='L38'><i><font color='green'>   odd numbers for some time now.</font></i>
<a name='L39'><i><font color='green'></font></i>
<a name='L40'><i><font color='green'>   There were a variety of old schemes for setting the magic number.</font></i>
<a name='L41'><i><font color='green'>   The current working scheme is to increment the previous value by</font></i>
<a name='L42'><i><font color='green'>   10.</font></i>
<a name='L43'><i><font color='green'></font></i>
<a name='L44'><i><font color='green'>   Starting with the adoption of PEP 3147 in Python 3.2, every bump in magic</font></i>
<a name='L45'><i><font color='green'>   number also includes a new "magic tag", i.e. a human readable string used</font></i>
<a name='L46'><i><font color='green'>   to represent the magic number in __pycache__ directories.  When you change</font></i>
<a name='L47'><i><font color='green'>   the magic number, you must also set a new unique magic tag.  Generally this</font></i>
<a name='L48'><i><font color='green'>   can be named after the Python major version of the magic number bump, but</font></i>
<a name='L49'><i><font color='green'>   it can really be anything, as long as it's different than anything else</font></i>
<a name='L50'><i><font color='green'>   that's come before.  The tags are included in the following table, starting</font></i>
<a name='L51'><i><font color='green'>   with Python 3.2a0.</font></i>
<a name='L52'><i><font color='green'></font></i>
<a name='L53'><i><font color='green'>   Known values:</font></i>
<a name='L54'><i><font color='green'>       Python 1.5:   20121</font></i>
<a name='L55'><i><font color='green'>       Python 1.5.1: 20121</font></i>
<a name='L56'><i><font color='green'>       Python 1.5.2: 20121</font></i>
<a name='L57'><i><font color='green'>       Python 1.6:   50428</font></i>
<a name='L58'><i><font color='green'>       Python 2.0:   50823</font></i>
<a name='L59'><i><font color='green'>       Python 2.0.1: 50823</font></i>
<a name='L60'><i><font color='green'>       Python 2.1:   60202</font></i>
<a name='L61'><i><font color='green'>       Python 2.1.1: 60202</font></i>
<a name='L62'><i><font color='green'>       Python 2.1.2: 60202</font></i>
<a name='L63'><i><font color='green'>       Python 2.2:   60717</font></i>
<a name='L64'><i><font color='green'>       Python 2.3a0: 62011</font></i>
<a name='L65'><i><font color='green'>       Python 2.3a0: 62021</font></i>
<a name='L66'><i><font color='green'>       Python 2.3a0: 62011 (!)</font></i>
<a name='L67'><i><font color='green'>       Python 2.4a0: 62041</font></i>
<a name='L68'><i><font color='green'>       Python 2.4a3: 62051</font></i>
<a name='L69'><i><font color='green'>       Python 2.4b1: 62061</font></i>
<a name='L70'><i><font color='green'>       Python 2.5a0: 62071</font></i>
<a name='L71'><i><font color='green'>       Python 2.5a0: 62081 (ast-branch)</font></i>
<a name='L72'><i><font color='green'>       Python 2.5a0: 62091 (with)</font></i>
<a name='L73'><i><font color='green'>       Python 2.5a0: 62092 (changed WITH_CLEANUP opcode)</font></i>
<a name='L74'><i><font color='green'>       Python 2.5b3: 62101 (fix wrong code: for x, in ...)</font></i>
<a name='L75'><i><font color='green'>       Python 2.5b3: 62111 (fix wrong code: x += yield)</font></i>
<a name='L76'><i><font color='green'>       Python 2.5c1: 62121 (fix wrong lnotab with for loops and</font></i>
<a name='L77'><i><font color='green'>                            storing constants that should have been removed)</font></i>
<a name='L78'><i><font color='green'>       Python 2.5c2: 62131 (fix wrong code: for x, in ... in listcomp/genexp)</font></i>
<a name='L79'><i><font color='green'>       Python 2.6a0: 62151 (peephole optimizations and STORE_MAP opcode)</font></i>
<a name='L80'><i><font color='green'>       Python 2.6a1: 62161 (WITH_CLEANUP optimization)</font></i>
<a name='L81'><i><font color='green'>       Python 3000:   3000</font></i>
<a name='L82'><i><font color='green'>                      3010 (removed UNARY_CONVERT)</font></i>
<a name='L83'><i><font color='green'>                      3020 (added BUILD_SET)</font></i>
<a name='L84'><i><font color='green'>                      3030 (added keyword-only parameters)</font></i>
<a name='L85'><i><font color='green'>                      3040 (added signature annotations)</font></i>
<a name='L86'><i><font color='green'>                      3050 (print becomes a function)</font></i>
<a name='L87'><i><font color='green'>                      3060 (PEP 3115 metaclass syntax)</font></i>
<a name='L88'><i><font color='green'>                      3061 (string literals become unicode)</font></i>
<a name='L89'><i><font color='green'>                      3071 (PEP 3109 raise changes)</font></i>
<a name='L90'><i><font color='green'>                      3081 (PEP 3137 make __file__ and __name__ unicode)</font></i>
<a name='L91'><i><font color='green'>                      3091 (kill str8 interning)</font></i>
<a name='L92'><i><font color='green'>                      3101 (merge from 2.6a0, see 62151)</font></i>
<a name='L93'><i><font color='green'>                      3103 (__file__ points to source file)</font></i>
<a name='L94'><i><font color='green'>       Python 3.0a4: 3111 (WITH_CLEANUP optimization).</font></i>
<a name='L95'><i><font color='green'>       Python 3.0a5: 3131 (lexical exception stacking, including POP_EXCEPT)</font></i>
<a name='L96'><i><font color='green'>       Python 3.1a0: 3141 (optimize list, set and dict comprehensions:</font></i>
<a name='L97'><i><font color='green'>               change LIST_APPEND and SET_ADD, add MAP_ADD)</font></i>
<a name='L98'><i><font color='green'>       Python 3.1a0: 3151 (optimize conditional branches:</font></i>
<a name='L99'><i><font color='green'>               introduce POP_JUMP_IF_FALSE and POP_JUMP_IF_TRUE)</font></i>
<a name='L100'><i><font color='green'>       Python 3.2a0: 3160 (add SETUP_WITH)</font></i>
<a name='L101'><i><font color='green'>                     tag: cpython-32</font></i>
<a name='L102'><i><font color='green'>       Python 3.2a1: 3170 (add DUP_TOP_TWO, remove DUP_TOPX and ROT_FOUR)</font></i>
<a name='L103'><i><font color='green'>                     tag: cpython-32</font></i>
<a name='L104'><i><font color='green'>       Python 3.2a2  3180 (add DELETE_DEREF)</font></i>
<a name='L105'><i><font color='green'>*/</font></i>
<a name='L106'>
<a name='L107'><i><font color='green'>/* MAGIC must change whenever the bytecode emitted by the compiler may no</font></i>
<a name='L108'><i><font color='green'>   longer be understood by older implementations of the eval loop (usually</font></i>
<a name='L109'><i><font color='green'>   due to the addition of new opcodes)</font></i>
<a name='L110'><i><font color='green'>   TAG must change for each major Python release. The magic number will take</font></i>
<a name='L111'><i><font color='green'>   care of any bytecode changes that occur during development.</font></i>
<a name='L112'><i><font color='green'>*/</font></i>
<a name='L113'><font color='darkred'>#define</font> <a href='../S/3120.html#L117' title='Refered from 117 in Python/import.c.'>MAGIC</a> (3180 | ((<b>long</b>)'\r'&lt;&lt;16) | ((<b>long</b>)'\n'&lt;&lt;24))
<a name='L114'><font color='darkred'>#define</font> <a href='../R/4520.html' title='Multiple refered from 12 places.'>TAG</a> "cpython-32"
<a name='L115'><font color='darkred'>#define</font> <a href='../R/435.html' title='Multiple refered from 6 places.'>CACHEDIR</a> "__pycache__"
<a name='L116'><i><font color='green'>/* Current magic word and string tag as globals. */</font></i>
<a name='L117'><b>static</b> <b>long</b> pyc_magic = <a href='../S/3120.html#L113' title='Defined at 113 in Python/import.c.'>MAGIC</a>;
<a name='L118'><b>static</b> <b>const</b> <b>char</b> *pyc_tag = <a href='../D/5127.html' title='Multiple defined in 2 places.'>TAG</a>;
<a name='L119'>
<a name='L120'><i><font color='green'>/* See _PyImport_FixupExtensionUnicode() below */</font></i>
<a name='L121'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *extensions = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L122'>
<a name='L123'><i><font color='green'>/* This table is defined in config.c: */</font></i>
<a name='L124'><b>extern</b> <b>struct</b> _inittab _PyImport_Inittab[];
<a name='L125'>
<a name='L126'><i><font color='green'>/* Method from Parser/tokenizer.c */</font></i>
<a name='L127'><b>extern</b> <b>char</b> * <a href='../S/2851.html#L1702' title='Defined at 1702 in Parser/tokenizer.c.'>PyTokenizer_FindEncoding</a>(<b>int</b>);
<a name='L128'>
<a name='L129'><b>struct</b> _inittab *PyImport_Inittab = _PyImport_Inittab;
<a name='L130'>
<a name='L131'><i><font color='green'>/* these tables define the module suffixes that Python recognizes */</font></i>
<a name='L132'><b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> * _PyImport_Filetab = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L133'>
<a name='L134'><b>static</b> <b>const</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> _PyImport_StandardFiletab[] = <font color='red'>{</font>
<a name='L135'>    <font color='red'>{</font>".py", "U", <a href='../S/3122.html#L12' title='Defined at 12 in Python/importdl.h.'>PY_SOURCE</a><font color='red'>}</font>,
<a name='L136'><font color='darkred'>#ifdef</font> <a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>
<a name='L137'>    <font color='red'>{</font>".pyw", "U", <a href='../S/3122.html#L12' title='Defined at 12 in Python/importdl.h.'>PY_SOURCE</a><font color='red'>}</font>,
<a name='L138'><font color='darkred'>#endif</font>
<a name='L139'>    <font color='red'>{</font>".pyc", "rb", <a href='../S/3122.html#L13' title='Defined at 13 in Python/importdl.h.'>PY_COMPILED</a><font color='red'>}</font>,
<a name='L140'>    <font color='red'>{</font>0, 0<font color='red'>}</font>
<a name='L141'><font color='red'>}</font>;
<a name='L142'>
<a name='L143'>
<a name='L144'><i><font color='green'>/* Initialize things */</font></i>
<a name='L145'>
<a name='L146'><b>void</b>
<a name='L147'><a href='../S/3138.html#L285' title='Refered from 285 in Python/pythonrun.c.'>_PyImport_Init</a>(<b>void</b>)
<a name='L148'><font color='red'>{</font>
<a name='L149'>    <b>const</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *scan;
<a name='L150'>    <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *filetab;
<a name='L151'>    <b>int</b> countD = 0;
<a name='L152'>    <b>int</b> countS = 0;
<a name='L153'>
<a name='L154'>    <i><font color='green'>/* prepare _PyImport_Filetab: copy entries from</font></i>
<a name='L155'><i><font color='green'>       _PyImport_DynLoadFiletab and _PyImport_StandardFiletab.</font></i>
<a name='L156'><i><font color='green'>     */</font></i>
<a name='L157'><font color='darkred'>#ifdef</font> <a href='../D/1481.html' title='Multiple defined in 3 places.'>HAVE_DYNAMIC_LOADING</a>
<a name='L158'>    <b>for</b> (scan = _PyImport_DynLoadFiletab; scan-&gt;suffix != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; ++scan)
<a name='L159'>        ++countD;
<a name='L160'><font color='darkred'>#endif</font>
<a name='L161'>    <b>for</b> (scan = _PyImport_StandardFiletab; scan-&gt;suffix != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; ++scan)
<a name='L162'>        ++countS;
<a name='L163'>    filetab = PyMem_NEW(<b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a>, countD + countS + 1);
<a name='L164'>    <b>if</b> (filetab == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L165'>        <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("Can't initialize import file table.");
<a name='L166'><font color='darkred'>#ifdef</font> <a href='../D/1481.html' title='Multiple defined in 3 places.'>HAVE_DYNAMIC_LOADING</a>
<a name='L167'>    <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(filetab, _PyImport_DynLoadFiletab,
<a name='L168'>           countD * <b>sizeof</b>(<b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a>));
<a name='L169'><font color='darkred'>#endif</font>
<a name='L170'>    <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(filetab + countD, _PyImport_StandardFiletab,
<a name='L171'>           countS * <b>sizeof</b>(<b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a>));
<a name='L172'>    filetab[countD + countS].suffix = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L173'>
<a name='L174'>    _PyImport_Filetab = filetab;
<a name='L175'>
<a name='L176'>    <b>if</b> (Py_OptimizeFlag) <font color='red'>{</font>
<a name='L177'>        <i><font color='green'>/* Replace ".pyc" with ".pyo" in _PyImport_Filetab */</font></i>
<a name='L178'>        <b>for</b> (; filetab-&gt;suffix != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; filetab++) <font color='red'>{</font>
<a name='L179'>            <b>if</b> (strcmp(filetab-&gt;suffix, ".pyc") == 0)
<a name='L180'>                filetab-&gt;suffix = ".pyo";
<a name='L181'>        <font color='red'>}</font>
<a name='L182'>    <font color='red'>}</font>
<a name='L183'><font color='red'>}</font>
<a name='L184'>
<a name='L185'><b>void</b>
<a name='L186'><a href='../R/5421.html' title='Multiple refered from 2 places.'>_PyImportHooks_Init</a>(<b>void</b>)
<a name='L187'><font color='red'>{</font>
<a name='L188'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *v, *path_hooks = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, *zimpimport;
<a name='L189'>    <b>int</b> err = 0;
<a name='L190'>
<a name='L191'>    <i><font color='green'>/* adding sys.path_hooks and sys.path_importer_cache, setting up</font></i>
<a name='L192'><i><font color='green'>       zipimport */</font></i>
<a name='L193'>    <b>if</b> (<a href='../S/2824.html#L3799' title='Defined at 3799 in Objects/typeobject.c.'>PyType_Ready</a>(&amp;PyNullImporter_Type) &lt; 0)
<a name='L194'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L195'>
<a name='L196'>    <b>if</b> (Py_VerboseFlag)
<a name='L197'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# installing zipimport hook\n");
<a name='L198'>
<a name='L199'>    v = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L200'>    <b>if</b> (v == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L201'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L202'>    err = <a href='../S/3144.html#L54' title='Defined at 54 in Python/sysmodule.c.'>PySys_SetObject</a>("meta_path", v);
<a name='L203'>    Py_DECREF(v);
<a name='L204'>    <b>if</b> (err)
<a name='L205'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L206'>    v = <a href='../S/2787.html#L233' title='Defined at 233 in Objects/dictobject.c.'>PyDict_New</a>();
<a name='L207'>    <b>if</b> (v == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L208'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L209'>    err = <a href='../S/3144.html#L54' title='Defined at 54 in Python/sysmodule.c.'>PySys_SetObject</a>("path_importer_cache", v);
<a name='L210'>    Py_DECREF(v);
<a name='L211'>    <b>if</b> (err)
<a name='L212'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L213'>    path_hooks = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L214'>    <b>if</b> (path_hooks == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L215'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L216'>    err = <a href='../S/3144.html#L54' title='Defined at 54 in Python/sysmodule.c.'>PySys_SetObject</a>("path_hooks", path_hooks);
<a name='L217'>    <b>if</b> (err) <font color='red'>{</font>
<a name='L218'>  <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>:
<a name='L219'>        <a href='../S/3138.html#L1342' title='Defined at 1342 in Python/pythonrun.c.'>PyErr_Print</a>();
<a name='L220'>        <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("initializing sys.meta_path, sys.path_hooks, "
<a name='L221'>                      "path_importer_cache, or NullImporter failed"
<a name='L222'>                      );
<a name='L223'>    <font color='red'>}</font>
<a name='L224'>
<a name='L225'>    zimpimport = <a href='../S/3120.html#L2325' title='Defined at 2325 in Python/import.c.'>PyImport_ImportModule</a>("zipimport");
<a name='L226'>    <b>if</b> (zimpimport == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L227'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>(); <i><font color='green'>/* No zip import module -- okay */</font></i>
<a name='L228'>        <b>if</b> (Py_VerboseFlag)
<a name='L229'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# can't import zipimport\n");
<a name='L230'>    <font color='red'>}</font>
<a name='L231'>    <b>else</b> <font color='red'>{</font>
<a name='L232'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *zipimporter = <a href='../S/2803.html#L779' title='Defined at 779 in Objects/object.c.'>PyObject_GetAttrString</a>(zimpimport,
<a name='L233'>                                                       "zipimporter");
<a name='L234'>        Py_DECREF(zimpimport);
<a name='L235'>        <b>if</b> (zipimporter == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L236'>            <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>(); <i><font color='green'>/* No zipimporter object -- okay */</font></i>
<a name='L237'>            <b>if</b> (Py_VerboseFlag)
<a name='L238'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L239'>                    "# can't import zipimport.zipimporter\n");
<a name='L240'>        <font color='red'>}</font>
<a name='L241'>        <b>else</b> <font color='red'>{</font>
<a name='L242'>            <i><font color='green'>/* sys.path_hooks.append(zipimporter) */</font></i>
<a name='L243'>            err = <a href='../S/2796.html#L286' title='Defined at 286 in Objects/listobject.c.'>PyList_Append</a>(path_hooks, zipimporter);
<a name='L244'>            Py_DECREF(zipimporter);
<a name='L245'>            <b>if</b> (err)
<a name='L246'>                <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L247'>            <b>if</b> (Py_VerboseFlag)
<a name='L248'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L249'>                    "# installed zipimport hook\n");
<a name='L250'>        <font color='red'>}</font>
<a name='L251'>    <font color='red'>}</font>
<a name='L252'>    Py_DECREF(path_hooks);
<a name='L253'><font color='red'>}</font>
<a name='L254'>
<a name='L255'><b>void</b>
<a name='L256'><a href='../S/3138.html#L455' title='Refered from 455 in Python/pythonrun.c.'>_PyImport_Fini</a>(<b>void</b>)
<a name='L257'><font color='red'>{</font>
<a name='L258'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(extensions);
<a name='L259'>    extensions = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L260'>    PyMem_DEL(_PyImport_Filetab);
<a name='L261'>    _PyImport_Filetab = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L262'><font color='red'>}</font>
<a name='L263'>
<a name='L264'>
<a name='L265'><i><font color='green'>/* Locking primitives to prevent parallel imports of the same module</font></i>
<a name='L266'><i><font color='green'>   in different threads to return with a partially loaded module.</font></i>
<a name='L267'><i><font color='green'>   These calls are serialized by the global interpreter lock. */</font></i>
<a name='L268'>
<a name='L269'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L270'>
<a name='L271'><font color='darkred'>#include</font> "<a href='572.html'>pythread.h</a>"
<a name='L272'>
<a name='L273'><b>static</b> <a href='../S/572.html#L5' title='Defined at 5 in Include/pythread.h.'>PyThread_type_lock</a> import_lock = 0;
<a name='L274'><b>static</b> <b>long</b> import_lock_thread = -1;
<a name='L275'><b>static</b> <b>int</b> import_lock_level = 0;
<a name='L276'>
<a name='L277'><b>void</b>
<a name='L278'><a href='../R/5422.html' title='Multiple refered from 6 places.'>_PyImport_AcquireLock</a>(<b>void</b>)
<a name='L279'><font color='red'>{</font>
<a name='L280'>    <b>long</b> me = <a href='../D/3856.html' title='Multiple defined in 10 places.'>PyThread_get_thread_ident</a>();
<a name='L281'>    <b>if</b> (me == -1)
<a name='L282'>        <b>return</b>; <i><font color='green'>/* Too bad */</font></i>
<a name='L283'>    <b>if</b> (import_lock == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L284'>        import_lock = <a href='../D/3848.html' title='Multiple defined in 11 places.'>PyThread_allocate_lock</a>();
<a name='L285'>        <b>if</b> (import_lock == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L286'>            <b>return</b>;  <i><font color='green'>/* Nothing much we can do. */</font></i>
<a name='L287'>    <font color='red'>}</font>
<a name='L288'>    <b>if</b> (import_lock_thread == me) <font color='red'>{</font>
<a name='L289'>        import_lock_level++;
<a name='L290'>        <b>return</b>;
<a name='L291'>    <font color='red'>}</font>
<a name='L292'>    <b>if</b> (import_lock_thread != -1 || !<a href='../D/3846.html' title='Multiple defined in 10 places.'>PyThread_acquire_lock</a>(import_lock, 0))
<a name='L293'>    <font color='red'>{</font>
<a name='L294'>        <a href='../D/3832.html' title='Multiple defined in 2 places.'>PyThreadState</a> *tstate = <a href='../S/3091.html#L422' title='Defined at 422 in Python/ceval.c.'>PyEval_SaveThread</a>();
<a name='L295'>        <a href='../D/3846.html' title='Multiple defined in 10 places.'>PyThread_acquire_lock</a>(import_lock, 1);
<a name='L296'>        <a href='../S/3091.html#L435' title='Defined at 435 in Python/ceval.c.'>PyEval_RestoreThread</a>(tstate);
<a name='L297'>    <font color='red'>}</font>
<a name='L298'>    import_lock_thread = me;
<a name='L299'>    import_lock_level = 1;
<a name='L300'><font color='red'>}</font>
<a name='L301'>
<a name='L302'><b>int</b>
<a name='L303'><a href='../R/5432.html' title='Multiple refered from 6 places.'>_PyImport_ReleaseLock</a>(<b>void</b>)
<a name='L304'><font color='red'>{</font>
<a name='L305'>    <b>long</b> me = <a href='../D/3856.html' title='Multiple defined in 10 places.'>PyThread_get_thread_ident</a>();
<a name='L306'>    <b>if</b> (me == -1 || import_lock == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L307'>        <b>return</b> 0; <i><font color='green'>/* Too bad */</font></i>
<a name='L308'>    <b>if</b> (import_lock_thread != me)
<a name='L309'>        <b>return</b> -1;
<a name='L310'>    import_lock_level--;
<a name='L311'>    <b>if</b> (import_lock_level == 0) <font color='red'>{</font>
<a name='L312'>        import_lock_thread = -1;
<a name='L313'>        <a href='../D/3858.html' title='Multiple defined in 11 places.'>PyThread_release_lock</a>(import_lock);
<a name='L314'>    <font color='red'>}</font>
<a name='L315'>    <b>return</b> 1;
<a name='L316'><font color='red'>}</font>
<a name='L317'>
<a name='L318'><i><font color='green'>/* This function is called from PyOS_AfterFork to ensure that newly</font></i>
<a name='L319'><i><font color='green'>   created child processes do not share locks with the parent.</font></i>
<a name='L320'><i><font color='green'>   We now acquire the import lock around fork() calls but on some platforms</font></i>
<a name='L321'><i><font color='green'>   (Solaris 9 and earlier? see isue7242) that still left us with problems. */</font></i>
<a name='L322'>
<a name='L323'><b>void</b>
<a name='L324'><a href='../S/2710.html#L991' title='Refered from 991 in Modules/signalmodule.c.'>_PyImport_ReInitLock</a>(<b>void</b>)
<a name='L325'><font color='red'>{</font>
<a name='L326'>    <b>if</b> (import_lock != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L327'>        import_lock = <a href='../D/3848.html' title='Multiple defined in 11 places.'>PyThread_allocate_lock</a>();
<a name='L328'>    <b>if</b> (import_lock_level &gt; 1) <font color='red'>{</font>
<a name='L329'>        <i><font color='green'>/* Forked as a side effect of import */</font></i>
<a name='L330'>        <b>long</b> me = <a href='../D/3856.html' title='Multiple defined in 10 places.'>PyThread_get_thread_ident</a>();
<a name='L331'>        <a href='../D/3846.html' title='Multiple defined in 10 places.'>PyThread_acquire_lock</a>(import_lock, 0);
<a name='L332'>        <i><font color='green'>/* XXX: can the previous line fail? */</font></i>
<a name='L333'>        import_lock_thread = me;
<a name='L334'>        import_lock_level--;
<a name='L335'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L336'>        import_lock_thread = -1;
<a name='L337'>        import_lock_level = 0;
<a name='L338'>    <font color='red'>}</font>
<a name='L339'><font color='red'>}</font>
<a name='L340'>
<a name='L341'><font color='darkred'>#endif</font>
<a name='L342'>
<a name='L343'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L344'><a href='../S/3120.html#L3624' title='Refered from 3624 in Python/import.c.'>imp_lock_held</a>(PyObject *self, PyObject *noargs)
<a name='L345'><font color='red'>{</font>
<a name='L346'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L347'>    <b>return</b> <a href='../D/2761.html' title='Multiple defined in 2 places.'>PyBool_FromLong</a>(import_lock_thread != -1);
<a name='L348'><font color='darkred'>#else</font>
<a name='L349'>    <b>return</b> <a href='../D/2761.html' title='Multiple defined in 2 places.'>PyBool_FromLong</a>(0);
<a name='L350'><font color='darkred'>#endif</font>
<a name='L351'><font color='red'>}</font>
<a name='L352'>
<a name='L353'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L354'><a href='../S/3120.html#L3625' title='Refered from 3625 in Python/import.c.'>imp_acquire_lock</a>(PyObject *self, PyObject *noargs)
<a name='L355'><font color='red'>{</font>
<a name='L356'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L357'>    <a href='../S/3120.html#L278' title='Defined at 278 in Python/import.c.'>_PyImport_AcquireLock</a>();
<a name='L358'><font color='darkred'>#endif</font>
<a name='L359'>    Py_INCREF(Py_None);
<a name='L360'>    <b>return</b> Py_None;
<a name='L361'><font color='red'>}</font>
<a name='L362'>
<a name='L363'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L364'><a href='../S/3120.html#L3626' title='Refered from 3626 in Python/import.c.'>imp_release_lock</a>(PyObject *self, PyObject *noargs)
<a name='L365'><font color='red'>{</font>
<a name='L366'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L367'>    <b>if</b> (<a href='../S/3120.html#L303' title='Defined at 303 in Python/import.c.'>_PyImport_ReleaseLock</a>() &lt; 0) <font color='red'>{</font>
<a name='L368'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_RuntimeError,
<a name='L369'>                        "not holding the import lock");
<a name='L370'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L371'>    <font color='red'>}</font>
<a name='L372'><font color='darkred'>#endif</font>
<a name='L373'>    Py_INCREF(Py_None);
<a name='L374'>    <b>return</b> Py_None;
<a name='L375'><font color='red'>}</font>
<a name='L376'>
<a name='L377'><b>static</b> <b>void</b>
<a name='L378'><a href='../R/8320.html' title='Multiple refered from 4 places.'>imp_modules_reloading_clear</a>(<b>void</b>)
<a name='L379'><font color='red'>{</font>
<a name='L380'>    <a href='../D/3410.html' title='Multiple defined in 2 places.'>PyInterpreterState</a> *interp = <a href='../S/3134.html#L368' title='Defined at 368 in Python/pystate.c.'>PyThreadState_Get</a>()-&gt;interp;
<a name='L381'>    <b>if</b> (interp-&gt;modules_reloading != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L382'>        <a href='../S/2787.html#L870' title='Defined at 870 in Objects/dictobject.c.'>PyDict_Clear</a>(interp-&gt;modules_reloading);
<a name='L383'><font color='red'>}</font>
<a name='L384'>
<a name='L385'><i><font color='green'>/* Helper for sys */</font></i>
<a name='L386'>
<a name='L387'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L388'><a href='../R/3012.html' title='Multiple refered from 15 places.'>PyImport_GetModuleDict</a>(<b>void</b>)
<a name='L389'><font color='red'>{</font>
<a name='L390'>    <a href='../D/3410.html' title='Multiple defined in 2 places.'>PyInterpreterState</a> *interp = <a href='../S/509.html#L90' title='Defined at 90 in Include/ceval.h.'>PyThreadState_GET</a>()-&gt;interp;
<a name='L391'>    <b>if</b> (interp-&gt;modules == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L392'>        <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("PyImport_GetModuleDict: no module dictionary!");
<a name='L393'>    <b>return</b> interp-&gt;modules;
<a name='L394'><font color='red'>}</font>
<a name='L395'>
<a name='L396'>
<a name='L397'><i><font color='green'>/* List of names to clear in sys */</font></i>
<a name='L398'><b>static</b> <b>char</b>* sys_deletes[] = <font color='red'>{</font>
<a name='L399'>    "path", "argv", "ps1", "ps2",
<a name='L400'>    "last_type", "last_value", "last_traceback",
<a name='L401'>    "path_hooks", "path_importer_cache", "meta_path",
<a name='L402'>    <i><font color='green'>/* misc stuff */</font></i>
<a name='L403'>    "flags", "float_info",
<a name='L404'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L405'><font color='red'>}</font>;
<a name='L406'>
<a name='L407'><b>static</b> <b>char</b>* sys_files[] = <font color='red'>{</font>
<a name='L408'>    "stdin", "__stdin__",
<a name='L409'>    "stdout", "__stdout__",
<a name='L410'>    "stderr", "__stderr__",
<a name='L411'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L412'><font color='red'>}</font>;
<a name='L413'>
<a name='L414'>
<a name='L415'><i><font color='green'>/* Un-initialize things, as good as we can */</font></i>
<a name='L416'>
<a name='L417'><b>void</b>
<a name='L418'><a href='../R/3007.html' title='Multiple refered from 2 places.'>PyImport_Cleanup</a>(<b>void</b>)
<a name='L419'><font color='red'>{</font>
<a name='L420'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> pos, ndone;
<a name='L421'>    <b>char</b> *name;
<a name='L422'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, *<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>, *dict;
<a name='L423'>    <a href='../D/3410.html' title='Multiple defined in 2 places.'>PyInterpreterState</a> *interp = <a href='../S/509.html#L90' title='Defined at 90 in Include/ceval.h.'>PyThreadState_GET</a>()-&gt;interp;
<a name='L424'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = interp-&gt;modules;
<a name='L425'>
<a name='L426'>    <b>if</b> (modules == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L427'>        <b>return</b>; <i><font color='green'>/* Already done */</font></i>
<a name='L428'>
<a name='L429'>    <i><font color='green'>/* Delete some special variables first.  These are common</font></i>
<a name='L430'><i><font color='green'>       places where user values hide and people complain when their</font></i>
<a name='L431'><i><font color='green'>       destructors fail.  Since the modules containing them are</font></i>
<a name='L432'><i><font color='green'>       deleted *last* of all, they would come too late in the normal</font></i>
<a name='L433'><i><font color='green'>       destruction order.  Sigh. */</font></i>
<a name='L434'>
<a name='L435'>    <a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, "builtins");
<a name='L436'>    <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; PyModule_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L437'>        dict = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L438'>        <b>if</b> (Py_VerboseFlag)
<a name='L439'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# clear builtins._\n");
<a name='L440'>        <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(dict, "_", Py_None);
<a name='L441'>    <font color='red'>}</font>
<a name='L442'>    <a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, "sys");
<a name='L443'>    <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; PyModule_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L444'>        <b>char</b> **p;
<a name='L445'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *v;
<a name='L446'>        dict = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L447'>        <b>for</b> (p = sys_deletes; *p != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; p++) <font color='red'>{</font>
<a name='L448'>            <b>if</b> (Py_VerboseFlag)
<a name='L449'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# clear sys.%s\n", *p);
<a name='L450'>            <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(dict, *p, Py_None);
<a name='L451'>        <font color='red'>}</font>
<a name='L452'>        <b>for</b> (p = sys_files; *p != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; p+=2) <font color='red'>{</font>
<a name='L453'>            <b>if</b> (Py_VerboseFlag)
<a name='L454'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# restore sys.%s\n", *p);
<a name='L455'>            v = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(dict, *(p+1));
<a name='L456'>            <b>if</b> (v == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L457'>                v = Py_None;
<a name='L458'>            <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(dict, *p, v);
<a name='L459'>        <font color='red'>}</font>
<a name='L460'>    <font color='red'>}</font>
<a name='L461'>
<a name='L462'>    <i><font color='green'>/* First, delete __main__ */</font></i>
<a name='L463'>    <a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, "__main__");
<a name='L464'>    <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; PyModule_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L465'>        <b>if</b> (Py_VerboseFlag)
<a name='L466'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# cleanup __main__\n");
<a name='L467'>        <a href='../S/2802.html#L247' title='Defined at 247 in Objects/moduleobject.c.'>_PyModule_Clear</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L468'>        <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules, "__main__", Py_None);
<a name='L469'>    <font color='red'>}</font>
<a name='L470'>
<a name='L471'>    <i><font color='green'>/* The special treatment of "builtins" here is because even</font></i>
<a name='L472'><i><font color='green'>       when it's not referenced as a module, its dictionary is</font></i>
<a name='L473'><i><font color='green'>       referenced by almost every module's __builtins__.  Since</font></i>
<a name='L474'><i><font color='green'>       deleting a module clears its dictionary (even if there are</font></i>
<a name='L475'><i><font color='green'>       references left to it), we need to delete the "builtins"</font></i>
<a name='L476'><i><font color='green'>       module last.  Likewise, we don't delete sys until the very</font></i>
<a name='L477'><i><font color='green'>       end because it is implicitly referenced (e.g. by print).</font></i>
<a name='L478'><i><font color='green'></font></i>
<a name='L479'><i><font color='green'>       Also note that we 'delete' modules by replacing their entry</font></i>
<a name='L480'><i><font color='green'>       in the modules dict with None, rather than really deleting</font></i>
<a name='L481'><i><font color='green'>       them; this avoids a rehash of the modules dictionary and</font></i>
<a name='L482'><i><font color='green'>       also marks them as "non existent" so they won't be</font></i>
<a name='L483'><i><font color='green'>       re-imported. */</font></i>
<a name='L484'>
<a name='L485'>    <i><font color='green'>/* Next, repeatedly delete modules with a reference count of</font></i>
<a name='L486'><i><font color='green'>       one (skipping builtins and sys) and delete them */</font></i>
<a name='L487'>    <b>do</b> <font color='red'>{</font>
<a name='L488'>        ndone = 0;
<a name='L489'>        pos = 0;
<a name='L490'>        <b>while</b> (<a href='../S/2787.html#L954' title='Defined at 954 in Objects/dictobject.c.'>PyDict_Next</a>(modules, &amp;pos, &amp;<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L491'>            <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>-&gt;ob_refcnt != 1)
<a name='L492'>                <b>continue</b>;
<a name='L493'>            <b>if</b> (PyUnicode_Check(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>) &amp;&amp; PyModule_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L494'>                name = <a href='../S/2828.html#L1919' title='Defined at 1919 in Objects/unicodeobject.c.'>_PyUnicode_AsString</a>(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>);
<a name='L495'>                <b>if</b> (strcmp(name, "builtins") == 0)
<a name='L496'>                    <b>continue</b>;
<a name='L497'>                <b>if</b> (strcmp(name, "sys") == 0)
<a name='L498'>                    <b>continue</b>;
<a name='L499'>                <b>if</b> (Py_VerboseFlag)
<a name='L500'>                    <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L501'>                        "# cleanup[1] %s\n", name);
<a name='L502'>                <a href='../S/2802.html#L247' title='Defined at 247 in Objects/moduleobject.c.'>_PyModule_Clear</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L503'>                <a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(modules, <a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, Py_None);
<a name='L504'>                ndone++;
<a name='L505'>            <font color='red'>}</font>
<a name='L506'>        <font color='red'>}</font>
<a name='L507'>    <font color='red'>}</font> <b>while</b> (ndone &gt; 0);
<a name='L508'>
<a name='L509'>    <i><font color='green'>/* Next, delete all modules (still skipping builtins and sys) */</font></i>
<a name='L510'>    pos = 0;
<a name='L511'>    <b>while</b> (<a href='../S/2787.html#L954' title='Defined at 954 in Objects/dictobject.c.'>PyDict_Next</a>(modules, &amp;pos, &amp;<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, &amp;<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L512'>        <b>if</b> (PyUnicode_Check(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>) &amp;&amp; PyModule_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L513'>            name = <a href='../S/2828.html#L1919' title='Defined at 1919 in Objects/unicodeobject.c.'>_PyUnicode_AsString</a>(<a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>);
<a name='L514'>            <b>if</b> (strcmp(name, "builtins") == 0)
<a name='L515'>                <b>continue</b>;
<a name='L516'>            <b>if</b> (strcmp(name, "sys") == 0)
<a name='L517'>                <b>continue</b>;
<a name='L518'>            <b>if</b> (Py_VerboseFlag)
<a name='L519'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# cleanup[2] %s\n", name);
<a name='L520'>            <a href='../S/2802.html#L247' title='Defined at 247 in Objects/moduleobject.c.'>_PyModule_Clear</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L521'>            <a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(modules, <a href='../S/3145.html#L213' title='Defined at 213 in Python/thread.c.'>key</a>, Py_None);
<a name='L522'>        <font color='red'>}</font>
<a name='L523'>    <font color='red'>}</font>
<a name='L524'>
<a name='L525'>    <i><font color='green'>/* Next, delete sys and builtins (in that order) */</font></i>
<a name='L526'>    <a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, "sys");
<a name='L527'>    <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; PyModule_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L528'>        <b>if</b> (Py_VerboseFlag)
<a name='L529'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# cleanup sys\n");
<a name='L530'>        <a href='../S/2802.html#L247' title='Defined at 247 in Objects/moduleobject.c.'>_PyModule_Clear</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L531'>        <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules, "sys", Py_None);
<a name='L532'>    <font color='red'>}</font>
<a name='L533'>    <a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, "builtins");
<a name='L534'>    <b>if</b> (<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; PyModule_Check(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>)) <font color='red'>{</font>
<a name='L535'>        <b>if</b> (Py_VerboseFlag)
<a name='L536'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# cleanup builtins\n");
<a name='L537'>        <a href='../S/2802.html#L247' title='Defined at 247 in Objects/moduleobject.c.'>_PyModule_Clear</a>(<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L538'>        <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules, "builtins", Py_None);
<a name='L539'>    <font color='red'>}</font>
<a name='L540'>
<a name='L541'>    <i><font color='green'>/* Finally, clear and delete the modules directory */</font></i>
<a name='L542'>    <a href='../S/2787.html#L870' title='Defined at 870 in Objects/dictobject.c.'>PyDict_Clear</a>(modules);
<a name='L543'>    interp-&gt;modules = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L544'>    Py_DECREF(modules);
<a name='L545'>    <a href='../D/4095.html' title='Multiple defined in 2 places.'>Py_CLEAR</a>(interp-&gt;modules_reloading);
<a name='L546'><font color='red'>}</font>
<a name='L547'>
<a name='L548'>
<a name='L549'><i><font color='green'>/* Helper for pythonrun.c -- return magic number and tag. */</font></i>
<a name='L550'>
<a name='L551'><b>long</b>
<a name='L552'><a href='../R/3011.html' title='Multiple refered from 4 places.'>PyImport_GetMagicNumber</a>(<b>void</b>)
<a name='L553'><font color='red'>{</font>
<a name='L554'>    <b>return</b> pyc_magic;
<a name='L555'><font color='red'>}</font>
<a name='L556'>
<a name='L557'>
<a name='L558'><b>const</b> <b>char</b> *
<a name='L559'>PyImport_GetMagicTag(<b>void</b>)
<a name='L560'><font color='red'>{</font>
<a name='L561'>    <b>return</b> pyc_tag;
<a name='L562'><font color='red'>}</font>
<a name='L563'>
<a name='L564'><i><font color='green'>/* Magic for extension modules (built-in as well as dynamically</font></i>
<a name='L565'><i><font color='green'>   loaded).  To prevent initializing an extension module more than</font></i>
<a name='L566'><i><font color='green'>   once, we keep a static dictionary 'extensions' keyed by module name</font></i>
<a name='L567'><i><font color='green'>   (for built-in modules) or by filename (for dynamically loaded</font></i>
<a name='L568'><i><font color='green'>   modules), containing these modules.  A copy of the module's</font></i>
<a name='L569'><i><font color='green'>   dictionary is stored by calling _PyImport_FixupExtensionUnicode()</font></i>
<a name='L570'><i><font color='green'>   immediately after the module initialization function succeeds.  A</font></i>
<a name='L571'><i><font color='green'>   copy can be retrieved from there by calling</font></i>
<a name='L572'><i><font color='green'>   _PyImport_FindExtensionUnicode().</font></i>
<a name='L573'><i><font color='green'></font></i>
<a name='L574'><i><font color='green'>   Modules which do support multiple initialization set their m_size</font></i>
<a name='L575'><i><font color='green'>   field to a non-negative number (indicating the size of the</font></i>
<a name='L576'><i><font color='green'>   module-specific state). They are still recorded in the extensions</font></i>
<a name='L577'><i><font color='green'>   dictionary, to avoid loading shared libraries twice.</font></i>
<a name='L578'><i><font color='green'>*/</font></i>
<a name='L579'>
<a name='L580'><b>int</b>
<a name='L581'><a href='../R/5427.html' title='Multiple refered from 2 places.'>_PyImport_FixupExtensionUnicode</a>(PyObject *mod, <b>char</b> *name, PyObject *filename)
<a name='L582'><font color='red'>{</font>
<a name='L583'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules, *dict;
<a name='L584'>    <b>struct</b> <a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a> *def;
<a name='L585'>    <b>if</b> (extensions == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L586'>        extensions = <a href='../S/2787.html#L233' title='Defined at 233 in Objects/dictobject.c.'>PyDict_New</a>();
<a name='L587'>        <b>if</b> (extensions == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L588'>            <b>return</b> -1;
<a name='L589'>    <font color='red'>}</font>
<a name='L590'>    <b>if</b> (mod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !PyModule_Check(mod)) <font color='red'>{</font>
<a name='L591'>        <a href='../D/3142.html' title='Multiple defined in 3 places.'>PyErr_BadInternalCall</a>();
<a name='L592'>        <b>return</b> -1;
<a name='L593'>    <font color='red'>}</font>
<a name='L594'>    def = <a href='../S/2802.html#L227' title='Defined at 227 in Objects/moduleobject.c.'>PyModule_GetDef</a>(mod);
<a name='L595'>    <b>if</b> (!def) <font color='red'>{</font>
<a name='L596'>        <a href='../D/3142.html' title='Multiple defined in 3 places.'>PyErr_BadInternalCall</a>();
<a name='L597'>        <b>return</b> -1;
<a name='L598'>    <font color='red'>}</font>
<a name='L599'>    modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L600'>    <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules, name, mod) &lt; 0)
<a name='L601'>        <b>return</b> -1;
<a name='L602'>    <b>if</b> (<a href='../S/3134.html#L252' title='Defined at 252 in Python/pystate.c.'>_PyState_AddModule</a>(mod, def) &lt; 0) <font color='red'>{</font>
<a name='L603'>        <a href='../S/2787.html#L2194' title='Defined at 2194 in Objects/dictobject.c.'>PyDict_DelItemString</a>(modules, name);
<a name='L604'>        <b>return</b> -1;
<a name='L605'>    <font color='red'>}</font>
<a name='L606'>    <b>if</b> (def-&gt;m_size == -1) <font color='red'>{</font>
<a name='L607'>        <b>if</b> (def-&gt;m_base.m_copy) <font color='red'>{</font>
<a name='L608'>            <i><font color='green'>/* Somebody already imported the module,</font></i>
<a name='L609'><i><font color='green'>               likely under a different name.</font></i>
<a name='L610'><i><font color='green'>               XXX this should really not happen. */</font></i>
<a name='L611'>            Py_DECREF(def-&gt;m_base.m_copy);
<a name='L612'>            def-&gt;m_base.m_copy = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L613'>        <font color='red'>}</font>
<a name='L614'>        dict = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(mod);
<a name='L615'>        <b>if</b> (dict == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L616'>            <b>return</b> -1;
<a name='L617'>        def-&gt;m_base.m_copy = <a href='../S/2787.html#L1602' title='Defined at 1602 in Objects/dictobject.c.'>PyDict_Copy</a>(dict);
<a name='L618'>        <b>if</b> (def-&gt;m_base.m_copy == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L619'>            <b>return</b> -1;
<a name='L620'>    <font color='red'>}</font>
<a name='L621'>    <a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(extensions, filename, (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a>*)def);
<a name='L622'>    <b>return</b> 0;
<a name='L623'><font color='red'>}</font>
<a name='L624'>
<a name='L625'><b>int</b>
<a name='L626'><a href='../R/5426.html' title='Multiple refered from 4 places.'>_PyImport_FixupBuiltin</a>(PyObject *mod, <b>char</b> *name)
<a name='L627'><font color='red'>{</font>
<a name='L628'>    <b>int</b> res;
<a name='L629'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *filename;
<a name='L630'>    filename = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(name);
<a name='L631'>    <b>if</b> (filename == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L632'>        <b>return</b> -1;
<a name='L633'>    res = <a href='../S/3120.html#L581' title='Defined at 581 in Python/import.c.'>_PyImport_FixupExtensionUnicode</a>(mod, name, filename);
<a name='L634'>    Py_DECREF(filename);
<a name='L635'>    <b>return</b> res;
<a name='L636'><font color='red'>}</font>
<a name='L637'>
<a name='L638'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L639'><a href='../R/5424.html' title='Multiple refered from 2 places.'>_PyImport_FindExtensionUnicode</a>(<b>char</b> *name, PyObject *filename)
<a name='L640'><font color='red'>{</font>
<a name='L641'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *mod, *mdict;
<a name='L642'>    <a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a>* def;
<a name='L643'>    <b>if</b> (extensions == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L644'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L645'>    def = (<a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a>*)<a href='../S/2787.html#L704' title='Defined at 704 in Objects/dictobject.c.'>PyDict_GetItem</a>(extensions, filename);
<a name='L646'>    <b>if</b> (def == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L647'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L648'>    <b>if</b> (def-&gt;m_size == -1) <font color='red'>{</font>
<a name='L649'>        <i><font color='green'>/* Module does not support repeated initialization */</font></i>
<a name='L650'>        <b>if</b> (def-&gt;m_base.m_copy == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L651'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L652'>        mod = <a href='../S/3120.html#L701' title='Defined at 701 in Python/import.c.'>PyImport_AddModule</a>(name);
<a name='L653'>        <b>if</b> (mod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L654'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L655'>        mdict = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(mod);
<a name='L656'>        <b>if</b> (mdict == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L657'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L658'>        <b>if</b> (<a href='../S/2787.html#L1493' title='Defined at 1493 in Objects/dictobject.c.'>PyDict_Update</a>(mdict, def-&gt;m_base.m_copy))
<a name='L659'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L660'>    <font color='red'>}</font>
<a name='L661'>    <b>else</b> <font color='red'>{</font>
<a name='L662'>        <b>if</b> (def-&gt;m_base.m_init == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L663'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L664'>        mod = def-&gt;m_base.m_init();
<a name='L665'>        <b>if</b> (mod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L666'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L667'>        <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(<a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>(), name, mod);
<a name='L668'>        Py_DECREF(mod);
<a name='L669'>    <font color='red'>}</font>
<a name='L670'>    <b>if</b> (<a href='../S/3134.html#L252' title='Defined at 252 in Python/pystate.c.'>_PyState_AddModule</a>(mod, def) &lt; 0) <font color='red'>{</font>
<a name='L671'>        <a href='../S/2787.html#L2194' title='Defined at 2194 in Objects/dictobject.c.'>PyDict_DelItemString</a>(<a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>(), name);
<a name='L672'>        Py_DECREF(mod);
<a name='L673'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L674'>    <font color='red'>}</font>
<a name='L675'>    <b>if</b> (Py_VerboseFlag)
<a name='L676'>        <a href='../S/3144.html#L2081' title='Defined at 2081 in Python/sysmodule.c.'>PySys_FormatStderr</a>("import %s # previously loaded (%U)\n",
<a name='L677'>                          name, filename);
<a name='L678'>    <b>return</b> mod;
<a name='L679'>
<a name='L680'><font color='red'>}</font>
<a name='L681'>
<a name='L682'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L683'><a href='../R/5423.html' title='Multiple refered from 3 places.'>_PyImport_FindBuiltin</a>(<b>char</b> *name)
<a name='L684'><font color='red'>{</font>
<a name='L685'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *res, *filename;
<a name='L686'>    filename = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(name);
<a name='L687'>    <b>if</b> (filename == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L688'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L689'>    res = <a href='../S/3120.html#L639' title='Defined at 639 in Python/import.c.'>_PyImport_FindExtensionUnicode</a>(name, filename);
<a name='L690'>    Py_DECREF(filename);
<a name='L691'>    <b>return</b> res;
<a name='L692'><font color='red'>}</font>
<a name='L693'>
<a name='L694'><i><font color='green'>/* Get the module object corresponding to a module name.</font></i>
<a name='L695'><i><font color='green'>   First check the modules dictionary if there's one there,</font></i>
<a name='L696'><i><font color='green'>   if not, create a new one and insert it in the modules dictionary.</font></i>
<a name='L697'><i><font color='green'>   Because the former action is most common, THIS DOES NOT RETURN A</font></i>
<a name='L698'><i><font color='green'>   'NEW' REFERENCE! */</font></i>
<a name='L699'>
<a name='L700'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L701'><a href='../R/3006.html' title='Multiple refered from 11 places.'>PyImport_AddModule</a>(<b>const</b> <b>char</b> *name)
<a name='L702'><font color='red'>{</font>
<a name='L703'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L704'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L705'>
<a name='L706'>    <b>if</b> ((m = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, name)) != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp;
<a name='L707'>        PyModule_Check(m))
<a name='L708'>        <b>return</b> m;
<a name='L709'>    m = <a href='../S/2802.html#L30' title='Defined at 30 in Objects/moduleobject.c.'>PyModule_New</a>(name);
<a name='L710'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L711'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L712'>    <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules, name, m) != 0) <font color='red'>{</font>
<a name='L713'>        Py_DECREF(m);
<a name='L714'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L715'>    <font color='red'>}</font>
<a name='L716'>    Py_DECREF(m); <i><font color='green'>/* Yes, it still exists, in modules! */</font></i>
<a name='L717'>
<a name='L718'>    <b>return</b> m;
<a name='L719'><font color='red'>}</font>
<a name='L720'>
<a name='L721'><i><font color='green'>/* Remove name from sys.modules, if it's there. */</font></i>
<a name='L722'><b>static</b> <b>void</b>
<a name='L723'><a href='../S/3120.html#L826' title='Refered from 826 in Python/import.c.'>remove_module</a>(<b>const</b> <b>char</b> *name)
<a name='L724'><font color='red'>{</font>
<a name='L725'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L726'>    <b>if</b> (<a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, name) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L727'>        <b>return</b>;
<a name='L728'>    <b>if</b> (<a href='../S/2787.html#L2194' title='Defined at 2194 in Objects/dictobject.c.'>PyDict_DelItemString</a>(modules, name) &lt; 0)
<a name='L729'>        <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("import:  deleting existing key in"
<a name='L730'>                      "sys.modules failed");
<a name='L731'><font color='red'>}</font>
<a name='L732'>
<a name='L733'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> * <a href='../S/3120.html#L1350' title='Defined at 1350 in Python/import.c.'>get_sourcefile</a>(<b>char</b> *file);
<a name='L734'><b>static</b> <b>char</b> *<a href='../S/3120.html#L968' title='Defined at 968 in Python/import.c.'>make_source_pathname</a>(<b>char</b> *pathname, <b>char</b> *buf);
<a name='L735'><b>static</b> <b>char</b> *<a href='../S/3120.html#L858' title='Defined at 858 in Python/import.c.'>make_compiled_pathname</a>(<b>char</b> *pathname, <b>char</b> *buf, <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> buflen,
<a name='L736'>                                    <b>int</b> debug);
<a name='L737'>
<a name='L738'><i><font color='green'>/* Execute a code object in a module and return the module object</font></i>
<a name='L739'><i><font color='green'> * WITH INCREMENTED REFERENCE COUNT.  If an error occurs, name is</font></i>
<a name='L740'><i><font color='green'> * removed from sys.modules, to avoid leaving damaged module objects</font></i>
<a name='L741'><i><font color='green'> * in sys.modules.  The caller may wish to restore the original</font></i>
<a name='L742'><i><font color='green'> * module object (if any) in this case; PyImport_ReloadModule is an</font></i>
<a name='L743'><i><font color='green'> * example.</font></i>
<a name='L744'><i><font color='green'> *</font></i>
<a name='L745'><i><font color='green'> * Note that PyImport_ExecCodeModuleWithPathnames() is the preferred, richer</font></i>
<a name='L746'><i><font color='green'> * interface.  The other two exist primarily for backward compatibility.</font></i>
<a name='L747'><i><font color='green'> */</font></i>
<a name='L748'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L749'>PyImport_ExecCodeModule(<b>char</b> *name, PyObject *co)
<a name='L750'><font color='red'>{</font>
<a name='L751'>    <b>return</b> <a href='../S/3120.html#L763' title='Defined at 763 in Python/import.c.'>PyImport_ExecCodeModuleWithPathnames</a>(
<a name='L752'>        name, co, (<b>char</b> *)<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, (<b>char</b> *)<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L753'><font color='red'>}</font>
<a name='L754'>
<a name='L755'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L756'><a href='../R/3008.html' title='Multiple refered from 2 places.'>PyImport_ExecCodeModuleEx</a>(<b>char</b> *name, PyObject *co, <b>char</b> *pathname)
<a name='L757'><font color='red'>{</font>
<a name='L758'>    <b>return</b> <a href='../S/3120.html#L763' title='Defined at 763 in Python/import.c.'>PyImport_ExecCodeModuleWithPathnames</a>(
<a name='L759'>        name, co, pathname, (<b>char</b> *)<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L760'><font color='red'>}</font>
<a name='L761'>
<a name='L762'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L763'><a href='../R/3009.html' title='Multiple refered from 4 places.'>PyImport_ExecCodeModuleWithPathnames</a>(<b>char</b> *name, PyObject *co, <b>char</b> *pathname,
<a name='L764'>                                     <b>char</b> *cpathname)
<a name='L765'><font color='red'>{</font>
<a name='L766'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L767'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m, *d, *v;
<a name='L768'>
<a name='L769'>    m = <a href='../S/3120.html#L701' title='Defined at 701 in Python/import.c.'>PyImport_AddModule</a>(name);
<a name='L770'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L771'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L772'>    <i><font color='green'>/* If the module is being reloaded, we get the old module back</font></i>
<a name='L773'><i><font color='green'>       and re-use its dict to exec the new code. */</font></i>
<a name='L774'>    d = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(m);
<a name='L775'>    <b>if</b> (<a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(d, "__builtins__") == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L776'>        <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "__builtins__",
<a name='L777'>                                 <a href='../S/3091.html#L3667' title='Defined at 3667 in Python/ceval.c.'>PyEval_GetBuiltins</a>()) != 0)
<a name='L778'>            <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L779'>    <font color='red'>}</font>
<a name='L780'>    <i><font color='green'>/* Remember the filename as the __file__ attribute */</font></i>
<a name='L781'>    v = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L782'>    <b>if</b> (pathname != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L783'>        v = <a href='../S/3120.html#L1350' title='Defined at 1350 in Python/import.c.'>get_sourcefile</a>(pathname);
<a name='L784'>        <b>if</b> (v == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L785'>            <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L786'>    <font color='red'>}</font>
<a name='L787'>    <b>if</b> (v == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L788'>        v = ((<a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *)co)-&gt;co_filename;
<a name='L789'>        Py_INCREF(v);
<a name='L790'>    <font color='red'>}</font>
<a name='L791'>    <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "__file__", v) != 0)
<a name='L792'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>(); <i><font color='green'>/* Not important enough to report */</font></i>
<a name='L793'>    Py_DECREF(v);
<a name='L794'>
<a name='L795'>    <i><font color='green'>/* Remember the pyc path name as the __cached__ attribute. */</font></i>
<a name='L796'>    <b>if</b> (cpathname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L797'>        v = Py_None;
<a name='L798'>        Py_INCREF(v);
<a name='L799'>    <font color='red'>}</font>
<a name='L800'>    <b>else</b> <b>if</b> ((v = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(cpathname)) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L801'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>(); <i><font color='green'>/* Not important enough to report */</font></i>
<a name='L802'>        v = Py_None;
<a name='L803'>        Py_INCREF(v);
<a name='L804'>    <font color='red'>}</font>
<a name='L805'>    <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "__cached__", v) != 0)
<a name='L806'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>(); <i><font color='green'>/* Not important enough to report */</font></i>
<a name='L807'>    Py_DECREF(v);
<a name='L808'>
<a name='L809'>    v = <a href='../S/3091.html#L759' title='Defined at 759 in Python/ceval.c.'>PyEval_EvalCode</a>(co, d, d);
<a name='L810'>    <b>if</b> (v == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L811'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L812'>    Py_DECREF(v);
<a name='L813'>
<a name='L814'>    <b>if</b> ((m = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, name)) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L815'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L816'>                     "Loaded module %.200s not found in sys.modules",
<a name='L817'>                     name);
<a name='L818'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L819'>    <font color='red'>}</font>
<a name='L820'>
<a name='L821'>    Py_INCREF(m);
<a name='L822'>
<a name='L823'>    <b>return</b> m;
<a name='L824'>
<a name='L825'>  <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>:
<a name='L826'>    <a href='../S/3120.html#L723' title='Defined at 723 in Python/import.c.'>remove_module</a>(name);
<a name='L827'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L828'><font color='red'>}</font>
<a name='L829'>
<a name='L830'>
<a name='L831'><i><font color='green'>/* Like strrchr(string, '/') but searches for the rightmost of either SEP</font></i>
<a name='L832'><i><font color='green'>   or ALTSEP, if the latter is defined.</font></i>
<a name='L833'><i><font color='green'>*/</font></i>
<a name='L834'><b>static</b> <b>char</b> *
<a name='L835'><a href='../R/10050.html' title='Multiple refered from 4 places.'>rightmost_sep</a>(<b>char</b> *s)
<a name='L836'><font color='red'>{</font>
<a name='L837'>    <b>char</b> *found, c;
<a name='L838'>    <b>for</b> (found = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; (c = *s); s++) <font color='red'>{</font>
<a name='L839'>        <b>if</b> (c == <a href='../D/4596.html' title='Multiple defined in 3 places.'>SEP</a>
<a name='L840'><font color='darkred'>#ifdef</font> <a href='../D/64.html' title='Multiple defined in 2 places.'>ALTSEP</a>
<a name='L841'>            || c == <a href='../D/64.html' title='Multiple defined in 2 places.'>ALTSEP</a>
<a name='L842'><font color='darkred'>#endif</font>
<a name='L843'>            )
<a name='L844'>        <font color='red'>{</font>
<a name='L845'>            found = s;
<a name='L846'>        <font color='red'>}</font>
<a name='L847'>    <font color='red'>}</font>
<a name='L848'>    <b>return</b> found;
<a name='L849'><font color='red'>}</font>
<a name='L850'>
<a name='L851'>
<a name='L852'><i><font color='green'>/* Given a pathname for a Python source file, fill a buffer with the</font></i>
<a name='L853'><i><font color='green'>   pathname for the corresponding compiled file.  Return the pathname</font></i>
<a name='L854'><i><font color='green'>   for the compiled file, or NULL if there's no space in the buffer.</font></i>
<a name='L855'><i><font color='green'>   Doesn't set an exception. */</font></i>
<a name='L856'>
<a name='L857'><b>static</b> <b>char</b> *
<a name='L858'><a href='../R/8834.html' title='Multiple refered from 3 places.'>make_compiled_pathname</a>(<b>char</b> *pathname, <b>char</b> *buf, <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> buflen, <b>int</b> debug)
<a name='L859'><font color='red'>{</font>
<a name='L860'>    <i><font color='green'>/* foo.py -&gt; __pycache__/foo.&lt;tag&gt;.pyc */</font></i>
<a name='L861'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> len = strlen(pathname);
<a name='L862'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> i, <a href='../S/2588.html#L3047' title='Defined at 3047 in Modules/_pickle.c.'>save</a>;
<a name='L863'>    <b>char</b> *pos;
<a name='L864'>    <b>int</b> sep = <a href='../D/4596.html' title='Multiple defined in 3 places.'>SEP</a>;
<a name='L865'>
<a name='L866'>    <i><font color='green'>/* Sanity check that the buffer has roughly enough space to hold what</font></i>
<a name='L867'><i><font color='green'>       will eventually be the full path to the compiled file.  The 5 extra</font></i>
<a name='L868'><i><font color='green'>       bytes include the slash afer __pycache__, the two extra dots, the</font></i>
<a name='L869'><i><font color='green'>       extra trailing character ('c' or 'o') and null.  This isn't exact</font></i>
<a name='L870'><i><font color='green'>       because the contents of the buffer can affect how many actual</font></i>
<a name='L871'><i><font color='green'>       characters of the string get into the buffer.  We'll do a final</font></i>
<a name='L872'><i><font color='green'>       sanity check before writing the extension to ensure we do not</font></i>
<a name='L873'><i><font color='green'>       overflow the buffer.</font></i>
<a name='L874'><i><font color='green'>    */</font></i>
<a name='L875'>    <b>if</b> (len + strlen(<a href='../S/3120.html#L115' title='Defined at 115 in Python/import.c.'>CACHEDIR</a>) + strlen(pyc_tag) + 5 &gt; buflen)
<a name='L876'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L877'>
<a name='L878'>    <i><font color='green'>/* Find the last path separator and copy everything from the start of</font></i>
<a name='L879'><i><font color='green'>       the source string up to and including the separator.</font></i>
<a name='L880'><i><font color='green'>    */</font></i>
<a name='L881'>    <b>if</b> ((pos = <a href='../S/3120.html#L835' title='Defined at 835 in Python/import.c.'>rightmost_sep</a>(pathname)) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L882'>        i = 0;
<a name='L883'>    <font color='red'>}</font>
<a name='L884'>    <b>else</b> <font color='red'>{</font>
<a name='L885'>        sep = *pos;
<a name='L886'>        i = pos - pathname + 1;
<a name='L887'>        strncpy(buf, pathname, i);
<a name='L888'>    <font color='red'>}</font>
<a name='L889'>
<a name='L890'>    <a href='../S/2588.html#L3047' title='Defined at 3047 in Modules/_pickle.c.'>save</a> = i;
<a name='L891'>    buf[i++] = '\0';
<a name='L892'>    <i><font color='green'>/* Add __pycache__/ */</font></i>
<a name='L893'>    strcat(buf, <a href='../S/3120.html#L115' title='Defined at 115 in Python/import.c.'>CACHEDIR</a>);
<a name='L894'>    i += strlen(<a href='../S/3120.html#L115' title='Defined at 115 in Python/import.c.'>CACHEDIR</a>) - 1;
<a name='L895'>    buf[i++] = sep;
<a name='L896'>    buf[i++] = '\0';
<a name='L897'>    <i><font color='green'>/* Add the base filename, but remove the .py or .pyw extension, since</font></i>
<a name='L898'><i><font color='green'>       the tag name must go before the extension.</font></i>
<a name='L899'><i><font color='green'>    */</font></i>
<a name='L900'>    strcat(buf, pathname + <a href='../S/2588.html#L3047' title='Defined at 3047 in Modules/_pickle.c.'>save</a>);
<a name='L901'>    <b>if</b> ((pos = strrchr(buf, '.')) != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L902'>        *++pos = '\0';
<a name='L903'>    strcat(buf, pyc_tag);
<a name='L904'>    <i><font color='green'>/* The length test above assumes that we're only adding one character</font></i>
<a name='L905'><i><font color='green'>       to the end of what would normally be the extension.  What if there</font></i>
<a name='L906'><i><font color='green'>       is no extension, or the string ends in '.' or '.p', and otherwise</font></i>
<a name='L907'><i><font color='green'>       fills the buffer?  By appending 4 more characters onto the string</font></i>
<a name='L908'><i><font color='green'>       here, we could overrun the buffer.</font></i>
<a name='L909'><i><font color='green'></font></i>
<a name='L910'><i><font color='green'>       As a simple example, let's say buflen=32 and the input string is</font></i>
<a name='L911'><i><font color='green'>       'xxx.py'.  strlen() would be 6 and the test above would yield:</font></i>
<a name='L912'><i><font color='green'></font></i>
<a name='L913'><i><font color='green'>       (6 + 11 + 10 + 5 == 32) &gt; 32</font></i>
<a name='L914'><i><font color='green'></font></i>
<a name='L915'><i><font color='green'>       which is false and so the name mangling would continue.  This would</font></i>
<a name='L916'><i><font color='green'>       be fine because we'd end up with this string in buf:</font></i>
<a name='L917'><i><font color='green'></font></i>
<a name='L918'><i><font color='green'>       __pycache__/xxx.cpython-32.pyc\0</font></i>
<a name='L919'><i><font color='green'></font></i>
<a name='L920'><i><font color='green'>       strlen(of that) == 30 + the nul fits inside a 32 character buffer.</font></i>
<a name='L921'><i><font color='green'>       We can even handle an input string of say 'xxxxx' above because</font></i>
<a name='L922'><i><font color='green'>       that's (5 + 11 + 10 + 5 == 31) &gt; 32 which is also false.  Name</font></i>
<a name='L923'><i><font color='green'>       mangling that yields:</font></i>
<a name='L924'><i><font color='green'></font></i>
<a name='L925'><i><font color='green'>       __pycache__/xxxxxcpython-32.pyc\0</font></i>
<a name='L926'><i><font color='green'></font></i>
<a name='L927'><i><font color='green'>       which is 32 characters including the nul, and thus fits in the</font></i>
<a name='L928'><i><font color='green'>       buffer. However, an input string of 'xxxxxx' would yield a result</font></i>
<a name='L929'><i><font color='green'>       string of:</font></i>
<a name='L930'><i><font color='green'></font></i>
<a name='L931'><i><font color='green'>       __pycache__/xxxxxxcpython-32.pyc\0</font></i>
<a name='L932'><i><font color='green'></font></i>
<a name='L933'><i><font color='green'>       which is 33 characters long (including the nul), thus overflowing</font></i>
<a name='L934'><i><font color='green'>       the buffer, even though the first test would fail, i.e.: the input</font></i>
<a name='L935'><i><font color='green'>       string is also 6 characters long, so 32 &gt; 32 is false.</font></i>
<a name='L936'><i><font color='green'></font></i>
<a name='L937'><i><font color='green'>       The reason the first test fails but we still overflow the buffer is</font></i>
<a name='L938'><i><font color='green'>       that the test above only expects to add one extra character to be</font></i>
<a name='L939'><i><font color='green'>       added to the extension, and here we're adding three (pyc).  We</font></i>
<a name='L940'><i><font color='green'>       don't add the first dot, so that reclaims one of expected</font></i>
<a name='L941'><i><font color='green'>       positions, leaving us overflowing by 1 byte (3 extra - 1 reclaimed</font></i>
<a name='L942'><i><font color='green'>       dot - 1 expected extra == 1 overflowed).</font></i>
<a name='L943'><i><font color='green'></font></i>
<a name='L944'><i><font color='green'>       The best we can do is ensure that we still have enough room in the</font></i>
<a name='L945'><i><font color='green'>       target buffer before we write the extension.  Because it's always</font></i>
<a name='L946'><i><font color='green'>       only the extension that can cause the overflow, and never the other</font></i>
<a name='L947'><i><font color='green'>       path bytes we've written, it's sufficient to just do one more test</font></i>
<a name='L948'><i><font color='green'>       here.  Still, the assertion that follows can't hurt.</font></i>
<a name='L949'><i><font color='green'>    */</font></i>
<a name='L950'><font color='darkred'>#if</font> 0
<a name='L951'>    printf("strlen(buf): %d; buflen: %d\n", (<b>int</b>)strlen(buf), (<b>int</b>)buflen);
<a name='L952'><font color='darkred'>#endif</font>
<a name='L953'>    <b>if</b> (strlen(buf) + 5 &gt; buflen)
<a name='L954'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L955'>    strcat(buf, <a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> ? ".pyc" : ".pyo");
<a name='L956'>    <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(strlen(buf) &lt; buflen);
<a name='L957'>    <b>return</b> buf;
<a name='L958'><font color='red'>}</font>
<a name='L959'>
<a name='L960'>
<a name='L961'><i><font color='green'>/* Given a pathname to a Python byte compiled file, return the path to the</font></i>
<a name='L962'><i><font color='green'>   source file, if the path matches the PEP 3147 format.  This does not check</font></i>
<a name='L963'><i><font color='green'>   for any file existence, however, if the pyc file name does not match PEP</font></i>
<a name='L964'><i><font color='green'>   3147 style, NULL is returned.  buf must be at least as big as pathname;</font></i>
<a name='L965'><i><font color='green'>   the resulting path will always be shorter. */</font></i>
<a name='L966'>
<a name='L967'><b>static</b> <b>char</b> *
<a name='L968'><a href='../R/8846.html' title='Multiple refered from 3 places.'>make_source_pathname</a>(<b>char</b> *pathname, <b>char</b> *buf)
<a name='L969'><font color='red'>{</font>
<a name='L970'>    <i><font color='green'>/* __pycache__/foo.&lt;tag&gt;.pyc -&gt; foo.py */</font></i>
<a name='L971'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> i, j;
<a name='L972'>    <b>char</b> *left, *right, *dot0, *dot1, sep;
<a name='L973'>
<a name='L974'>    <i><font color='green'>/* Look back two slashes from the end.  In between these two slashes</font></i>
<a name='L975'><i><font color='green'>       must be the string __pycache__ or this is not a PEP 3147 style</font></i>
<a name='L976'><i><font color='green'>       path.  It's possible for there to be only one slash.</font></i>
<a name='L977'><i><font color='green'>    */</font></i>
<a name='L978'>    <b>if</b> ((right = <a href='../S/3120.html#L835' title='Defined at 835 in Python/import.c.'>rightmost_sep</a>(pathname)) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L979'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L980'>    sep = *right;
<a name='L981'>    *right = '\0';
<a name='L982'>    left = <a href='../S/3120.html#L835' title='Defined at 835 in Python/import.c.'>rightmost_sep</a>(pathname);
<a name='L983'>    *right = sep;
<a name='L984'>    <b>if</b> (left == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L985'>        left = pathname;
<a name='L986'>    <b>else</b>
<a name='L987'>        left++;
<a name='L988'>    <b>if</b> (right-left != strlen(<a href='../S/3120.html#L115' title='Defined at 115 in Python/import.c.'>CACHEDIR</a>) ||
<a name='L989'>        strncmp(left, <a href='../S/3120.html#L115' title='Defined at 115 in Python/import.c.'>CACHEDIR</a>, right-left) != 0)
<a name='L990'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L991'>
<a name='L992'>    <i><font color='green'>/* Now verify that the path component to the right of the last slash</font></i>
<a name='L993'><i><font color='green'>       has two dots in it.</font></i>
<a name='L994'><i><font color='green'>    */</font></i>
<a name='L995'>    <b>if</b> ((dot0 = strchr(right + 1, '.')) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L996'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L997'>    <b>if</b> ((dot1 = strchr(dot0 + 1, '.')) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L998'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L999'>    <i><font color='green'>/* Too many dots? */</font></i>
<a name='L1000'>    <b>if</b> (strchr(dot1 + 1, '.') != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1001'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1002'>
<a name='L1003'>    <i><font color='green'>/* This is a PEP 3147 path.  Start by copying everything from the</font></i>
<a name='L1004'><i><font color='green'>       start of pathname up to and including the leftmost slash.  Then</font></i>
<a name='L1005'><i><font color='green'>       copy the file's basename, removing the magic tag and adding a .py</font></i>
<a name='L1006'><i><font color='green'>       suffix.</font></i>
<a name='L1007'><i><font color='green'>    */</font></i>
<a name='L1008'>    strncpy(buf, pathname, (i=left-pathname));
<a name='L1009'>    strncpy(buf+i, right+1, (j=dot0-right));
<a name='L1010'>    strcpy(buf+i+j, "py");
<a name='L1011'>    <b>return</b> buf;
<a name='L1012'><font color='red'>}</font>
<a name='L1013'>
<a name='L1014'><i><font color='green'>/* Given a pathname for a Python source file, its time of last</font></i>
<a name='L1015'><i><font color='green'>   modification, and a pathname for a compiled file, check whether the</font></i>
<a name='L1016'><i><font color='green'>   compiled file represents the same version of the source.  If so,</font></i>
<a name='L1017'><i><font color='green'>   return a FILE pointer for the compiled file, positioned just after</font></i>
<a name='L1018'><i><font color='green'>   the header; if not, return NULL.</font></i>
<a name='L1019'><i><font color='green'>   Doesn't set an exception. */</font></i>
<a name='L1020'>
<a name='L1021'><b>static</b> FILE *
<a name='L1022'><a href='../S/3120.html#L1314' title='Refered from 1314 in Python/import.c.'>check_compiled_module</a>(<b>char</b> *pathname, time_t mtime, <b>char</b> *cpathname)
<a name='L1023'><font color='red'>{</font>
<a name='L1024'>    FILE *fp;
<a name='L1025'>    <b>long</b> magic;
<a name='L1026'>    <b>long</b> pyc_mtime;
<a name='L1027'>
<a name='L1028'>    fp = fopen(cpathname, "rb");
<a name='L1029'>    <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1030'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1031'>    magic = <a href='../S/3124.html#L1050' title='Defined at 1050 in Python/marshal.c.'>PyMarshal_ReadLongFromFile</a>(fp);
<a name='L1032'>    <b>if</b> (magic != pyc_magic) <font color='red'>{</font>
<a name='L1033'>        <b>if</b> (Py_VerboseFlag)
<a name='L1034'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# %s has bad magic\n", cpathname);
<a name='L1035'>        fclose(fp);
<a name='L1036'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1037'>    <font color='red'>}</font>
<a name='L1038'>    pyc_mtime = <a href='../S/3124.html#L1050' title='Defined at 1050 in Python/marshal.c.'>PyMarshal_ReadLongFromFile</a>(fp);
<a name='L1039'>    <b>if</b> (pyc_mtime != mtime) <font color='red'>{</font>
<a name='L1040'>        <b>if</b> (Py_VerboseFlag)
<a name='L1041'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# %s has bad mtime\n", cpathname);
<a name='L1042'>        fclose(fp);
<a name='L1043'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1044'>    <font color='red'>}</font>
<a name='L1045'>    <b>if</b> (Py_VerboseFlag)
<a name='L1046'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# %s matches %s\n", cpathname, pathname);
<a name='L1047'>    <b>return</b> fp;
<a name='L1048'><font color='red'>}</font>
<a name='L1049'>
<a name='L1050'>
<a name='L1051'><i><font color='green'>/* Read a code object from a file and check it for validity */</font></i>
<a name='L1052'>
<a name='L1053'><b>static</b> <a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *
<a name='L1054'><a href='../R/9970.html' title='Multiple refered from 2 places.'>read_compiled_module</a>(<b>char</b> *cpathname, FILE *fp)
<a name='L1055'><font color='red'>{</font>
<a name='L1056'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *co;
<a name='L1057'>
<a name='L1058'>    co = <a href='../S/3124.html#L1079' title='Defined at 1079 in Python/marshal.c.'>PyMarshal_ReadLastObjectFromFile</a>(fp);
<a name='L1059'>    <b>if</b> (co == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1060'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1061'>    <b>if</b> (!PyCode_Check(co)) <font color='red'>{</font>
<a name='L1062'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L1063'>                     "Non-code object in %.200s", cpathname);
<a name='L1064'>        Py_DECREF(co);
<a name='L1065'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1066'>    <font color='red'>}</font>
<a name='L1067'>    <b>return</b> (<a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *)co;
<a name='L1068'><font color='red'>}</font>
<a name='L1069'>
<a name='L1070'>
<a name='L1071'><i><font color='green'>/* Load a module from a compiled file, execute it, and return its</font></i>
<a name='L1072'><i><font color='green'>   module object WITH INCREMENTED REFERENCE COUNT */</font></i>
<a name='L1073'>
<a name='L1074'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1075'><a href='../R/8697.html' title='Multiple refered from 2 places.'>load_compiled_module</a>(<b>char</b> *name, <b>char</b> *cpathname, FILE *fp)
<a name='L1076'><font color='red'>{</font>
<a name='L1077'>    <b>long</b> magic;
<a name='L1078'>    <a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *co;
<a name='L1079'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L1080'>
<a name='L1081'>    magic = <a href='../S/3124.html#L1050' title='Defined at 1050 in Python/marshal.c.'>PyMarshal_ReadLongFromFile</a>(fp);
<a name='L1082'>    <b>if</b> (magic != pyc_magic) <font color='red'>{</font>
<a name='L1083'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L1084'>                     "Bad magic number in %.200s", cpathname);
<a name='L1085'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1086'>    <font color='red'>}</font>
<a name='L1087'>    (<b>void</b>) <a href='../S/3124.html#L1050' title='Defined at 1050 in Python/marshal.c.'>PyMarshal_ReadLongFromFile</a>(fp);
<a name='L1088'>    co = <a href='../S/3120.html#L1054' title='Defined at 1054 in Python/import.c.'>read_compiled_module</a>(cpathname, fp);
<a name='L1089'>    <b>if</b> (co == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1090'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1091'>    <b>if</b> (Py_VerboseFlag)
<a name='L1092'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("import %s # precompiled from %s\n",
<a name='L1093'>            name, cpathname);
<a name='L1094'>    m = <a href='../S/3120.html#L763' title='Defined at 763 in Python/import.c.'>PyImport_ExecCodeModuleWithPathnames</a>(
<a name='L1095'>        name, (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)co, cpathname, cpathname);
<a name='L1096'>    Py_DECREF(co);
<a name='L1097'>
<a name='L1098'>    <b>return</b> m;
<a name='L1099'><font color='red'>}</font>
<a name='L1100'>
<a name='L1101'><i><font color='green'>/* Parse a source file and return the corresponding code object */</font></i>
<a name='L1102'>
<a name='L1103'><b>static</b> <a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *
<a name='L1104'><a href='../S/3120.html#L1327' title='Refered from 1327 in Python/import.c.'>parse_source_module</a>(<b>const</b> <b>char</b> *pathname, FILE *fp)
<a name='L1105'><font color='red'>{</font>
<a name='L1106'>    <a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *co = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1107'>    <a href='../S/569.html#L5' title='Defined at 5 in Include/Python-ast.h.'>mod_ty</a> mod;
<a name='L1108'>    <a href='../S/571.html#L22' title='Defined at 22 in Include/pythonrun.h.'>PyCompilerFlags</a> <a href='../D/8626.html' title='Multiple defined in 2 places.'>flags</a>;
<a name='L1109'>    <a href='../S/553.html#L12' title='Defined at 12 in Include/pyarena.h.'>PyArena</a> *arena = <a href='../S/3130.html#L130' title='Defined at 130 in Python/pyarena.c.'>PyArena_New</a>();
<a name='L1110'>    <b>if</b> (arena == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1111'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1112'>
<a name='L1113'>    <a href='../D/8626.html' title='Multiple defined in 2 places.'>flags</a>.cf_flags = 0;
<a name='L1114'>    mod = <a href='../S/3138.html#L1881' title='Defined at 1881 in Python/pythonrun.c.'>PyParser_ASTFromFile</a>(fp, pathname, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L1115'>                               <a href='../S/570.html#L151' title='Defined at 151 in Include/Python.h.'>Py_file_input</a>, 0, 0, &amp;<a href='../D/8626.html' title='Multiple defined in 2 places.'>flags</a>,
<a name='L1116'>                               <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, arena);
<a name='L1117'>    <b>if</b> (mod) <font color='red'>{</font>
<a name='L1118'>        co = <a href='../D/2718.html' title='Multiple defined in 2 places.'>PyAST_Compile</a>(mod, pathname, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, arena);
<a name='L1119'>    <font color='red'>}</font>
<a name='L1120'>    <a href='../S/3130.html#L159' title='Defined at 159 in Python/pyarena.c.'>PyArena_Free</a>(arena);
<a name='L1121'>    <b>return</b> co;
<a name='L1122'><font color='red'>}</font>
<a name='L1123'>
<a name='L1124'>
<a name='L1125'><i><font color='green'>/* Helper to open a bytecode file for writing in exclusive mode */</font></i>
<a name='L1126'>
<a name='L1127'><b>static</b> FILE *
<a name='L1128'><a href='../S/3120.html#L1205' title='Refered from 1205 in Python/import.c.'>open_exclusive</a>(<b>char</b> *filename, <a href='../D/9918.html' title='Multiple defined in 2 places.'>mode_t</a> mode)
<a name='L1129'><font color='red'>{</font>
<a name='L1130'><font color='darkred'>#if</font> <b>defined</b>(O_EXCL)&amp;&amp;<b>defined</b>(O_CREAT)&amp;&amp;<b>defined</b>(<a href='../S/2694.html#L29' title='Defined at 29 in Modules/ossaudiodev.c.'>O_WRONLY</a>)&amp;&amp;<b>defined</b>(O_TRUNC)
<a name='L1131'>    <i><font color='green'>/* Use O_EXCL to avoid a race condition when another process tries to</font></i>
<a name='L1132'><i><font color='green'>       write the same file.  When that happens, our open() call fails,</font></i>
<a name='L1133'><i><font color='green'>       which is just fine (since it's only a cache).</font></i>
<a name='L1134'><i><font color='green'>       XXX If the file exists and is writable but the directory is not</font></i>
<a name='L1135'><i><font color='green'>       writable, the file will never be written.  Oh well.</font></i>
<a name='L1136'><i><font color='green'>    */</font></i>
<a name='L1137'>    <b>int</b> fd;
<a name='L1138'>    (<b>void</b>) <a href='../D/12052.html' title='Multiple defined in 2 places.'>unlink</a>(filename);
<a name='L1139'>    fd = open(filename, O_EXCL|O_CREAT|<a href='../S/2694.html#L29' title='Defined at 29 in Modules/ossaudiodev.c.'>O_WRONLY</a>|O_TRUNC
<a name='L1140'><font color='darkred'>#ifdef</font> O_BINARY
<a name='L1141'>                            |O_BINARY   <i><font color='green'>/* necessary for Windows */</font></i>
<a name='L1142'><font color='darkred'>#endif</font>
<a name='L1143'><font color='darkred'>#ifdef</font> __VMS
<a name='L1144'>            , mode, "ctxt=bin", "shr=nil"
<a name='L1145'><font color='darkred'>#else</font>
<a name='L1146'>            , mode
<a name='L1147'><font color='darkred'>#endif</font>
<a name='L1148'>          );
<a name='L1149'>    <b>if</b> (fd &lt; 0)
<a name='L1150'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1151'>    <b>return</b> <a href='../D/8463.html' title='Multiple defined in 4 places.'>fdopen</a>(fd, "wb");
<a name='L1152'><font color='darkred'>#else</font>
<a name='L1153'>    <i><font color='green'>/* Best we can do -- on Windows this can't happen anyway */</font></i>
<a name='L1154'>    <b>return</b> fopen(filename, "wb");
<a name='L1155'><font color='darkred'>#endif</font>
<a name='L1156'><font color='red'>}</font>
<a name='L1157'>
<a name='L1158'>
<a name='L1159'><i><font color='green'>/* Write a compiled module to a file, placing the time of last</font></i>
<a name='L1160'><i><font color='green'>   modification of its source into the header.</font></i>
<a name='L1161'><i><font color='green'>   Errors are ignored, if a write error occurs an attempt is made to</font></i>
<a name='L1162'><i><font color='green'>   remove the file. */</font></i>
<a name='L1163'>
<a name='L1164'><b>static</b> <b>void</b>
<a name='L1165'><a href='../S/3120.html#L1336' title='Refered from 1336 in Python/import.c.'>write_compiled_module</a>(PyCodeObject *co, <b>char</b> *cpathname, <b>struct</b> stat *srcstat)
<a name='L1166'><font color='red'>{</font>
<a name='L1167'>    FILE *fp;
<a name='L1168'>    <b>char</b> *dirpath;
<a name='L1169'>    time_t mtime = srcstat-&gt;st_mtime;
<a name='L1170'><font color='darkred'>#ifdef</font> <a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>   <i><font color='green'>/* since Windows uses different permissions  */</font></i>
<a name='L1171'>    <a href='../D/9918.html' title='Multiple defined in 2 places.'>mode_t</a> mode = srcstat-&gt;st_mode &amp; ~S_IEXEC;
<a name='L1172'><font color='darkred'>#else</font>
<a name='L1173'>    <a href='../D/9918.html' title='Multiple defined in 2 places.'>mode_t</a> mode = srcstat-&gt;st_mode &amp; ~S_IXUSR &amp; ~S_IXGRP &amp; ~S_IXOTH;
<a name='L1174'>    <a href='../D/9918.html' title='Multiple defined in 2 places.'>mode_t</a> dirmode = (srcstat-&gt;st_mode |
<a name='L1175'>                      S_IXUSR | S_IXGRP | S_IXOTH |
<a name='L1176'>                      S_IWUSR | S_IWGRP | S_IWOTH);
<a name='L1177'><font color='darkred'>#endif</font>
<a name='L1178'>    <b>int</b> saved;
<a name='L1179'>
<a name='L1180'>    <i><font color='green'>/* Ensure that the __pycache__ directory exists. */</font></i>
<a name='L1181'>    dirpath = <a href='../S/3120.html#L835' title='Defined at 835 in Python/import.c.'>rightmost_sep</a>(cpathname);
<a name='L1182'>    <b>if</b> (dirpath == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1183'>        <b>if</b> (Py_VerboseFlag)
<a name='L1184'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L1185'>                "# no %s path found %s\n",
<a name='L1186'>                <a href='../S/3120.html#L115' title='Defined at 115 in Python/import.c.'>CACHEDIR</a>, cpathname);
<a name='L1187'>        <b>return</b>;
<a name='L1188'>    <font color='red'>}</font>
<a name='L1189'>    saved = *dirpath;
<a name='L1190'>    *dirpath = '\0';
<a name='L1191'>
<a name='L1192'><font color='darkred'>#ifdef</font> <a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>
<a name='L1193'>    <b>if</b> (_mkdir(cpathname) &lt; 0 &amp;&amp; errno != EEXIST) <font color='red'>{</font>
<a name='L1194'><font color='darkred'>#else</font>
<a name='L1195'>    <b>if</b> (mkdir(cpathname, dirmode) &lt; 0 &amp;&amp; errno != EEXIST) <font color='red'>{</font>
<a name='L1196'><font color='darkred'>#endif</font>
<a name='L1197'>        *dirpath = saved;
<a name='L1198'>        <b>if</b> (Py_VerboseFlag)
<a name='L1199'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L1200'>                "# cannot create cache dir %s\n", cpathname);
<a name='L1201'>        <b>return</b>;
<a name='L1202'>    <font color='red'>}</font>
<a name='L1203'>    *dirpath = saved;
<a name='L1204'>
<a name='L1205'>    fp = <a href='../S/3120.html#L1128' title='Defined at 1128 in Python/import.c.'>open_exclusive</a>(cpathname, mode);
<a name='L1206'>    <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1207'>        <b>if</b> (Py_VerboseFlag)
<a name='L1208'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>(
<a name='L1209'>                "# can't create %s\n", cpathname);
<a name='L1210'>        <b>return</b>;
<a name='L1211'>    <font color='red'>}</font>
<a name='L1212'>    <a href='../S/3124.html#L441' title='Defined at 441 in Python/marshal.c.'>PyMarshal_WriteLongToFile</a>(pyc_magic, fp, <a href='../S/537.html#L10' title='Defined at 10 in Include/marshal.h.'>Py_MARSHAL_VERSION</a>);
<a name='L1213'>    <i><font color='green'>/* First write a 0 for mtime */</font></i>
<a name='L1214'>    <a href='../S/3124.html#L441' title='Defined at 441 in Python/marshal.c.'>PyMarshal_WriteLongToFile</a>(0L, fp, <a href='../S/537.html#L10' title='Defined at 10 in Include/marshal.h.'>Py_MARSHAL_VERSION</a>);
<a name='L1215'>    <a href='../S/3124.html#L453' title='Defined at 453 in Python/marshal.c.'>PyMarshal_WriteObjectToFile</a>((<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)co, fp, <a href='../S/537.html#L10' title='Defined at 10 in Include/marshal.h.'>Py_MARSHAL_VERSION</a>);
<a name='L1216'>    <b>if</b> (fflush(fp) != 0 || ferror(fp)) <font color='red'>{</font>
<a name='L1217'>        <b>if</b> (Py_VerboseFlag)
<a name='L1218'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# can't write %s\n", cpathname);
<a name='L1219'>        <i><font color='green'>/* Don't keep partial file */</font></i>
<a name='L1220'>        fclose(fp);
<a name='L1221'>        (<b>void</b>) <a href='../D/12052.html' title='Multiple defined in 2 places.'>unlink</a>(cpathname);
<a name='L1222'>        <b>return</b>;
<a name='L1223'>    <font color='red'>}</font>
<a name='L1224'>    <i><font color='green'>/* Now write the true mtime */</font></i>
<a name='L1225'>    fseek(fp, 4L, 0);
<a name='L1226'>    <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(mtime &lt; <a href='../D/1965.html' title='Multiple defined in 2 places.'>LONG_MAX</a>);
<a name='L1227'>    <a href='../S/3124.html#L441' title='Defined at 441 in Python/marshal.c.'>PyMarshal_WriteLongToFile</a>((<b>long</b>)mtime, fp, <a href='../S/537.html#L10' title='Defined at 10 in Include/marshal.h.'>Py_MARSHAL_VERSION</a>);
<a name='L1228'>    fflush(fp);
<a name='L1229'>    fclose(fp);
<a name='L1230'>    <b>if</b> (Py_VerboseFlag)
<a name='L1231'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# wrote %s\n", cpathname);
<a name='L1232'><font color='red'>}</font>
<a name='L1233'>
<a name='L1234'><b>static</b> <b>void</b>
<a name='L1235'><a href='../R/11181.html' title='Multiple refered from 2 places.'>update_code_filenames</a>(PyCodeObject *co, PyObject *oldname, PyObject *newname)
<a name='L1236'><font color='red'>{</font>
<a name='L1237'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *constants, *tmp;
<a name='L1238'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> i, n;
<a name='L1239'>
<a name='L1240'>    <b>if</b> (<a href='../D/3967.html' title='Multiple defined in 3 places.'>PyUnicode_Compare</a>(co-&gt;co_filename, oldname))
<a name='L1241'>        <b>return</b>;
<a name='L1242'>
<a name='L1243'>    tmp = co-&gt;co_filename;
<a name='L1244'>    co-&gt;co_filename = newname;
<a name='L1245'>    Py_INCREF(co-&gt;co_filename);
<a name='L1246'>    Py_DECREF(tmp);
<a name='L1247'>
<a name='L1248'>    constants = co-&gt;co_consts;
<a name='L1249'>    n = PyTuple_GET_SIZE(constants);
<a name='L1250'>    <b>for</b> (i = 0; i &lt; n; i++) <font color='red'>{</font>
<a name='L1251'>        tmp = PyTuple_GET_ITEM(constants, i);
<a name='L1252'>        <b>if</b> (PyCode_Check(tmp))
<a name='L1253'>            <a href='../S/3120.html#L1235' title='Defined at 1235 in Python/import.c.'>update_code_filenames</a>((<a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *)tmp,
<a name='L1254'>                                  oldname, newname);
<a name='L1255'>    <font color='red'>}</font>
<a name='L1256'><font color='red'>}</font>
<a name='L1257'>
<a name='L1258'><b>static</b> <b>int</b>
<a name='L1259'><a href='../S/3120.html#L1319' title='Refered from 1319 in Python/import.c.'>update_compiled_module</a>(PyCodeObject *co, <b>char</b> *pathname)
<a name='L1260'><font color='red'>{</font>
<a name='L1261'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *oldname, *newname;
<a name='L1262'>
<a name='L1263'>    newname = <a href='../D/3975.html' title='Multiple defined in 3 places.'>PyUnicode_DecodeFSDefault</a>(pathname);
<a name='L1264'>    <b>if</b> (newname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1265'>        <b>return</b> -1;
<a name='L1266'>
<a name='L1267'>    <b>if</b> (!<a href='../D/3967.html' title='Multiple defined in 3 places.'>PyUnicode_Compare</a>(co-&gt;co_filename, newname)) <font color='red'>{</font>
<a name='L1268'>        Py_DECREF(newname);
<a name='L1269'>        <b>return</b> 0;
<a name='L1270'>    <font color='red'>}</font>
<a name='L1271'>
<a name='L1272'>    oldname = co-&gt;co_filename;
<a name='L1273'>    Py_INCREF(oldname);
<a name='L1274'>    <a href='../S/3120.html#L1235' title='Defined at 1235 in Python/import.c.'>update_code_filenames</a>(co, oldname, newname);
<a name='L1275'>    Py_DECREF(oldname);
<a name='L1276'>    Py_DECREF(newname);
<a name='L1277'>    <b>return</b> 1;
<a name='L1278'><font color='red'>}</font>
<a name='L1279'>
<a name='L1280'><i><font color='green'>/* Load a source module from a given file and return its module</font></i>
<a name='L1281'><i><font color='green'>   object WITH INCREMENTED REFERENCE COUNT.  If there's a matching</font></i>
<a name='L1282'><i><font color='green'>   byte-compiled file, use that instead. */</font></i>
<a name='L1283'>
<a name='L1284'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1285'><a href='../R/8732.html' title='Multiple refered from 2 places.'>load_source_module</a>(<b>char</b> *name, <b>char</b> *pathname, FILE *fp)
<a name='L1286'><font color='red'>{</font>
<a name='L1287'>    <b>struct</b> stat st;
<a name='L1288'>    FILE *fpc;
<a name='L1289'>    <b>char</b> buf[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L1290'>    <b>char</b> *cpathname;
<a name='L1291'>    <a href='../S/511.html#L32' title='Defined at 32 in Include/code.h.'>PyCodeObject</a> *co;
<a name='L1292'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L1293'>
<a name='L1294'>    <b>if</b> (fstat(<a href='../S/2759.html#L50' title='Defined at 50 in Modules/zlib/minigzip.c.'>fileno</a>(fp), &amp;st) != 0) <font color='red'>{</font>
<a name='L1295'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_RuntimeError,
<a name='L1296'>                     "unable to get file status from '%s'",
<a name='L1297'>                     pathname);
<a name='L1298'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1299'>    <font color='red'>}</font>
<a name='L1300'><font color='darkred'>#if</font> <a href='../D/4742.html' title='Multiple defined in 7 places.'>SIZEOF_TIME_T</a> &gt; 4
<a name='L1301'>    <i><font color='green'>/* Python's .pyc timestamp handling presumes that the timestamp fits</font></i>
<a name='L1302'><i><font color='green'>       in 4 bytes. This will be fine until sometime in the year 2038,</font></i>
<a name='L1303'><i><font color='green'>       when a 4-byte signed time_t will overflow.</font></i>
<a name='L1304'><i><font color='green'>     */</font></i>
<a name='L1305'>    <b>if</b> (st.st_mtime &gt;&gt; 32) <font color='red'>{</font>
<a name='L1306'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_OverflowError,
<a name='L1307'>            "modification time overflows a 4 byte field");
<a name='L1308'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1309'>    <font color='red'>}</font>
<a name='L1310'><font color='darkred'>#endif</font>
<a name='L1311'>    cpathname = <a href='../S/3120.html#L858' title='Defined at 858 in Python/import.c.'>make_compiled_pathname</a>(
<a name='L1312'>        pathname, buf, (<a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a>)<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a> + 1, !Py_OptimizeFlag);
<a name='L1313'>    <b>if</b> (cpathname != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp;
<a name='L1314'>        (fpc = <a href='../S/3120.html#L1022' title='Defined at 1022 in Python/import.c.'>check_compiled_module</a>(pathname, st.st_mtime, cpathname))) <font color='red'>{</font>
<a name='L1315'>        co = <a href='../S/3120.html#L1054' title='Defined at 1054 in Python/import.c.'>read_compiled_module</a>(cpathname, fpc);
<a name='L1316'>        fclose(fpc);
<a name='L1317'>        <b>if</b> (co == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1318'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1319'>        <b>if</b> (<a href='../S/3120.html#L1259' title='Defined at 1259 in Python/import.c.'>update_compiled_module</a>(co, pathname) &lt; 0)
<a name='L1320'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1321'>        <b>if</b> (Py_VerboseFlag)
<a name='L1322'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("import %s # precompiled from %s\n",
<a name='L1323'>                name, cpathname);
<a name='L1324'>        pathname = cpathname;
<a name='L1325'>    <font color='red'>}</font>
<a name='L1326'>    <b>else</b> <font color='red'>{</font>
<a name='L1327'>        co = <a href='../S/3120.html#L1104' title='Defined at 1104 in Python/import.c.'>parse_source_module</a>(pathname, fp);
<a name='L1328'>        <b>if</b> (co == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1329'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1330'>        <b>if</b> (Py_VerboseFlag)
<a name='L1331'>            <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("import %s # from %s\n",
<a name='L1332'>                name, pathname);
<a name='L1333'>        <b>if</b> (cpathname) <font color='red'>{</font>
<a name='L1334'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *ro = <a href='../S/3144.html#L44' title='Defined at 44 in Python/sysmodule.c.'>PySys_GetObject</a>("dont_write_bytecode");
<a name='L1335'>            <b>if</b> (ro == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !<a href='../S/2803.html#L1140' title='Defined at 1140 in Objects/object.c.'>PyObject_IsTrue</a>(ro))
<a name='L1336'>                <a href='../S/3120.html#L1165' title='Defined at 1165 in Python/import.c.'>write_compiled_module</a>(co, cpathname, &amp;st);
<a name='L1337'>        <font color='red'>}</font>
<a name='L1338'>    <font color='red'>}</font>
<a name='L1339'>    m = <a href='../S/3120.html#L763' title='Defined at 763 in Python/import.c.'>PyImport_ExecCodeModuleWithPathnames</a>(
<a name='L1340'>        name, (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)co, pathname, cpathname);
<a name='L1341'>    Py_DECREF(co);
<a name='L1342'>
<a name='L1343'>    <b>return</b> m;
<a name='L1344'><font color='red'>}</font>
<a name='L1345'>
<a name='L1346'><i><font color='green'>/* Get source file -&gt; unicode or None</font></i>
<a name='L1347'><i><font color='green'> * Returns the path to the py file if available, else the given path</font></i>
<a name='L1348'><i><font color='green'> */</font></i>
<a name='L1349'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1350'><a href='../R/8095.html' title='Multiple refered from 3 places.'>get_sourcefile</a>(<b>char</b> *file)
<a name='L1351'><font color='red'>{</font>
<a name='L1352'>    <b>char</b> py[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a> + 1];
<a name='L1353'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len;
<a name='L1354'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *u;
<a name='L1355'>    <b>struct</b> stat statbuf;
<a name='L1356'>
<a name='L1357'>    <b>if</b> (!file || !*file) <font color='red'>{</font>
<a name='L1358'>        <a href='../S/2562.html#L112' title='Defined at 112 in Modules/_elementtree.c.'>Py_RETURN_NONE</a>;
<a name='L1359'>    <font color='red'>}</font>
<a name='L1360'>
<a name='L1361'>    len = strlen(file);
<a name='L1362'>    <i><font color='green'>/* match '*.py?' */</font></i>
<a name='L1363'>    <b>if</b> (len &gt; <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a> || PyOS_strnicmp(&amp;file[len-4], ".py", 3) != 0) <font color='red'>{</font>
<a name='L1364'>        <b>return</b> <a href='../D/3975.html' title='Multiple defined in 3 places.'>PyUnicode_DecodeFSDefault</a>(file);
<a name='L1365'>    <font color='red'>}</font>
<a name='L1366'>
<a name='L1367'>    <i><font color='green'>/* Start by trying to turn PEP 3147 path into source path.  If that</font></i>
<a name='L1368'><i><font color='green'>     * fails, just chop off the trailing character, i.e. legacy pyc path</font></i>
<a name='L1369'><i><font color='green'>     * to py.</font></i>
<a name='L1370'><i><font color='green'>     */</font></i>
<a name='L1371'>    <b>if</b> (<a href='../S/3120.html#L968' title='Defined at 968 in Python/import.c.'>make_source_pathname</a>(file, py) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1372'>        strncpy(py, file, len-1);
<a name='L1373'>        py[len-1] = '\0';
<a name='L1374'>    <font color='red'>}</font>
<a name='L1375'>
<a name='L1376'>    <b>if</b> (stat(py, &amp;statbuf) == 0 &amp;&amp;
<a name='L1377'>        <a href='../S/565.html#L393' title='Defined at 393 in Include/pyport.h.'>S_ISREG</a>(statbuf.st_mode)) <font color='red'>{</font>
<a name='L1378'>        u = <a href='../D/3975.html' title='Multiple defined in 3 places.'>PyUnicode_DecodeFSDefault</a>(py);
<a name='L1379'>    <font color='red'>}</font>
<a name='L1380'>    <b>else</b> <font color='red'>{</font>
<a name='L1381'>        u = <a href='../D/3975.html' title='Multiple defined in 3 places.'>PyUnicode_DecodeFSDefault</a>(file);
<a name='L1382'>    <font color='red'>}</font>
<a name='L1383'>    <b>return</b> u;
<a name='L1384'><font color='red'>}</font>
<a name='L1385'>
<a name='L1386'><i><font color='green'>/* Forward */</font></i>
<a name='L1387'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3120.html#L2083' title='Defined at 2083 in Python/import.c.'>load_module</a>(<b>char</b> *, FILE *, <b>char</b> *, <b>int</b>, PyObject *);
<a name='L1388'><b>static</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *<a href='../S/3120.html#L1559' title='Defined at 1559 in Python/import.c.'>find_module</a>(<b>char</b> *, <b>char</b> *, PyObject *,
<a name='L1389'>                                     <b>char</b> *, <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a>, FILE **, PyObject **);
<a name='L1390'><b>static</b> <b>struct</b> _frozen * <a href='../S/3120.html#L2187' title='Defined at 2187 in Python/import.c.'>find_frozen</a>(<b>char</b> *);
<a name='L1391'>
<a name='L1392'><i><font color='green'>/* Load a package and return its module object WITH INCREMENTED</font></i>
<a name='L1393'><i><font color='green'>   REFERENCE COUNT */</font></i>
<a name='L1394'>
<a name='L1395'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1396'><a href='../R/8721.html' title='Multiple refered from 2 places.'>load_package</a>(<b>char</b> *name, <b>char</b> *pathname)
<a name='L1397'><font color='red'>{</font>
<a name='L1398'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m, *d;
<a name='L1399'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *file = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1400'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *path = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1401'>    <b>int</b> err;
<a name='L1402'>    <b>char</b> buf[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L1403'>    FILE *fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1404'>    <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *fdp;
<a name='L1405'>
<a name='L1406'>    m = <a href='../S/3120.html#L701' title='Defined at 701 in Python/import.c.'>PyImport_AddModule</a>(name);
<a name='L1407'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1408'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1409'>    <b>if</b> (Py_VerboseFlag)
<a name='L1410'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("import %s # directory %s\n",
<a name='L1411'>            name, pathname);
<a name='L1412'>    d = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(m);
<a name='L1413'>    file = <a href='../S/3120.html#L1350' title='Defined at 1350 in Python/import.c.'>get_sourcefile</a>(pathname);
<a name='L1414'>    <b>if</b> (file == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1415'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L1416'>    path = <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("[O]", file);
<a name='L1417'>    <b>if</b> (path == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1418'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L1419'>    err = <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "__file__", file);
<a name='L1420'>    <b>if</b> (err == 0)
<a name='L1421'>        err = <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "__path__", path);
<a name='L1422'>    <b>if</b> (err != 0)
<a name='L1423'>        <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L1424'>    buf[0] = '\0';
<a name='L1425'>    fdp = <a href='../S/3120.html#L1559' title='Defined at 1559 in Python/import.c.'>find_module</a>(name, "__init__", path, buf, <b>sizeof</b>(buf), &amp;fp, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L1426'>    <b>if</b> (fdp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1427'>        <b>if</b> (<a href='../S/3106.html#L189' title='Defined at 189 in Python/errors.c.'>PyErr_ExceptionMatches</a>(PyExc_ImportError)) <font color='red'>{</font>
<a name='L1428'>            <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L1429'>            Py_INCREF(m);
<a name='L1430'>        <font color='red'>}</font>
<a name='L1431'>        <b>else</b>
<a name='L1432'>            m = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1433'>        <b>goto</b> cleanup;
<a name='L1434'>    <font color='red'>}</font>
<a name='L1435'>    m = <a href='../S/3120.html#L2083' title='Defined at 2083 in Python/import.c.'>load_module</a>(name, fp, buf, fdp-&gt;type, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L1436'>    <b>if</b> (fp != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1437'>        fclose(fp);
<a name='L1438'>    <b>goto</b> cleanup;
<a name='L1439'>
<a name='L1440'>  <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>:
<a name='L1441'>    m = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1442'>  cleanup:
<a name='L1443'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(path);
<a name='L1444'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(file);
<a name='L1445'>    <b>return</b> m;
<a name='L1446'><font color='red'>}</font>
<a name='L1447'>
<a name='L1448'>
<a name='L1449'><i><font color='green'>/* Helper to test for built-in module */</font></i>
<a name='L1450'>
<a name='L1451'><b>static</b> <b>int</b>
<a name='L1452'><a href='../R/8494.html' title='Multiple refered from 2 places.'>is_builtin</a>(<b>char</b> *name)
<a name='L1453'><font color='red'>{</font>
<a name='L1454'>    <b>int</b> i;
<a name='L1455'>    <b>for</b> (i = 0; PyImport_Inittab[i].name != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; i++) <font color='red'>{</font>
<a name='L1456'>        <b>if</b> (strcmp(name, PyImport_Inittab[i].name) == 0) <font color='red'>{</font>
<a name='L1457'>            <b>if</b> (PyImport_Inittab[i].initfunc == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1458'>                <b>return</b> -1;
<a name='L1459'>            <b>else</b>
<a name='L1460'>                <b>return</b> 1;
<a name='L1461'>        <font color='red'>}</font>
<a name='L1462'>    <font color='red'>}</font>
<a name='L1463'>    <b>return</b> 0;
<a name='L1464'><font color='red'>}</font>
<a name='L1465'>
<a name='L1466'>
<a name='L1467'><i><font color='green'>/* Return an importer object for a sys.path/pkg.__path__ item 'p',</font></i>
<a name='L1468'><i><font color='green'>   possibly by fetching it from the path_importer_cache dict. If it</font></i>
<a name='L1469'><i><font color='green'>   wasn't yet cached, traverse path_hooks until a hook is found</font></i>
<a name='L1470'><i><font color='green'>   that can handle the path item. Return None if no hook could;</font></i>
<a name='L1471'><i><font color='green'>   this tells our caller it should fall back to the builtin</font></i>
<a name='L1472'><i><font color='green'>   import mechanism. Cache the result in path_importer_cache.</font></i>
<a name='L1473'><i><font color='green'>   Returns a borrowed reference. */</font></i>
<a name='L1474'>
<a name='L1475'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L1476'><a href='../R/8084.html' title='Multiple refered from 2 places.'>get_path_importer</a>(PyObject *path_importer_cache, PyObject *path_hooks,
<a name='L1477'>                  PyObject *p)
<a name='L1478'><font color='red'>{</font>
<a name='L1479'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *importer;
<a name='L1480'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> j, nhooks;
<a name='L1481'>
<a name='L1482'>    <i><font color='green'>/* These conditions are the caller's responsibility: */</font></i>
<a name='L1483'>    <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(PyList_Check(path_hooks));
<a name='L1484'>    <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(PyDict_Check(path_importer_cache));
<a name='L1485'>
<a name='L1486'>    nhooks = <a href='../S/2796.html#L166' title='Defined at 166 in Objects/listobject.c.'>PyList_Size</a>(path_hooks);
<a name='L1487'>    <b>if</b> (nhooks &lt; 0)
<a name='L1488'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; <i><font color='green'>/* Shouldn't happen */</font></i>
<a name='L1489'>
<a name='L1490'>    importer = <a href='../S/2787.html#L704' title='Defined at 704 in Objects/dictobject.c.'>PyDict_GetItem</a>(path_importer_cache, p);
<a name='L1491'>    <b>if</b> (importer != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1492'>        <b>return</b> importer;
<a name='L1493'>
<a name='L1494'>    <i><font color='green'>/* set path_importer_cache[p] to None to avoid recursion */</font></i>
<a name='L1495'>    <b>if</b> (<a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(path_importer_cache, p, Py_None) != 0)
<a name='L1496'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1497'>
<a name='L1498'>    <b>for</b> (j = 0; j &lt; nhooks; j++) <font color='red'>{</font>
<a name='L1499'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *hook = <a href='../S/2796.html#L179' title='Defined at 179 in Objects/listobject.c.'>PyList_GetItem</a>(path_hooks, j);
<a name='L1500'>        <b>if</b> (hook == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1501'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1502'>        importer = <a href='../S/2775.html#L2358' title='Defined at 2358 in Objects/abstract.c.'>PyObject_CallFunctionObjArgs</a>(hook, p, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L1503'>        <b>if</b> (importer != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1504'>            <b>break</b>;
<a name='L1505'>
<a name='L1506'>        <b>if</b> (!<a href='../S/3106.html#L189' title='Defined at 189 in Python/errors.c.'>PyErr_ExceptionMatches</a>(PyExc_ImportError)) <font color='red'>{</font>
<a name='L1507'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1508'>        <font color='red'>}</font>
<a name='L1509'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L1510'>    <font color='red'>}</font>
<a name='L1511'>    <b>if</b> (importer == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1512'>        importer = <a href='../S/2775.html#L2358' title='Defined at 2358 in Objects/abstract.c.'>PyObject_CallFunctionObjArgs</a>(
<a name='L1513'>            (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)&amp;PyNullImporter_Type, p, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L1514'>        );
<a name='L1515'>        <b>if</b> (importer == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1516'>            <b>if</b> (<a href='../S/3106.html#L189' title='Defined at 189 in Python/errors.c.'>PyErr_ExceptionMatches</a>(PyExc_ImportError)) <font color='red'>{</font>
<a name='L1517'>                <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L1518'>                <b>return</b> Py_None;
<a name='L1519'>            <font color='red'>}</font>
<a name='L1520'>        <font color='red'>}</font>
<a name='L1521'>    <font color='red'>}</font>
<a name='L1522'>    <b>if</b> (importer != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1523'>        <b>int</b> err = <a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(path_importer_cache, p, importer);
<a name='L1524'>        Py_DECREF(importer);
<a name='L1525'>        <b>if</b> (err != 0)
<a name='L1526'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1527'>    <font color='red'>}</font>
<a name='L1528'>    <b>return</b> importer;
<a name='L1529'><font color='red'>}</font>
<a name='L1530'>
<a name='L1531'><a href='../R/2475.html' title='Multiple refered from 87 places.'>PyAPI_FUNC</a>(PyObject *)
<a name='L1532'>PyImport_GetImporter(PyObject *path) <font color='red'>{</font>
<a name='L1533'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *importer=<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, *path_importer_cache=<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, *path_hooks=<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1534'>
<a name='L1535'>    <b>if</b> ((path_importer_cache = <a href='../S/3144.html#L44' title='Defined at 44 in Python/sysmodule.c.'>PySys_GetObject</a>("path_importer_cache"))) <font color='red'>{</font>
<a name='L1536'>        <b>if</b> ((path_hooks = <a href='../S/3144.html#L44' title='Defined at 44 in Python/sysmodule.c.'>PySys_GetObject</a>("path_hooks"))) <font color='red'>{</font>
<a name='L1537'>            importer = <a href='../S/3120.html#L1476' title='Defined at 1476 in Python/import.c.'>get_path_importer</a>(path_importer_cache,
<a name='L1538'>                                         path_hooks, path);
<a name='L1539'>        <font color='red'>}</font>
<a name='L1540'>    <font color='red'>}</font>
<a name='L1541'>    <a href='../S/544.html#L766' title='Defined at 766 in Include/object.h.'>Py_XINCREF</a>(importer); <i><font color='green'>/* get_path_importer returns a borrowed reference */</font></i>
<a name='L1542'>    <b>return</b> importer;
<a name='L1543'><font color='red'>}</font>
<a name='L1544'>
<a name='L1545'><i><font color='green'>/* Search the path (default sys.path) for a module.  Return the</font></i>
<a name='L1546'><i><font color='green'>   corresponding filedescr struct, and (via return arguments) the</font></i>
<a name='L1547'><i><font color='green'>   pathname and an open file.  Return NULL if the module is not found. */</font></i>
<a name='L1548'>
<a name='L1549'><font color='darkred'>#ifdef</font> <a href='../S/2906.html#L308' title='Defined at 308 in PC/pyconfig.h.'>MS_COREDLL</a>
<a name='L1550'><b>extern</b> FILE *<a href='../S/2885.html#L18' title='Defined at 18 in PC/import_nt.c.'>PyWin_FindRegisteredModule</a>(<b>const</b> <b>char</b> *, <b>struct</b> filedescr **,
<a name='L1551'>                                        <b>char</b> *, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>);
<a name='L1552'><font color='darkred'>#endif</font>
<a name='L1553'>
<a name='L1554'><b>static</b> <b>int</b> <a href='../S/3120.html#L1878' title='Defined at 1878 in Python/import.c.'>case_ok</a>(<b>char</b> *, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a>, <b>char</b> *);
<a name='L1555'><b>static</b> <b>int</b> <a href='../S/3120.html#L1991' title='Defined at 1991 in Python/import.c.'>find_init_module</a>(<b>char</b> *); <i><font color='green'>/* Forward */</font></i>
<a name='L1556'><b>static</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> importhookdescr = <font color='red'>{</font>"", "", <a href='../S/3122.html#L20' title='Defined at 20 in Python/importdl.h.'>IMP_HOOK</a><font color='red'>}</font>;
<a name='L1557'>
<a name='L1558'><b>static</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *
<a name='L1559'><a href='../R/7803.html' title='Multiple refered from 5 places.'>find_module</a>(<b>char</b> *fullname, <b>char</b> *subname, PyObject *path, <b>char</b> *buf,
<a name='L1560'>            <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> buflen, FILE **p_fp, PyObject **p_loader)
<a name='L1561'><font color='red'>{</font>
<a name='L1562'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> i, npath;
<a name='L1563'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> len, namelen;
<a name='L1564'>    <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *fdp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1565'>    <b>char</b> *filemode;
<a name='L1566'>    FILE *fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1567'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *path_hooks, *path_importer_cache;
<a name='L1568'>    <b>struct</b> stat statbuf;
<a name='L1569'>    <b>static</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> fd_frozen = <font color='red'>{</font>"", "", <a href='../S/3122.html#L18' title='Defined at 18 in Python/importdl.h.'>PY_FROZEN</a><font color='red'>}</font>;
<a name='L1570'>    <b>static</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> fd_builtin = <font color='red'>{</font>"", "", <a href='../S/3122.html#L17' title='Defined at 17 in Python/importdl.h.'>C_BUILTIN</a><font color='red'>}</font>;
<a name='L1571'>    <b>static</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> fd_package = <font color='red'>{</font>"", "", <a href='../S/3122.html#L16' title='Defined at 16 in Python/importdl.h.'>PKG_DIRECTORY</a><font color='red'>}</font>;
<a name='L1572'>    <b>char</b> name[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L1573'><font color='darkred'>#if</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>)
<a name='L1574'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> saved_len;
<a name='L1575'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> saved_namelen;
<a name='L1576'>    <b>char</b> *saved_buf = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1577'><font color='darkred'>#endif</font>
<a name='L1578'>    <b>if</b> (p_loader != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1579'>        *p_loader = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1580'>
<a name='L1581'>    <b>if</b> (strlen(subname) &gt; <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>) <font color='red'>{</font>
<a name='L1582'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_OverflowError,
<a name='L1583'>                        "module name is too long");
<a name='L1584'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1585'>    <font color='red'>}</font>
<a name='L1586'>    strcpy(name, subname);
<a name='L1587'>
<a name='L1588'>    <i><font color='green'>/* sys.meta_path import hook */</font></i>
<a name='L1589'>    <b>if</b> (p_loader != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1590'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *meta_path;
<a name='L1591'>
<a name='L1592'>        meta_path = <a href='../S/3144.html#L44' title='Defined at 44 in Python/sysmodule.c.'>PySys_GetObject</a>("meta_path");
<a name='L1593'>        <b>if</b> (meta_path == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !PyList_Check(meta_path)) <font color='red'>{</font>
<a name='L1594'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError,
<a name='L1595'>                            "sys.meta_path must be a list of "
<a name='L1596'>                            "import hooks");
<a name='L1597'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1598'>        <font color='red'>}</font>
<a name='L1599'>        Py_INCREF(meta_path);  <i><font color='green'>/* zap guard */</font></i>
<a name='L1600'>        npath = <a href='../S/2796.html#L166' title='Defined at 166 in Objects/listobject.c.'>PyList_Size</a>(meta_path);
<a name='L1601'>        <b>for</b> (i = 0; i &lt; npath; i++) <font color='red'>{</font>
<a name='L1602'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *loader;
<a name='L1603'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *hook = <a href='../S/2796.html#L179' title='Defined at 179 in Objects/listobject.c.'>PyList_GetItem</a>(meta_path, i);
<a name='L1604'>            loader = <a href='../D/3603.html' title='Multiple defined in 2 places.'>PyObject_CallMethod</a>(hook, "find_module",
<a name='L1605'>                                         "sO", fullname,
<a name='L1606'>                                         path != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> ?
<a name='L1607'>                                         path : Py_None);
<a name='L1608'>            <b>if</b> (loader == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1609'>                Py_DECREF(meta_path);
<a name='L1610'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;  <i><font color='green'>/* true error */</font></i>
<a name='L1611'>            <font color='red'>}</font>
<a name='L1612'>            <b>if</b> (loader != Py_None) <font color='red'>{</font>
<a name='L1613'>                <i><font color='green'>/* a loader was found */</font></i>
<a name='L1614'>                *p_loader = loader;
<a name='L1615'>                Py_DECREF(meta_path);
<a name='L1616'>                <b>return</b> &amp;importhookdescr;
<a name='L1617'>            <font color='red'>}</font>
<a name='L1618'>            Py_DECREF(loader);
<a name='L1619'>        <font color='red'>}</font>
<a name='L1620'>        Py_DECREF(meta_path);
<a name='L1621'>    <font color='red'>}</font>
<a name='L1622'>
<a name='L1623'>    <b>if</b> (<a href='../S/3120.html#L2187' title='Defined at 2187 in Python/import.c.'>find_frozen</a>(fullname) != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1624'>        strcpy(buf, fullname);
<a name='L1625'>        <b>return</b> &amp;fd_frozen;
<a name='L1626'>    <font color='red'>}</font>
<a name='L1627'>
<a name='L1628'>    <b>if</b> (path == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1629'>        <b>if</b> (<a href='../S/3120.html#L1452' title='Defined at 1452 in Python/import.c.'>is_builtin</a>(name)) <font color='red'>{</font>
<a name='L1630'>            strcpy(buf, name);
<a name='L1631'>            <b>return</b> &amp;fd_builtin;
<a name='L1632'>        <font color='red'>}</font>
<a name='L1633'><font color='darkred'>#ifdef</font> <a href='../S/2906.html#L308' title='Defined at 308 in PC/pyconfig.h.'>MS_COREDLL</a>
<a name='L1634'>        fp = <a href='../S/2885.html#L18' title='Defined at 18 in PC/import_nt.c.'>PyWin_FindRegisteredModule</a>(name, &amp;fdp, buf, buflen);
<a name='L1635'>        <b>if</b> (fp != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1636'>            *p_fp = fp;
<a name='L1637'>            <b>return</b> fdp;
<a name='L1638'>        <font color='red'>}</font>
<a name='L1639'><font color='darkred'>#endif</font>
<a name='L1640'>        path = <a href='../S/3144.html#L44' title='Defined at 44 in Python/sysmodule.c.'>PySys_GetObject</a>("path");
<a name='L1641'>    <font color='red'>}</font>
<a name='L1642'>
<a name='L1643'>    <b>if</b> (path == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !PyList_Check(path)) <font color='red'>{</font>
<a name='L1644'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError,
<a name='L1645'>                        "sys.path must be a list of directory names");
<a name='L1646'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1647'>    <font color='red'>}</font>
<a name='L1648'>
<a name='L1649'>    path_hooks = <a href='../S/3144.html#L44' title='Defined at 44 in Python/sysmodule.c.'>PySys_GetObject</a>("path_hooks");
<a name='L1650'>    <b>if</b> (path_hooks == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !PyList_Check(path_hooks)) <font color='red'>{</font>
<a name='L1651'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError,
<a name='L1652'>                        "sys.path_hooks must be a list of "
<a name='L1653'>                        "import hooks");
<a name='L1654'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1655'>    <font color='red'>}</font>
<a name='L1656'>    path_importer_cache = <a href='../S/3144.html#L44' title='Defined at 44 in Python/sysmodule.c.'>PySys_GetObject</a>("path_importer_cache");
<a name='L1657'>    <b>if</b> (path_importer_cache == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> ||
<a name='L1658'>        !PyDict_Check(path_importer_cache)) <font color='red'>{</font>
<a name='L1659'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError,
<a name='L1660'>                        "sys.path_importer_cache must be a dict");
<a name='L1661'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1662'>    <font color='red'>}</font>
<a name='L1663'>
<a name='L1664'>    npath = <a href='../S/2796.html#L166' title='Defined at 166 in Objects/listobject.c.'>PyList_Size</a>(path);
<a name='L1665'>    namelen = strlen(name);
<a name='L1666'>    <b>for</b> (i = 0; i &lt; npath; i++) <font color='red'>{</font>
<a name='L1667'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *v = <a href='../S/2796.html#L179' title='Defined at 179 in Objects/listobject.c.'>PyList_GetItem</a>(path, i);
<a name='L1668'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *origv = v;
<a name='L1669'>        <b>const</b> <b>char</b> *base;
<a name='L1670'>        <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> size;
<a name='L1671'>        <b>if</b> (!v)
<a name='L1672'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1673'>        <b>if</b> (PyUnicode_Check(v)) <font color='red'>{</font>
<a name='L1674'>            v = <a href='../S/2828.html#L1585' title='Defined at 1585 in Objects/unicodeobject.c.'>PyUnicode_EncodeFSDefault</a>(v);
<a name='L1675'>            <b>if</b> (v == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1676'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1677'>        <font color='red'>}</font>
<a name='L1678'>        <b>else</b> <b>if</b> (!PyBytes_Check(v))
<a name='L1679'>            <b>continue</b>;
<a name='L1680'>        <b>else</b>
<a name='L1681'>            Py_INCREF(v);
<a name='L1682'>
<a name='L1683'>        base = PyBytes_AS_STRING(v);
<a name='L1684'>        size = PyBytes_GET_SIZE(v);
<a name='L1685'>        len = size;
<a name='L1686'>        <b>if</b> (len + 2 + namelen + <a href='../S/3122.html#L35' title='Defined at 35 in Python/importdl.h.'>MAXSUFFIXSIZE</a> &gt;= buflen) <font color='red'>{</font>
<a name='L1687'>            Py_DECREF(v);
<a name='L1688'>            <b>continue</b>; <i><font color='green'>/* Too long */</font></i>
<a name='L1689'>        <font color='red'>}</font>
<a name='L1690'>        strcpy(buf, base);
<a name='L1691'>        Py_DECREF(v);
<a name='L1692'>
<a name='L1693'>        <b>if</b> (strlen(buf) != len) <font color='red'>{</font>
<a name='L1694'>            <b>continue</b>; <i><font color='green'>/* v contains '\0' */</font></i>
<a name='L1695'>        <font color='red'>}</font>
<a name='L1696'>
<a name='L1697'>        <i><font color='green'>/* sys.path_hooks import hook */</font></i>
<a name='L1698'>        <b>if</b> (p_loader != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1699'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *importer;
<a name='L1700'>
<a name='L1701'>            importer = <a href='../S/3120.html#L1476' title='Defined at 1476 in Python/import.c.'>get_path_importer</a>(path_importer_cache,
<a name='L1702'>                                         path_hooks, origv);
<a name='L1703'>            <b>if</b> (importer == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1704'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1705'>            <font color='red'>}</font>
<a name='L1706'>            <i><font color='green'>/* Note: importer is a borrowed reference */</font></i>
<a name='L1707'>            <b>if</b> (importer != Py_None) <font color='red'>{</font>
<a name='L1708'>                <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *loader;
<a name='L1709'>                loader = <a href='../D/3603.html' title='Multiple defined in 2 places.'>PyObject_CallMethod</a>(importer,
<a name='L1710'>                                             "find_module",
<a name='L1711'>                                             "s", fullname);
<a name='L1712'>                <b>if</b> (loader == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1713'>                    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;  <i><font color='green'>/* error */</font></i>
<a name='L1714'>                <b>if</b> (loader != Py_None) <font color='red'>{</font>
<a name='L1715'>                    <i><font color='green'>/* a loader was found */</font></i>
<a name='L1716'>                    *p_loader = loader;
<a name='L1717'>                    <b>return</b> &amp;importhookdescr;
<a name='L1718'>                <font color='red'>}</font>
<a name='L1719'>                Py_DECREF(loader);
<a name='L1720'>                <b>continue</b>;
<a name='L1721'>            <font color='red'>}</font>
<a name='L1722'>        <font color='red'>}</font>
<a name='L1723'>        <i><font color='green'>/* no hook was found, use builtin import */</font></i>
<a name='L1724'>
<a name='L1725'>        <b>if</b> (len &gt; 0 &amp;&amp; buf[len-1] != <a href='../D/4596.html' title='Multiple defined in 3 places.'>SEP</a>
<a name='L1726'><font color='darkred'>#ifdef</font> <a href='../D/64.html' title='Multiple defined in 2 places.'>ALTSEP</a>
<a name='L1727'>            &amp;&amp; buf[len-1] != <a href='../D/64.html' title='Multiple defined in 2 places.'>ALTSEP</a>
<a name='L1728'><font color='darkred'>#endif</font>
<a name='L1729'>            )
<a name='L1730'>            buf[len++] = <a href='../D/4596.html' title='Multiple defined in 3 places.'>SEP</a>;
<a name='L1731'>        strcpy(buf+len, name);
<a name='L1732'>        len += namelen;
<a name='L1733'>
<a name='L1734'>        <i><font color='green'>/* Check for package import (buf holds a directory name,</font></i>
<a name='L1735'><i><font color='green'>           and there's an __init__ module in that directory */</font></i>
<a name='L1736'><font color='darkred'>#ifdef</font> <a href='../S/565.html#L371' title='Defined at 371 in Include/pyport.h.'>HAVE_STAT</a>
<a name='L1737'>        <b>if</b> (stat(buf, &amp;statbuf) == 0 &amp;&amp;         <i><font color='green'>/* it exists */</font></i>
<a name='L1738'>            <a href='../S/565.html#L397' title='Defined at 397 in Include/pyport.h.'>S_ISDIR</a>(statbuf.st_mode) &amp;&amp;         <i><font color='green'>/* it's a directory */</font></i>
<a name='L1739'>            <a href='../S/3120.html#L1878' title='Defined at 1878 in Python/import.c.'>case_ok</a>(buf, len, namelen, name)) <font color='red'>{</font> <i><font color='green'>/* case matches */</font></i>
<a name='L1740'>            <b>if</b> (<a href='../S/3120.html#L1991' title='Defined at 1991 in Python/import.c.'>find_init_module</a>(buf)) <font color='red'>{</font> <i><font color='green'>/* and has __init__.py */</font></i>
<a name='L1741'>                <b>return</b> &amp;fd_package;
<a name='L1742'>            <font color='red'>}</font>
<a name='L1743'>            <b>else</b> <font color='red'>{</font>
<a name='L1744'>                <b>int</b> err;
<a name='L1745'>                <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *unicode = <a href='../D/3975.html' title='Multiple defined in 3 places.'>PyUnicode_DecodeFSDefault</a>(buf);
<a name='L1746'>                <b>if</b> (unicode == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1747'>                    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1748'>                err = <a href='../S/3087.html#L732' title='Defined at 732 in Python/_warnings.c.'>PyErr_WarnFormat</a>(PyExc_ImportWarning, 1,
<a name='L1749'>                    "Not importing directory '%U': missing __init__.py",
<a name='L1750'>                    unicode);
<a name='L1751'>                Py_DECREF(unicode);
<a name='L1752'>                <b>if</b> (err)
<a name='L1753'>                    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1754'>            <font color='red'>}</font>
<a name='L1755'>        <font color='red'>}</font>
<a name='L1756'><font color='darkred'>#endif</font>
<a name='L1757'><font color='darkred'>#if</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>)
<a name='L1758'>        <i><font color='green'>/* take a snapshot of the module spec for restoration</font></i>
<a name='L1759'><i><font color='green'>         * after the 8 character DLL hackery</font></i>
<a name='L1760'><i><font color='green'>         */</font></i>
<a name='L1761'>        saved_buf = <a href='../D/11408.html' title='Multiple defined in 2 places.'>strdup</a>(buf);
<a name='L1762'>        saved_len = len;
<a name='L1763'>        saved_namelen = namelen;
<a name='L1764'><font color='darkred'>#endif</font> <i><font color='green'>/* PYOS_OS2 */</font></i>
<a name='L1765'>        <b>for</b> (fdp = _PyImport_Filetab; fdp-&gt;suffix != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; fdp++) <font color='red'>{</font>
<a name='L1766'><font color='darkred'>#if</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>) &amp;&amp; <b>defined</b>(<a href='../D/1481.html' title='Multiple defined in 3 places.'>HAVE_DYNAMIC_LOADING</a>)
<a name='L1767'>            <i><font color='green'>/* OS/2 limits DLLs to 8 character names (w/o</font></i>
<a name='L1768'><i><font color='green'>               extension)</font></i>
<a name='L1769'><i><font color='green'>             * so if the name is longer than that and its a</font></i>
<a name='L1770'><i><font color='green'>             * dynamically loaded module we're going to try,</font></i>
<a name='L1771'><i><font color='green'>             * truncate the name before trying</font></i>
<a name='L1772'><i><font color='green'>             */</font></i>
<a name='L1773'>            <b>if</b> (strlen(subname) &gt; 8) <font color='red'>{</font>
<a name='L1774'>                <i><font color='green'>/* is this an attempt to load a C extension? */</font></i>
<a name='L1775'>                <b>const</b> <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *scan;
<a name='L1776'>                scan = _PyImport_DynLoadFiletab;
<a name='L1777'>                <b>while</b> (scan-&gt;suffix != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1778'>                    <b>if</b> (!strcmp(scan-&gt;suffix, fdp-&gt;suffix))
<a name='L1779'>                        <b>break</b>;
<a name='L1780'>                    <b>else</b>
<a name='L1781'>                        scan++;
<a name='L1782'>                <font color='red'>}</font>
<a name='L1783'>                <b>if</b> (scan-&gt;suffix != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1784'>                    <i><font color='green'>/* yes, so truncate the name */</font></i>
<a name='L1785'>                    namelen = 8;
<a name='L1786'>                    len -= strlen(subname) - namelen;
<a name='L1787'>                    buf[len] = '\0';
<a name='L1788'>                <font color='red'>}</font>
<a name='L1789'>            <font color='red'>}</font>
<a name='L1790'><font color='darkred'>#endif</font> <i><font color='green'>/* PYOS_OS2 */</font></i>
<a name='L1791'>            strcpy(buf+len, fdp-&gt;suffix);
<a name='L1792'>            <b>if</b> (Py_VerboseFlag &gt; 1)
<a name='L1793'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("# trying %s\n", buf);
<a name='L1794'>            filemode = fdp-&gt;mode;
<a name='L1795'>            <b>if</b> (filemode[0] == 'U')
<a name='L1796'>                filemode = "r" <a href='../S/523.html#L9' title='Defined at 9 in Include/fileobject.h.'>PY_STDIOTEXTMODE</a>;
<a name='L1797'>            fp = fopen(buf, filemode);
<a name='L1798'>            <b>if</b> (fp != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1799'>                <b>if</b> (<a href='../S/3120.html#L1878' title='Defined at 1878 in Python/import.c.'>case_ok</a>(buf, len, namelen, name))
<a name='L1800'>                    <b>break</b>;
<a name='L1801'>                <b>else</b> <font color='red'>{</font>                   <i><font color='green'>/* continue search */</font></i>
<a name='L1802'>                    fclose(fp);
<a name='L1803'>                    fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1804'>                <font color='red'>}</font>
<a name='L1805'>            <font color='red'>}</font>
<a name='L1806'><font color='darkred'>#if</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>)
<a name='L1807'>            <i><font color='green'>/* restore the saved snapshot */</font></i>
<a name='L1808'>            strcpy(buf, saved_buf);
<a name='L1809'>            len = saved_len;
<a name='L1810'>            namelen = saved_namelen;
<a name='L1811'><font color='darkred'>#endif</font>
<a name='L1812'>        <font color='red'>}</font>
<a name='L1813'><font color='darkred'>#if</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>)
<a name='L1814'>        <i><font color='green'>/* don't need/want the module name snapshot anymore */</font></i>
<a name='L1815'>        <b>if</b> (saved_buf)
<a name='L1816'>        <font color='red'>{</font>
<a name='L1817'>            free(saved_buf);
<a name='L1818'>            saved_buf = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1819'>        <font color='red'>}</font>
<a name='L1820'><font color='darkred'>#endif</font>
<a name='L1821'>        <b>if</b> (fp != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1822'>            <b>break</b>;
<a name='L1823'>    <font color='red'>}</font>
<a name='L1824'>    <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1825'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L1826'>                     "No module named %.200s", name);
<a name='L1827'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L1828'>    <font color='red'>}</font>
<a name='L1829'>    *p_fp = fp;
<a name='L1830'>    <b>return</b> fdp;
<a name='L1831'><font color='red'>}</font>
<a name='L1832'>
<a name='L1833'><i><font color='green'>/* case_ok(char* buf, Py_ssize_t len, Py_ssize_t namelen, char* name)</font></i>
<a name='L1834'><i><font color='green'> * The arguments here are tricky, best shown by example:</font></i>
<a name='L1835'><i><font color='green'> *    /a/b/c/d/e/f/g/h/i/j/k/some_long_module_name.py\0</font></i>
<a name='L1836'><i><font color='green'> *    ^                      ^                   ^    ^</font></i>
<a name='L1837'><i><font color='green'> *    |--------------------- buf ---------------------|</font></i>
<a name='L1838'><i><font color='green'> *    |------------------- len ------------------|</font></i>
<a name='L1839'><i><font color='green'> *                           |------ name -------|</font></i>
<a name='L1840'><i><font color='green'> *                           |----- namelen -----|</font></i>
<a name='L1841'><i><font color='green'> * buf is the full path, but len only counts up to (&amp; exclusive of) the</font></i>
<a name='L1842'><i><font color='green'> * extension.  name is the module name, also exclusive of extension.</font></i>
<a name='L1843'><i><font color='green'> *</font></i>
<a name='L1844'><i><font color='green'> * We've already done a successful stat() or fopen() on buf, so know that</font></i>
<a name='L1845'><i><font color='green'> * there's some match, possibly case-insensitive.</font></i>
<a name='L1846'><i><font color='green'> *</font></i>
<a name='L1847'><i><font color='green'> * case_ok() is to return 1 if there's a case-sensitive match for</font></i>
<a name='L1848'><i><font color='green'> * name, else 0.  case_ok() is also to return 1 if envar PYTHONCASEOK</font></i>
<a name='L1849'><i><font color='green'> * exists.</font></i>
<a name='L1850'><i><font color='green'> *</font></i>
<a name='L1851'><i><font color='green'> * case_ok() is used to implement case-sensitive import semantics even</font></i>
<a name='L1852'><i><font color='green'> * on platforms with case-insensitive filesystems.  It's trivial to implement</font></i>
<a name='L1853'><i><font color='green'> * for case-sensitive filesystems.  It's pretty much a cross-platform</font></i>
<a name='L1854'><i><font color='green'> * nightmare for systems with case-insensitive filesystems.</font></i>
<a name='L1855'><i><font color='green'> */</font></i>
<a name='L1856'>
<a name='L1857'><i><font color='green'>/* First we may need a pile of platform-specific header files; the sequence</font></i>
<a name='L1858'><i><font color='green'> * of #if's here should match the sequence in the body of case_ok().</font></i>
<a name='L1859'><i><font color='green'> */</font></i>
<a name='L1860'><font color='darkred'>#if</font> <b>defined</b>(<a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>)
<a name='L1861'><font color='darkred'>#include</font> &lt;windows.h&gt;
<a name='L1862'>
<a name='L1863'><font color='darkred'>#elif</font> <b>defined</b>(DJGPP)
<a name='L1864'><font color='darkred'>#include</font> &lt;dir.h&gt;
<a name='L1865'>
<a name='L1866'><font color='darkred'>#elif</font> (<b>defined</b>(__MACH__) &amp;&amp; <b>defined</b>(__APPLE__) || <b>defined</b>(__CYGWIN__)) &amp;&amp; <b>defined</b>(<a href='../D/1478.html' title='Multiple defined in 2 places.'>HAVE_DIRENT_H</a>)
<a name='L1867'><font color='darkred'>#include</font> &lt;sys/types.h&gt;
<a name='L1868'><font color='darkred'>#include</font> &lt;dirent.h&gt;
<a name='L1869'>
<a name='L1870'><font color='darkred'>#elif</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>)
<a name='L1871'><font color='darkred'>#define</font> INCL_DOS
<a name='L1872'><font color='darkred'>#define</font> INCL_DOSERRORS
<a name='L1873'><font color='darkred'>#define</font> INCL_NOPMAPI
<a name='L1874'><font color='darkred'>#include</font> &lt;os2.h&gt;
<a name='L1875'><font color='darkred'>#endif</font>
<a name='L1876'>
<a name='L1877'><b>static</b> <b>int</b>
<a name='L1878'><a href='../R/6581.html' title='Multiple refered from 5 places.'>case_ok</a>(<b>char</b> *buf, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> namelen, <b>char</b> *name)
<a name='L1879'><font color='red'>{</font>
<a name='L1880'><i><font color='green'>/* Pick a platform-specific implementation; the sequence of #if's here should</font></i>
<a name='L1881'><i><font color='green'> * match the sequence just above.</font></i>
<a name='L1882'><i><font color='green'> */</font></i>
<a name='L1883'>
<a name='L1884'><i><font color='green'>/* MS_WINDOWS */</font></i>
<a name='L1885'><font color='darkred'>#if</font> <b>defined</b>(<a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>)
<a name='L1886'>    WIN32_FIND_DATA data;
<a name='L1887'>    <a href='../S/2583.html#L40' title='Defined at 40 in Modules/_multiprocessing/multiprocessing.h.'>HANDLE</a> h;
<a name='L1888'>
<a name='L1889'>    <b>if</b> (Py_GETENV("PYTHONCASEOK") != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1890'>        <b>return</b> 1;
<a name='L1891'>
<a name='L1892'>    h = FindFirstFile(buf, &amp;data);
<a name='L1893'>    <b>if</b> (h == <a href='../S/2583.html#L47' title='Defined at 47 in Modules/_multiprocessing/multiprocessing.h.'>INVALID_HANDLE_VALUE</a>) <font color='red'>{</font>
<a name='L1894'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_NameError,
<a name='L1895'>          "Can't find file for module %.100s\n(filename %.300s)",
<a name='L1896'>          name, buf);
<a name='L1897'>        <b>return</b> 0;
<a name='L1898'>    <font color='red'>}</font>
<a name='L1899'>    FindClose(h);
<a name='L1900'>    <b>return</b> strncmp(data.cFileName, name, namelen) == 0;
<a name='L1901'>
<a name='L1902'><i><font color='green'>/* DJGPP */</font></i>
<a name='L1903'><font color='darkred'>#elif</font> <b>defined</b>(DJGPP)
<a name='L1904'>    <b>struct</b> ffblk ffblk;
<a name='L1905'>    <b>int</b> done;
<a name='L1906'>
<a name='L1907'>    <b>if</b> (Py_GETENV("PYTHONCASEOK") != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1908'>        <b>return</b> 1;
<a name='L1909'>
<a name='L1910'>    done = findfirst(buf, &amp;ffblk, FA_ARCH|FA_RDONLY|FA_HIDDEN|FA_DIREC);
<a name='L1911'>    <b>if</b> (done) <font color='red'>{</font>
<a name='L1912'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_NameError,
<a name='L1913'>          "Can't find file for module %.100s\n(filename %.300s)",
<a name='L1914'>          name, buf);
<a name='L1915'>        <b>return</b> 0;
<a name='L1916'>    <font color='red'>}</font>
<a name='L1917'>    <b>return</b> strncmp(ffblk.ff_name, name, namelen) == 0;
<a name='L1918'>
<a name='L1919'><i><font color='green'>/* new-fangled macintosh (macosx) or Cygwin */</font></i>
<a name='L1920'><font color='darkred'>#elif</font> (<b>defined</b>(__MACH__) &amp;&amp; <b>defined</b>(__APPLE__) || <b>defined</b>(__CYGWIN__)) &amp;&amp; <b>defined</b>(<a href='../D/1478.html' title='Multiple defined in 2 places.'>HAVE_DIRENT_H</a>)
<a name='L1921'>    DIR *dirp;
<a name='L1922'>    <b>struct</b> <a href='../S/2696.html#L242' title='Defined at 242 in Modules/posixmodule.c.'>dirent</a> *dp;
<a name='L1923'>    <b>char</b> dirname[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a> + 1];
<a name='L1924'>    <b>const</b> <b>int</b> dirlen = len - namelen - 1; <i><font color='green'>/* don't want trailing SEP */</font></i>
<a name='L1925'>
<a name='L1926'>    <b>if</b> (Py_GETENV("PYTHONCASEOK") != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1927'>        <b>return</b> 1;
<a name='L1928'>
<a name='L1929'>    <i><font color='green'>/* Copy the dir component into dirname; substitute "." if empty */</font></i>
<a name='L1930'>    <b>if</b> (dirlen &lt;= 0) <font color='red'>{</font>
<a name='L1931'>        dirname[0] = '.';
<a name='L1932'>        dirname[1] = '\0';
<a name='L1933'>    <font color='red'>}</font>
<a name='L1934'>    <b>else</b> <font color='red'>{</font>
<a name='L1935'>        <a href='../D/6814.html' title='Multiple defined in 2 places.'>assert</a>(dirlen &lt;= <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>);
<a name='L1936'>        <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(dirname, buf, dirlen);
<a name='L1937'>        dirname[dirlen] = '\0';
<a name='L1938'>    <font color='red'>}</font>
<a name='L1939'>    <i><font color='green'>/* Open the directory and search the entries for an exact match. */</font></i>
<a name='L1940'>    dirp = opendir(dirname);
<a name='L1941'>    <b>if</b> (dirp) <font color='red'>{</font>
<a name='L1942'>        <b>char</b> *nameWithExt = buf + len - namelen;
<a name='L1943'>        <b>while</b> ((dp = readdir(dirp)) != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L1944'>            <b>const</b> <b>int</b> thislen =
<a name='L1945'><font color='darkred'>#ifdef</font> _DIRENT_HAVE_D_NAMELEN
<a name='L1946'>                                    dp-&gt;d_namlen;
<a name='L1947'><font color='darkred'>#else</font>
<a name='L1948'>                                    strlen(dp-&gt;d_name);
<a name='L1949'><font color='darkred'>#endif</font>
<a name='L1950'>            <b>if</b> (thislen &gt;= namelen &amp;&amp;
<a name='L1951'>                strcmp(dp-&gt;d_name, nameWithExt) == 0) <font color='red'>{</font>
<a name='L1952'>                (<b>void</b>)closedir(dirp);
<a name='L1953'>                <b>return</b> 1; <i><font color='green'>/* Found */</font></i>
<a name='L1954'>            <font color='red'>}</font>
<a name='L1955'>        <font color='red'>}</font>
<a name='L1956'>        (<b>void</b>)closedir(dirp);
<a name='L1957'>    <font color='red'>}</font>
<a name='L1958'>    <b>return</b> 0 ; <i><font color='green'>/* Not found */</font></i>
<a name='L1959'>
<a name='L1960'><i><font color='green'>/* OS/2 */</font></i>
<a name='L1961'><font color='darkred'>#elif</font> <b>defined</b>(<a href='../D/2567.html' title='Multiple defined in 2 places.'>PYOS_OS2</a>)
<a name='L1962'>    HDIR hdir = 1;
<a name='L1963'>    ULONG srchcnt = 1;
<a name='L1964'>    FILEFINDBUF3 ffbuf;
<a name='L1965'>    APIRET rc;
<a name='L1966'>
<a name='L1967'>    <b>if</b> (Py_GETENV("PYTHONCASEOK") != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L1968'>        <b>return</b> 1;
<a name='L1969'>
<a name='L1970'>    rc = DosFindFirst(buf,
<a name='L1971'>                      &amp;hdir,
<a name='L1972'>                      FILE_READONLY | FILE_HIDDEN | FILE_SYSTEM | FILE_DIRECTORY,
<a name='L1973'>                      &amp;ffbuf, <b>sizeof</b>(ffbuf),
<a name='L1974'>                      &amp;srchcnt,
<a name='L1975'>                      FIL_STANDARD);
<a name='L1976'>    <b>if</b> (rc != NO_ERROR)
<a name='L1977'>        <b>return</b> 0;
<a name='L1978'>    <b>return</b> strncmp(ffbuf.achName, name, namelen) == 0;
<a name='L1979'>
<a name='L1980'><i><font color='green'>/* assuming it's a case-sensitive filesystem, so there's nothing to do! */</font></i>
<a name='L1981'><font color='darkred'>#else</font>
<a name='L1982'>    <b>return</b> 1;
<a name='L1983'>
<a name='L1984'><font color='darkred'>#endif</font>
<a name='L1985'><font color='red'>}</font>
<a name='L1986'>
<a name='L1987'><font color='darkred'>#ifdef</font> <a href='../S/565.html#L371' title='Defined at 371 in Include/pyport.h.'>HAVE_STAT</a>
<a name='L1988'>
<a name='L1989'><i><font color='green'>/* Helper to look for __init__.py or __init__.py[co] in potential package */</font></i>
<a name='L1990'><b>static</b> <b>int</b>
<a name='L1991'><a href='../R/7801.html' title='Multiple refered from 2 places.'>find_init_module</a>(<b>char</b> *buf)
<a name='L1992'><font color='red'>{</font>
<a name='L1993'>    <b>const</b> <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> save_len = strlen(buf);
<a name='L1994'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> i = save_len;
<a name='L1995'>    <b>char</b> *pname;  <i><font color='green'>/* pointer to start of __init__ */</font></i>
<a name='L1996'>    <b>struct</b> stat statbuf;
<a name='L1997'>
<a name='L1998'><i><font color='green'>/*      For calling case_ok(buf, len, namelen, name):</font></i>
<a name='L1999'><i><font color='green'> *      /a/b/c/d/e/f/g/h/i/j/k/some_long_module_name.py\0</font></i>
<a name='L2000'><i><font color='green'> *      ^                      ^                   ^    ^</font></i>
<a name='L2001'><i><font color='green'> *      |--------------------- buf ---------------------|</font></i>
<a name='L2002'><i><font color='green'> *      |------------------- len ------------------|</font></i>
<a name='L2003'><i><font color='green'> *                             |------ name -------|</font></i>
<a name='L2004'><i><font color='green'> *                             |----- namelen -----|</font></i>
<a name='L2005'><i><font color='green'> */</font></i>
<a name='L2006'>    <b>if</b> (save_len + 13 &gt;= <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>)
<a name='L2007'>        <b>return</b> 0;
<a name='L2008'>    buf[i++] = <a href='../D/4596.html' title='Multiple defined in 3 places.'>SEP</a>;
<a name='L2009'>    pname = buf + i;
<a name='L2010'>    strcpy(pname, "__init__.py");
<a name='L2011'>    <b>if</b> (stat(buf, &amp;statbuf) == 0) <font color='red'>{</font>
<a name='L2012'>        <b>if</b> (<a href='../S/3120.html#L1878' title='Defined at 1878 in Python/import.c.'>case_ok</a>(buf,
<a name='L2013'>                    save_len + 9,               <i><font color='green'>/* len("/__init__") */</font></i>
<a name='L2014'>                8,                              <i><font color='green'>/* len("__init__") */</font></i>
<a name='L2015'>                pname)) <font color='red'>{</font>
<a name='L2016'>            buf[save_len] = '\0';
<a name='L2017'>            <b>return</b> 1;
<a name='L2018'>        <font color='red'>}</font>
<a name='L2019'>    <font color='red'>}</font>
<a name='L2020'>    i += strlen(pname);
<a name='L2021'>    strcpy(buf+i, Py_OptimizeFlag ? "o" : "c");
<a name='L2022'>    <b>if</b> (stat(buf, &amp;statbuf) == 0) <font color='red'>{</font>
<a name='L2023'>        <b>if</b> (<a href='../S/3120.html#L1878' title='Defined at 1878 in Python/import.c.'>case_ok</a>(buf,
<a name='L2024'>                    save_len + 9,               <i><font color='green'>/* len("/__init__") */</font></i>
<a name='L2025'>                8,                              <i><font color='green'>/* len("__init__") */</font></i>
<a name='L2026'>                pname)) <font color='red'>{</font>
<a name='L2027'>            buf[save_len] = '\0';
<a name='L2028'>            <b>return</b> 1;
<a name='L2029'>        <font color='red'>}</font>
<a name='L2030'>    <font color='red'>}</font>
<a name='L2031'>    buf[save_len] = '\0';
<a name='L2032'>    <b>return</b> 0;
<a name='L2033'><font color='red'>}</font>
<a name='L2034'>
<a name='L2035'><font color='darkred'>#endif</font> <i><font color='green'>/* HAVE_STAT */</font></i>
<a name='L2036'>
<a name='L2037'>
<a name='L2038'><b>static</b> <b>int</b> <a href='../S/3120.html#L2151' title='Defined at 2151 in Python/import.c.'>init_builtin</a>(<b>char</b> *); <i><font color='green'>/* Forward */</font></i>
<a name='L2039'>
<a name='L2040'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a>*
<a name='L2041'><a href='../S/3120.html#L2121' title='Refered from 2121 in Python/import.c.'>load_builtin</a>(<b>char</b> *name, <b>char</b> *pathname, <b>int</b> type)
<a name='L2042'><font color='red'>{</font>
<a name='L2043'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m, *modules;
<a name='L2044'>    <b>int</b> err;
<a name='L2045'>
<a name='L2046'>    <b>if</b> (pathname != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; pathname[0] != '\0')
<a name='L2047'>        name = pathname;
<a name='L2048'>
<a name='L2049'>    <b>if</b> (type == <a href='../S/3122.html#L17' title='Defined at 17 in Python/importdl.h.'>C_BUILTIN</a>)
<a name='L2050'>        err = <a href='../S/3120.html#L2151' title='Defined at 2151 in Python/import.c.'>init_builtin</a>(name);
<a name='L2051'>    <b>else</b>
<a name='L2052'>        err = <a href='../S/3120.html#L2255' title='Defined at 2255 in Python/import.c.'>PyImport_ImportFrozenModule</a>(name);
<a name='L2053'>    <b>if</b> (err &lt; 0)
<a name='L2054'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2055'>    <b>if</b> (err == 0) <font color='red'>{</font>
<a name='L2056'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2057'>                "Purported %s module %.200s not found",
<a name='L2058'>                type == <a href='../S/3122.html#L17' title='Defined at 17 in Python/importdl.h.'>C_BUILTIN</a> ?
<a name='L2059'>                "builtin" : "frozen",
<a name='L2060'>                name);
<a name='L2061'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2062'>    <font color='red'>}</font>
<a name='L2063'>
<a name='L2064'>    modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L2065'>    m = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, name);
<a name='L2066'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2067'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(
<a name='L2068'>                PyExc_ImportError,
<a name='L2069'>                "%s module %.200s not properly initialized",
<a name='L2070'>                type == <a href='../S/3122.html#L17' title='Defined at 17 in Python/importdl.h.'>C_BUILTIN</a> ?
<a name='L2071'>                "builtin" : "frozen",
<a name='L2072'>                name);
<a name='L2073'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2074'>    <font color='red'>}</font>
<a name='L2075'>    Py_INCREF(m);
<a name='L2076'>    <b>return</b> m;
<a name='L2077'><font color='red'>}</font>
<a name='L2078'>
<a name='L2079'><i><font color='green'>/* Load an external module using the default search path and return</font></i>
<a name='L2080'><i><font color='green'>   its module object WITH INCREMENTED REFERENCE COUNT */</font></i>
<a name='L2081'>
<a name='L2082'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2083'><a href='../R/8716.html' title='Multiple refered from 5 places.'>load_module</a>(<b>char</b> *name, FILE *fp, <b>char</b> *pathname, <b>int</b> type, PyObject *loader)
<a name='L2084'><font color='red'>{</font>
<a name='L2085'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L2086'>
<a name='L2087'>    <i><font color='green'>/* First check that there's an open file (if we need one)  */</font></i>
<a name='L2088'>    <b>switch</b> (type) <font color='red'>{</font>
<a name='L2089'>    <b>case</b> <a href='../S/3122.html#L12' title='Defined at 12 in Python/importdl.h.'>PY_SOURCE</a>:
<a name='L2090'>    <b>case</b> <a href='../S/3122.html#L13' title='Defined at 13 in Python/importdl.h.'>PY_COMPILED</a>:
<a name='L2091'>        <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2092'>            <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ValueError,
<a name='L2093'>               "file object required for import (type code %d)",
<a name='L2094'>                         type);
<a name='L2095'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2096'>        <font color='red'>}</font>
<a name='L2097'>    <font color='red'>}</font>
<a name='L2098'>
<a name='L2099'>    <b>switch</b> (type) <font color='red'>{</font>
<a name='L2100'>
<a name='L2101'>    <b>case</b> <a href='../S/3122.html#L12' title='Defined at 12 in Python/importdl.h.'>PY_SOURCE</a>:
<a name='L2102'>        m = <a href='../S/3120.html#L1285' title='Defined at 1285 in Python/import.c.'>load_source_module</a>(name, pathname, fp);
<a name='L2103'>        <b>break</b>;
<a name='L2104'>
<a name='L2105'>    <b>case</b> <a href='../S/3122.html#L13' title='Defined at 13 in Python/importdl.h.'>PY_COMPILED</a>:
<a name='L2106'>        m = <a href='../S/3120.html#L1075' title='Defined at 1075 in Python/import.c.'>load_compiled_module</a>(name, pathname, fp);
<a name='L2107'>        <b>break</b>;
<a name='L2108'>
<a name='L2109'><font color='darkred'>#ifdef</font> <a href='../D/1481.html' title='Multiple defined in 3 places.'>HAVE_DYNAMIC_LOADING</a>
<a name='L2110'>    <b>case</b> <a href='../S/3122.html#L14' title='Defined at 14 in Python/importdl.h.'>C_EXTENSION</a>:
<a name='L2111'>        m = <a href='../S/3121.html#L22' title='Defined at 22 in Python/importdl.c.'>_PyImport_LoadDynamicModule</a>(name, pathname, fp);
<a name='L2112'>        <b>break</b>;
<a name='L2113'><font color='darkred'>#endif</font>
<a name='L2114'>
<a name='L2115'>    <b>case</b> <a href='../S/3122.html#L16' title='Defined at 16 in Python/importdl.h.'>PKG_DIRECTORY</a>:
<a name='L2116'>        m = <a href='../S/3120.html#L1396' title='Defined at 1396 in Python/import.c.'>load_package</a>(name, pathname);
<a name='L2117'>        <b>break</b>;
<a name='L2118'>
<a name='L2119'>    <b>case</b> <a href='../S/3122.html#L17' title='Defined at 17 in Python/importdl.h.'>C_BUILTIN</a>:
<a name='L2120'>    <b>case</b> <a href='../S/3122.html#L18' title='Defined at 18 in Python/importdl.h.'>PY_FROZEN</a>:
<a name='L2121'>        m = <a href='../S/3120.html#L2041' title='Defined at 2041 in Python/import.c.'>load_builtin</a>(name, pathname, type);
<a name='L2122'>        <b>break</b>;
<a name='L2123'>
<a name='L2124'>    <b>case</b> <a href='../S/3122.html#L20' title='Defined at 20 in Python/importdl.h.'>IMP_HOOK</a>: <font color='red'>{</font>
<a name='L2125'>        <b>if</b> (loader == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2126'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError,
<a name='L2127'>                            "import hook without loader");
<a name='L2128'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2129'>        <font color='red'>}</font>
<a name='L2130'>        m = <a href='../D/3603.html' title='Multiple defined in 2 places.'>PyObject_CallMethod</a>(loader, "load_module", "s", name);
<a name='L2131'>        <b>break</b>;
<a name='L2132'>    <font color='red'>}</font>
<a name='L2133'>
<a name='L2134'>    <b>default</b>:
<a name='L2135'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2136'>                     "Don't know how to import %.200s (type code %d)",
<a name='L2137'>                      name, type);
<a name='L2138'>        m = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2139'>
<a name='L2140'>    <font color='red'>}</font>
<a name='L2141'>
<a name='L2142'>    <b>return</b> m;
<a name='L2143'><font color='red'>}</font>
<a name='L2144'>
<a name='L2145'>
<a name='L2146'><i><font color='green'>/* Initialize a built-in module.</font></i>
<a name='L2147'><i><font color='green'>   Return 1 for success, 0 if the module is not found, and -1 with</font></i>
<a name='L2148'><i><font color='green'>   an exception set if the initialization failed. */</font></i>
<a name='L2149'>
<a name='L2150'><b>static</b> <b>int</b>
<a name='L2151'><a href='../R/8381.html' title='Multiple refered from 3 places.'>init_builtin</a>(<b>char</b> *name)
<a name='L2152'><font color='red'>{</font>
<a name='L2153'>    <b>struct</b> _inittab *p;
<a name='L2154'>
<a name='L2155'>    <b>if</b> (<a href='../S/3120.html#L683' title='Defined at 683 in Python/import.c.'>_PyImport_FindBuiltin</a>(name) != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2156'>        <b>return</b> 1;
<a name='L2157'>
<a name='L2158'>    <b>for</b> (p = PyImport_Inittab; p-&gt;name != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; p++) <font color='red'>{</font>
<a name='L2159'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *mod;
<a name='L2160'>        <b>if</b> (strcmp(name, p-&gt;name) == 0) <font color='red'>{</font>
<a name='L2161'>            <b>if</b> (p-&gt;initfunc == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2162'>                <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2163'>                    "Cannot re-init internal module %.200s",
<a name='L2164'>                    name);
<a name='L2165'>                <b>return</b> -1;
<a name='L2166'>            <font color='red'>}</font>
<a name='L2167'>            <b>if</b> (Py_VerboseFlag)
<a name='L2168'>                <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("import %s # builtin\n", name);
<a name='L2169'>            mod = (*p-&gt;initfunc)();
<a name='L2170'>            <b>if</b> (mod == 0)
<a name='L2171'>                <b>return</b> -1;
<a name='L2172'>            <b>if</b> (<a href='../S/3120.html#L626' title='Defined at 626 in Python/import.c.'>_PyImport_FixupBuiltin</a>(mod, name) &lt; 0)
<a name='L2173'>                <b>return</b> -1;
<a name='L2174'>            <i><font color='green'>/* FixupExtension has put the module into sys.modules,</font></i>
<a name='L2175'><i><font color='green'>               so we can release our own reference. */</font></i>
<a name='L2176'>            Py_DECREF(mod);
<a name='L2177'>            <b>return</b> 1;
<a name='L2178'>        <font color='red'>}</font>
<a name='L2179'>    <font color='red'>}</font>
<a name='L2180'>    <b>return</b> 0;
<a name='L2181'><font color='red'>}</font>
<a name='L2182'>
<a name='L2183'>
<a name='L2184'><i><font color='green'>/* Frozen modules */</font></i>
<a name='L2185'>
<a name='L2186'><b>static</b> <b>struct</b> _frozen *
<a name='L2187'><a href='../R/7799.html' title='Multiple refered from 6 places.'>find_frozen</a>(<b>char</b> *name)
<a name='L2188'><font color='red'>{</font>
<a name='L2189'>    <b>struct</b> _frozen *p;
<a name='L2190'>
<a name='L2191'>    <b>if</b> (!name)
<a name='L2192'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2193'>
<a name='L2194'>    <b>for</b> (p = PyImport_FrozenModules; ; p++) <font color='red'>{</font>
<a name='L2195'>        <b>if</b> (p-&gt;name == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2196'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2197'>        <b>if</b> (strcmp(p-&gt;name, name) == 0)
<a name='L2198'>            <b>break</b>;
<a name='L2199'>    <font color='red'>}</font>
<a name='L2200'>    <b>return</b> p;
<a name='L2201'><font color='red'>}</font>
<a name='L2202'>
<a name='L2203'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2204'><a href='../S/3120.html#L3267' title='Refered from 3267 in Python/import.c.'>get_frozen_object</a>(<b>char</b> *name)
<a name='L2205'><font color='red'>{</font>
<a name='L2206'>    <b>struct</b> _frozen *p = <a href='../S/3120.html#L2187' title='Defined at 2187 in Python/import.c.'>find_frozen</a>(name);
<a name='L2207'>    <b>int</b> size;
<a name='L2208'>
<a name='L2209'>    <b>if</b> (p == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2210'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2211'>                     "No such frozen object named %.200s",
<a name='L2212'>                     name);
<a name='L2213'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2214'>    <font color='red'>}</font>
<a name='L2215'>    <b>if</b> (p-&gt;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2216'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2217'>                     "Excluded frozen object named %.200s",
<a name='L2218'>                     name);
<a name='L2219'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2220'>    <font color='red'>}</font>
<a name='L2221'>    size = p-&gt;size;
<a name='L2222'>    <b>if</b> (size &lt; 0)
<a name='L2223'>        size = -size;
<a name='L2224'>    <b>return</b> <a href='../S/3124.html#L1124' title='Defined at 1124 in Python/marshal.c.'>PyMarshal_ReadObjectFromString</a>((<b>char</b> *)p-&gt;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, size);
<a name='L2225'><font color='red'>}</font>
<a name='L2226'>
<a name='L2227'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2228'><a href='../S/3120.html#L3277' title='Refered from 3277 in Python/import.c.'>is_frozen_package</a>(<b>char</b> *name)
<a name='L2229'><font color='red'>{</font>
<a name='L2230'>    <b>struct</b> _frozen *p = <a href='../S/3120.html#L2187' title='Defined at 2187 in Python/import.c.'>find_frozen</a>(name);
<a name='L2231'>    <b>int</b> size;
<a name='L2232'>
<a name='L2233'>    <b>if</b> (p == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2234'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2235'>                     "No such frozen object named %.200s",
<a name='L2236'>                     name);
<a name='L2237'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2238'>    <font color='red'>}</font>
<a name='L2239'>
<a name='L2240'>    size = p-&gt;size;
<a name='L2241'>
<a name='L2242'>    <b>if</b> (size &lt; 0)
<a name='L2243'>        Py_RETURN_TRUE;
<a name='L2244'>    <b>else</b>
<a name='L2245'>        Py_RETURN_FALSE;
<a name='L2246'><font color='red'>}</font>
<a name='L2247'>
<a name='L2248'>
<a name='L2249'><i><font color='green'>/* Initialize a frozen module.</font></i>
<a name='L2250'><i><font color='green'>   Return 1 for success, 0 if the module is not found, and -1 with</font></i>
<a name='L2251'><i><font color='green'>   an exception set if the initialization failed.</font></i>
<a name='L2252'><i><font color='green'>   This function is also used from frozenmain.c */</font></i>
<a name='L2253'>
<a name='L2254'><b>int</b>
<a name='L2255'><a href='../R/3014.html' title='Multiple refered from 3 places.'>PyImport_ImportFrozenModule</a>(<b>char</b> *name)
<a name='L2256'><font color='red'>{</font>
<a name='L2257'>    <b>struct</b> _frozen *p = <a href='../S/3120.html#L2187' title='Defined at 2187 in Python/import.c.'>find_frozen</a>(name);
<a name='L2258'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *co;
<a name='L2259'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L2260'>    <b>int</b> ispackage;
<a name='L2261'>    <b>int</b> size;
<a name='L2262'>
<a name='L2263'>    <b>if</b> (p == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2264'>        <b>return</b> 0;
<a name='L2265'>    <b>if</b> (p-&gt;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a> == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2266'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2267'>                     "Excluded frozen object named %.200s",
<a name='L2268'>                     name);
<a name='L2269'>        <b>return</b> -1;
<a name='L2270'>    <font color='red'>}</font>
<a name='L2271'>    size = p-&gt;size;
<a name='L2272'>    ispackage = (size &lt; 0);
<a name='L2273'>    <b>if</b> (ispackage)
<a name='L2274'>        size = -size;
<a name='L2275'>    <b>if</b> (Py_VerboseFlag)
<a name='L2276'>        <a href='../D/3819.html' title='Multiple defined in 2 places.'>PySys_WriteStderr</a>("import %s # frozen%s\n",
<a name='L2277'>            name, ispackage ? " package" : "");
<a name='L2278'>    co = <a href='../S/3124.html#L1124' title='Defined at 1124 in Python/marshal.c.'>PyMarshal_ReadObjectFromString</a>((<b>char</b> *)p-&gt;<a href='../S/2755.html#L28' title='Defined at 28 in Modules/zlib/inftrees.h.'>code</a>, size);
<a name='L2279'>    <b>if</b> (co == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2280'>        <b>return</b> -1;
<a name='L2281'>    <b>if</b> (!PyCode_Check(co)) <font color='red'>{</font>
<a name='L2282'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_TypeError,
<a name='L2283'>                     "frozen object %.200s is not a code object",
<a name='L2284'>                     name);
<a name='L2285'>        <b>goto</b> err_return;
<a name='L2286'>    <font color='red'>}</font>
<a name='L2287'>    <b>if</b> (ispackage) <font color='red'>{</font>
<a name='L2288'>        <i><font color='green'>/* Set __path__ to the package name */</font></i>
<a name='L2289'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *d, *s, *l;
<a name='L2290'>        <b>int</b> err;
<a name='L2291'>        m = <a href='../S/3120.html#L701' title='Defined at 701 in Python/import.c.'>PyImport_AddModule</a>(name);
<a name='L2292'>        <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2293'>            <b>goto</b> err_return;
<a name='L2294'>        d = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(m);
<a name='L2295'>        s = <a href='../S/2828.html#L10060' title='Defined at 10060 in Objects/unicodeobject.c.'>PyUnicode_InternFromString</a>(name);
<a name='L2296'>        <b>if</b> (s == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2297'>            <b>goto</b> err_return;
<a name='L2298'>        l = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(1);
<a name='L2299'>        <b>if</b> (l == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2300'>            Py_DECREF(s);
<a name='L2301'>            <b>goto</b> err_return;
<a name='L2302'>        <font color='red'>}</font>
<a name='L2303'>        PyList_SET_ITEM(l, 0, s);
<a name='L2304'>        err = <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, "__path__", l);
<a name='L2305'>        Py_DECREF(l);
<a name='L2306'>        <b>if</b> (err != 0)
<a name='L2307'>            <b>goto</b> err_return;
<a name='L2308'>    <font color='red'>}</font>
<a name='L2309'>    m = <a href='../S/3120.html#L756' title='Defined at 756 in Python/import.c.'>PyImport_ExecCodeModuleEx</a>(name, co, "&lt;frozen&gt;");
<a name='L2310'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2311'>        <b>goto</b> err_return;
<a name='L2312'>    Py_DECREF(co);
<a name='L2313'>    Py_DECREF(m);
<a name='L2314'>    <b>return</b> 1;
<a name='L2315'>err_return:
<a name='L2316'>    Py_DECREF(co);
<a name='L2317'>    <b>return</b> -1;
<a name='L2318'><font color='red'>}</font>
<a name='L2319'>
<a name='L2320'>
<a name='L2321'><i><font color='green'>/* Import a module, either built-in, frozen, or external, and return</font></i>
<a name='L2322'><i><font color='green'>   its module object WITH INCREMENTED REFERENCE COUNT */</font></i>
<a name='L2323'>
<a name='L2324'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2325'><a href='../R/3015.html' title='Multiple refered from 31 places.'>PyImport_ImportModule</a>(<b>const</b> <b>char</b> *name)
<a name='L2326'><font color='red'>{</font>
<a name='L2327'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pname;
<a name='L2328'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2329'>
<a name='L2330'>    pname = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(name);
<a name='L2331'>    <b>if</b> (pname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2332'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2333'>    <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/3120.html#L3017' title='Defined at 3017 in Python/import.c.'>PyImport_Import</a>(pname);
<a name='L2334'>    Py_DECREF(pname);
<a name='L2335'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2336'><font color='red'>}</font>
<a name='L2337'>
<a name='L2338'><i><font color='green'>/* Import a module without blocking</font></i>
<a name='L2339'><i><font color='green'> *</font></i>
<a name='L2340'><i><font color='green'> * At first it tries to fetch the module from sys.modules. If the module was</font></i>
<a name='L2341'><i><font color='green'> * never loaded before it loads it with PyImport_ImportModule() unless another</font></i>
<a name='L2342'><i><font color='green'> * thread holds the import lock. In the latter case the function raises an</font></i>
<a name='L2343'><i><font color='green'> * ImportError instead of blocking.</font></i>
<a name='L2344'><i><font color='green'> *</font></i>
<a name='L2345'><i><font color='green'> * Returns the module object with incremented ref count.</font></i>
<a name='L2346'><i><font color='green'> */</font></i>
<a name='L2347'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2348'><a href='../R/3017.html' title='Multiple refered from 19 places.'>PyImport_ImportModuleNoBlock</a>(<b>const</b> <b>char</b> *name)
<a name='L2349'><font color='red'>{</font>
<a name='L2350'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2351'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules;
<a name='L2352'>    <b>long</b> me;
<a name='L2353'>
<a name='L2354'>    <i><font color='green'>/* Try to get the module from sys.modules[name] */</font></i>
<a name='L2355'>    modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L2356'>    <b>if</b> (modules == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2357'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2358'>
<a name='L2359'>    <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, name);
<a name='L2360'>    <b>if</b> (<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2361'>        Py_INCREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L2362'>        <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2363'>    <font color='red'>}</font>
<a name='L2364'>    <b>else</b> <font color='red'>{</font>
<a name='L2365'>        <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L2366'>    <font color='red'>}</font>
<a name='L2367'><font color='darkred'>#ifdef</font> <a href='../D/5537.html' title='Multiple defined in 3 places.'>WITH_THREAD</a>
<a name='L2368'>    <i><font color='green'>/* check the import lock</font></i>
<a name='L2369'><i><font color='green'>     * me might be -1 but I ignore the error here, the lock function</font></i>
<a name='L2370'><i><font color='green'>     * takes care of the problem */</font></i>
<a name='L2371'>    me = <a href='../D/3856.html' title='Multiple defined in 10 places.'>PyThread_get_thread_ident</a>();
<a name='L2372'>    <b>if</b> (import_lock_thread == -1 || import_lock_thread == me) <font color='red'>{</font>
<a name='L2373'>        <i><font color='green'>/* no thread or me is holding the lock */</font></i>
<a name='L2374'>        <b>return</b> <a href='../S/3120.html#L2325' title='Defined at 2325 in Python/import.c.'>PyImport_ImportModule</a>(name);
<a name='L2375'>    <font color='red'>}</font>
<a name='L2376'>    <b>else</b> <font color='red'>{</font>
<a name='L2377'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2378'>                     "Failed to import %.200s because the import lock"
<a name='L2379'>                     "is held by another thread.",
<a name='L2380'>                     name);
<a name='L2381'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2382'>    <font color='red'>}</font>
<a name='L2383'><font color='darkred'>#else</font>
<a name='L2384'>    <b>return</b> <a href='../S/3120.html#L2325' title='Defined at 2325 in Python/import.c.'>PyImport_ImportModule</a>(name);
<a name='L2385'><font color='darkred'>#endif</font>
<a name='L2386'><font color='red'>}</font>
<a name='L2387'>
<a name='L2388'><i><font color='green'>/* Forward declarations for helper routines */</font></i>
<a name='L2389'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3120.html#L2496' title='Defined at 2496 in Python/import.c.'>get_parent</a>(PyObject *globals, <b>char</b> *buf,
<a name='L2390'>                            <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> *p_buflen, <b>int</b> level);
<a name='L2391'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/3120.html#L2663' title='Defined at 2663 in Python/import.c.'>load_next</a>(PyObject *mod, PyObject *altmod,
<a name='L2392'>                           <b>char</b> **p_name, <b>char</b> *buf, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> *p_buflen);
<a name='L2393'><b>static</b> <b>int</b> <a href='../S/3120.html#L2735' title='Defined at 2735 in Python/import.c.'>mark_miss</a>(<b>char</b> *name);
<a name='L2394'><b>static</b> <b>int</b> <a href='../S/3120.html#L2742' title='Defined at 2742 in Python/import.c.'>ensure_fromlist</a>(PyObject *mod, PyObject *fromlist,
<a name='L2395'>                           <b>char</b> *buf, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> buflen, <b>int</b> recursive);
<a name='L2396'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> * <a href='../S/3120.html#L2853' title='Defined at 2853 in Python/import.c.'>import_submodule</a>(PyObject *mod, <b>char</b> *name, <b>char</b> *fullname);
<a name='L2397'>
<a name='L2398'><i><font color='green'>/* The Magnum Opus of dotted-name import :-) */</font></i>
<a name='L2399'>
<a name='L2400'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2401'><a href='../S/3120.html#L2474' title='Refered from 2474 in Python/import.c.'>import_module_level</a>(<b>char</b> *name, PyObject *globals, PyObject *locals,
<a name='L2402'>                    PyObject *fromlist, <b>int</b> level)
<a name='L2403'><font color='red'>{</font>
<a name='L2404'>    <b>char</b> buf[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L2405'>    <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> buflen = 0;
<a name='L2406'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *parent, *head, *next, *tail;
<a name='L2407'>
<a name='L2408'>    <b>if</b> (strchr(name, '/') != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L2409'><font color='darkred'>#ifdef</font> <a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>
<a name='L2410'>        || strchr(name, '\\') != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L2411'><font color='darkred'>#endif</font>
<a name='L2412'>        ) <font color='red'>{</font>
<a name='L2413'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError,
<a name='L2414'>                        "Import by filename is not supported.");
<a name='L2415'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2416'>    <font color='red'>}</font>
<a name='L2417'>
<a name='L2418'>    parent = <a href='../S/3120.html#L2496' title='Defined at 2496 in Python/import.c.'>get_parent</a>(globals, buf, &amp;buflen, level);
<a name='L2419'>    <b>if</b> (parent == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2420'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2421'>
<a name='L2422'>    head = <a href='../S/3120.html#L2663' title='Defined at 2663 in Python/import.c.'>load_next</a>(parent, level &lt; 0 ? Py_None : parent, &amp;name, buf,
<a name='L2423'>                        &amp;buflen);
<a name='L2424'>    <b>if</b> (head == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2425'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2426'>
<a name='L2427'>    tail = head;
<a name='L2428'>    Py_INCREF(tail);
<a name='L2429'>    <b>while</b> (name) <font color='red'>{</font>
<a name='L2430'>        next = <a href='../S/3120.html#L2663' title='Defined at 2663 in Python/import.c.'>load_next</a>(tail, tail, &amp;name, buf, &amp;buflen);
<a name='L2431'>        Py_DECREF(tail);
<a name='L2432'>        <b>if</b> (next == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2433'>            Py_DECREF(head);
<a name='L2434'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2435'>        <font color='red'>}</font>
<a name='L2436'>        tail = next;
<a name='L2437'>    <font color='red'>}</font>
<a name='L2438'>    <b>if</b> (tail == Py_None) <font color='red'>{</font>
<a name='L2439'>        <i><font color='green'>/* If tail is Py_None, both get_parent and load_next found</font></i>
<a name='L2440'><i><font color='green'>           an empty module name: someone called __import__("") or</font></i>
<a name='L2441'><i><font color='green'>           doctored faulty bytecode */</font></i>
<a name='L2442'>        Py_DECREF(tail);
<a name='L2443'>        Py_DECREF(head);
<a name='L2444'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2445'>                        "Empty module name");
<a name='L2446'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2447'>    <font color='red'>}</font>
<a name='L2448'>
<a name='L2449'>    <b>if</b> (fromlist != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2450'>        <b>if</b> (fromlist == Py_None || !<a href='../S/2803.html#L1140' title='Defined at 1140 in Objects/object.c.'>PyObject_IsTrue</a>(fromlist))
<a name='L2451'>            fromlist = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2452'>    <font color='red'>}</font>
<a name='L2453'>
<a name='L2454'>    <b>if</b> (fromlist == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2455'>        Py_DECREF(tail);
<a name='L2456'>        <b>return</b> head;
<a name='L2457'>    <font color='red'>}</font>
<a name='L2458'>
<a name='L2459'>    Py_DECREF(head);
<a name='L2460'>    <b>if</b> (!<a href='../S/3120.html#L2742' title='Defined at 2742 in Python/import.c.'>ensure_fromlist</a>(tail, fromlist, buf, buflen, 0)) <font color='red'>{</font>
<a name='L2461'>        Py_DECREF(tail);
<a name='L2462'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2463'>    <font color='red'>}</font>
<a name='L2464'>
<a name='L2465'>    <b>return</b> tail;
<a name='L2466'><font color='red'>}</font>
<a name='L2467'>
<a name='L2468'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2469'><a href='../R/3016.html' title='Multiple refered from 2 places.'>PyImport_ImportModuleLevel</a>(<b>char</b> *name, PyObject *globals, PyObject *locals,
<a name='L2470'>                         PyObject *fromlist, <b>int</b> level)
<a name='L2471'><font color='red'>{</font>
<a name='L2472'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2473'>    <a href='../S/3120.html#L278' title='Defined at 278 in Python/import.c.'>_PyImport_AcquireLock</a>();
<a name='L2474'>    <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/3120.html#L2401' title='Defined at 2401 in Python/import.c.'>import_module_level</a>(name, globals, locals, fromlist, level);
<a name='L2475'>    <b>if</b> (<a href='../S/3120.html#L303' title='Defined at 303 in Python/import.c.'>_PyImport_ReleaseLock</a>() &lt; 0) <font color='red'>{</font>
<a name='L2476'>        <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L2477'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_RuntimeError,
<a name='L2478'>                        "not holding the import lock");
<a name='L2479'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2480'>    <font color='red'>}</font>
<a name='L2481'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2482'><font color='red'>}</font>
<a name='L2483'>
<a name='L2484'><i><font color='green'>/* Return the package that an import is being performed in.  If globals comes</font></i>
<a name='L2485'><i><font color='green'>   from the module foo.bar.bat (not itself a package), this returns the</font></i>
<a name='L2486'><i><font color='green'>   sys.modules entry for foo.bar.  If globals is from a package's __init__.py,</font></i>
<a name='L2487'><i><font color='green'>   the package's entry in sys.modules is returned, as a borrowed reference.</font></i>
<a name='L2488'><i><font color='green'></font></i>
<a name='L2489'><i><font color='green'>   The *name* of the returned package is returned in buf, with the length of</font></i>
<a name='L2490'><i><font color='green'>   the name in *p_buflen.</font></i>
<a name='L2491'><i><font color='green'></font></i>
<a name='L2492'><i><font color='green'>   If globals doesn't come from a package or a module in a package, or a</font></i>
<a name='L2493'><i><font color='green'>   corresponding entry is not found in sys.modules, Py_None is returned.</font></i>
<a name='L2494'><i><font color='green'>*/</font></i>
<a name='L2495'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2496'><a href='../R/8083.html' title='Multiple refered from 2 places.'>get_parent</a>(PyObject *globals, <b>char</b> *buf, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> *p_buflen, <b>int</b> level)
<a name='L2497'><font color='red'>{</font>
<a name='L2498'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *namestr = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2499'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathstr = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2500'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pkgstr = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2501'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pkgname, *modname, *modpath, *modules, *parent;
<a name='L2502'>    <b>int</b> orig_level = level;
<a name='L2503'>
<a name='L2504'>    <b>if</b> (globals == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !PyDict_Check(globals) || !level)
<a name='L2505'>        <b>return</b> Py_None;
<a name='L2506'>
<a name='L2507'>    <b>if</b> (namestr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2508'>        namestr = <a href='../S/2828.html#L10060' title='Defined at 10060 in Objects/unicodeobject.c.'>PyUnicode_InternFromString</a>("__name__");
<a name='L2509'>        <b>if</b> (namestr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2510'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2511'>    <font color='red'>}</font>
<a name='L2512'>    <b>if</b> (pathstr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2513'>        pathstr = <a href='../S/2828.html#L10060' title='Defined at 10060 in Objects/unicodeobject.c.'>PyUnicode_InternFromString</a>("__path__");
<a name='L2514'>        <b>if</b> (pathstr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2515'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2516'>    <font color='red'>}</font>
<a name='L2517'>    <b>if</b> (pkgstr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2518'>        pkgstr = <a href='../S/2828.html#L10060' title='Defined at 10060 in Objects/unicodeobject.c.'>PyUnicode_InternFromString</a>("__package__");
<a name='L2519'>        <b>if</b> (pkgstr == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2520'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2521'>    <font color='red'>}</font>
<a name='L2522'>
<a name='L2523'>    *buf = '\0';
<a name='L2524'>    *p_buflen = 0;
<a name='L2525'>    pkgname = <a href='../S/2787.html#L704' title='Defined at 704 in Objects/dictobject.c.'>PyDict_GetItem</a>(globals, pkgstr);
<a name='L2526'>
<a name='L2527'>    <b>if</b> ((pkgname != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) &amp;&amp; (pkgname != Py_None)) <font color='red'>{</font>
<a name='L2528'>        <i><font color='green'>/* __package__ is set, so use it */</font></i>
<a name='L2529'>        <b>char</b> *pkgname_str;
<a name='L2530'>        <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len;
<a name='L2531'>
<a name='L2532'>        <b>if</b> (!PyUnicode_Check(pkgname)) <font color='red'>{</font>
<a name='L2533'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2534'>                            "__package__ set to non-string");
<a name='L2535'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2536'>        <font color='red'>}</font>
<a name='L2537'>        pkgname_str = <a href='../S/2828.html#L1903' title='Defined at 1903 in Objects/unicodeobject.c.'>_PyUnicode_AsStringAndSize</a>(pkgname, &amp;len);
<a name='L2538'>        <b>if</b> (len == 0) <font color='red'>{</font>
<a name='L2539'>            <b>if</b> (level &gt; 0) <font color='red'>{</font>
<a name='L2540'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2541'>                    "Attempted relative import in non-package");
<a name='L2542'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2543'>            <font color='red'>}</font>
<a name='L2544'>            <b>return</b> Py_None;
<a name='L2545'>        <font color='red'>}</font>
<a name='L2546'>        <b>if</b> (len &gt; <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>) <font color='red'>{</font>
<a name='L2547'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2548'>                            "Package name too long");
<a name='L2549'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2550'>        <font color='red'>}</font>
<a name='L2551'>        strcpy(buf, pkgname_str);
<a name='L2552'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L2553'>        <i><font color='green'>/* __package__ not set, so figure it out and set it */</font></i>
<a name='L2554'>        modname = <a href='../S/2787.html#L704' title='Defined at 704 in Objects/dictobject.c.'>PyDict_GetItem</a>(globals, namestr);
<a name='L2555'>        <b>if</b> (modname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !PyUnicode_Check(modname))
<a name='L2556'>            <b>return</b> Py_None;
<a name='L2557'>
<a name='L2558'>        modpath = <a href='../S/2787.html#L704' title='Defined at 704 in Objects/dictobject.c.'>PyDict_GetItem</a>(globals, pathstr);
<a name='L2559'>        <b>if</b> (modpath != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2560'>            <i><font color='green'>/* __path__ is set, so modname is already the package name */</font></i>
<a name='L2561'>            <b>char</b> *modname_str;
<a name='L2562'>            <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> len;
<a name='L2563'>            <b>int</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L2564'>
<a name='L2565'>            modname_str = <a href='../S/2828.html#L1903' title='Defined at 1903 in Objects/unicodeobject.c.'>_PyUnicode_AsStringAndSize</a>(modname, &amp;len);
<a name='L2566'>            <b>if</b> (len &gt; <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>) <font color='red'>{</font>
<a name='L2567'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2568'>                                "Module name too long");
<a name='L2569'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2570'>            <font color='red'>}</font>
<a name='L2571'>            strcpy(buf, modname_str);
<a name='L2572'>            <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a> = <a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(globals, pkgstr, modname);
<a name='L2573'>            <b>if</b> (<a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>) <font color='red'>{</font>
<a name='L2574'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2575'>                                "Could not set __package__");
<a name='L2576'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2577'>            <font color='red'>}</font>
<a name='L2578'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L2579'>            <i><font color='green'>/* Normal module, so work out the package name if any */</font></i>
<a name='L2580'>            <b>char</b> *start = <a href='../S/2828.html#L1919' title='Defined at 1919 in Objects/unicodeobject.c.'>_PyUnicode_AsString</a>(modname);
<a name='L2581'>            <b>char</b> *lastdot = strrchr(start, '.');
<a name='L2582'>            <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> len;
<a name='L2583'>            <b>int</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L2584'>            <b>if</b> (lastdot == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; level &gt; 0) <font color='red'>{</font>
<a name='L2585'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2586'>                    "Attempted relative import in non-package");
<a name='L2587'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2588'>            <font color='red'>}</font>
<a name='L2589'>            <b>if</b> (lastdot == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2590'>                <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a> = <a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(globals, pkgstr, Py_None);
<a name='L2591'>                <b>if</b> (<a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>) <font color='red'>{</font>
<a name='L2592'>                    <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2593'>                        "Could not set __package__");
<a name='L2594'>                    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2595'>                <font color='red'>}</font>
<a name='L2596'>                <b>return</b> Py_None;
<a name='L2597'>            <font color='red'>}</font>
<a name='L2598'>            len = lastdot - start;
<a name='L2599'>            <b>if</b> (len &gt;= <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>) <font color='red'>{</font>
<a name='L2600'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2601'>                                "Module name too long");
<a name='L2602'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2603'>            <font color='red'>}</font>
<a name='L2604'>            strncpy(buf, start, len);
<a name='L2605'>            buf[len] = '\0';
<a name='L2606'>            pkgname = <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(buf);
<a name='L2607'>            <b>if</b> (pkgname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2608'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2609'>            <font color='red'>}</font>
<a name='L2610'>            <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a> = <a href='../S/2787.html#L786' title='Defined at 786 in Objects/dictobject.c.'>PyDict_SetItem</a>(globals, pkgstr, pkgname);
<a name='L2611'>            Py_DECREF(pkgname);
<a name='L2612'>            <b>if</b> (<a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>) <font color='red'>{</font>
<a name='L2613'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2614'>                                "Could not set __package__");
<a name='L2615'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2616'>            <font color='red'>}</font>
<a name='L2617'>        <font color='red'>}</font>
<a name='L2618'>    <font color='red'>}</font>
<a name='L2619'>    <b>while</b> (--level &gt; 0) <font color='red'>{</font>
<a name='L2620'>        <b>char</b> *dot = strrchr(buf, '.');
<a name='L2621'>        <b>if</b> (dot == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2622'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2623'>                "Attempted relative import beyond "
<a name='L2624'>                "toplevel package");
<a name='L2625'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2626'>        <font color='red'>}</font>
<a name='L2627'>        *dot = '\0';
<a name='L2628'>    <font color='red'>}</font>
<a name='L2629'>    *p_buflen = strlen(buf);
<a name='L2630'>
<a name='L2631'>    modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L2632'>    parent = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, buf);
<a name='L2633'>    <b>if</b> (parent == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2634'>        <b>if</b> (orig_level &lt; 1) <font color='red'>{</font>
<a name='L2635'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *err_msg = <a href='../S/2779.html#L344' title='Defined at 344 in Objects/bytesobject.c.'>PyBytes_FromFormat</a>(
<a name='L2636'>                "Parent module '%.200s' not found "
<a name='L2637'>                "while handling absolute import", buf);
<a name='L2638'>            <b>if</b> (err_msg == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2639'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2640'>            <font color='red'>}</font>
<a name='L2641'>            <b>if</b> (!<a href='../S/3087.html#L756' title='Defined at 756 in Python/_warnings.c.'>PyErr_WarnEx</a>(PyExc_RuntimeWarning,
<a name='L2642'>                              <a href='../S/2779.html#L517' title='Defined at 517 in Objects/bytesobject.c.'>PyBytes_AsString</a>(err_msg), 1)) <font color='red'>{</font>
<a name='L2643'>                *buf = '\0';
<a name='L2644'>                *p_buflen = 0;
<a name='L2645'>                parent = Py_None;
<a name='L2646'>            <font color='red'>}</font>
<a name='L2647'>            Py_DECREF(err_msg);
<a name='L2648'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L2649'>            <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_SystemError,
<a name='L2650'>                "Parent module '%.200s' not loaded, "
<a name='L2651'>                "cannot perform relative import", buf);
<a name='L2652'>        <font color='red'>}</font>
<a name='L2653'>    <font color='red'>}</font>
<a name='L2654'>    <b>return</b> parent;
<a name='L2655'>    <i><font color='green'>/* We expect, but can't guarantee, if parent != None, that:</font></i>
<a name='L2656'><i><font color='green'>       - parent.__name__ == buf</font></i>
<a name='L2657'><i><font color='green'>       - parent.__dict__ is globals</font></i>
<a name='L2658'><i><font color='green'>       If this is violated...  Who cares? */</font></i>
<a name='L2659'><font color='red'>}</font>
<a name='L2660'>
<a name='L2661'><i><font color='green'>/* altmod is either None or same as mod */</font></i>
<a name='L2662'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2663'><a href='../R/8718.html' title='Multiple refered from 3 places.'>load_next</a>(PyObject *mod, PyObject *altmod, <b>char</b> **p_name, <b>char</b> *buf,
<a name='L2664'>          <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> *p_buflen)
<a name='L2665'><font color='red'>{</font>
<a name='L2666'>    <b>char</b> *name = *p_name;
<a name='L2667'>    <b>char</b> *dot = strchr(name, '.');
<a name='L2668'>    <a href='../D/11182.html' title='Multiple defined in 2 places.'>size_t</a> len;
<a name='L2669'>    <b>char</b> *p;
<a name='L2670'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2671'>
<a name='L2672'>    <b>if</b> (strlen(name) == 0) <font color='red'>{</font>
<a name='L2673'>        <i><font color='green'>/* completely empty module name should only happen in</font></i>
<a name='L2674'><i><font color='green'>           'from . import' (or '__import__("")')*/</font></i>
<a name='L2675'>        Py_INCREF(mod);
<a name='L2676'>        *p_name = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2677'>        <b>return</b> mod;
<a name='L2678'>    <font color='red'>}</font>
<a name='L2679'>
<a name='L2680'>    <b>if</b> (dot == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2681'>        *p_name = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2682'>        len = strlen(name);
<a name='L2683'>    <font color='red'>}</font>
<a name='L2684'>    <b>else</b> <font color='red'>{</font>
<a name='L2685'>        *p_name = dot+1;
<a name='L2686'>        len = dot-name;
<a name='L2687'>    <font color='red'>}</font>
<a name='L2688'>    <b>if</b> (len == 0) <font color='red'>{</font>
<a name='L2689'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2690'>                        "Empty module name");
<a name='L2691'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2692'>    <font color='red'>}</font>
<a name='L2693'>
<a name='L2694'>    p = buf + *p_buflen;
<a name='L2695'>    <b>if</b> (p != buf)
<a name='L2696'>        *p++ = '.';
<a name='L2697'>    <b>if</b> (p+len-buf &gt;= <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>) <font color='red'>{</font>
<a name='L2698'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2699'>                        "Module name too long");
<a name='L2700'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2701'>    <font color='red'>}</font>
<a name='L2702'>    strncpy(p, name, len);
<a name='L2703'>    p[len] = '\0';
<a name='L2704'>    *p_buflen = p+len-buf;
<a name='L2705'>
<a name='L2706'>    <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/3120.html#L2853' title='Defined at 2853 in Python/import.c.'>import_submodule</a>(mod, p, buf);
<a name='L2707'>    <b>if</b> (<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> == Py_None &amp;&amp; altmod != mod) <font color='red'>{</font>
<a name='L2708'>        Py_DECREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L2709'>        <i><font color='green'>/* Here, altmod must be None and mod must not be None */</font></i>
<a name='L2710'>        <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> = <a href='../S/3120.html#L2853' title='Defined at 2853 in Python/import.c.'>import_submodule</a>(altmod, p, p);
<a name='L2711'>        <b>if</b> (<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> != Py_None) <font color='red'>{</font>
<a name='L2712'>            <b>if</b> (<a href='../S/3120.html#L2735' title='Defined at 2735 in Python/import.c.'>mark_miss</a>(buf) != 0) <font color='red'>{</font>
<a name='L2713'>                Py_DECREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L2714'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2715'>            <font color='red'>}</font>
<a name='L2716'>            strncpy(buf, name, len);
<a name='L2717'>            buf[len] = '\0';
<a name='L2718'>            *p_buflen = len;
<a name='L2719'>        <font color='red'>}</font>
<a name='L2720'>    <font color='red'>}</font>
<a name='L2721'>    <b>if</b> (<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2722'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2723'>
<a name='L2724'>    <b>if</b> (<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a> == Py_None) <font color='red'>{</font>
<a name='L2725'>        Py_DECREF(<a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>);
<a name='L2726'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2727'>                     "No module named %.200s", name);
<a name='L2728'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2729'>    <font color='red'>}</font>
<a name='L2730'>
<a name='L2731'>    <b>return</b> <a href='../S/2250.html#L579' title='Defined at 579 in Modules/_ctypes/callproc.c.'>result</a>;
<a name='L2732'><font color='red'>}</font>
<a name='L2733'>
<a name='L2734'><b>static</b> <b>int</b>
<a name='L2735'><a href='../R/8878.html' title='Multiple refered from 2 places.'>mark_miss</a>(<b>char</b> *name)
<a name='L2736'><font color='red'>{</font>
<a name='L2737'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L2738'>    <b>return</b> <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules, name, Py_None);
<a name='L2739'><font color='red'>}</font>
<a name='L2740'>
<a name='L2741'><b>static</b> <b>int</b>
<a name='L2742'><a href='../R/7571.html' title='Multiple refered from 3 places.'>ensure_fromlist</a>(PyObject *mod, PyObject *fromlist, <b>char</b> *buf, <a href='../D/4364.html' title='Multiple defined in 6 places.'>Py_ssize_t</a> buflen,
<a name='L2743'>                <b>int</b> recursive)
<a name='L2744'><font color='red'>{</font>
<a name='L2745'>    <b>int</b> i;
<a name='L2746'>
<a name='L2747'>    <b>if</b> (!<a href='../S/2803.html#L794' title='Defined at 794 in Objects/object.c.'>PyObject_HasAttrString</a>(mod, "__path__"))
<a name='L2748'>        <b>return</b> 1;
<a name='L2749'>
<a name='L2750'>    <b>for</b> (i = 0; ; i++) <font color='red'>{</font>
<a name='L2751'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *item = <a href='../S/2775.html#L1584' title='Defined at 1584 in Objects/abstract.c.'>PySequence_GetItem</a>(fromlist, i);
<a name='L2752'>        <b>int</b> hasit;
<a name='L2753'>        <b>if</b> (item == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2754'>            <b>if</b> (<a href='../S/3106.html#L189' title='Defined at 189 in Python/errors.c.'>PyErr_ExceptionMatches</a>(PyExc_IndexError)) <font color='red'>{</font>
<a name='L2755'>                <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L2756'>                <b>return</b> 1;
<a name='L2757'>            <font color='red'>}</font>
<a name='L2758'>            <b>return</b> 0;
<a name='L2759'>        <font color='red'>}</font>
<a name='L2760'>        <b>if</b> (!PyUnicode_Check(item)) <font color='red'>{</font>
<a name='L2761'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError,
<a name='L2762'>                            "Item in ``from list'' not a string");
<a name='L2763'>            Py_DECREF(item);
<a name='L2764'>            <b>return</b> 0;
<a name='L2765'>        <font color='red'>}</font>
<a name='L2766'>        <b>if</b> (<a href='../S/587.html#L408' title='Defined at 408 in Include/unicodeobject.h.'>PyUnicode_AS_UNICODE</a>(item)[0] == '*') <font color='red'>{</font>
<a name='L2767'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *all;
<a name='L2768'>            Py_DECREF(item);
<a name='L2769'>            <i><font color='green'>/* See if the package defines __all__ */</font></i>
<a name='L2770'>            <b>if</b> (recursive)
<a name='L2771'>                <b>continue</b>; <i><font color='green'>/* Avoid endless recursion */</font></i>
<a name='L2772'>            all = <a href='../S/2803.html#L779' title='Defined at 779 in Objects/object.c.'>PyObject_GetAttrString</a>(mod, "__all__");
<a name='L2773'>            <b>if</b> (all == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2774'>                <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L2775'>            <b>else</b> <font color='red'>{</font>
<a name='L2776'>                <b>int</b> ret = <a href='../S/3120.html#L2742' title='Defined at 2742 in Python/import.c.'>ensure_fromlist</a>(mod, all, buf, buflen, 1);
<a name='L2777'>                Py_DECREF(all);
<a name='L2778'>                <b>if</b> (!ret)
<a name='L2779'>                    <b>return</b> 0;
<a name='L2780'>            <font color='red'>}</font>
<a name='L2781'>            <b>continue</b>;
<a name='L2782'>        <font color='red'>}</font>
<a name='L2783'>        hasit = <a href='../S/2803.html#L847' title='Defined at 847 in Objects/object.c.'>PyObject_HasAttr</a>(mod, item);
<a name='L2784'>        <b>if</b> (!hasit) <font color='red'>{</font>
<a name='L2785'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *item8;
<a name='L2786'>            <b>char</b> *subname;
<a name='L2787'>            <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *submod;
<a name='L2788'>            <b>char</b> *p;
<a name='L2789'>            item8 = <a href='../S/2828.html#L1585' title='Defined at 1585 in Objects/unicodeobject.c.'>PyUnicode_EncodeFSDefault</a>(item);
<a name='L2790'>            <b>if</b> (!item8) <font color='red'>{</font>
<a name='L2791'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError, "Cannot encode path item");
<a name='L2792'>                <b>return</b> 0;
<a name='L2793'>            <font color='red'>}</font>
<a name='L2794'>            subname = PyBytes_AS_STRING(item8);
<a name='L2795'>            <b>if</b> (buflen + strlen(subname) &gt;= <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>) <font color='red'>{</font>
<a name='L2796'>                <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ValueError,
<a name='L2797'>                                "Module name too long");
<a name='L2798'>                Py_DECREF(item);
<a name='L2799'>                <b>return</b> 0;
<a name='L2800'>            <font color='red'>}</font>
<a name='L2801'>            p = buf + buflen;
<a name='L2802'>            *p++ = '.';
<a name='L2803'>            strcpy(p, subname);
<a name='L2804'>            submod = <a href='../S/3120.html#L2853' title='Defined at 2853 in Python/import.c.'>import_submodule</a>(mod, subname, buf);
<a name='L2805'>            Py_DECREF(item8);
<a name='L2806'>            <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(submod);
<a name='L2807'>            <b>if</b> (submod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2808'>                Py_DECREF(item);
<a name='L2809'>                <b>return</b> 0;
<a name='L2810'>            <font color='red'>}</font>
<a name='L2811'>        <font color='red'>}</font>
<a name='L2812'>        Py_DECREF(item);
<a name='L2813'>    <font color='red'>}</font>
<a name='L2814'>
<a name='L2815'>    <i><font color='green'>/* NOTREACHED */</font></i>
<a name='L2816'><font color='red'>}</font>
<a name='L2817'>
<a name='L2818'><b>static</b> <b>int</b>
<a name='L2819'><a href='../S/3120.html#L2898' title='Refered from 2898 in Python/import.c.'>add_submodule</a>(PyObject *mod, PyObject *submod, <b>char</b> *fullname, <b>char</b> *subname,
<a name='L2820'>              PyObject *modules)
<a name='L2821'><font color='red'>{</font>
<a name='L2822'>    <b>if</b> (mod == Py_None)
<a name='L2823'>        <b>return</b> 1;
<a name='L2824'>    <i><font color='green'>/* Irrespective of the success of this load, make a</font></i>
<a name='L2825'><i><font color='green'>       reference to it in the parent package module.  A copy gets</font></i>
<a name='L2826'><i><font color='green'>       saved in the modules dictionary under the full name, so get a</font></i>
<a name='L2827'><i><font color='green'>       reference from there, if need be.  (The exception is when the</font></i>
<a name='L2828'><i><font color='green'>       load failed with a SyntaxError -- then there's no trace in</font></i>
<a name='L2829'><i><font color='green'>       sys.modules.  In that case, of course, do nothing extra.) */</font></i>
<a name='L2830'>    <b>if</b> (submod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2831'>        submod = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, fullname);
<a name='L2832'>        <b>if</b> (submod == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2833'>            <b>return</b> 1;
<a name='L2834'>    <font color='red'>}</font>
<a name='L2835'>    <b>if</b> (PyModule_Check(mod)) <font color='red'>{</font>
<a name='L2836'>        <i><font color='green'>/* We can't use setattr here since it can give a</font></i>
<a name='L2837'><i><font color='green'>         * spurious warning if the submodule name shadows a</font></i>
<a name='L2838'><i><font color='green'>         * builtin name */</font></i>
<a name='L2839'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *dict = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(mod);
<a name='L2840'>        <b>if</b> (!dict)
<a name='L2841'>            <b>return</b> 0;
<a name='L2842'>        <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(dict, subname, submod) &lt; 0)
<a name='L2843'>            <b>return</b> 0;
<a name='L2844'>    <font color='red'>}</font>
<a name='L2845'>    <b>else</b> <font color='red'>{</font>
<a name='L2846'>        <b>if</b> (<a href='../S/2803.html#L806' title='Defined at 806 in Objects/object.c.'>PyObject_SetAttrString</a>(mod, subname, submod) &lt; 0)
<a name='L2847'>            <b>return</b> 0;
<a name='L2848'>    <font color='red'>}</font>
<a name='L2849'>    <b>return</b> 1;
<a name='L2850'><font color='red'>}</font>
<a name='L2851'>
<a name='L2852'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2853'><a href='../R/8334.html' title='Multiple refered from 4 places.'>import_submodule</a>(PyObject *mod, <b>char</b> *subname, <b>char</b> *fullname)
<a name='L2854'><font color='red'>{</font>
<a name='L2855'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L2856'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2857'>
<a name='L2858'>    <i><font color='green'>/* Require:</font></i>
<a name='L2859'><i><font color='green'>       if mod == None: subname == fullname</font></i>
<a name='L2860'><i><font color='green'>       else: mod.__name__ + "." + subname == fullname</font></i>
<a name='L2861'><i><font color='green'>    */</font></i>
<a name='L2862'>
<a name='L2863'>    <b>if</b> ((m = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, fullname)) != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2864'>        Py_INCREF(m);
<a name='L2865'>    <font color='red'>}</font>
<a name='L2866'>    <b>else</b> <font color='red'>{</font>
<a name='L2867'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *path, *loader = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2868'>        <b>char</b> buf[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L2869'>        <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *fdp;
<a name='L2870'>        FILE *fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2871'>
<a name='L2872'>        <b>if</b> (mod == Py_None)
<a name='L2873'>            path = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2874'>        <b>else</b> <font color='red'>{</font>
<a name='L2875'>            path = <a href='../S/2803.html#L779' title='Defined at 779 in Objects/object.c.'>PyObject_GetAttrString</a>(mod, "__path__");
<a name='L2876'>            <b>if</b> (path == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2877'>                <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L2878'>                Py_INCREF(Py_None);
<a name='L2879'>                <b>return</b> Py_None;
<a name='L2880'>            <font color='red'>}</font>
<a name='L2881'>        <font color='red'>}</font>
<a name='L2882'>
<a name='L2883'>        buf[0] = '\0';
<a name='L2884'>        fdp = <a href='../S/3120.html#L1559' title='Defined at 1559 in Python/import.c.'>find_module</a>(fullname, subname, path, buf, <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1,
<a name='L2885'>                          &amp;fp, &amp;loader);
<a name='L2886'>        <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(path);
<a name='L2887'>        <b>if</b> (fdp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2888'>            <b>if</b> (!<a href='../S/3106.html#L189' title='Defined at 189 in Python/errors.c.'>PyErr_ExceptionMatches</a>(PyExc_ImportError))
<a name='L2889'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2890'>            <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L2891'>            Py_INCREF(Py_None);
<a name='L2892'>            <b>return</b> Py_None;
<a name='L2893'>        <font color='red'>}</font>
<a name='L2894'>        m = <a href='../S/3120.html#L2083' title='Defined at 2083 in Python/import.c.'>load_module</a>(fullname, fp, buf, fdp-&gt;type, loader);
<a name='L2895'>        <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(loader);
<a name='L2896'>        <b>if</b> (fp)
<a name='L2897'>            fclose(fp);
<a name='L2898'>        <b>if</b> (!<a href='../S/3120.html#L2819' title='Defined at 2819 in Python/import.c.'>add_submodule</a>(mod, m, fullname, subname, modules)) <font color='red'>{</font>
<a name='L2899'>            <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(m);
<a name='L2900'>            m = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2901'>        <font color='red'>}</font>
<a name='L2902'>    <font color='red'>}</font>
<a name='L2903'>
<a name='L2904'>    <b>return</b> m;
<a name='L2905'><font color='red'>}</font>
<a name='L2906'>
<a name='L2907'>
<a name='L2908'><i><font color='green'>/* Re-import a module of any kind and return its module object, WITH</font></i>
<a name='L2909'><i><font color='green'>   INCREMENTED REFERENCE COUNT */</font></i>
<a name='L2910'>
<a name='L2911'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L2912'><a href='../S/3120.html#L3480' title='Refered from 3480 in Python/import.c.'>PyImport_ReloadModule</a>(PyObject *m)
<a name='L2913'><font color='red'>{</font>
<a name='L2914'>    <a href='../D/3410.html' title='Multiple defined in 2 places.'>PyInterpreterState</a> *interp = <a href='../S/3134.html#L368' title='Defined at 368 in Python/pystate.c.'>PyThreadState_Get</a>()-&gt;interp;
<a name='L2915'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules_reloading = interp-&gt;modules_reloading;
<a name='L2916'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L2917'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *path = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, *loader = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, *existing_m = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2918'>    <b>char</b> *name, *subname;
<a name='L2919'>    <b>char</b> buf[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L2920'>    <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *fdp;
<a name='L2921'>    FILE *fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2922'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *newm;
<a name='L2923'>
<a name='L2924'>    <b>if</b> (modules_reloading == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2925'>        <a href='../D/4129.html' title='Multiple defined in 2 places.'>Py_FatalError</a>("PyImport_ReloadModule: "
<a name='L2926'>                      "no modules_reloading dictionary!");
<a name='L2927'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2928'>    <font color='red'>}</font>
<a name='L2929'>
<a name='L2930'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> || !PyModule_Check(m)) <font color='red'>{</font>
<a name='L2931'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_TypeError,
<a name='L2932'>                        "reload() argument must be module");
<a name='L2933'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2934'>    <font color='red'>}</font>
<a name='L2935'>    name = (<b>char</b>*)<a href='../S/2802.html#L173' title='Defined at 173 in Objects/moduleobject.c.'>PyModule_GetName</a>(m);
<a name='L2936'>    <b>if</b> (name == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2937'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2938'>    <b>if</b> (m != <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules, name)) <font color='red'>{</font>
<a name='L2939'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2940'>                     "reload(): module %.200s not in sys.modules",
<a name='L2941'>                     name);
<a name='L2942'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2943'>    <font color='red'>}</font>
<a name='L2944'>    existing_m = <a href='../S/2787.html#L2168' title='Defined at 2168 in Objects/dictobject.c.'>PyDict_GetItemString</a>(modules_reloading, name);
<a name='L2945'>    <b>if</b> (existing_m != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2946'>        <i><font color='green'>/* Due to a recursive reload, this module is already</font></i>
<a name='L2947'><i><font color='green'>           being reloaded. */</font></i>
<a name='L2948'>        Py_INCREF(existing_m);
<a name='L2949'>        <b>return</b> existing_m;
<a name='L2950'>    <font color='red'>}</font>
<a name='L2951'>    <b>if</b> (<a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules_reloading, name, m) &lt; 0)
<a name='L2952'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2953'>
<a name='L2954'>    subname = strrchr(name, '.');
<a name='L2955'>    <b>if</b> (subname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2956'>        subname = name;
<a name='L2957'>    <b>else</b> <font color='red'>{</font>
<a name='L2958'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *parentname, *parent;
<a name='L2959'>        parentname = <a href='../D/4013.html' title='Multiple defined in 3 places.'>PyUnicode_FromStringAndSize</a>(name, (subname-name));
<a name='L2960'>        <b>if</b> (parentname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2961'>            <a href='../S/3120.html#L378' title='Defined at 378 in Python/import.c.'>imp_modules_reloading_clear</a>();
<a name='L2962'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2963'>        <font color='red'>}</font>
<a name='L2964'>        parent = <a href='../S/2787.html#L704' title='Defined at 704 in Objects/dictobject.c.'>PyDict_GetItem</a>(modules, parentname);
<a name='L2965'>        <b>if</b> (parent == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2966'>            <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ImportError,
<a name='L2967'>                "reload(): parent %U not in sys.modules",
<a name='L2968'>                 parentname);
<a name='L2969'>            Py_DECREF(parentname);
<a name='L2970'>            <a href='../S/3120.html#L378' title='Defined at 378 in Python/import.c.'>imp_modules_reloading_clear</a>();
<a name='L2971'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2972'>        <font color='red'>}</font>
<a name='L2973'>        Py_DECREF(parentname);
<a name='L2974'>        subname++;
<a name='L2975'>        path = <a href='../S/2803.html#L779' title='Defined at 779 in Objects/object.c.'>PyObject_GetAttrString</a>(parent, "__path__");
<a name='L2976'>        <b>if</b> (path == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L2977'>            <a href='../S/3106.html#L318' title='Defined at 318 in Python/errors.c.'>PyErr_Clear</a>();
<a name='L2978'>    <font color='red'>}</font>
<a name='L2979'>    buf[0] = '\0';
<a name='L2980'>    fdp = <a href='../S/3120.html#L1559' title='Defined at 1559 in Python/import.c.'>find_module</a>(name, subname, path, buf, <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1, &amp;fp, &amp;loader);
<a name='L2981'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(path);
<a name='L2982'>
<a name='L2983'>    <b>if</b> (fdp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2984'>        <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(loader);
<a name='L2985'>        <a href='../S/3120.html#L378' title='Defined at 378 in Python/import.c.'>imp_modules_reloading_clear</a>();
<a name='L2986'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L2987'>    <font color='red'>}</font>
<a name='L2988'>
<a name='L2989'>    newm = <a href='../S/3120.html#L2083' title='Defined at 2083 in Python/import.c.'>load_module</a>(name, fp, buf, fdp-&gt;type, loader);
<a name='L2990'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(loader);
<a name='L2991'>
<a name='L2992'>    <b>if</b> (fp)
<a name='L2993'>        fclose(fp);
<a name='L2994'>    <b>if</b> (newm == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L2995'>        <i><font color='green'>/* load_module probably removed name from modules because of</font></i>
<a name='L2996'><i><font color='green'>         * the error.  Put back the original module object.  We're</font></i>
<a name='L2997'><i><font color='green'>         * going to return NULL in this case regardless of whether</font></i>
<a name='L2998'><i><font color='green'>         * replacing name succeeds, so the return value is ignored.</font></i>
<a name='L2999'><i><font color='green'>         */</font></i>
<a name='L3000'>        <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(modules, name, m);
<a name='L3001'>    <font color='red'>}</font>
<a name='L3002'>    <a href='../S/3120.html#L378' title='Defined at 378 in Python/import.c.'>imp_modules_reloading_clear</a>();
<a name='L3003'>    <b>return</b> newm;
<a name='L3004'><font color='red'>}</font>
<a name='L3005'>
<a name='L3006'>
<a name='L3007'><i><font color='green'>/* Higher-level import emulator which emulates the "import" statement</font></i>
<a name='L3008'><i><font color='green'>   more accurately -- it invokes the __import__() function from the</font></i>
<a name='L3009'><i><font color='green'>   builtins of the current globals.  This means that the import is</font></i>
<a name='L3010'><i><font color='green'>   done using whatever import hooks are installed in the current</font></i>
<a name='L3011'><i><font color='green'>   environment.</font></i>
<a name='L3012'><i><font color='green'>   A dummy list ["__doc__"] is passed as the 4th argument so that</font></i>
<a name='L3013'><i><font color='green'>   e.g. PyImport_Import(PyUnicode_FromString("win32com.client.gencache"))</font></i>
<a name='L3014'><i><font color='green'>   will return &lt;module "gencache"&gt; instead of &lt;module "win32com"&gt;. */</font></i>
<a name='L3015'>
<a name='L3016'><a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3017'><a href='../R/3013.html' title='Multiple refered from 6 places.'>PyImport_Import</a>(PyObject *module_name)
<a name='L3018'><font color='red'>{</font>
<a name='L3019'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *silly_list = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3020'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *builtins_str = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3021'>    <b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *import_str = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3022'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *globals = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3023'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *import = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3024'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *builtins = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3025'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *modules = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3026'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *r = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3027'>
<a name='L3028'>    <i><font color='green'>/* Initialize constant string objects */</font></i>
<a name='L3029'>    <b>if</b> (silly_list == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3030'>        import_str = <a href='../S/2828.html#L10060' title='Defined at 10060 in Objects/unicodeobject.c.'>PyUnicode_InternFromString</a>("__import__");
<a name='L3031'>        <b>if</b> (import_str == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3032'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3033'>        builtins_str = <a href='../S/2828.html#L10060' title='Defined at 10060 in Objects/unicodeobject.c.'>PyUnicode_InternFromString</a>("__builtins__");
<a name='L3034'>        <b>if</b> (builtins_str == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3035'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3036'>        silly_list = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L3037'>        <b>if</b> (silly_list == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3038'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3039'>    <font color='red'>}</font>
<a name='L3040'>
<a name='L3041'>    <i><font color='green'>/* Get the builtins from current globals */</font></i>
<a name='L3042'>    globals = <a href='../S/3091.html#L3687' title='Defined at 3687 in Python/ceval.c.'>PyEval_GetGlobals</a>();
<a name='L3043'>    <b>if</b> (globals != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3044'>        Py_INCREF(globals);
<a name='L3045'>        builtins = <a href='../S/2775.html#L113' title='Defined at 113 in Objects/abstract.c.'>PyObject_GetItem</a>(globals, builtins_str);
<a name='L3046'>        <b>if</b> (builtins == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3047'>            <b>goto</b> err;
<a name='L3048'>    <font color='red'>}</font>
<a name='L3049'>    <b>else</b> <font color='red'>{</font>
<a name='L3050'>        <i><font color='green'>/* No globals -- use standard builtins, and fake globals */</font></i>
<a name='L3051'>        builtins = <a href='../S/3120.html#L2469' title='Defined at 2469 in Python/import.c.'>PyImport_ImportModuleLevel</a>("builtins",
<a name='L3052'>                                              <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, 0);
<a name='L3053'>        <b>if</b> (builtins == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3054'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3055'>        globals = <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("{OO}", builtins_str, builtins);
<a name='L3056'>        <b>if</b> (globals == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3057'>            <b>goto</b> err;
<a name='L3058'>    <font color='red'>}</font>
<a name='L3059'>
<a name='L3060'>    <i><font color='green'>/* Get the __import__ function from the builtins */</font></i>
<a name='L3061'>    <b>if</b> (PyDict_Check(builtins)) <font color='red'>{</font>
<a name='L3062'>        import = <a href='../S/2775.html#L113' title='Defined at 113 in Objects/abstract.c.'>PyObject_GetItem</a>(builtins, import_str);
<a name='L3063'>        <b>if</b> (import == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3064'>            <a href='../S/3106.html#L53' title='Defined at 53 in Python/errors.c.'>PyErr_SetObject</a>(PyExc_KeyError, import_str);
<a name='L3065'>    <font color='red'>}</font>
<a name='L3066'>    <b>else</b>
<a name='L3067'>        import = <a href='../S/2803.html#L822' title='Defined at 822 in Objects/object.c.'>PyObject_GetAttr</a>(builtins, import_str);
<a name='L3068'>    <b>if</b> (import == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3069'>        <b>goto</b> err;
<a name='L3070'>
<a name='L3071'>    <i><font color='green'>/* Call the __import__ function with the proper argument list</font></i>
<a name='L3072'><i><font color='green'>       Always use absolute import here.</font></i>
<a name='L3073'><i><font color='green'>       Calling for side-effect of import. */</font></i>
<a name='L3074'>    r = <a href='../D/3601.html' title='Multiple defined in 2 places.'>PyObject_CallFunction</a>(import, "OOOOi", module_name, globals,
<a name='L3075'>                              globals, silly_list, 0, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L3076'>    <b>if</b> (r == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3077'>        <b>goto</b> err;
<a name='L3078'>    Py_DECREF(r);
<a name='L3079'>
<a name='L3080'>    modules = <a href='../S/3120.html#L388' title='Defined at 388 in Python/import.c.'>PyImport_GetModuleDict</a>();
<a name='L3081'>    r = <a href='../S/2787.html#L704' title='Defined at 704 in Objects/dictobject.c.'>PyDict_GetItem</a>(modules, module_name);
<a name='L3082'>    <b>if</b> (r != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3083'>        Py_INCREF(r);
<a name='L3084'>
<a name='L3085'>  err:
<a name='L3086'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(globals);
<a name='L3087'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(builtins);
<a name='L3088'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(import);
<a name='L3089'>
<a name='L3090'>    <b>return</b> r;
<a name='L3091'><font color='red'>}</font>
<a name='L3092'>
<a name='L3093'>
<a name='L3094'><i><font color='green'>/* Module 'imp' provides Python access to the primitives used for</font></i>
<a name='L3095'><i><font color='green'>   importing modules.</font></i>
<a name='L3096'><i><font color='green'>*/</font></i>
<a name='L3097'>
<a name='L3098'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3099'><a href='../S/3120.html#L3114' title='Refered from 3114 in Python/import.c.'>imp_make_magic</a>(<b>long</b> magic)
<a name='L3100'><font color='red'>{</font>
<a name='L3101'>    <b>char</b> buf[4];
<a name='L3102'>
<a name='L3103'>    buf[0] = (<b>char</b>) ((magic &gt;&gt;  0) &amp; 0xff);
<a name='L3104'>    buf[1] = (<b>char</b>) ((magic &gt;&gt;  8) &amp; 0xff);
<a name='L3105'>    buf[2] = (<b>char</b>) ((magic &gt;&gt; 16) &amp; 0xff);
<a name='L3106'>    buf[3] = (<b>char</b>) ((magic &gt;&gt; 24) &amp; 0xff);
<a name='L3107'>
<a name='L3108'>    <b>return</b> <a href='../S/2779.html#L70' title='Defined at 70 in Objects/bytesobject.c.'>PyBytes_FromStringAndSize</a>(buf, 4);
<a name='L3109'><font color='red'>}</font>
<a name='L3110'>
<a name='L3111'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3112'><a href='../S/3120.html#L3619' title='Refered from 3619 in Python/import.c.'>imp_get_magic</a>(PyObject *self, PyObject *noargs)
<a name='L3113'><font color='red'>{</font>
<a name='L3114'>    <b>return</b> <a href='../S/3120.html#L3099' title='Defined at 3099 in Python/import.c.'>imp_make_magic</a>(pyc_magic);
<a name='L3115'><font color='red'>}</font>
<a name='L3116'>
<a name='L3117'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3118'><a href='../S/3120.html#L3620' title='Refered from 3620 in Python/import.c.'>imp_get_tag</a>(PyObject *self, PyObject *noargs)
<a name='L3119'><font color='red'>{</font>
<a name='L3120'>    <b>return</b> <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(pyc_tag);
<a name='L3121'><font color='red'>}</font>
<a name='L3122'>
<a name='L3123'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3124'><a href='../S/3120.html#L3621' title='Refered from 3621 in Python/import.c.'>imp_get_suffixes</a>(PyObject *self, PyObject *noargs)
<a name='L3125'><font color='red'>{</font>
<a name='L3126'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *list;
<a name='L3127'>    <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *fdp;
<a name='L3128'>
<a name='L3129'>    list = <a href='../S/2796.html#L113' title='Defined at 113 in Objects/listobject.c.'>PyList_New</a>(0);
<a name='L3130'>    <b>if</b> (list == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3131'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3132'>    <b>for</b> (fdp = _PyImport_Filetab; fdp-&gt;suffix != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; fdp++) <font color='red'>{</font>
<a name='L3133'>        <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *item = <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("ssi",
<a name='L3134'>                               fdp-&gt;suffix, fdp-&gt;mode, fdp-&gt;type);
<a name='L3135'>        <b>if</b> (item == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3136'>            Py_DECREF(list);
<a name='L3137'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3138'>        <font color='red'>}</font>
<a name='L3139'>        <b>if</b> (<a href='../S/2796.html#L286' title='Defined at 286 in Objects/listobject.c.'>PyList_Append</a>(list, item) &lt; 0) <font color='red'>{</font>
<a name='L3140'>            Py_DECREF(list);
<a name='L3141'>            Py_DECREF(item);
<a name='L3142'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3143'>        <font color='red'>}</font>
<a name='L3144'>        Py_DECREF(item);
<a name='L3145'>    <font color='red'>}</font>
<a name='L3146'>    <b>return</b> list;
<a name='L3147'><font color='red'>}</font>
<a name='L3148'>
<a name='L3149'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3150'><a href='../S/3120.html#L3215' title='Refered from 3215 in Python/import.c.'>call_find_module</a>(<b>char</b> *name, PyObject *path)
<a name='L3151'><font color='red'>{</font>
<a name='L3152'>    <b>extern</b> <b>int</b> fclose(FILE *);
<a name='L3153'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *fob, *ret;
<a name='L3154'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathobj;
<a name='L3155'>    <b>struct</b> <a href='../S/3122.html#L23' title='Defined at 23 in Python/importdl.h.'>filedescr</a> *fdp;
<a name='L3156'>    <b>char</b> pathname[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L3157'>    FILE *fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3158'>    <b>int</b> fd = -1;
<a name='L3159'>    <b>char</b> *found_encoding = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3160'>    <b>char</b> *<a href='../D/8346.html' title='Multiple defined in 2 places.'>encoding</a> = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3161'>
<a name='L3162'>    pathname[0] = '\0';
<a name='L3163'>    <b>if</b> (path == Py_None)
<a name='L3164'>        path = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3165'>    fdp = <a href='../S/3120.html#L1559' title='Defined at 1559 in Python/import.c.'>find_module</a>(<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, name, path, pathname, <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1, &amp;fp, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L3166'>    <b>if</b> (fdp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3167'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3168'>    <b>if</b> (fp != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3169'>        fd = <a href='../S/2759.html#L50' title='Defined at 50 in Modules/zlib/minigzip.c.'>fileno</a>(fp);
<a name='L3170'>        <b>if</b> (fd != -1)
<a name='L3171'>            fd = dup(fd);
<a name='L3172'>        fclose(fp);
<a name='L3173'>        fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3174'>    <font color='red'>}</font>
<a name='L3175'>    <b>if</b> (fd != -1) <font color='red'>{</font>
<a name='L3176'>        <b>if</b> (strchr(fdp-&gt;mode, 'b') == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3177'>            <i><font color='green'>/* PyTokenizer_FindEncoding() returns PyMem_MALLOC'ed</font></i>
<a name='L3178'><i><font color='green'>               memory. */</font></i>
<a name='L3179'>            found_encoding = <a href='../S/2851.html#L1702' title='Defined at 1702 in Parser/tokenizer.c.'>PyTokenizer_FindEncoding</a>(fd);
<a name='L3180'>            lseek(fd, 0, 0); <i><font color='green'>/* Reset position */</font></i>
<a name='L3181'>            <b>if</b> (found_encoding == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp; <a href='../D/3154.html' title='Multiple defined in 2 places.'>PyErr_Occurred</a>())
<a name='L3182'>                <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3183'>            <a href='../D/8346.html' title='Multiple defined in 2 places.'>encoding</a> = (found_encoding != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) ? found_encoding :
<a name='L3184'>                   (<b>char</b>*)<a href='../D/4018.html' title='Multiple defined in 3 places.'>PyUnicode_GetDefaultEncoding</a>();
<a name='L3185'>        <font color='red'>}</font>
<a name='L3186'>        fob = <a href='../S/2790.html#L29' title='Defined at 29 in Objects/fileobject.c.'>PyFile_FromFd</a>(fd, pathname, fdp-&gt;mode, -1,
<a name='L3187'>                            (<b>char</b>*)<a href='../D/8346.html' title='Multiple defined in 2 places.'>encoding</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, 1);
<a name='L3188'>        <b>if</b> (fob == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3189'>            close(fd);
<a name='L3190'>            PyMem_FREE(found_encoding);
<a name='L3191'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3192'>        <font color='red'>}</font>
<a name='L3193'>    <font color='red'>}</font>
<a name='L3194'>    <b>else</b> <font color='red'>{</font>
<a name='L3195'>        fob = Py_None;
<a name='L3196'>        Py_INCREF(fob);
<a name='L3197'>    <font color='red'>}</font>
<a name='L3198'>    pathobj = <a href='../D/3975.html' title='Multiple defined in 3 places.'>PyUnicode_DecodeFSDefault</a>(pathname);
<a name='L3199'>    ret = <a href='../D/4089.html' title='Multiple defined in 2 places.'>Py_BuildValue</a>("NN(ssi)",
<a name='L3200'>                  fob, pathobj, fdp-&gt;suffix, fdp-&gt;mode, fdp-&gt;type);
<a name='L3201'>    PyMem_FREE(found_encoding);
<a name='L3202'>
<a name='L3203'>    <b>return</b> ret;
<a name='L3204'><font color='red'>}</font>
<a name='L3205'>
<a name='L3206'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3207'><a href='../S/3120.html#L3618' title='Refered from 3618 in Python/import.c.'>imp_find_module</a>(PyObject *self, PyObject *args)
<a name='L3208'><font color='red'>{</font>
<a name='L3209'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *name;
<a name='L3210'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *ret, *path = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3211'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O&amp;|O:find_module",
<a name='L3212'>                          <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;name,
<a name='L3213'>                          &amp;path))
<a name='L3214'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3215'>    ret = <a href='../S/3120.html#L3150' title='Defined at 3150 in Python/import.c.'>call_find_module</a>(PyBytes_AS_STRING(name), path);
<a name='L3216'>    Py_DECREF(name);
<a name='L3217'>    <b>return</b> ret;
<a name='L3218'><font color='red'>}</font>
<a name='L3219'>
<a name='L3220'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3221'><a href='../S/3120.html#L3635' title='Refered from 3635 in Python/import.c.'>imp_init_builtin</a>(PyObject *self, PyObject *args)
<a name='L3222'><font color='red'>{</font>
<a name='L3223'>    <b>char</b> *name;
<a name='L3224'>    <b>int</b> ret;
<a name='L3225'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L3226'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "s:init_builtin", &amp;name))
<a name='L3227'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3228'>    ret = <a href='../S/3120.html#L2151' title='Defined at 2151 in Python/import.c.'>init_builtin</a>(name);
<a name='L3229'>    <b>if</b> (ret &lt; 0)
<a name='L3230'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3231'>    <b>if</b> (ret == 0) <font color='red'>{</font>
<a name='L3232'>        Py_INCREF(Py_None);
<a name='L3233'>        <b>return</b> Py_None;
<a name='L3234'>    <font color='red'>}</font>
<a name='L3235'>    m = <a href='../S/3120.html#L701' title='Defined at 701 in Python/import.c.'>PyImport_AddModule</a>(name);
<a name='L3236'>    <a href='../S/544.html#L766' title='Defined at 766 in Include/object.h.'>Py_XINCREF</a>(m);
<a name='L3237'>    <b>return</b> m;
<a name='L3238'><font color='red'>}</font>
<a name='L3239'>
<a name='L3240'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3241'><a href='../S/3120.html#L3636' title='Refered from 3636 in Python/import.c.'>imp_init_frozen</a>(PyObject *self, PyObject *args)
<a name='L3242'><font color='red'>{</font>
<a name='L3243'>    <b>char</b> *name;
<a name='L3244'>    <b>int</b> ret;
<a name='L3245'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L3246'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "s:init_frozen", &amp;name))
<a name='L3247'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3248'>    ret = <a href='../S/3120.html#L2255' title='Defined at 2255 in Python/import.c.'>PyImport_ImportFrozenModule</a>(name);
<a name='L3249'>    <b>if</b> (ret &lt; 0)
<a name='L3250'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3251'>    <b>if</b> (ret == 0) <font color='red'>{</font>
<a name='L3252'>        Py_INCREF(Py_None);
<a name='L3253'>        <b>return</b> Py_None;
<a name='L3254'>    <font color='red'>}</font>
<a name='L3255'>    m = <a href='../S/3120.html#L701' title='Defined at 701 in Python/import.c.'>PyImport_AddModule</a>(name);
<a name='L3256'>    <a href='../S/544.html#L766' title='Defined at 766 in Include/object.h.'>Py_XINCREF</a>(m);
<a name='L3257'>    <b>return</b> m;
<a name='L3258'><font color='red'>}</font>
<a name='L3259'>
<a name='L3260'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3261'><a href='../S/3120.html#L3633' title='Refered from 3633 in Python/import.c.'>imp_get_frozen_object</a>(PyObject *self, PyObject *args)
<a name='L3262'><font color='red'>{</font>
<a name='L3263'>    <b>char</b> *name;
<a name='L3264'>
<a name='L3265'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "s:get_frozen_object", &amp;name))
<a name='L3266'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3267'>    <b>return</b> <a href='../S/3120.html#L2204' title='Defined at 2204 in Python/import.c.'>get_frozen_object</a>(name);
<a name='L3268'><font color='red'>}</font>
<a name='L3269'>
<a name='L3270'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3271'><a href='../S/3120.html#L3634' title='Refered from 3634 in Python/import.c.'>imp_is_frozen_package</a>(PyObject *self, PyObject *args)
<a name='L3272'><font color='red'>{</font>
<a name='L3273'>    <b>char</b> *name;
<a name='L3274'>
<a name='L3275'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "s:is_frozen_package", &amp;name))
<a name='L3276'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3277'>    <b>return</b> <a href='../S/3120.html#L2228' title='Defined at 2228 in Python/import.c.'>is_frozen_package</a>(name);
<a name='L3278'><font color='red'>}</font>
<a name='L3279'>
<a name='L3280'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3281'><a href='../S/3120.html#L3637' title='Refered from 3637 in Python/import.c.'>imp_is_builtin</a>(PyObject *self, PyObject *args)
<a name='L3282'><font color='red'>{</font>
<a name='L3283'>    <b>char</b> *name;
<a name='L3284'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "s:is_builtin", &amp;name))
<a name='L3285'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3286'>    <b>return</b> <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>(<a href='../S/3120.html#L1452' title='Defined at 1452 in Python/import.c.'>is_builtin</a>(name));
<a name='L3287'><font color='red'>}</font>
<a name='L3288'>
<a name='L3289'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3290'><a href='../S/3120.html#L3638' title='Refered from 3638 in Python/import.c.'>imp_is_frozen</a>(PyObject *self, PyObject *args)
<a name='L3291'><font color='red'>{</font>
<a name='L3292'>    <b>char</b> *name;
<a name='L3293'>    <b>struct</b> _frozen *p;
<a name='L3294'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "s:is_frozen", &amp;name))
<a name='L3295'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3296'>    p = <a href='../S/3120.html#L2187' title='Defined at 2187 in Python/import.c.'>find_frozen</a>(name);
<a name='L3297'>    <b>return</b> <a href='../D/2761.html' title='Multiple defined in 2 places.'>PyBool_FromLong</a>((<b>long</b>) (p == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> ? 0 : p-&gt;size));
<a name='L3298'><font color='red'>}</font>
<a name='L3299'>
<a name='L3300'><b>static</b> FILE *
<a name='L3301'><a href='../R/8056.html' title='Multiple refered from 4 places.'>get_file</a>(<b>char</b> *pathname, PyObject *fob, <b>char</b> *mode)
<a name='L3302'><font color='red'>{</font>
<a name='L3303'>    FILE *fp;
<a name='L3304'>    <b>if</b> (mode[0] == 'U')
<a name='L3305'>        mode = "r" <a href='../S/523.html#L9' title='Defined at 9 in Include/fileobject.h.'>PY_STDIOTEXTMODE</a>;
<a name='L3306'>    <b>if</b> (fob == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3307'>        fp = fopen(pathname, mode);
<a name='L3308'>    <font color='red'>}</font>
<a name='L3309'>    <b>else</b> <font color='red'>{</font>
<a name='L3310'>        <b>int</b> fd = <a href='../S/2790.html#L197' title='Defined at 197 in Objects/fileobject.c.'>PyObject_AsFileDescriptor</a>(fob);
<a name='L3311'>        <b>if</b> (fd == -1)
<a name='L3312'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3313'>        <b>if</b> (!_PyVerify_fd(fd))
<a name='L3314'>            <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L3315'>        <i><font color='green'>/* the FILE struct gets a new fd, so that it can be closed</font></i>
<a name='L3316'><i><font color='green'>         * independently of the file descriptor given</font></i>
<a name='L3317'><i><font color='green'>         */</font></i>
<a name='L3318'>        fd = dup(fd);
<a name='L3319'>        <b>if</b> (fd == -1)
<a name='L3320'>            <b>goto</b> <a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>;
<a name='L3321'>        fp = <a href='../D/8463.html' title='Multiple defined in 4 places.'>fdopen</a>(fd, mode);
<a name='L3322'>    <font color='red'>}</font>
<a name='L3323'>    <b>if</b> (fp)
<a name='L3324'>        <b>return</b> fp;
<a name='L3325'><a href='../D/8389.html' title='Multiple defined in 3 places.'>error</a>:
<a name='L3326'>    <a href='../S/3106.html#L452' title='Defined at 452 in Python/errors.c.'>PyErr_SetFromErrno</a>(PyExc_IOError);
<a name='L3327'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3328'><font color='red'>}</font>
<a name='L3329'>
<a name='L3330'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3331'><a href='../S/3120.html#L3639' title='Refered from 3639 in Python/import.c.'>imp_load_compiled</a>(PyObject *self, PyObject *args)
<a name='L3332'><font color='red'>{</font>
<a name='L3333'>    <b>char</b> *name;
<a name='L3334'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathname;
<a name='L3335'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *fob = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3336'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L3337'>    FILE *fp;
<a name='L3338'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "sO&amp;|O:load_compiled",
<a name='L3339'>                          &amp;name,
<a name='L3340'>                          <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;pathname,
<a name='L3341'>                          &amp;fob))
<a name='L3342'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3343'>    fp = <a href='../S/3120.html#L3301' title='Defined at 3301 in Python/import.c.'>get_file</a>(PyBytes_AS_STRING(pathname), fob, "rb");
<a name='L3344'>    <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3345'>        Py_DECREF(pathname);
<a name='L3346'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3347'>    <font color='red'>}</font>
<a name='L3348'>    m = <a href='../S/3120.html#L1075' title='Defined at 1075 in Python/import.c.'>load_compiled_module</a>(name, PyBytes_AS_STRING(pathname), fp);
<a name='L3349'>    fclose(fp);
<a name='L3350'>    Py_DECREF(pathname);
<a name='L3351'>    <b>return</b> m;
<a name='L3352'><font color='red'>}</font>
<a name='L3353'>
<a name='L3354'><font color='darkred'>#ifdef</font> <a href='../D/1481.html' title='Multiple defined in 3 places.'>HAVE_DYNAMIC_LOADING</a>
<a name='L3355'>
<a name='L3356'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3357'><a href='../S/3120.html#L3641' title='Refered from 3641 in Python/import.c.'>imp_load_dynamic</a>(PyObject *self, PyObject *args)
<a name='L3358'><font color='red'>{</font>
<a name='L3359'>    <b>char</b> *name;
<a name='L3360'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathbytes;
<a name='L3361'>    <b>char</b> *pathname;
<a name='L3362'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *fob = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3363'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L3364'>    FILE *fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3365'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "sO&amp;|O:load_dynamic",
<a name='L3366'>                          &amp;name, <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;pathbytes, &amp;fob))
<a name='L3367'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3368'>    pathname = PyBytes_AS_STRING(pathbytes);
<a name='L3369'>    <b>if</b> (fob) <font color='red'>{</font>
<a name='L3370'>        fp = <a href='../S/3120.html#L3301' title='Defined at 3301 in Python/import.c.'>get_file</a>(pathname, fob, "r");
<a name='L3371'>        <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3372'>            Py_DECREF(pathbytes);
<a name='L3373'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3374'>        <font color='red'>}</font>
<a name='L3375'>    <font color='red'>}</font>
<a name='L3376'>    m = <a href='../S/3121.html#L22' title='Defined at 22 in Python/importdl.c.'>_PyImport_LoadDynamicModule</a>(name, pathname, fp);
<a name='L3377'>    Py_DECREF(pathbytes);
<a name='L3378'>    <b>if</b> (fp)
<a name='L3379'>        fclose(fp);
<a name='L3380'>    <b>return</b> m;
<a name='L3381'><font color='red'>}</font>
<a name='L3382'>
<a name='L3383'><font color='darkred'>#endif</font> <i><font color='green'>/* HAVE_DYNAMIC_LOADING */</font></i>
<a name='L3384'>
<a name='L3385'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3386'><a href='../S/3120.html#L3644' title='Refered from 3644 in Python/import.c.'>imp_load_source</a>(PyObject *self, PyObject *args)
<a name='L3387'><font color='red'>{</font>
<a name='L3388'>    <b>char</b> *name;
<a name='L3389'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathname;
<a name='L3390'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *fob = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3391'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m;
<a name='L3392'>    FILE *fp;
<a name='L3393'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "sO&amp;|O:load_source",
<a name='L3394'>                          &amp;name,
<a name='L3395'>                          <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;pathname,
<a name='L3396'>                          &amp;fob))
<a name='L3397'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3398'>    fp = <a href='../S/3120.html#L3301' title='Defined at 3301 in Python/import.c.'>get_file</a>(PyBytes_AS_STRING(pathname), fob, "r");
<a name='L3399'>    <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3400'>        Py_DECREF(pathname);
<a name='L3401'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3402'>    <font color='red'>}</font>
<a name='L3403'>    m = <a href='../S/3120.html#L1285' title='Defined at 1285 in Python/import.c.'>load_source_module</a>(name, PyBytes_AS_STRING(pathname), fp);
<a name='L3404'>    Py_DECREF(pathname);
<a name='L3405'>    fclose(fp);
<a name='L3406'>    <b>return</b> m;
<a name='L3407'><font color='red'>}</font>
<a name='L3408'>
<a name='L3409'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3410'><a href='../S/3120.html#L3622' title='Refered from 3622 in Python/import.c.'>imp_load_module</a>(PyObject *self, PyObject *args)
<a name='L3411'><font color='red'>{</font>
<a name='L3412'>    <b>char</b> *name;
<a name='L3413'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *fob;
<a name='L3414'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathname;
<a name='L3415'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> * ret;
<a name='L3416'>    <b>char</b> *suffix; <i><font color='green'>/* Unused */</font></i>
<a name='L3417'>    <b>char</b> *mode;
<a name='L3418'>    <b>int</b> type;
<a name='L3419'>    FILE *fp;
<a name='L3420'>
<a name='L3421'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "sOO&amp;(ssi):load_module",
<a name='L3422'>                          &amp;name, &amp;fob,
<a name='L3423'>                          <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;pathname,
<a name='L3424'>                          &amp;suffix, &amp;mode, &amp;type))
<a name='L3425'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3426'>    <b>if</b> (*mode) <font color='red'>{</font>
<a name='L3427'>        <i><font color='green'>/* Mode must start with 'r' or 'U' and must not contain '+'.</font></i>
<a name='L3428'><i><font color='green'>           Implicit in this test is the assumption that the mode</font></i>
<a name='L3429'><i><font color='green'>           may contain other modifiers like 'b' or 't'. */</font></i>
<a name='L3430'>
<a name='L3431'>        <b>if</b> (!(*mode == 'r' || *mode == 'U') || strchr(mode, '+')) <font color='red'>{</font>
<a name='L3432'>            <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ValueError,
<a name='L3433'>                         "invalid file open mode %.200s", mode);
<a name='L3434'>            Py_DECREF(pathname);
<a name='L3435'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3436'>        <font color='red'>}</font>
<a name='L3437'>    <font color='red'>}</font>
<a name='L3438'>    <b>if</b> (fob == Py_None)
<a name='L3439'>        fp = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3440'>    <b>else</b> <font color='red'>{</font>
<a name='L3441'>        fp = <a href='../S/3120.html#L3301' title='Defined at 3301 in Python/import.c.'>get_file</a>(<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, fob, mode);
<a name='L3442'>        <b>if</b> (fp == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3443'>            Py_DECREF(pathname);
<a name='L3444'>            <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3445'>        <font color='red'>}</font>
<a name='L3446'>    <font color='red'>}</font>
<a name='L3447'>    ret = <a href='../S/3120.html#L2083' title='Defined at 2083 in Python/import.c.'>load_module</a>(name, fp, PyBytes_AS_STRING(pathname), type, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L3448'>    Py_DECREF(pathname);
<a name='L3449'>    <b>if</b> (fp)
<a name='L3450'>        fclose(fp);
<a name='L3451'>    <b>return</b> ret;
<a name='L3452'><font color='red'>}</font>
<a name='L3453'>
<a name='L3454'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3455'><a href='../S/3120.html#L3643' title='Refered from 3643 in Python/import.c.'>imp_load_package</a>(PyObject *self, PyObject *args)
<a name='L3456'><font color='red'>{</font>
<a name='L3457'>    <b>char</b> *name;
<a name='L3458'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathname;
<a name='L3459'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> * ret;
<a name='L3460'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "sO&amp;:load_package",
<a name='L3461'>                          &amp;name, <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;pathname))
<a name='L3462'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3463'>    ret = <a href='../S/3120.html#L1396' title='Defined at 1396 in Python/import.c.'>load_package</a>(name, PyBytes_AS_STRING(pathname));
<a name='L3464'>    Py_DECREF(pathname);
<a name='L3465'>    <b>return</b> ret;
<a name='L3466'><font color='red'>}</font>
<a name='L3467'>
<a name='L3468'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3469'><a href='../S/3120.html#L3623' title='Refered from 3623 in Python/import.c.'>imp_new_module</a>(PyObject *self, PyObject *args)
<a name='L3470'><font color='red'>{</font>
<a name='L3471'>    <b>char</b> *name;
<a name='L3472'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "s:new_module", &amp;name))
<a name='L3473'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3474'>    <b>return</b> <a href='../S/2802.html#L30' title='Defined at 30 in Objects/moduleobject.c.'>PyModule_New</a>(name);
<a name='L3475'><font color='red'>}</font>
<a name='L3476'>
<a name='L3477'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3478'><a href='../S/3120.html#L3627' title='Refered from 3627 in Python/import.c.'>imp_reload</a>(PyObject *self, PyObject *v)
<a name='L3479'><font color='red'>{</font>
<a name='L3480'>    <b>return</b> <a href='../S/3120.html#L2912' title='Defined at 2912 in Python/import.c.'>PyImport_ReloadModule</a>(v);
<a name='L3481'><font color='red'>}</font>
<a name='L3482'>
<a name='L3483'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_reload,
<a name='L3484'>"reload(module) -&gt; module\n\
<a name='L3485'>\n\
<a name='L3486'>Reload the module.  The module must have been successfully imported before.");
<a name='L3487'>
<a name='L3488'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3489'><a href='../S/3120.html#L3628' title='Refered from 3628 in Python/import.c.'>imp_cache_from_source</a>(PyObject *self, PyObject *args, PyObject *kws)
<a name='L3490'><font color='red'>{</font>
<a name='L3491'>    <b>static</b> <b>char</b> *kwlist[] = <font color='red'>{</font>"path", "debug_override", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L3492'>
<a name='L3493'>    <b>char</b> buf[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L3494'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathbytes;
<a name='L3495'>    <b>char</b> *cpathname;
<a name='L3496'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *debug_override = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3497'>    <b>int</b> <a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> = !Py_OptimizeFlag;
<a name='L3498'>
<a name='L3499'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(
<a name='L3500'>                <a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kws, "O&amp;|O", kwlist,
<a name='L3501'>                <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;pathbytes, &amp;debug_override))
<a name='L3502'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3503'>
<a name='L3504'>    <b>if</b> (debug_override != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a> &amp;&amp;
<a name='L3505'>        (<a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a> = <a href='../S/2803.html#L1140' title='Defined at 1140 in Objects/object.c.'>PyObject_IsTrue</a>(debug_override)) &lt; 0) <font color='red'>{</font>
<a name='L3506'>        Py_DECREF(pathbytes);
<a name='L3507'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3508'>    <font color='red'>}</font>
<a name='L3509'>
<a name='L3510'>    cpathname = <a href='../S/3120.html#L858' title='Defined at 858 in Python/import.c.'>make_compiled_pathname</a>(
<a name='L3511'>        PyBytes_AS_STRING(pathbytes),
<a name='L3512'>        buf, <a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1, <a href='../D/7964.html' title='Multiple defined in 2 places.'>debug</a>);
<a name='L3513'>    Py_DECREF(pathbytes);
<a name='L3514'>
<a name='L3515'>    <b>if</b> (cpathname == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3516'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_SystemError, "path buffer too short");
<a name='L3517'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3518'>    <font color='red'>}</font>
<a name='L3519'>    <b>return</b> <a href='../D/3975.html' title='Multiple defined in 3 places.'>PyUnicode_DecodeFSDefault</a>(buf);
<a name='L3520'><font color='red'>}</font>
<a name='L3521'>
<a name='L3522'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_cache_from_source,
<a name='L3523'>"Given the path to a .py file, return the path to its .pyc/.pyo file.\n\
<a name='L3524'>\n\
<a name='L3525'>The .py file does not need to exist; this simply returns the path to the\n\
<a name='L3526'>.pyc/.pyo file calculated as if the .py file were imported.  The extension\n\
<a name='L3527'>will be .pyc unless __debug__ is not defined, then it will be .pyo.\n\
<a name='L3528'>\n\
<a name='L3529'>If debug_override is not None, then it must be a boolean and is taken as\n\
<a name='L3530'>the value of __debug__ instead.");
<a name='L3531'>
<a name='L3532'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3533'><a href='../S/3120.html#L3630' title='Refered from 3630 in Python/import.c.'>imp_source_from_cache</a>(PyObject *self, PyObject *args, PyObject *kws)
<a name='L3534'><font color='red'>{</font>
<a name='L3535'>    <b>static</b> <b>char</b> *kwlist[] = <font color='red'>{</font>"path", <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>;
<a name='L3536'>
<a name='L3537'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathname_obj;
<a name='L3538'>    <b>char</b> *pathname;
<a name='L3539'>    <b>char</b> buf[<a href='../D/2043.html' title='Multiple defined in 8 places.'>MAXPATHLEN</a>+1];
<a name='L3540'>
<a name='L3541'>    <b>if</b> (!<a href='../D/2732.html' title='Multiple defined in 2 places.'>PyArg_ParseTupleAndKeywords</a>(
<a name='L3542'>                <a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, kws, "O&amp;", kwlist,
<a name='L3543'>                <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;pathname_obj))
<a name='L3544'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3545'>
<a name='L3546'>    pathname = PyBytes_AS_STRING(pathname_obj);
<a name='L3547'>    <b>if</b> (<a href='../S/3120.html#L968' title='Defined at 968 in Python/import.c.'>make_source_pathname</a>(pathname, buf) == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L3548'>        <a href='../S/3106.html#L600' title='Defined at 600 in Python/errors.c.'>PyErr_Format</a>(PyExc_ValueError, "Not a PEP 3147 pyc path: %s",
<a name='L3549'>                     pathname);
<a name='L3550'>        Py_DECREF(pathname_obj);
<a name='L3551'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3552'>    <font color='red'>}</font>
<a name='L3553'>    Py_DECREF(pathname_obj);
<a name='L3554'>    <b>return</b> <a href='../D/4012.html' title='Multiple defined in 3 places.'>PyUnicode_FromString</a>(buf);
<a name='L3555'><font color='red'>}</font>
<a name='L3556'>
<a name='L3557'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_source_from_cache,
<a name='L3558'>"Given the path to a .pyc./.pyo file, return the path to its .py file.\n\
<a name='L3559'>\n\
<a name='L3560'>The .pyc/.pyo file does not need to exist; this simply returns the path to\n\
<a name='L3561'>the .py file calculated to correspond to the .pyc/.pyo file.  If path\n\
<a name='L3562'>does not conform to PEP 3147 format, ValueError will be raised.");
<a name='L3563'>
<a name='L3564'><i><font color='green'>/* Doc strings */</font></i>
<a name='L3565'>
<a name='L3566'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_imp,
<a name='L3567'>"This module provides the components needed to build your own\n\
<a name='L3568'>__import__ function.  Undocumented functions are obsolete.");
<a name='L3569'>
<a name='L3570'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_find_module,
<a name='L3571'>"find_module(name, [path]) -&gt; (file, filename, (suffix, mode, type))\n\
<a name='L3572'>Search for a module.  If path is omitted or None, search for a\n\
<a name='L3573'>built-in, frozen or special module and continue search in sys.path.\n\
<a name='L3574'>The module name cannot contain '.'; to search for a submodule of a\n\
<a name='L3575'>package, pass the submodule name and the package's __path__.");
<a name='L3576'>
<a name='L3577'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_load_module,
<a name='L3578'>"load_module(name, file, filename, (suffix, mode, type)) -&gt; module\n\
<a name='L3579'>Load a module, given information returned by find_module().\n\
<a name='L3580'>The module name must include the full package name, if any.");
<a name='L3581'>
<a name='L3582'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_get_magic,
<a name='L3583'>"get_magic() -&gt; string\n\
<a name='L3584'>Return the magic number for .pyc or .pyo files.");
<a name='L3585'>
<a name='L3586'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_get_tag,
<a name='L3587'>"get_tag() -&gt; string\n\
<a name='L3588'>Return the magic tag for .pyc or .pyo files.");
<a name='L3589'>
<a name='L3590'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_get_suffixes,
<a name='L3591'>"get_suffixes() -&gt; [(suffix, mode, type), ...]\n\
<a name='L3592'>Return a list of (suffix, mode, type) tuples describing the files\n\
<a name='L3593'>that find_module() looks for.");
<a name='L3594'>
<a name='L3595'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_new_module,
<a name='L3596'>"new_module(name) -&gt; module\n\
<a name='L3597'>Create a new module.  Do not enter it in sys.modules.\n\
<a name='L3598'>The module name must include the full package name, if any.");
<a name='L3599'>
<a name='L3600'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_lock_held,
<a name='L3601'>"lock_held() -&gt; boolean\n\
<a name='L3602'>Return True if the import lock is currently held, else False.\n\
<a name='L3603'>On platforms without threads, return False.");
<a name='L3604'>
<a name='L3605'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_acquire_lock,
<a name='L3606'>"acquire_lock() -&gt; None\n\
<a name='L3607'>Acquires the interpreter's import lock for the current thread.\n\
<a name='L3608'>This lock should be used by import hooks to ensure thread-safety\n\
<a name='L3609'>when importing modules.\n\
<a name='L3610'>On platforms without threads, this function does nothing.");
<a name='L3611'>
<a name='L3612'><a href='../D/3131.html' title='Multiple defined in 2 places.'>PyDoc_STRVAR</a>(doc_release_lock,
<a name='L3613'>"release_lock() -&gt; None\n\
<a name='L3614'>Release the interpreter's import lock.\n\
<a name='L3615'>On platforms without threads, this function does nothing.");
<a name='L3616'>
<a name='L3617'><b>static</b> <a href='../D/3525.html' title='Multiple defined in 3 places.'>PyMethodDef</a> imp_methods[] = <font color='red'>{</font>
<a name='L3618'>    <font color='red'>{</font>"find_module",      <a href='../S/3120.html#L3207' title='Defined at 3207 in Python/import.c.'>imp_find_module</a>,  <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, doc_find_module<font color='red'>}</font>,
<a name='L3619'>    <font color='red'>{</font>"get_magic",        <a href='../S/3120.html#L3112' title='Defined at 3112 in Python/import.c.'>imp_get_magic</a>,    <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  doc_get_magic<font color='red'>}</font>,
<a name='L3620'>    <font color='red'>{</font>"get_tag",          <a href='../S/3120.html#L3118' title='Defined at 3118 in Python/import.c.'>imp_get_tag</a>,      <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  doc_get_tag<font color='red'>}</font>,
<a name='L3621'>    <font color='red'>{</font>"get_suffixes", <a href='../S/3120.html#L3124' title='Defined at 3124 in Python/import.c.'>imp_get_suffixes</a>, <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  doc_get_suffixes<font color='red'>}</font>,
<a name='L3622'>    <font color='red'>{</font>"load_module",      <a href='../S/3120.html#L3410' title='Defined at 3410 in Python/import.c.'>imp_load_module</a>,  <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, doc_load_module<font color='red'>}</font>,
<a name='L3623'>    <font color='red'>{</font>"new_module",       <a href='../S/3120.html#L3469' title='Defined at 3469 in Python/import.c.'>imp_new_module</a>,   <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>, doc_new_module<font color='red'>}</font>,
<a name='L3624'>    <font color='red'>{</font>"lock_held",        <a href='../S/3120.html#L344' title='Defined at 344 in Python/import.c.'>imp_lock_held</a>,    <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  doc_lock_held<font color='red'>}</font>,
<a name='L3625'>    <font color='red'>{</font>"acquire_lock", <a href='../S/3120.html#L354' title='Defined at 354 in Python/import.c.'>imp_acquire_lock</a>, <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  doc_acquire_lock<font color='red'>}</font>,
<a name='L3626'>    <font color='red'>{</font>"release_lock", <a href='../S/3120.html#L364' title='Defined at 364 in Python/import.c.'>imp_release_lock</a>, <a href='../S/2858.html#L634' title='Defined at 634 in PC/bdist_wininst/install.c.'>METH_NOARGS</a>,  doc_release_lock<font color='red'>}</font>,
<a name='L3627'>    <font color='red'>{</font>"reload",       <a href='../S/3120.html#L3478' title='Defined at 3478 in Python/import.c.'>imp_reload</a>,       METH_O,       doc_reload<font color='red'>}</font>,
<a name='L3628'>    <font color='red'>{</font>"cache_from_source", (PyCFunction)<a href='../S/3120.html#L3489' title='Defined at 3489 in Python/import.c.'>imp_cache_from_source</a>,
<a name='L3629'>     <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a> | METH_KEYWORDS, doc_cache_from_source<font color='red'>}</font>,
<a name='L3630'>    <font color='red'>{</font>"source_from_cache", (PyCFunction)<a href='../S/3120.html#L3533' title='Defined at 3533 in Python/import.c.'>imp_source_from_cache</a>,
<a name='L3631'>     <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a> | METH_KEYWORDS, doc_source_from_cache<font color='red'>}</font>,
<a name='L3632'>    <i><font color='green'>/* The rest are obsolete */</font></i>
<a name='L3633'>    <font color='red'>{</font>"get_frozen_object",       <a href='../S/3120.html#L3261' title='Defined at 3261 in Python/import.c.'>imp_get_frozen_object</a>,  <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3634'>    <font color='red'>{</font>"is_frozen_package",   <a href='../S/3120.html#L3271' title='Defined at 3271 in Python/import.c.'>imp_is_frozen_package</a>,  <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3635'>    <font color='red'>{</font>"init_builtin",            <a href='../S/3120.html#L3221' title='Defined at 3221 in Python/import.c.'>imp_init_builtin</a>,       <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3636'>    <font color='red'>{</font>"init_frozen",             <a href='../S/3120.html#L3241' title='Defined at 3241 in Python/import.c.'>imp_init_frozen</a>,        <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3637'>    <font color='red'>{</font>"is_builtin",              <a href='../S/3120.html#L3281' title='Defined at 3281 in Python/import.c.'>imp_is_builtin</a>,         <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3638'>    <font color='red'>{</font>"is_frozen",               <a href='../S/3120.html#L3290' title='Defined at 3290 in Python/import.c.'>imp_is_frozen</a>,          <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3639'>    <font color='red'>{</font>"load_compiled",           <a href='../S/3120.html#L3331' title='Defined at 3331 in Python/import.c.'>imp_load_compiled</a>,      <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3640'><font color='darkred'>#ifdef</font> <a href='../D/1481.html' title='Multiple defined in 3 places.'>HAVE_DYNAMIC_LOADING</a>
<a name='L3641'>    <font color='red'>{</font>"load_dynamic",            <a href='../S/3120.html#L3357' title='Defined at 3357 in Python/import.c.'>imp_load_dynamic</a>,       <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3642'><font color='darkred'>#endif</font>
<a name='L3643'>    <font color='red'>{</font>"load_package",            <a href='../S/3120.html#L3455' title='Defined at 3455 in Python/import.c.'>imp_load_package</a>,       <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3644'>    <font color='red'>{</font>"load_source",             <a href='../S/3120.html#L3386' title='Defined at 3386 in Python/import.c.'>imp_load_source</a>,        <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a><font color='red'>}</font>,
<a name='L3645'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,                      <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>           <i><font color='green'>/* sentinel */</font></i>
<a name='L3646'><font color='red'>}</font>;
<a name='L3647'>
<a name='L3648'><b>static</b> <b>int</b>
<a name='L3649'><a href='../R/10269.html' title='Multiple refered from 24 places.'>setint</a>(PyObject *d, <b>char</b> *name, <b>int</b> value)
<a name='L3650'><font color='red'>{</font>
<a name='L3651'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *v;
<a name='L3652'>    <b>int</b> err;
<a name='L3653'>
<a name='L3654'>    v = <a href='../S/2799.html#L176' title='Defined at 176 in Objects/longobject.c.'>PyLong_FromLong</a>((<b>long</b>)<a href='../S/2252.html#L27' title='Defined at 27 in Modules/_ctypes/ctypes.h.'>value</a>);
<a name='L3655'>    err = <a href='../S/2787.html#L2180' title='Defined at 2180 in Objects/dictobject.c.'>PyDict_SetItemString</a>(d, name, v);
<a name='L3656'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(v);
<a name='L3657'>    <b>return</b> err;
<a name='L3658'><font color='red'>}</font>
<a name='L3659'>
<a name='L3660'><b>typedef</b> <b>struct</b> <font color='red'>{</font>
<a name='L3661'>    <a href='../S/544.html#L82' title='Defined at 82 in Include/object.h.'>PyObject_HEAD</a>
<a name='L3662'><font color='red'>}</font> <a href='../S/3120.html#L3750' title='Refered from 3750 in Python/import.c.'>NullImporter</a>;
<a name='L3663'>
<a name='L3664'><b>static</b> <b>int</b>
<a name='L3665'><a href='../S/3120.html#L3783' title='Refered from 3783 in Python/import.c.'>NullImporter_init</a>(NullImporter *self, PyObject *args, PyObject *kwds)
<a name='L3666'><font color='red'>{</font>
<a name='L3667'><font color='darkred'>#ifndef</font> <a href='../S/2906.html#L81' title='Defined at 81 in PC/pyconfig.h.'>MS_WINDOWS</a>
<a name='L3668'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *path;
<a name='L3669'>    <b>struct</b> stat statbuf;
<a name='L3670'>    <b>int</b> rv;
<a name='L3671'>
<a name='L3672'>    <b>if</b> (!<a href='../S/3112.html#L1777' title='Defined at 1777 in Python/getargs.c.'>_PyArg_NoKeywords</a>("NullImporter()", kwds))
<a name='L3673'>        <b>return</b> -1;
<a name='L3674'>
<a name='L3675'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "O&amp;:NullImporter",
<a name='L3676'>                          <a href='../D/4003.html' title='Multiple defined in 3 places.'>PyUnicode_FSConverter</a>, &amp;path))
<a name='L3677'>        <b>return</b> -1;
<a name='L3678'>
<a name='L3679'>    <b>if</b> (PyBytes_GET_SIZE(path) == 0) <font color='red'>{</font>
<a name='L3680'>        Py_DECREF(path);
<a name='L3681'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError, "empty pathname");
<a name='L3682'>        <b>return</b> -1;
<a name='L3683'>    <font color='red'>}</font>
<a name='L3684'>
<a name='L3685'>    rv = stat(PyBytes_AS_STRING(path), &amp;statbuf);
<a name='L3686'>    Py_DECREF(path);
<a name='L3687'>    <b>if</b> (rv == 0) <font color='red'>{</font>
<a name='L3688'>        <i><font color='green'>/* it exists */</font></i>
<a name='L3689'>        <b>if</b> (<a href='../S/565.html#L397' title='Defined at 397 in Include/pyport.h.'>S_ISDIR</a>(statbuf.st_mode)) <font color='red'>{</font>
<a name='L3690'>            <i><font color='green'>/* it's a directory */</font></i>
<a name='L3691'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError, "existing directory");
<a name='L3692'>            <b>return</b> -1;
<a name='L3693'>        <font color='red'>}</font>
<a name='L3694'>    <font color='red'>}</font>
<a name='L3695'><font color='darkred'>#else</font> <i><font color='green'>/* MS_WINDOWS */</font></i>
<a name='L3696'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *pathobj;
<a name='L3697'>    DWORD rv;
<a name='L3698'>    wchar_t *path;
<a name='L3699'>
<a name='L3700'>    <b>if</b> (!<a href='../S/3112.html#L1777' title='Defined at 1777 in Python/getargs.c.'>_PyArg_NoKeywords</a>("NullImporter()", kwds))
<a name='L3701'>        <b>return</b> -1;
<a name='L3702'>
<a name='L3703'>    <b>if</b> (!<a href='../D/2731.html' title='Multiple defined in 2 places.'>PyArg_ParseTuple</a>(<a href='../S/2858.html#L294' title='Defined at 294 in PC/bdist_wininst/install.c.'>args</a>, "U:NullImporter",
<a name='L3704'>                          &amp;pathobj))
<a name='L3705'>        <b>return</b> -1;
<a name='L3706'>
<a name='L3707'>    <b>if</b> (<a href='../S/587.html#L404' title='Defined at 404 in Include/unicodeobject.h.'>PyUnicode_GET_SIZE</a>(pathobj) == 0) <font color='red'>{</font>
<a name='L3708'>        <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError, "empty pathname");
<a name='L3709'>        <b>return</b> -1;
<a name='L3710'>    <font color='red'>}</font>
<a name='L3711'>
<a name='L3712'>    path = <a href='../D/3964.html' title='Multiple defined in 3 places.'>PyUnicode_AsWideCharString</a>(pathobj, <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>);
<a name='L3713'>    <b>if</b> (path == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3714'>        <b>return</b> -1;
<a name='L3715'>    <i><font color='green'>/* see issue1293 and issue3677:</font></i>
<a name='L3716'><i><font color='green'>     * stat() on Windows doesn't recognise paths like</font></i>
<a name='L3717'><i><font color='green'>     * "e:\\shared\\" and "\\\\whiterab-c2znlh\\shared" as dirs.</font></i>
<a name='L3718'><i><font color='green'>     */</font></i>
<a name='L3719'>    rv = GetFileAttributesW(path);
<a name='L3720'>    <a href='../S/2803.html#L1781' title='Defined at 1781 in Objects/object.c.'>PyMem_Free</a>(path);
<a name='L3721'>    <b>if</b> (rv != INVALID_FILE_ATTRIBUTES) <font color='red'>{</font>
<a name='L3722'>        <i><font color='green'>/* it exists */</font></i>
<a name='L3723'>        <b>if</b> (rv &amp; FILE_ATTRIBUTE_DIRECTORY) <font color='red'>{</font>
<a name='L3724'>            <i><font color='green'>/* it's a directory */</font></i>
<a name='L3725'>            <a href='../S/3106.html#L122' title='Defined at 122 in Python/errors.c.'>PyErr_SetString</a>(PyExc_ImportError, "existing directory");
<a name='L3726'>            <b>return</b> -1;
<a name='L3727'>        <font color='red'>}</font>
<a name='L3728'>    <font color='red'>}</font>
<a name='L3729'><font color='darkred'>#endif</font>
<a name='L3730'>    <b>return</b> 0;
<a name='L3731'><font color='red'>}</font>
<a name='L3732'>
<a name='L3733'><b>static</b> <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *
<a name='L3734'><a href='../S/3120.html#L3740' title='Refered from 3740 in Python/import.c.'>NullImporter_find_module</a>(NullImporter *self, PyObject *args)
<a name='L3735'><font color='red'>{</font>
<a name='L3736'>    <a href='../S/2562.html#L112' title='Defined at 112 in Modules/_elementtree.c.'>Py_RETURN_NONE</a>;
<a name='L3737'><font color='red'>}</font>
<a name='L3738'>
<a name='L3739'><b>static</b> <a href='../D/3525.html' title='Multiple defined in 3 places.'>PyMethodDef</a> NullImporter_methods[] = <font color='red'>{</font>
<a name='L3740'>    <font color='red'>{</font>"find_module", (PyCFunction)<a href='../S/3120.html#L3734' title='Defined at 3734 in Python/import.c.'>NullImporter_find_module</a>, <a href='../S/2858.html#L633' title='Defined at 633 in PC/bdist_wininst/install.c.'>METH_VARARGS</a>,
<a name='L3741'>     "Always return None"
<a name='L3742'>    <font color='red'>}</font>,
<a name='L3743'>    <font color='red'>{</font><a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a><font color='red'>}</font>  <i><font color='green'>/* Sentinel */</font></i>
<a name='L3744'><font color='red'>}</font>;
<a name='L3745'>
<a name='L3746'>
<a name='L3747'><a href='../D/3899.html' title='Multiple defined in 3 places.'>PyTypeObject</a> PyNullImporter_Type = <font color='red'>{</font>
<a name='L3748'>    <a href='../D/4042.html' title='Multiple defined in 3 places.'>PyVarObject_HEAD_INIT</a>(<a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>, 0)
<a name='L3749'>    "imp.NullImporter",        <i><font color='green'>/*tp_name*/</font></i>
<a name='L3750'>    <b>sizeof</b>(<a href='../S/3120.html#L3662' title='Defined at 3662 in Python/import.c.'>NullImporter</a>),      <i><font color='green'>/*tp_basicsize*/</font></i>
<a name='L3751'>    0,                         <i><font color='green'>/*tp_itemsize*/</font></i>
<a name='L3752'>    0,                         <i><font color='green'>/*tp_dealloc*/</font></i>
<a name='L3753'>    0,                         <i><font color='green'>/*tp_print*/</font></i>
<a name='L3754'>    0,                         <i><font color='green'>/*tp_getattr*/</font></i>
<a name='L3755'>    0,                         <i><font color='green'>/*tp_setattr*/</font></i>
<a name='L3756'>    0,                         <i><font color='green'>/*tp_reserved*/</font></i>
<a name='L3757'>    0,                         <i><font color='green'>/*tp_repr*/</font></i>
<a name='L3758'>    0,                         <i><font color='green'>/*tp_as_number*/</font></i>
<a name='L3759'>    0,                         <i><font color='green'>/*tp_as_sequence*/</font></i>
<a name='L3760'>    0,                         <i><font color='green'>/*tp_as_mapping*/</font></i>
<a name='L3761'>    0,                         <i><font color='green'>/*tp_hash */</font></i>
<a name='L3762'>    0,                         <i><font color='green'>/*tp_call*/</font></i>
<a name='L3763'>    0,                         <i><font color='green'>/*tp_str*/</font></i>
<a name='L3764'>    0,                         <i><font color='green'>/*tp_getattro*/</font></i>
<a name='L3765'>    0,                         <i><font color='green'>/*tp_setattro*/</font></i>
<a name='L3766'>    0,                         <i><font color='green'>/*tp_as_buffer*/</font></i>
<a name='L3767'>    Py_TPFLAGS_DEFAULT,        <i><font color='green'>/*tp_flags*/</font></i>
<a name='L3768'>    "Null importer object",    <i><font color='green'>/* tp_doc */</font></i>
<a name='L3769'>    0,                             <i><font color='green'>/* tp_traverse */</font></i>
<a name='L3770'>    0,                             <i><font color='green'>/* tp_clear */</font></i>
<a name='L3771'>    0,                             <i><font color='green'>/* tp_richcompare */</font></i>
<a name='L3772'>    0,                             <i><font color='green'>/* tp_weaklistoffset */</font></i>
<a name='L3773'>    0,                             <i><font color='green'>/* tp_iter */</font></i>
<a name='L3774'>    0,                             <i><font color='green'>/* tp_iternext */</font></i>
<a name='L3775'>    NullImporter_methods,      <i><font color='green'>/* tp_methods */</font></i>
<a name='L3776'>    0,                         <i><font color='green'>/* tp_members */</font></i>
<a name='L3777'>    0,                         <i><font color='green'>/* tp_getset */</font></i>
<a name='L3778'>    0,                         <i><font color='green'>/* tp_base */</font></i>
<a name='L3779'>    0,                         <i><font color='green'>/* tp_dict */</font></i>
<a name='L3780'>    0,                         <i><font color='green'>/* tp_descr_get */</font></i>
<a name='L3781'>    0,                         <i><font color='green'>/* tp_descr_set */</font></i>
<a name='L3782'>    0,                         <i><font color='green'>/* tp_dictoffset */</font></i>
<a name='L3783'>    (initproc)<a href='../S/3120.html#L3665' title='Defined at 3665 in Python/import.c.'>NullImporter_init</a>,      <i><font color='green'>/* tp_init */</font></i>
<a name='L3784'>    0,                         <i><font color='green'>/* tp_alloc */</font></i>
<a name='L3785'>    <a href='../S/2824.html#L730' title='Defined at 730 in Objects/typeobject.c.'>PyType_GenericNew</a>          <i><font color='green'>/* tp_new */</font></i>
<a name='L3786'><font color='red'>}</font>;
<a name='L3787'>
<a name='L3788'><b>static</b> <b>struct</b> <a href='../D/3534.html' title='Multiple defined in 2 places.'>PyModuleDef</a> impmodule = <font color='red'>{</font>
<a name='L3789'>    <a href='../S/542.html#L33' title='Defined at 33 in Include/moduleobject.h.'>PyModuleDef_HEAD_INIT</a>,
<a name='L3790'>    "imp",
<a name='L3791'>    doc_imp,
<a name='L3792'>    0,
<a name='L3793'>    imp_methods,
<a name='L3794'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L3795'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L3796'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>,
<a name='L3797'>    <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>
<a name='L3798'><font color='red'>}</font>;
<a name='L3799'>
<a name='L3800'><a href='../D/3482.html' title='Multiple defined in 10 places.'>PyMODINIT_FUNC</a>
<a name='L3801'><a href='../R/3054.html' title='Multiple refered from 2 places.'>PyInit_imp</a>(<b>void</b>)
<a name='L3802'><font color='red'>{</font>
<a name='L3803'>    <a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *m, *d;
<a name='L3804'>
<a name='L3805'>    <b>if</b> (<a href='../S/2824.html#L3799' title='Defined at 3799 in Objects/typeobject.c.'>PyType_Ready</a>(&amp;PyNullImporter_Type) &lt; 0)
<a name='L3806'>        <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3807'>
<a name='L3808'>    m = PyModule_Create(&amp;impmodule);
<a name='L3809'>    <b>if</b> (m == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3810'>        <b>goto</b> failure;
<a name='L3811'>    d = <a href='../S/2802.html#L159' title='Defined at 159 in Objects/moduleobject.c.'>PyModule_GetDict</a>(m);
<a name='L3812'>    <b>if</b> (d == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3813'>        <b>goto</b> failure;
<a name='L3814'>
<a name='L3815'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "SEARCH_ERROR", <a href='../S/3122.html#L11' title='Defined at 11 in Python/importdl.h.'>SEARCH_ERROR</a>) &lt; 0) <b>goto</b> failure;
<a name='L3816'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "PY_SOURCE", <a href='../S/3122.html#L12' title='Defined at 12 in Python/importdl.h.'>PY_SOURCE</a>) &lt; 0) <b>goto</b> failure;
<a name='L3817'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "PY_COMPILED", <a href='../S/3122.html#L13' title='Defined at 13 in Python/importdl.h.'>PY_COMPILED</a>) &lt; 0) <b>goto</b> failure;
<a name='L3818'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "C_EXTENSION", <a href='../S/3122.html#L14' title='Defined at 14 in Python/importdl.h.'>C_EXTENSION</a>) &lt; 0) <b>goto</b> failure;
<a name='L3819'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "PY_RESOURCE", <a href='../S/3122.html#L15' title='Defined at 15 in Python/importdl.h.'>PY_RESOURCE</a>) &lt; 0) <b>goto</b> failure;
<a name='L3820'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "PKG_DIRECTORY", <a href='../S/3122.html#L16' title='Defined at 16 in Python/importdl.h.'>PKG_DIRECTORY</a>) &lt; 0) <b>goto</b> failure;
<a name='L3821'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "C_BUILTIN", <a href='../S/3122.html#L17' title='Defined at 17 in Python/importdl.h.'>C_BUILTIN</a>) &lt; 0) <b>goto</b> failure;
<a name='L3822'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "PY_FROZEN", <a href='../S/3122.html#L18' title='Defined at 18 in Python/importdl.h.'>PY_FROZEN</a>) &lt; 0) <b>goto</b> failure;
<a name='L3823'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "PY_CODERESOURCE", <a href='../S/3122.html#L19' title='Defined at 19 in Python/importdl.h.'>PY_CODERESOURCE</a>) &lt; 0) <b>goto</b> failure;
<a name='L3824'>    <b>if</b> (<a href='../D/11129.html' title='Multiple defined in 2 places.'>setint</a>(d, "IMP_HOOK", <a href='../S/3122.html#L20' title='Defined at 20 in Python/importdl.h.'>IMP_HOOK</a>) &lt; 0) <b>goto</b> failure;
<a name='L3825'>
<a name='L3826'>    Py_INCREF(&amp;PyNullImporter_Type);
<a name='L3827'>    <a href='../S/3125.html#L525' title='Defined at 525 in Python/modsupport.c.'>PyModule_AddObject</a>(m, "NullImporter", (<a href='../D/3593.html' title='Multiple defined in 2 places.'>PyObject</a> *)&amp;PyNullImporter_Type);
<a name='L3828'>    <b>return</b> m;
<a name='L3829'>  failure:
<a name='L3830'>    <a href='../S/544.html#L767' title='Defined at 767 in Include/object.h.'>Py_XDECREF</a>(m);
<a name='L3831'>    <b>return</b> <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3832'><font color='red'>}</font>
<a name='L3833'>
<a name='L3834'>
<a name='L3835'><i><font color='green'>/* API for embedding applications that want to add their own entries</font></i>
<a name='L3836'><i><font color='green'>   to the table of built-in modules.  This should normally be called</font></i>
<a name='L3837'><i><font color='green'>   *before* Py_Initialize().  When the table resize fails, -1 is</font></i>
<a name='L3838'><i><font color='green'>   returned and the existing table is unchanged.</font></i>
<a name='L3839'><i><font color='green'></font></i>
<a name='L3840'><i><font color='green'>   After a similar function by Just van Rossum. */</font></i>
<a name='L3841'>
<a name='L3842'><b>int</b>
<a name='L3843'><a href='../S/3120.html#L3884' title='Refered from 3884 in Python/import.c.'>PyImport_ExtendInittab</a>(<b>struct</b> _inittab *newtab)
<a name='L3844'><font color='red'>{</font>
<a name='L3845'>    <b>static</b> <b>struct</b> _inittab *our_copy = <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>;
<a name='L3846'>    <b>struct</b> _inittab *p;
<a name='L3847'>    <b>int</b> i, n;
<a name='L3848'>
<a name='L3849'>    <i><font color='green'>/* Count the number of entries in both tables */</font></i>
<a name='L3850'>    <b>for</b> (n = 0; newtab[n].name != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; n++)
<a name='L3851'>        ;
<a name='L3852'>    <b>if</b> (n == 0)
<a name='L3853'>        <b>return</b> 0; <i><font color='green'>/* Nothing to do */</font></i>
<a name='L3854'>    <b>for</b> (i = 0; PyImport_Inittab[i].name != <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>; i++)
<a name='L3855'>        ;
<a name='L3856'>
<a name='L3857'>    <i><font color='green'>/* Allocate new memory for the combined table */</font></i>
<a name='L3858'>    p = our_copy;
<a name='L3859'>    PyMem_RESIZE(p, <b>struct</b> _inittab, i+n+1);
<a name='L3860'>    <b>if</b> (p == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>)
<a name='L3861'>        <b>return</b> -1;
<a name='L3862'>
<a name='L3863'>    <i><font color='green'>/* Copy the tables into the new memory */</font></i>
<a name='L3864'>    <b>if</b> (our_copy != PyImport_Inittab)
<a name='L3865'>        <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(p, PyImport_Inittab, (i+1) * <b>sizeof</b>(<b>struct</b> _inittab));
<a name='L3866'>    PyImport_Inittab = our_copy = p;
<a name='L3867'>    <a href='../D/9803.html' title='Multiple defined in 4 places.'>memcpy</a>(p+i, newtab, (n+1) * <b>sizeof</b>(<b>struct</b> _inittab));
<a name='L3868'>
<a name='L3869'>    <b>return</b> 0;
<a name='L3870'><font color='red'>}</font>
<a name='L3871'>
<a name='L3872'><i><font color='green'>/* Shorthand to add a single entry given a name and a function */</font></i>
<a name='L3873'>
<a name='L3874'><b>int</b>
<a name='L3875'>PyImport_AppendInittab(<b>const</b> <b>char</b> *name, PyObject* (*initfunc)(<b>void</b>))
<a name='L3876'><font color='red'>{</font>
<a name='L3877'>    <b>struct</b> _inittab newtab[2];
<a name='L3878'>
<a name='L3879'>    memset(newtab, '\0', <b>sizeof</b> newtab);
<a name='L3880'>
<a name='L3881'>    newtab[0].name = (<b>char</b> *)name;
<a name='L3882'>    newtab[0].initfunc = initfunc;
<a name='L3883'>
<a name='L3884'>    <b>return</b> <a href='../S/3120.html#L3843' title='Defined at 3843 in Python/import.c.'>PyImport_ExtendInittab</a>(newtab);
<a name='L3885'><font color='red'>}</font>
<a name='L3886'>
<a name='L3887'><font color='darkred'>#ifdef</font> __cplusplus
<a name='L3888'><font color='red'>}</font>
<a name='L3889'><font color='darkred'>#endif</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L147'>[^]</a><a href='#L3875'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
