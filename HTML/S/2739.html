<html>
<head>
<title>Modules/zlib/example.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.8.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/3353.html'>Modules</a>/<a href='../files/3390.html'>zlib</a>/example.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L59'>[^]</a><a href='#L514'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L59' title='Defined at 59.'>test_compress</a>
<li><a href='#L85' title='Defined at 85.'>test_gzio</a>
<li><a href='#L169' title='Defined at 169.'>test_deflate</a>
<li><a href='#L207' title='Defined at 207.'>test_inflate</a>
<li><a href='#L248' title='Defined at 248.'>test_large_deflate</a>
<li><a href='#L303' title='Defined at 303.'>test_large_inflate</a>
<li><a href='#L344' title='Defined at 344.'>test_flush</a>
<li><a href='#L382' title='Defined at 382.'>test_sync</a>
<li><a href='#L426' title='Defined at 426.'>test_dict_deflate</a>
<li><a href='#L463' title='Defined at 463.'>test_dict_inflate</a>
<li><a href='#L514' title='Defined at 514.'>main</a>
</ol>
<hr>
<pre>
<a name='L1'><i><font color='green'>/* example.c -- usage example of the zlib compression library</font></i>
<a name='L2'><i><font color='green'> * Copyright (C) 1995-2006 Jean-loup Gailly.</font></i>
<a name='L3'><i><font color='green'> * For conditions of distribution and use, see copyright notice in zlib.h</font></i>
<a name='L4'><i><font color='green'> */</font></i>
<a name='L5'>
<a name='L6'><i><font color='green'>/* @(#) $Id$ */</font></i>
<a name='L7'>
<a name='L8'><font color='darkred'>#include</font> "<a href='2769.html'>zlib.h</a>"
<a name='L9'><font color='darkred'>#include</font> &lt;stdio.h&gt;
<a name='L10'>
<a name='L11'><font color='darkred'>#ifdef</font> <a href='../D/4951.html' title='Multiple defined in 12 places.'>STDC</a>
<a name='L12'><font color='darkred'>#  include</font> &lt;string.h&gt;
<a name='L13'><font color='darkred'>#  include</font> &lt;stdlib.h&gt;
<a name='L14'><font color='darkred'>#endif</font>
<a name='L15'>
<a name='L16'><font color='darkred'>#if</font> <b>defined</b>(VMS) || <b>defined</b>(RISCOS)
<a name='L17'><font color='darkred'>#  define</font> <a href='../S/2739.html#L545' title='Refered from 545 in Modules/zlib/example.c.'>TESTFILE</a> "foo-gz"
<a name='L18'><font color='darkred'>#else</font>
<a name='L19'><font color='darkred'>#  define</font> <a href='../S/2739.html#L545' title='Refered from 545 in Modules/zlib/example.c.'>TESTFILE</a> "foo.gz"
<a name='L20'><font color='darkred'>#endif</font>
<a name='L21'>
<a name='L22'><font color='darkred'>#define</font> <a href='../R/489.html' title='Multiple refered from 31 places.'>CHECK_ERR</a>(err, msg) <font color='red'>{</font> \
<a name='L23'>    <b>if</b> (err != <a href='../S/2769.html#L173' title='Defined at 173 in Modules/zlib/zlib.h.'>Z_OK</a>) <font color='red'>{</font> \
<a name='L24'>        fprintf(stderr, "%s error: %d\n", msg, err); \
<a name='L25'>        exit(1); \
<a name='L26'>    <font color='red'>}</font> \
<a name='L27'><font color='red'>}</font>
<a name='L28'>
<a name='L29'><b>const</b> <b>char</b> hello[] = "hello, hello!";
<a name='L30'><i><font color='green'>/* "hello world" would be more standard, but the repeated "hello"</font></i>
<a name='L31'><i><font color='green'> * stresses the compression code better, sorry...</font></i>
<a name='L32'><i><font color='green'> */</font></i>
<a name='L33'>
<a name='L34'><b>const</b> <b>char</b> dictionary[] = "hello";
<a name='L35'><a href='../D/11920.html' title='Multiple defined in 4 places.'>uLong</a> dictId; <i><font color='green'>/* Adler32 value of the dictionary */</font></i>
<a name='L36'>
<a name='L37'><b>void</b> <a href='../S/2739.html#L59' title='Defined at 59 in Modules/zlib/example.c.'>test_compress</a>      <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen,
<a name='L38'>                            Byte *uncompr, uLong uncomprLen));
<a name='L39'><b>void</b> <a href='../S/2739.html#L85' title='Defined at 85 in Modules/zlib/example.c.'>test_gzio</a>          <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((<b>const</b> <b>char</b> *fname,
<a name='L40'>                            Byte *uncompr, uLong uncomprLen));
<a name='L41'><b>void</b> <a href='../S/2739.html#L169' title='Defined at 169 in Modules/zlib/example.c.'>test_deflate</a>       <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen));
<a name='L42'><b>void</b> <a href='../S/2739.html#L207' title='Defined at 207 in Modules/zlib/example.c.'>test_inflate</a>       <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen,
<a name='L43'>                            Byte *uncompr, uLong uncomprLen));
<a name='L44'><b>void</b> <a href='../S/2739.html#L248' title='Defined at 248 in Modules/zlib/example.c.'>test_large_deflate</a> <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen,
<a name='L45'>                            Byte *uncompr, uLong uncomprLen));
<a name='L46'><b>void</b> <a href='../S/2739.html#L303' title='Defined at 303 in Modules/zlib/example.c.'>test_large_inflate</a> <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen,
<a name='L47'>                            Byte *uncompr, uLong uncomprLen));
<a name='L48'><b>void</b> <a href='../S/2739.html#L344' title='Defined at 344 in Modules/zlib/example.c.'>test_flush</a>         <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong *comprLen));
<a name='L49'><b>void</b> <a href='../S/2739.html#L382' title='Defined at 382 in Modules/zlib/example.c.'>test_sync</a>          <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen,
<a name='L50'>                            Byte *uncompr, uLong uncomprLen));
<a name='L51'><b>void</b> <a href='../S/2739.html#L426' title='Defined at 426 in Modules/zlib/example.c.'>test_dict_deflate</a>  <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen));
<a name='L52'><b>void</b> <a href='../S/2739.html#L463' title='Defined at 463 in Modules/zlib/example.c.'>test_dict_inflate</a>  <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((Byte *compr, uLong comprLen,
<a name='L53'>                            Byte *uncompr, uLong uncomprLen));
<a name='L54'><b>int</b>  <a href='../D/9659.html' title='Multiple defined in 138 places.'>main</a>               <a href='../D/2401.html' title='Multiple defined in 9 places.'>OF</a>((<b>int</b> argc, <b>char</b> *argv[]));
<a name='L55'>
<a name='L56'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L57'><i><font color='green'> * Test compress() and uncompress()</font></i>
<a name='L58'><i><font color='green'> */</font></i>
<a name='L59'><b>void</b> <a href='../R/10776.html' title='Multiple refered from 2 places.'>test_compress</a>(compr, comprLen, uncompr, uncomprLen)
<a name='L60'>    Byte *compr, *uncompr;
<a name='L61'>    uLong comprLen, uncomprLen;
<a name='L62'><font color='red'>{</font>
<a name='L63'>    <b>int</b> err;
<a name='L64'>    <a href='../D/11920.html' title='Multiple defined in 4 places.'>uLong</a> len = (<a href='../D/11920.html' title='Multiple defined in 4 places.'>uLong</a>)strlen(hello)+1;
<a name='L65'>
<a name='L66'>    err = <a href='../D/7719.html' title='Multiple defined in 3 places.'>compress</a>(compr, &amp;comprLen, (<b>const</b> <a href='../D/459.html' title='Multiple defined in 6 places.'>Bytef</a>*)hello, len);
<a name='L67'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "compress");
<a name='L68'>
<a name='L69'>    strcpy((<b>char</b>*)uncompr, "garbage");
<a name='L70'>
<a name='L71'>    err = <a href='../D/11944.html' title='Multiple defined in 3 places.'>uncompress</a>(uncompr, &amp;uncomprLen, compr, comprLen);
<a name='L72'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "uncompress");
<a name='L73'>
<a name='L74'>    <b>if</b> (strcmp((<b>char</b>*)uncompr, hello)) <font color='red'>{</font>
<a name='L75'>        fprintf(stderr, "bad uncompress\n");
<a name='L76'>        exit(1);
<a name='L77'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L78'>        printf("uncompress(): %s\n", (<b>char</b> *)uncompr);
<a name='L79'>    <font color='red'>}</font>
<a name='L80'><font color='red'>}</font>
<a name='L81'>
<a name='L82'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L83'><i><font color='green'> * Test read/write of .gz files</font></i>
<a name='L84'><i><font color='green'> */</font></i>
<a name='L85'><b>void</b> <a href='../R/10788.html' title='Multiple refered from 2 places.'>test_gzio</a>(fname, uncompr, uncomprLen)
<a name='L86'>    <b>const</b> <b>char</b> *fname; <i><font color='green'>/* compressed file name */</font></i>
<a name='L87'>    Byte *uncompr;
<a name='L88'>    uLong uncomprLen;
<a name='L89'><font color='red'>{</font>
<a name='L90'><font color='darkred'>#ifdef</font> <a href='../D/2330.html' title='Multiple defined in 2 places.'>NO_GZCOMPRESS</a>
<a name='L91'>    fprintf(stderr, "NO_GZCOMPRESS -- gz* functions cannot compress\n");
<a name='L92'><font color='darkred'>#else</font>
<a name='L93'>    <b>int</b> err;
<a name='L94'>    <b>int</b> len = (<b>int</b>)strlen(hello)+1;
<a name='L95'>    <a href='../D/8993.html' title='Multiple defined in 2 places.'>gzFile</a> file;
<a name='L96'>    <a href='../D/12437.html' title='Multiple defined in 4 places.'>z_off_t</a> pos;
<a name='L97'>
<a name='L98'>    file = <a href='../D/9032.html' title='Multiple defined in 4 places.'>gzopen</a>(fname, "wb");
<a name='L99'>    <b>if</b> (file == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L100'>        fprintf(stderr, "gzopen error\n");
<a name='L101'>        exit(1);
<a name='L102'>    <font color='red'>}</font>
<a name='L103'>    <a href='../D/9035.html' title='Multiple defined in 3 places.'>gzputc</a>(file, 'h');
<a name='L104'>    <b>if</b> (<a href='../D/9036.html' title='Multiple defined in 3 places.'>gzputs</a>(file, "ello") != 4) <font color='red'>{</font>
<a name='L105'>        fprintf(stderr, "gzputs err: %s\n", <a href='../D/9026.html' title='Multiple defined in 3 places.'>gzerror</a>(file, &amp;err));
<a name='L106'>        exit(1);
<a name='L107'>    <font color='red'>}</font>
<a name='L108'>    <b>if</b> (<a href='../D/9034.html' title='Multiple defined in 5 places.'>gzprintf</a>(file, ", %s!", "hello") != 8) <font color='red'>{</font>
<a name='L109'>        fprintf(stderr, "gzprintf err: %s\n", <a href='../D/9026.html' title='Multiple defined in 3 places.'>gzerror</a>(file, &amp;err));
<a name='L110'>        exit(1);
<a name='L111'>    <font color='red'>}</font>
<a name='L112'>    <a href='../D/9039.html' title='Multiple defined in 4 places.'>gzseek</a>(file, 1L, <a href='../D/4574.html' title='Multiple defined in 2 places.'>SEEK_CUR</a>); <i><font color='green'>/* add one zero byte */</font></i>
<a name='L113'>    <a href='../D/9020.html' title='Multiple defined in 3 places.'>gzclose</a>(file);
<a name='L114'>
<a name='L115'>    file = <a href='../D/9032.html' title='Multiple defined in 4 places.'>gzopen</a>(fname, "rb");
<a name='L116'>    <b>if</b> (file == <a href='../S/2891.html#L5' title='Defined at 5 in PC/os2emx/dllentry.c.'>NULL</a>) <font color='red'>{</font>
<a name='L117'>        fprintf(stderr, "gzopen error\n");
<a name='L118'>        exit(1);
<a name='L119'>    <font color='red'>}</font>
<a name='L120'>    strcpy((<b>char</b>*)uncompr, "garbage");
<a name='L121'>
<a name='L122'>    <b>if</b> (<a href='../D/9037.html' title='Multiple defined in 3 places.'>gzread</a>(file, uncompr, (<b>unsigned</b>)uncomprLen) != len) <font color='red'>{</font>
<a name='L123'>        fprintf(stderr, "gzread err: %s\n", <a href='../D/9026.html' title='Multiple defined in 3 places.'>gzerror</a>(file, &amp;err));
<a name='L124'>        exit(1);
<a name='L125'>    <font color='red'>}</font>
<a name='L126'>    <b>if</b> (strcmp((<b>char</b>*)uncompr, hello)) <font color='red'>{</font>
<a name='L127'>        fprintf(stderr, "bad gzread: %s\n", (<b>char</b>*)uncompr);
<a name='L128'>        exit(1);
<a name='L129'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L130'>        printf("gzread(): %s\n", (<b>char</b>*)uncompr);
<a name='L131'>    <font color='red'>}</font>
<a name='L132'>
<a name='L133'>    pos = <a href='../D/9039.html' title='Multiple defined in 4 places.'>gzseek</a>(file, -8L, <a href='../D/4574.html' title='Multiple defined in 2 places.'>SEEK_CUR</a>);
<a name='L134'>    <b>if</b> (pos != 6 || <a href='../D/9042.html' title='Multiple defined in 4 places.'>gztell</a>(file) != pos) <font color='red'>{</font>
<a name='L135'>        fprintf(stderr, "gzseek error, pos=%ld, gztell=%ld\n",
<a name='L136'>                (<b>long</b>)pos, (<b>long</b>)<a href='../D/9042.html' title='Multiple defined in 4 places.'>gztell</a>(file));
<a name='L137'>        exit(1);
<a name='L138'>    <font color='red'>}</font>
<a name='L139'>
<a name='L140'>    <b>if</b> (<a href='../D/9028.html' title='Multiple defined in 3 places.'>gzgetc</a>(file) != ' ') <font color='red'>{</font>
<a name='L141'>        fprintf(stderr, "gzgetc error\n");
<a name='L142'>        exit(1);
<a name='L143'>    <font color='red'>}</font>
<a name='L144'>
<a name='L145'>    <b>if</b> (<a href='../D/9044.html' title='Multiple defined in 3 places.'>gzungetc</a>(' ', file) != ' ') <font color='red'>{</font>
<a name='L146'>        fprintf(stderr, "gzungetc error\n");
<a name='L147'>        exit(1);
<a name='L148'>    <font color='red'>}</font>
<a name='L149'>
<a name='L150'>    <a href='../D/9029.html' title='Multiple defined in 3 places.'>gzgets</a>(file, (<b>char</b>*)uncompr, (<b>int</b>)uncomprLen);
<a name='L151'>    <b>if</b> (strlen((<b>char</b>*)uncompr) != 7) <font color='red'>{</font> <i><font color='green'>/* " hello!" */</font></i>
<a name='L152'>        fprintf(stderr, "gzgets err after gzseek: %s\n", <a href='../D/9026.html' title='Multiple defined in 3 places.'>gzerror</a>(file, &amp;err));
<a name='L153'>        exit(1);
<a name='L154'>    <font color='red'>}</font>
<a name='L155'>    <b>if</b> (strcmp((<b>char</b>*)uncompr, hello + 6)) <font color='red'>{</font>
<a name='L156'>        fprintf(stderr, "bad gzgets after gzseek\n");
<a name='L157'>        exit(1);
<a name='L158'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L159'>        printf("gzgets() after gzseek: %s\n", (<b>char</b>*)uncompr);
<a name='L160'>    <font color='red'>}</font>
<a name='L161'>
<a name='L162'>    <a href='../D/9020.html' title='Multiple defined in 3 places.'>gzclose</a>(file);
<a name='L163'><font color='darkred'>#endif</font>
<a name='L164'><font color='red'>}</font>
<a name='L165'>
<a name='L166'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L167'><i><font color='green'> * Test deflate() with small buffers</font></i>
<a name='L168'><i><font color='green'> */</font></i>
<a name='L169'><b>void</b> <a href='../R/10779.html' title='Multiple refered from 2 places.'>test_deflate</a>(compr, comprLen)
<a name='L170'>    Byte *compr;
<a name='L171'>    uLong comprLen;
<a name='L172'><font color='red'>{</font>
<a name='L173'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> c_stream; <i><font color='green'>/* compression stream */</font></i>
<a name='L174'>    <b>int</b> err;
<a name='L175'>    <a href='../D/11920.html' title='Multiple defined in 4 places.'>uLong</a> len = (<a href='../D/11920.html' title='Multiple defined in 4 places.'>uLong</a>)strlen(hello)+1;
<a name='L176'>
<a name='L177'>    c_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L178'>    c_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L179'>    c_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L180'>
<a name='L181'>    err = <a href='../S/2769.html#L1546' title='Defined at 1546 in Modules/zlib/zlib.h.'>deflateInit</a>(&amp;c_stream, <a href='../S/2769.html#L189' title='Defined at 189 in Modules/zlib/zlib.h.'>Z_DEFAULT_COMPRESSION</a>);
<a name='L182'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateInit");
<a name='L183'>
<a name='L184'>    c_stream.next_in  = (<a href='../D/459.html' title='Multiple defined in 6 places.'>Bytef</a>*)hello;
<a name='L185'>    c_stream.next_out = compr;
<a name='L186'>
<a name='L187'>    <b>while</b> (c_stream.total_in != len &amp;&amp; c_stream.total_out &lt; comprLen) <font color='red'>{</font>
<a name='L188'>        c_stream.avail_in = c_stream.avail_out = 1; <i><font color='green'>/* force small buffers */</font></i>
<a name='L189'>        err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L190'>        <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflate");
<a name='L191'>    <font color='red'>}</font>
<a name='L192'>    <i><font color='green'>/* Finish the stream, still forcing small buffers: */</font></i>
<a name='L193'>    <b>for</b> (;;) <font color='red'>{</font>
<a name='L194'>        c_stream.avail_out = 1;
<a name='L195'>        err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L168' title='Defined at 168 in Modules/zlib/zlib.h.'>Z_FINISH</a>);
<a name='L196'>        <b>if</b> (err == <a href='../S/2769.html#L174' title='Defined at 174 in Modules/zlib/zlib.h.'>Z_STREAM_END</a>) <b>break</b>;
<a name='L197'>        <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflate");
<a name='L198'>    <font color='red'>}</font>
<a name='L199'>
<a name='L200'>    err = <a href='../D/8007.html' title='Multiple defined in 3 places.'>deflateEnd</a>(&amp;c_stream);
<a name='L201'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateEnd");
<a name='L202'><font color='red'>}</font>
<a name='L203'>
<a name='L204'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L205'><i><font color='green'> * Test inflate() with small buffers</font></i>
<a name='L206'><i><font color='green'> */</font></i>
<a name='L207'><b>void</b> <a href='../R/10789.html' title='Multiple refered from 2 places.'>test_inflate</a>(compr, comprLen, uncompr, uncomprLen)
<a name='L208'>    Byte *compr, *uncompr;
<a name='L209'>    uLong comprLen, uncomprLen;
<a name='L210'><font color='red'>{</font>
<a name='L211'>    <b>int</b> err;
<a name='L212'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> d_stream; <i><font color='green'>/* decompression stream */</font></i>
<a name='L213'>
<a name='L214'>    strcpy((<b>char</b>*)uncompr, "garbage");
<a name='L215'>
<a name='L216'>    d_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L217'>    d_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L218'>    d_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L219'>
<a name='L220'>    d_stream.next_in  = compr;
<a name='L221'>    d_stream.avail_in = 0;
<a name='L222'>    d_stream.next_out = uncompr;
<a name='L223'>
<a name='L224'>    err = <a href='../S/2769.html#L1548' title='Defined at 1548 in Modules/zlib/zlib.h.'>inflateInit</a>(&amp;d_stream);
<a name='L225'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateInit");
<a name='L226'>
<a name='L227'>    <b>while</b> (d_stream.total_out &lt; uncomprLen &amp;&amp; d_stream.total_in &lt; comprLen) <font color='red'>{</font>
<a name='L228'>        d_stream.avail_in = d_stream.avail_out = 1; <i><font color='green'>/* force small buffers */</font></i>
<a name='L229'>        err = <a href='../D/9156.html' title='Multiple defined in 3 places.'>inflate</a>(&amp;d_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L230'>        <b>if</b> (err == <a href='../S/2769.html#L174' title='Defined at 174 in Modules/zlib/zlib.h.'>Z_STREAM_END</a>) <b>break</b>;
<a name='L231'>        <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflate");
<a name='L232'>    <font color='red'>}</font>
<a name='L233'>
<a name='L234'>    err = <a href='../D/9162.html' title='Multiple defined in 3 places.'>inflateEnd</a>(&amp;d_stream);
<a name='L235'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateEnd");
<a name='L236'>
<a name='L237'>    <b>if</b> (strcmp((<b>char</b>*)uncompr, hello)) <font color='red'>{</font>
<a name='L238'>        fprintf(stderr, "bad inflate\n");
<a name='L239'>        exit(1);
<a name='L240'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L241'>        printf("inflate(): %s\n", (<b>char</b> *)uncompr);
<a name='L242'>    <font color='red'>}</font>
<a name='L243'><font color='red'>}</font>
<a name='L244'>
<a name='L245'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L246'><i><font color='green'> * Test deflate() with large buffers and dynamic change of compression level</font></i>
<a name='L247'><i><font color='green'> */</font></i>
<a name='L248'><b>void</b> <a href='../R/10791.html' title='Multiple refered from 2 places.'>test_large_deflate</a>(compr, comprLen, uncompr, uncomprLen)
<a name='L249'>    Byte *compr, *uncompr;
<a name='L250'>    uLong comprLen, uncomprLen;
<a name='L251'><font color='red'>{</font>
<a name='L252'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> c_stream; <i><font color='green'>/* compression stream */</font></i>
<a name='L253'>    <b>int</b> err;
<a name='L254'>
<a name='L255'>    c_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L256'>    c_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L257'>    c_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L258'>
<a name='L259'>    err = <a href='../S/2769.html#L1546' title='Defined at 1546 in Modules/zlib/zlib.h.'>deflateInit</a>(&amp;c_stream, <a href='../S/2769.html#L187' title='Defined at 187 in Modules/zlib/zlib.h.'>Z_BEST_SPEED</a>);
<a name='L260'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateInit");
<a name='L261'>
<a name='L262'>    c_stream.next_out = compr;
<a name='L263'>    c_stream.avail_out = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)comprLen;
<a name='L264'>
<a name='L265'>    <i><font color='green'>/* At this point, uncompr is still mostly zeroes, so it should compress</font></i>
<a name='L266'><i><font color='green'>     * very well:</font></i>
<a name='L267'><i><font color='green'>     */</font></i>
<a name='L268'>    c_stream.next_in = uncompr;
<a name='L269'>    c_stream.avail_in = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)uncomprLen;
<a name='L270'>    err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L271'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflate");
<a name='L272'>    <b>if</b> (c_stream.avail_in != 0) <font color='red'>{</font>
<a name='L273'>        fprintf(stderr, "deflate not greedy\n");
<a name='L274'>        exit(1);
<a name='L275'>    <font color='red'>}</font>
<a name='L276'>
<a name='L277'>    <i><font color='green'>/* Feed in already compressed data and switch to no compression: */</font></i>
<a name='L278'>    <a href='../D/8012.html' title='Multiple defined in 3 places.'>deflateParams</a>(&amp;c_stream, <a href='../S/2769.html#L186' title='Defined at 186 in Modules/zlib/zlib.h.'>Z_NO_COMPRESSION</a>, <a href='../S/2769.html#L196' title='Defined at 196 in Modules/zlib/zlib.h.'>Z_DEFAULT_STRATEGY</a>);
<a name='L279'>    c_stream.next_in = compr;
<a name='L280'>    c_stream.avail_in = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)comprLen/2;
<a name='L281'>    err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L282'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflate");
<a name='L283'>
<a name='L284'>    <i><font color='green'>/* Switch back to compressing mode: */</font></i>
<a name='L285'>    <a href='../D/8012.html' title='Multiple defined in 3 places.'>deflateParams</a>(&amp;c_stream, <a href='../S/2769.html#L188' title='Defined at 188 in Modules/zlib/zlib.h.'>Z_BEST_COMPRESSION</a>, <a href='../S/2769.html#L192' title='Defined at 192 in Modules/zlib/zlib.h.'>Z_FILTERED</a>);
<a name='L286'>    c_stream.next_in = uncompr;
<a name='L287'>    c_stream.avail_in = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)uncomprLen;
<a name='L288'>    err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L289'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflate");
<a name='L290'>
<a name='L291'>    err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L168' title='Defined at 168 in Modules/zlib/zlib.h.'>Z_FINISH</a>);
<a name='L292'>    <b>if</b> (err != <a href='../S/2769.html#L174' title='Defined at 174 in Modules/zlib/zlib.h.'>Z_STREAM_END</a>) <font color='red'>{</font>
<a name='L293'>        fprintf(stderr, "deflate should report Z_STREAM_END\n");
<a name='L294'>        exit(1);
<a name='L295'>    <font color='red'>}</font>
<a name='L296'>    err = <a href='../D/8007.html' title='Multiple defined in 3 places.'>deflateEnd</a>(&amp;c_stream);
<a name='L297'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateEnd");
<a name='L298'><font color='red'>}</font>
<a name='L299'>
<a name='L300'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L301'><i><font color='green'> * Test inflate() with large buffers</font></i>
<a name='L302'><i><font color='green'> */</font></i>
<a name='L303'><b>void</b> <a href='../R/10793.html' title='Multiple refered from 2 places.'>test_large_inflate</a>(compr, comprLen, uncompr, uncomprLen)
<a name='L304'>    Byte *compr, *uncompr;
<a name='L305'>    uLong comprLen, uncomprLen;
<a name='L306'><font color='red'>{</font>
<a name='L307'>    <b>int</b> err;
<a name='L308'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> d_stream; <i><font color='green'>/* decompression stream */</font></i>
<a name='L309'>
<a name='L310'>    strcpy((<b>char</b>*)uncompr, "garbage");
<a name='L311'>
<a name='L312'>    d_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L313'>    d_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L314'>    d_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L315'>
<a name='L316'>    d_stream.next_in  = compr;
<a name='L317'>    d_stream.avail_in = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)comprLen;
<a name='L318'>
<a name='L319'>    err = <a href='../S/2769.html#L1548' title='Defined at 1548 in Modules/zlib/zlib.h.'>inflateInit</a>(&amp;d_stream);
<a name='L320'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateInit");
<a name='L321'>
<a name='L322'>    <b>for</b> (;;) <font color='red'>{</font>
<a name='L323'>        d_stream.next_out = uncompr;            <i><font color='green'>/* discard the output */</font></i>
<a name='L324'>        d_stream.avail_out = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)uncomprLen;
<a name='L325'>        err = <a href='../D/9156.html' title='Multiple defined in 3 places.'>inflate</a>(&amp;d_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L326'>        <b>if</b> (err == <a href='../S/2769.html#L174' title='Defined at 174 in Modules/zlib/zlib.h.'>Z_STREAM_END</a>) <b>break</b>;
<a name='L327'>        <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "large inflate");
<a name='L328'>    <font color='red'>}</font>
<a name='L329'>
<a name='L330'>    err = <a href='../D/9162.html' title='Multiple defined in 3 places.'>inflateEnd</a>(&amp;d_stream);
<a name='L331'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateEnd");
<a name='L332'>
<a name='L333'>    <b>if</b> (d_stream.total_out != 2*uncomprLen + comprLen/2) <font color='red'>{</font>
<a name='L334'>        fprintf(stderr, "bad large inflate: %ld\n", d_stream.total_out);
<a name='L335'>        exit(1);
<a name='L336'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L337'>        printf("large_inflate(): OK\n");
<a name='L338'>    <font color='red'>}</font>
<a name='L339'><font color='red'>}</font>
<a name='L340'>
<a name='L341'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L342'><i><font color='green'> * Test deflate() with full flush</font></i>
<a name='L343'><i><font color='green'> */</font></i>
<a name='L344'><b>void</b> <a href='../R/10785.html' title='Multiple refered from 2 places.'>test_flush</a>(compr, comprLen)
<a name='L345'>    Byte *compr;
<a name='L346'>    uLong *comprLen;
<a name='L347'><font color='red'>{</font>
<a name='L348'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> c_stream; <i><font color='green'>/* compression stream */</font></i>
<a name='L349'>    <b>int</b> err;
<a name='L350'>    <a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a> len = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)strlen(hello)+1;
<a name='L351'>
<a name='L352'>    c_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L353'>    c_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L354'>    c_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L355'>
<a name='L356'>    err = <a href='../S/2769.html#L1546' title='Defined at 1546 in Modules/zlib/zlib.h.'>deflateInit</a>(&amp;c_stream, <a href='../S/2769.html#L189' title='Defined at 189 in Modules/zlib/zlib.h.'>Z_DEFAULT_COMPRESSION</a>);
<a name='L357'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateInit");
<a name='L358'>
<a name='L359'>    c_stream.next_in  = (<a href='../D/459.html' title='Multiple defined in 6 places.'>Bytef</a>*)hello;
<a name='L360'>    c_stream.next_out = compr;
<a name='L361'>    c_stream.avail_in = 3;
<a name='L362'>    c_stream.avail_out = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)*comprLen;
<a name='L363'>    err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L167' title='Defined at 167 in Modules/zlib/zlib.h.'>Z_FULL_FLUSH</a>);
<a name='L364'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflate");
<a name='L365'>
<a name='L366'>    compr[3]++; <i><font color='green'>/* force an error in first compressed block */</font></i>
<a name='L367'>    c_stream.avail_in = len - 3;
<a name='L368'>
<a name='L369'>    err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L168' title='Defined at 168 in Modules/zlib/zlib.h.'>Z_FINISH</a>);
<a name='L370'>    <b>if</b> (err != <a href='../S/2769.html#L174' title='Defined at 174 in Modules/zlib/zlib.h.'>Z_STREAM_END</a>) <font color='red'>{</font>
<a name='L371'>        <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflate");
<a name='L372'>    <font color='red'>}</font>
<a name='L373'>    err = <a href='../D/8007.html' title='Multiple defined in 3 places.'>deflateEnd</a>(&amp;c_stream);
<a name='L374'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateEnd");
<a name='L375'>
<a name='L376'>    *comprLen = c_stream.total_out;
<a name='L377'><font color='red'>}</font>
<a name='L378'>
<a name='L379'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L380'><i><font color='green'> * Test inflateSync()</font></i>
<a name='L381'><i><font color='green'> */</font></i>
<a name='L382'><b>void</b> <a href='../R/10818.html' title='Multiple refered from 2 places.'>test_sync</a>(compr, comprLen, uncompr, uncomprLen)
<a name='L383'>    Byte *compr, *uncompr;
<a name='L384'>    uLong comprLen, uncomprLen;
<a name='L385'><font color='red'>{</font>
<a name='L386'>    <b>int</b> err;
<a name='L387'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> d_stream; <i><font color='green'>/* decompression stream */</font></i>
<a name='L388'>
<a name='L389'>    strcpy((<b>char</b>*)uncompr, "garbage");
<a name='L390'>
<a name='L391'>    d_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L392'>    d_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L393'>    d_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L394'>
<a name='L395'>    d_stream.next_in  = compr;
<a name='L396'>    d_stream.avail_in = 2; <i><font color='green'>/* just read the zlib header */</font></i>
<a name='L397'>
<a name='L398'>    err = <a href='../S/2769.html#L1548' title='Defined at 1548 in Modules/zlib/zlib.h.'>inflateInit</a>(&amp;d_stream);
<a name='L399'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateInit");
<a name='L400'>
<a name='L401'>    d_stream.next_out = uncompr;
<a name='L402'>    d_stream.avail_out = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)uncomprLen;
<a name='L403'>
<a name='L404'>    <a href='../D/9156.html' title='Multiple defined in 3 places.'>inflate</a>(&amp;d_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L405'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflate");
<a name='L406'>
<a name='L407'>    d_stream.avail_in = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)comprLen-2;   <i><font color='green'>/* read all compressed data */</font></i>
<a name='L408'>    err = <a href='../D/9173.html' title='Multiple defined in 3 places.'>inflateSync</a>(&amp;d_stream);           <i><font color='green'>/* but skip the damaged part */</font></i>
<a name='L409'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateSync");
<a name='L410'>
<a name='L411'>    err = <a href='../D/9156.html' title='Multiple defined in 3 places.'>inflate</a>(&amp;d_stream, <a href='../S/2769.html#L168' title='Defined at 168 in Modules/zlib/zlib.h.'>Z_FINISH</a>);
<a name='L412'>    <b>if</b> (err != <a href='../S/2769.html#L178' title='Defined at 178 in Modules/zlib/zlib.h.'>Z_DATA_ERROR</a>) <font color='red'>{</font>
<a name='L413'>        fprintf(stderr, "inflate should report DATA_ERROR\n");
<a name='L414'>        <i><font color='green'>/* Because of incorrect adler32 */</font></i>
<a name='L415'>        exit(1);
<a name='L416'>    <font color='red'>}</font>
<a name='L417'>    err = <a href='../D/9162.html' title='Multiple defined in 3 places.'>inflateEnd</a>(&amp;d_stream);
<a name='L418'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateEnd");
<a name='L419'>
<a name='L420'>    printf("after inflateSync(): hel%s\n", (<b>char</b> *)uncompr);
<a name='L421'><font color='red'>}</font>
<a name='L422'>
<a name='L423'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L424'><i><font color='green'> * Test deflate() with preset dictionary</font></i>
<a name='L425'><i><font color='green'> */</font></i>
<a name='L426'><b>void</b> <a href='../R/10780.html' title='Multiple refered from 2 places.'>test_dict_deflate</a>(compr, comprLen)
<a name='L427'>    Byte *compr;
<a name='L428'>    uLong comprLen;
<a name='L429'><font color='red'>{</font>
<a name='L430'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> c_stream; <i><font color='green'>/* compression stream */</font></i>
<a name='L431'>    <b>int</b> err;
<a name='L432'>
<a name='L433'>    c_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L434'>    c_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L435'>    c_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L436'>
<a name='L437'>    err = <a href='../S/2769.html#L1546' title='Defined at 1546 in Modules/zlib/zlib.h.'>deflateInit</a>(&amp;c_stream, <a href='../S/2769.html#L188' title='Defined at 188 in Modules/zlib/zlib.h.'>Z_BEST_COMPRESSION</a>);
<a name='L438'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateInit");
<a name='L439'>
<a name='L440'>    err = <a href='../D/8015.html' title='Multiple defined in 3 places.'>deflateSetDictionary</a>(&amp;c_stream,
<a name='L441'>                               (<b>const</b> <a href='../D/459.html' title='Multiple defined in 6 places.'>Bytef</a>*)dictionary, <b>sizeof</b>(dictionary));
<a name='L442'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateSetDictionary");
<a name='L443'>
<a name='L444'>    dictId = c_stream.adler;
<a name='L445'>    c_stream.next_out = compr;
<a name='L446'>    c_stream.avail_out = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)comprLen;
<a name='L447'>
<a name='L448'>    c_stream.next_in = (<a href='../D/459.html' title='Multiple defined in 6 places.'>Bytef</a>*)hello;
<a name='L449'>    c_stream.avail_in = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)strlen(hello)+1;
<a name='L450'>
<a name='L451'>    err = <a href='../D/8004.html' title='Multiple defined in 3 places.'>deflate</a>(&amp;c_stream, <a href='../S/2769.html#L168' title='Defined at 168 in Modules/zlib/zlib.h.'>Z_FINISH</a>);
<a name='L452'>    <b>if</b> (err != <a href='../S/2769.html#L174' title='Defined at 174 in Modules/zlib/zlib.h.'>Z_STREAM_END</a>) <font color='red'>{</font>
<a name='L453'>        fprintf(stderr, "deflate should report Z_STREAM_END\n");
<a name='L454'>        exit(1);
<a name='L455'>    <font color='red'>}</font>
<a name='L456'>    err = <a href='../D/8007.html' title='Multiple defined in 3 places.'>deflateEnd</a>(&amp;c_stream);
<a name='L457'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "deflateEnd");
<a name='L458'><font color='red'>}</font>
<a name='L459'>
<a name='L460'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L461'><i><font color='green'> * Test inflate() with a preset dictionary</font></i>
<a name='L462'><i><font color='green'> */</font></i>
<a name='L463'><b>void</b> <a href='../R/10781.html' title='Multiple refered from 2 places.'>test_dict_inflate</a>(compr, comprLen, uncompr, uncomprLen)
<a name='L464'>    Byte *compr, *uncompr;
<a name='L465'>    uLong comprLen, uncomprLen;
<a name='L466'><font color='red'>{</font>
<a name='L467'>    <b>int</b> err;
<a name='L468'>    <a href='../S/2769.html#L104' title='Defined at 104 in Modules/zlib/zlib.h.'>z_stream</a> d_stream; <i><font color='green'>/* decompression stream */</font></i>
<a name='L469'>
<a name='L470'>    strcpy((<b>char</b>*)uncompr, "garbage");
<a name='L471'>
<a name='L472'>    d_stream.zalloc = (<a href='../D/6713.html' title='Multiple defined in 2 places.'>alloc_func</a>)0;
<a name='L473'>    d_stream.zfree = (<a href='../D/8725.html' title='Multiple defined in 2 places.'>free_func</a>)0;
<a name='L474'>    d_stream.opaque = (<a href='../D/12267.html' title='Multiple defined in 6 places.'>voidpf</a>)0;
<a name='L475'>
<a name='L476'>    d_stream.next_in  = compr;
<a name='L477'>    d_stream.avail_in = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)comprLen;
<a name='L478'>
<a name='L479'>    err = <a href='../S/2769.html#L1548' title='Defined at 1548 in Modules/zlib/zlib.h.'>inflateInit</a>(&amp;d_stream);
<a name='L480'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateInit");
<a name='L481'>
<a name='L482'>    d_stream.next_out = uncompr;
<a name='L483'>    d_stream.avail_out = (<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)uncomprLen;
<a name='L484'>
<a name='L485'>    <b>for</b> (;;) <font color='red'>{</font>
<a name='L486'>        err = <a href='../D/9156.html' title='Multiple defined in 3 places.'>inflate</a>(&amp;d_stream, <a href='../S/2769.html#L164' title='Defined at 164 in Modules/zlib/zlib.h.'>Z_NO_FLUSH</a>);
<a name='L487'>        <b>if</b> (err == <a href='../S/2769.html#L174' title='Defined at 174 in Modules/zlib/zlib.h.'>Z_STREAM_END</a>) <b>break</b>;
<a name='L488'>        <b>if</b> (err == <a href='../S/2769.html#L175' title='Defined at 175 in Modules/zlib/zlib.h.'>Z_NEED_DICT</a>) <font color='red'>{</font>
<a name='L489'>            <b>if</b> (d_stream.adler != dictId) <font color='red'>{</font>
<a name='L490'>                fprintf(stderr, "unexpected dictionary");
<a name='L491'>                exit(1);
<a name='L492'>            <font color='red'>}</font>
<a name='L493'>            err = <a href='../D/9172.html' title='Multiple defined in 3 places.'>inflateSetDictionary</a>(&amp;d_stream, (<b>const</b> <a href='../D/459.html' title='Multiple defined in 6 places.'>Bytef</a>*)dictionary,
<a name='L494'>                                       <b>sizeof</b>(dictionary));
<a name='L495'>        <font color='red'>}</font>
<a name='L496'>        <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflate with dict");
<a name='L497'>    <font color='red'>}</font>
<a name='L498'>
<a name='L499'>    err = <a href='../D/9162.html' title='Multiple defined in 3 places.'>inflateEnd</a>(&amp;d_stream);
<a name='L500'>    <a href='../S/2739.html#L22' title='Defined at 22 in Modules/zlib/example.c.'>CHECK_ERR</a>(err, "inflateEnd");
<a name='L501'>
<a name='L502'>    <b>if</b> (strcmp((<b>char</b>*)uncompr, hello)) <font color='red'>{</font>
<a name='L503'>        fprintf(stderr, "bad inflate with dict\n");
<a name='L504'>        exit(1);
<a name='L505'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L506'>        printf("inflate with dictionary: %s\n", (<b>char</b> *)uncompr);
<a name='L507'>    <font color='red'>}</font>
<a name='L508'><font color='red'>}</font>
<a name='L509'>
<a name='L510'><i><font color='green'>/* ===========================================================================</font></i>
<a name='L511'><i><font color='green'> * Usage:  example [output.gz  [input.gz]]</font></i>
<a name='L512'><i><font color='green'> */</font></i>
<a name='L513'>
<a name='L514'><b>int</b> <a href='../R/8830.html' title='Multiple refered from 2 places.'>main</a>(argc, argv)
<a name='L515'>    <b>int</b> argc;
<a name='L516'>    <b>char</b> *argv[];
<a name='L517'><font color='red'>{</font>
<a name='L518'>    <a href='../D/458.html' title='Multiple defined in 4 places.'>Byte</a> *compr, *uncompr;
<a name='L519'>    <a href='../D/11920.html' title='Multiple defined in 4 places.'>uLong</a> comprLen = 10000*<b>sizeof</b>(<b>int</b>); <i><font color='green'>/* don't overflow on MSDOS */</font></i>
<a name='L520'>    <a href='../D/11920.html' title='Multiple defined in 4 places.'>uLong</a> uncomprLen = comprLen;
<a name='L521'>    <b>static</b> <b>const</b> <b>char</b>* myVersion = <a href='../S/2769.html#L40' title='Defined at 40 in Modules/zlib/zlib.h.'>ZLIB_VERSION</a>;
<a name='L522'>
<a name='L523'>    <b>if</b> (<a href='../D/12468.html' title='Multiple defined in 2 places.'>zlibVersion</a>()[0] != myVersion[0]) <font color='red'>{</font>
<a name='L524'>        fprintf(stderr, "incompatible zlib version\n");
<a name='L525'>        exit(1);
<a name='L526'>
<a name='L527'>    <font color='red'>}</font> <b>else</b> <b>if</b> (strcmp(<a href='../D/12468.html' title='Multiple defined in 2 places.'>zlibVersion</a>(), <a href='../S/2769.html#L40' title='Defined at 40 in Modules/zlib/zlib.h.'>ZLIB_VERSION</a>) != 0) <font color='red'>{</font>
<a name='L528'>        fprintf(stderr, "warning: different zlib version\n");
<a name='L529'>    <font color='red'>}</font>
<a name='L530'>
<a name='L531'>    printf("zlib version %s = 0x%04x, compile flags = 0x%lx\n",
<a name='L532'>            <a href='../S/2769.html#L40' title='Defined at 40 in Modules/zlib/zlib.h.'>ZLIB_VERSION</a>, <a href='../S/2769.html#L41' title='Defined at 41 in Modules/zlib/zlib.h.'>ZLIB_VERNUM</a>, <a href='../D/12467.html' title='Multiple defined in 2 places.'>zlibCompileFlags</a>());
<a name='L533'>
<a name='L534'>    compr    = (<a href='../D/458.html' title='Multiple defined in 4 places.'>Byte</a>*)calloc((<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)comprLen, 1);
<a name='L535'>    uncompr  = (<a href='../D/458.html' title='Multiple defined in 4 places.'>Byte</a>*)calloc((<a href='../D/11918.html' title='Multiple defined in 4 places.'>uInt</a>)uncomprLen, 1);
<a name='L536'>    <i><font color='green'>/* compr and uncompr are cleared to avoid reading uninitialized</font></i>
<a name='L537'><i><font color='green'>     * data and to ensure that uncompr compresses well.</font></i>
<a name='L538'><i><font color='green'>     */</font></i>
<a name='L539'>    <b>if</b> (compr == <a href='../S/2769.html#L208' title='Defined at 208 in Modules/zlib/zlib.h.'>Z_NULL</a> || uncompr == <a href='../S/2769.html#L208' title='Defined at 208 in Modules/zlib/zlib.h.'>Z_NULL</a>) <font color='red'>{</font>
<a name='L540'>        printf("out of memory\n");
<a name='L541'>        exit(1);
<a name='L542'>    <font color='red'>}</font>
<a name='L543'>    <a href='../S/2739.html#L59' title='Defined at 59 in Modules/zlib/example.c.'>test_compress</a>(compr, comprLen, uncompr, uncomprLen);
<a name='L544'>
<a name='L545'>    <a href='../S/2739.html#L85' title='Defined at 85 in Modules/zlib/example.c.'>test_gzio</a>((argc &gt; 1 ? argv[1] : <a href='../D/5138.html' title='Multiple defined in 2 places.'>TESTFILE</a>),
<a name='L546'>              uncompr, uncomprLen);
<a name='L547'>
<a name='L548'>    <a href='../S/2739.html#L169' title='Defined at 169 in Modules/zlib/example.c.'>test_deflate</a>(compr, comprLen);
<a name='L549'>    <a href='../S/2739.html#L207' title='Defined at 207 in Modules/zlib/example.c.'>test_inflate</a>(compr, comprLen, uncompr, uncomprLen);
<a name='L550'>
<a name='L551'>    <a href='../S/2739.html#L248' title='Defined at 248 in Modules/zlib/example.c.'>test_large_deflate</a>(compr, comprLen, uncompr, uncomprLen);
<a name='L552'>    <a href='../S/2739.html#L303' title='Defined at 303 in Modules/zlib/example.c.'>test_large_inflate</a>(compr, comprLen, uncompr, uncomprLen);
<a name='L553'>
<a name='L554'>    <a href='../S/2739.html#L344' title='Defined at 344 in Modules/zlib/example.c.'>test_flush</a>(compr, &amp;comprLen);
<a name='L555'>    <a href='../S/2739.html#L382' title='Defined at 382 in Modules/zlib/example.c.'>test_sync</a>(compr, comprLen, uncompr, uncomprLen);
<a name='L556'>    comprLen = uncomprLen;
<a name='L557'>
<a name='L558'>    <a href='../S/2739.html#L426' title='Defined at 426 in Modules/zlib/example.c.'>test_dict_deflate</a>(compr, comprLen);
<a name='L559'>    <a href='../S/2739.html#L463' title='Defined at 463 in Modules/zlib/example.c.'>test_dict_inflate</a>(compr, comprLen, uncompr, uncomprLen);
<a name='L560'>
<a name='L561'>    free(compr);
<a name='L562'>    free(uncompr);
<a name='L563'>
<a name='L564'>    <b>return</b> 0;
<a name='L565'><font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L59'>[^]</a><a href='#L514'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
